<!DOCTYPE html><html> <head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1"><meta name=robots context="index, archive"><!--  --><script>
      const versions_json = "../../../../../versions.json";
      const search_worker_js = "../../../../assets/javascript/search-worker.js";
      const search_index_json = "../../../../search/search_index.json";
      const base_url = '../../../..';
    </script><!-- Site title --><title>Secagg - Fed-BioMed</title><link rel=icon type=image/x-icon href=../../../../favicon.ico><!-- Page description --><meta name=description content="Open, Transparent and Trusted Collaborative Learning for Real-world Healthcare Applications"><!-- Page keywords --><!-- Page author --><!-- Latest compiled and minified CSS --><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><!-- Bootstrap Icons --><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link href=../../../../assets/_mkdocstrings.css rel=stylesheet><link href=../../../../assets/css/style.css rel=stylesheet></head> <body> <header> <div class="container-fluid top-bar"> <div class=brand> <a href=/ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <nav class=top> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class="container-fluid top-bar-mobile"> <div class=mobile-bar> <div class=brand> <a href=../../../../ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <div class=hum-menu> <img class=open src=../../../../assets/img/menu.svg> <img class=close style=display:none src=../../../../assets/img/cancel.svg> </div> </div> <nav class=top-mobile> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> </header> <div class=main> <!-- Home page --> <div class=container-fluid> <div class=doc-row> <div class=left-col> <div class=sidebar-doc> <nav class=sidebar-inner> <ul class="sidebar-menu-left sub"> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Getting Started <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ class>What's Fed-BioMed</a> </li> <li class> <a href=../../../../getting-started/getting-started/ class>Basic Example</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-architecture/ class>Fedbiomed Architecture</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-workflow/ class>Fedbiomed Workflow</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Tutorials <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Installation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/installation/0-basic-software-installation/ class>Software Installation</a> </li> <li class> <a href=../../../../tutorials/installation/1-setting-up-environment/ class>Setting Up Environment</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> PyTorch <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/pytorch/01_PyTorch_MNIST_Single_Node_Tutorial/ class>PyTorch MNIST Basic Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/02_Create_Your_Custom_Training_Plan/ class>How to Create Your Custom PyTorch Training Plan</a> </li> <li class> <a href=../../../../tutorials/pytorch/03_PyTorch_Used_Cars_Dataset_Example/ class>PyTorch Used Cars Dataset Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/04-Aggregation_in_Fed-BioMed/ class>PyTorch aggregation methods in Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/pytorch/05_Transfer-learning_tutorial_usingDenseNet-121/ class>Transfer-learning in Fed-BioMed tutorial</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> MONAI <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/monai/01_monai-2d-image-classification/ class>Federated 2d image classification with MONAI</a> </li> <li class> <a href=../../../../tutorials/monai/02_monai-2d-image-registration/ class>Federated 2d XRay registration with MONAI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Scikit-Learn <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/scikit-learn/01_sklearn_MNIST_classification_tutorial/ class>MNIST classification with Scikit-Learn Classifier (Perceptron)</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/02_sklearn_sgd_regressor_tutorial/ class>Fed-BioMed to train a federated SGD regressor model</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/03-other-scikit-learn-models/ class>Implementing other Scikit Learn models for Federated Learning</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Optimizers <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/optimizers/01-fedopt-and-scaffold/ class>Advanced optimizers in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> FLamby <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/flamby/flamby/ class>General Concepts</a> </li> <li class> <a href=../../../../tutorials/flamby/flamby-integration-into-fedbiomed/ class>FLamby integration in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Advanced <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/advanced/in-depth-experiment-configuration/ class>In Depth Experiment Configuration</a> </li> <li class> <a href=../../../../tutorials/advanced/training-with-gpu/ class>PyTorch model training using a GPU</a> </li> <li class> <a href=../../../../tutorials/advanced/breakpoints/ class>Breakpoints</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Security <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/security/differential-privacy-with-opacus-on-fedbiomed/ class>Using Differential Privacy with OPACUS on Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/security/non-private-local-central-dp-monai-2d-image-registration/ class>Local and Central DP with Fed-BioMed: MONAI 2d image registration</a> </li> <li class> <a href=../../../../tutorials/security/training-with-approved-training-plans/ class>Training Process with Training Plan Management</a> </li> <li class> <a href=../../../../tutorials/security/secure-aggregation/ class>Training with Secure Aggregation</a> </li> <li class> <a href=../../../../tutorials/concrete-ml/concrete-ml/ class>End-to-end Privacy Preserving Training and Inference on Medical Data</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Biomedical data <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/medical/medical-image-segmentation-unet-library/ class>Brain Segmentation</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> User Guide <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/glossary/ class>Glossary</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Deployment <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/deployment/deployment/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/deployment/deployment-vpn/ class>VPN Deployment</a> </li> <li class> <a href=../../../../user-guide/deployment/matrix/ class>Network matrix</a> </li> <li class> <a href=../../../../user-guide/deployment/security-model/ class>Security model</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/nodes/configuring-nodes/ class>Configuring Nodes</a> </li> <li class> <a href=../../../../user-guide/nodes/deploying-datasets/ class>Deploying Datasets</a> </li> <li class> <a href=../../../../user-guide/nodes/training-plan-security-manager/ class>Training Plan Management</a> </li> <li class> <a href=../../../../user-guide/nodes/using-gpu/ class>Using GPU</a> </li> <li class> <a href=../../../../user-guide/nodes/node-gui/ class>Node GUI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/researcher/training-plan/ class>Training Plan</a> </li> <li class> <a href=../../../../user-guide/researcher/training-data/ class>Training Data</a> </li> <li class> <a href=../../../../user-guide/researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../../../user-guide/researcher/aggregation/ class>Aggregation</a> </li> <li class> <a href=../../../../user-guide/researcher/listing-datasets-and-selecting-nodes/ class>Listing Datasets and Selecting Nodes</a> </li> <li class> <a href=../../../../user-guide/researcher/model-testing-during-federated-training/ class>Model Validation on the Node Side</a> </li> <li class> <a href=../../../../user-guide/researcher/tensorboard/ class>Tensorboard</a> </li> </ul> </li> <li class> <a href=../../../../user-guide/advanced-optimization/ class>Optimization</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Secure Aggregation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/secagg/introduction/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/secagg/configuration/ class>Configuration</a> </li> <li class> <a href=../../../../user-guide/secagg/researcher-interface/ class>Managing Secure Aggregation in Researcher</a> </li> <li class> <a href=../../../../user-guide/secagg/certificate-registration/ class>Joye-Libert Cert. Registration</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Developer <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> API Reference <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Common <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li class> <a href=../certificate_manager/ class>Certificate Manager</a> </li> <li class> <a href=../cli/ class>CLI</a> </li> <li class> <a href=../config/ class>Config</a> </li> <li class> <a href=../constants/ class>Constants</a> </li> <li class> <a href=../data/ class>Data</a> </li> <li class> <a href=../db/ class>DB</a> </li> <li class> <a href=../environ/ class>Environ</a> </li> <li class> <a href=../exceptions/ class>Exceptions</a> </li> <li class> <a href=../ipython/ class>IPython</a> </li> <li class> <a href=../json/ class>Json</a> </li> <li class> <a href=../logger/ class>Logger</a> </li> <li class> <a href=../message/ class>Message</a> </li> <li class> <a href=../metrics/ class>Metrics</a> </li> <li class> <a href=../models/ class>Model</a> </li> <li class> <a href=../mpc_controller/ class>MPC controller</a> </li> <li class> <a href=../optimizers/ class>Optimizers</a> </li> <li class> <a href=../privacy/ class>Privacy</a> </li> <li class=current> <a href=./ class="link current">Secagg</a> </li> <li class> <a href=../secagg_manager/ class>Secagg Manager</a> </li> <li class> <a href=../serializer/ class>Serializer</a> </li> <li class> <a href=../singleton/ class>Singleton</a> </li> <li class> <a href=../synchro/ class>Synchro</a> </li> <li class> <a href=../tasks_queue/ class>TasksQueue</a> </li> <li class> <a href=../training_plans/ class>TrainingPlans</a> </li> <li class> <a href=../training_args/ class>TrainingArgs</a> </li> <li class> <a href=../utils/ class>Utils</a> </li> <li class> <a href=../validator/ class>Validator</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../node/cli/ class>CLI</a> </li> <li class> <a href=../../node/cli_utils/ class>CLI Utils</a> </li> <li class> <a href=../../node/config/ class>Config</a> </li> <li class> <a href=../../node/dataset_manager/ class>DatasetManager</a> </li> <li class> <a href=../../node/environ/ class>Environ</a> </li> <li class> <a href=../../node/history_monitor/ class>HistoryMonitor</a> </li> <li class> <a href=../../node/node/ class>Node</a> </li> <li class> <a href=../../node/node_state_manager/ class>NodeStateManager</a> </li> <li class> <a href=../../node/requests/ class>Requests</a> </li> <li class> <a href=../../node/round/ class>Round</a> </li> <li class> <a href=../../node/secagg/ class>Secagg</a> </li> <li class> <a href=../../node/secagg_manager/ class>Secagg Manager</a> </li> <li class> <a href=../../node/training_plan_security_manager/ class>TrainingPlanSecurityManager</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../researcher/aggregators/ class>Aggregators</a> </li> <li class> <a href=../../researcher/cli/ class>CLI</a> </li> <li class> <a href=../../researcher/config/ class>Config</a> </li> <li class> <a href=../../researcher/datasets/ class>Datasets</a> </li> <li class> <a href=../../researcher/environ/ class>Environ</a> </li> <li class> <a href=../../researcher/federated_workflows/ class>Federated Workflows</a> </li> <li class> <a href=../../researcher/filetools/ class>Filetools</a> </li> <li class> <a href=../../researcher/jobs/ class>Jobs</a> </li> <li class> <a href=../../researcher/monitor/ class>Monitor</a> </li> <li class> <a href=../../researcher/node_state_agent/ class>NodeStateAgent</a> </li> <li class> <a href=../../researcher/requests/ class>Requests</a> </li> <li class> <a href=../../researcher/secagg/ class>Secagg</a> </li> <li class> <a href=../../researcher/strategies/ class>Strategies</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Transport <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../transport/client/ class>Client</a> </li> <li class> <a href=../../transport/controller/ class>Controller</a> </li> <li class> <a href=../../transport/node_agent/ class>NodeAgent</a> </li> <li class> <a href=../../transport/server/ class>Server</a> </li> </ul> </li> </ul> </li> <li class> <a href=../../../usage_and_tools/ class>Usage and Tools</a> </li> <li class> <a href=../../../ci/ class>Continuous Integration</a> </li> <li class> <a href=../../../definition-of-done/ class>Definition of Done</a> </li> <li class> <a href=../../../testing-in-fedbiomed/ class>Testing in Fed-BioMed</a> </li> <li class> <a href=../../../messaging/ class>RPC Protocol and Messages</a> </li> </ul> </li> </ul> </nav> </div> </div> <div class=main-col> <main class=main-docs> <h1>Secagg</h1> <article> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <div class="doc doc-children"> <h2 id=fedbiomed.common.secagg-classes>Classes</h2> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.secagg.DHKey class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">DHKey</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>DHKey</span><span class=p>(</span><span class=n>private_key_pem</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>public_key_pem</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Key handling for ephemeral-ephemeral ECDH, a session is defined for each experiment.</p> <p>This class handles the generation and importing of ECC keys using the P-256 curve. It provides methods to export the private and public keys in PEM format as bytes.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" title="fedbiomed.common.secagg.DHKey.private_key" href="#fedbiomed.common.secagg.DHKey.private_key">private_key</a></code></td> <td> </td> <td> <div class=doc-md-description> <p>The user's private ECC key.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" title="fedbiomed.common.secagg.DHKey.public_key" href="#fedbiomed.common.secagg.DHKey.public_key">public_key</a></code></td> <td> </td> <td> <div class=doc-md-description> <p>The user's public ECC key.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>private_key_pem</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a> | None</code> </td> <td> <div class=doc-md-description> <p>Optional. The private key in PEM format.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>public_key_pem</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a> | None</code> </td> <td> <div class=doc-md-description> <p>Optional. The public key in PEM format.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_dh.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="24 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos="25 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="26 "></span>    <span class=n>private_key_pem</span><span class=p>:</span> <span class=nb>bytes</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="27 "></span>    <span class=n>public_key_pem</span><span class=p>:</span> <span class=nb>bytes</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="28 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="29 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="30 "></span><span class=sd>    Initializes the DHKey instance by generating a new key pair or importing the provided keys.</span>
<span class=linenos data-linenos="31 "></span>
<span class=linenos data-linenos="32 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="33 "></span><span class=sd>        private_key_pem: Optional. The private key in PEM format.</span>
<span class=linenos data-linenos="34 "></span><span class=sd>        public_key_pem: Optional. The public key in PEM format.</span>
<span class=linenos data-linenos="35 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="36 "></span>    <span class=k>if</span> <span class=n>private_key_pem</span><span class=p>:</span>
<span class=linenos data-linenos="37 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>private_key</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_import_key</span><span class=p>(</span>
<span class=linenos data-linenos="38 "></span>            <span class=n>serialization</span><span class=o>.</span><span class=n>load_pem_private_key</span><span class=p>,</span>
<span class=linenos data-linenos="39 "></span>            <span class=n>data</span><span class=o>=</span><span class=n>private_key_pem</span><span class=p>,</span>
<span class=linenos data-linenos="40 "></span>            <span class=n>password</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="41 "></span>            <span class=n>backend</span><span class=o>=</span><span class=n>default_backend</span><span class=p>()</span>
<span class=linenos data-linenos="42 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="43 "></span>    <span class=k>elif</span> <span class=ow>not</span> <span class=n>public_key_pem</span><span class=p>:</span>
<span class=linenos data-linenos="44 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>private_key</span> <span class=o>=</span> <span class=n>ec</span><span class=o>.</span><span class=n>generate_private_key</span><span class=p>(</span>
<span class=linenos data-linenos="45 "></span>            <span class=n>ec</span><span class=o>.</span><span class=n>SECP256R1</span><span class=p>(),</span> <span class=n>default_backend</span><span class=p>()</span>
<span class=linenos data-linenos="46 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="47 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="48 "></span>        <span class=c1># Means that only public key is loaded</span>
<span class=linenos data-linenos="49 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>private_key</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="50 "></span>
<span class=linenos data-linenos="51 "></span>    <span class=k>if</span> <span class=n>public_key_pem</span><span class=p>:</span>
<span class=linenos data-linenos="52 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>public_key</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_import_key</span><span class=p>(</span><span class=n>serialization</span><span class=o>.</span><span class=n>load_pem_public_key</span><span class=p>,</span>
<span class=linenos data-linenos="53 "></span>                                           <span class=n>data</span><span class=o>=</span><span class=n>public_key_pem</span><span class=p>,</span>
<span class=linenos data-linenos="54 "></span>                                           <span class=n>backend</span><span class=o>=</span><span class=n>default_backend</span><span class=p>()</span>
<span class=linenos data-linenos="55 "></span>                                           <span class=p>)</span>
<span class=linenos data-linenos="56 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="57 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>public_key</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>private_key</span><span class=o>.</span><span class=n>public_key</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.secagg.DHKey-attributes>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.secagg.DHKey.private_key class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">private_key</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=n>private_key</span> <span class=o>=</span> <span class=n>_import_key</span><span class=p>(</span><span class=n>load_pem_private_key</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>private_key_pem</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>default_backend</span><span class=p>())</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.secagg.DHKey.public_key class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">public_key</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=n>public_key</span> <span class=o>=</span> <span class=n>_import_key</span><span class=p>(</span><span class=n>load_pem_public_key</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>public_key_pem</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>default_backend</span><span class=p>())</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.common.secagg.DHKey-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.DHKey.export_private_key class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">export_private_key</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>export_private_key</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Exports the private key to PEM format.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>The private key in PEM format. Returns <code>None</code> if private key is not loaded.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_dh.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="60 "></span><span class=k>def</span> <span class=nf>export_private_key</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos="61 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="62 "></span><span class=sd>    Exports the private key to PEM format.</span>
<span class=linenos data-linenos="63 "></span>
<span class=linenos data-linenos="64 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="65 "></span><span class=sd>        The private key in PEM format. Returns `None` if private key</span>
<span class=linenos data-linenos="66 "></span><span class=sd>            is not loaded.</span>
<span class=linenos data-linenos="67 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="68 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>private_key</span><span class=p>:</span>
<span class=linenos data-linenos="69 "></span>        <span class=k>return</span> <span class=kc>None</span>
<span class=linenos data-linenos="70 "></span>
<span class=linenos data-linenos="71 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>private_key</span><span class=o>.</span><span class=n>private_bytes</span><span class=p>(</span>
<span class=linenos data-linenos="72 "></span>        <span class=n>encoding</span><span class=o>=</span><span class=n>serialization</span><span class=o>.</span><span class=n>Encoding</span><span class=o>.</span><span class=n>PEM</span><span class=p>,</span>
<span class=linenos data-linenos="73 "></span>        <span class=nb>format</span><span class=o>=</span><span class=n>serialization</span><span class=o>.</span><span class=n>PrivateFormat</span><span class=o>.</span><span class=n>PKCS8</span><span class=p>,</span>
<span class=linenos data-linenos="74 "></span>        <span class=n>encryption_algorithm</span><span class=o>=</span><span class=n>serialization</span><span class=o>.</span><span class=n>NoEncryption</span><span class=p>(),</span>
<span class=linenos data-linenos="75 "></span>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.DHKey.export_public_key class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">export_public_key</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>export_public_key</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Exports the public key to PEM format.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>The public key in PEM format.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_dh.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="77 "></span><span class=k>def</span> <span class=nf>export_public_key</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos="78 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="79 "></span><span class=sd>    Exports the public key to PEM format.</span>
<span class=linenos data-linenos="80 "></span>
<span class=linenos data-linenos="81 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="82 "></span><span class=sd>        The public key in PEM format.</span>
<span class=linenos data-linenos="83 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="84 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>public_key</span><span class=o>.</span><span class=n>public_bytes</span><span class=p>(</span>
<span class=linenos data-linenos="85 "></span>        <span class=n>encoding</span><span class=o>=</span><span class=n>serialization</span><span class=o>.</span><span class=n>Encoding</span><span class=o>.</span><span class=n>PEM</span><span class=p>,</span>
<span class=linenos data-linenos="86 "></span>        <span class=nb>format</span><span class=o>=</span><span class=n>serialization</span><span class=o>.</span><span class=n>PublicFormat</span><span class=o>.</span><span class=n>SubjectPublicKeyInfo</span><span class=p>,</span>
<span class=linenos data-linenos="87 "></span>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.secagg.DHKeyAgreement class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">DHKeyAgreement</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>DHKeyAgreement</span><span class=p>(</span><span class=n>node_u_id</span><span class=p>,</span> <span class=n>node_u_dh_key</span><span class=p>,</span> <span class=n>session_salt</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Key Agreement with ephemeral-ephemeral ECDH, a session is defined for each experiment.</p> <p>This class handles the key agreement process using the private ECC key of the user. It imports the private key, performs the key exchange, and derives the shared secret using a KDF.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="fedbiomed.common.secagg.DHKeyAgreement.private_key">private_key</span></code></td> <td> </td> <td> <div class=doc-md-description> <p>The user's private ECC key.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>node_u_id</code></td> <td> </td> <td> <div class=doc-md-description> <p>The ID of the node.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>node_u_dh_key</code></td> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.secagg._dh.DHKey" href="#fedbiomed.common.secagg.DHKey">DHKey</a></code> </td> <td> <div class=doc-md-description> <p>The keypair of the node.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>session_salt</code></td> <td> </td> <td> <div class=doc-md-description> <p>A session-specific salt.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_dh.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="117 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>node_u_id</span><span class=p>,</span> <span class=n>node_u_dh_key</span><span class=p>:</span> <span class=n>DHKey</span><span class=p>,</span> <span class=n>session_salt</span><span class=p>):</span>
<span class=linenos data-linenos="118 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="119 "></span><span class=sd>    Initializes the DHKeyAgreement instance.</span>
<span class=linenos data-linenos="120 "></span>
<span class=linenos data-linenos="121 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="122 "></span><span class=sd>        node_u_id: The ID of the node.</span>
<span class=linenos data-linenos="123 "></span><span class=sd>        node_u_dh_key: The keypair of the node.</span>
<span class=linenos data-linenos="124 "></span><span class=sd>        session_salt: A session-specific salt.</span>
<span class=linenos data-linenos="125 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="126 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_node_u_id</span> <span class=o>=</span> <span class=n>node_u_id</span>
<span class=linenos data-linenos="127 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_dh_key</span> <span class=o>=</span> <span class=n>node_u_dh_key</span>
<span class=linenos data-linenos="128 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>session_salt</span> <span class=o>=</span> <span class=n>session_salt</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.secagg.DHKeyAgreement-attributes>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.secagg.DHKeyAgreement.session_salt class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">session_salt</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=n>session_salt</span> <span class=o>=</span> <span class=n>session_salt</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.common.secagg.DHKeyAgreement-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.DHKeyAgreement.agree class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">agree</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>agree</span><span class=p>(</span><span class=n>node_v_id</span><span class=p>,</span> <span class=n>public_key_pem</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Performs the key agreement and derives the shared secret.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>node_v_id</code></td> <td> </td> <td> <div class=doc-md-description> <p>The ID of the other node (node_v).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>public_key_pem</code></td> <td> </td> <td> <div class=doc-md-description> <p>The public key of the other node in PEM format as bytes.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>The derived shared secret.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_dh.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="154 "></span><span class=k>def</span> <span class=nf>agree</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>node_v_id</span><span class=p>,</span> <span class=n>public_key_pem</span><span class=p>):</span>
<span class=linenos data-linenos="155 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="156 "></span><span class=sd>    Performs the key agreement and derives the shared secret.</span>
<span class=linenos data-linenos="157 "></span>
<span class=linenos data-linenos="158 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="159 "></span><span class=sd>        node_v_id: The ID of the other node (node_v).</span>
<span class=linenos data-linenos="160 "></span><span class=sd>        public_key_pem: The public key of the other node in PEM format as bytes.</span>
<span class=linenos data-linenos="161 "></span>
<span class=linenos data-linenos="162 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="163 "></span><span class=sd>        The derived shared secret.</span>
<span class=linenos data-linenos="164 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="165 "></span>    <span class=n>dh_v_key</span> <span class=o>=</span> <span class=n>DHKey</span><span class=p>(</span><span class=n>public_key_pem</span><span class=o>=</span><span class=n>public_key_pem</span><span class=p>)</span>
<span class=linenos data-linenos="166 "></span>    <span class=n>shared_secret</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_dh_key</span><span class=o>.</span><span class=n>private_key</span><span class=o>.</span><span class=n>exchange</span><span class=p>(</span><span class=n>ec</span><span class=o>.</span><span class=n>ECDH</span><span class=p>(),</span> <span class=n>dh_v_key</span><span class=o>.</span><span class=n>public_key</span><span class=p>)</span>
<span class=linenos data-linenos="167 "></span>    <span class=n>derived_key</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_kdf</span><span class=p>(</span><span class=n>shared_secret</span><span class=p>,</span> <span class=n>node_v_id</span><span class=p>)</span>
<span class=linenos data-linenos="168 "></span>    <span class=k>return</span> <span class=n>derived_key</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.secagg.EncryptedNumber class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">EncryptedNumber</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>EncryptedNumber</span><span class=p>(</span><span class=n>param</span><span class=p>,</span> <span class=n>ciphertext</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a></code></p> <p>An encrypted number by one of the user keys .</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="fedbiomed.common.secagg.EncryptedNumber.param">param</span></code></td> <td> </td> <td> <div class=doc-md-description> <p>The public parameters</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><a class="autorefs autorefs-internal" title="fedbiomed.common.secagg.EncryptedNumber.ciphertext" href="#fedbiomed.common.secagg.EncryptedNumber.ciphertext">ciphertext</a></code></td> <td> </td> <td> <div class=doc-md-description> <p>The integer value of the ciphertext</p> </div> </td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code>ciphertext: The integer value of the ciphertext
</code></pre></div> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_jls.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="325 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param</span><span class=p>:</span> <span class=n>PublicParam</span><span class=p>,</span> <span class=n>ciphertext</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos="326 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="327 "></span>
<span class=linenos data-linenos="328 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="329 "></span><span class=sd>        param: The public parameters.</span>
<span class=linenos data-linenos="330 "></span><span class=sd>        ciphertext: The integer value of the ciphertext</span>
<span class=linenos data-linenos="331 "></span>
<span class=linenos data-linenos="332 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="333 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>public_param</span> <span class=o>=</span> <span class=n>param</span>
<span class=linenos data-linenos="334 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>ciphertext</span> <span class=o>=</span> <span class=n>mpz</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.secagg.EncryptedNumber-attributes>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.secagg.EncryptedNumber.ciphertext class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">ciphertext</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=n>ciphertext</span> <span class=o>=</span> <span class=n>mpz</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.secagg.EncryptedNumber.public_param class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">public_param</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=n>public_param</span> <span class=o>=</span> <span class=n>param</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.secagg.JoyeLibert class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">JoyeLibert</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>JoyeLibert</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>The Joye-Libert scheme. It consists of three Probabilistic Polynomial Time algorithms: <code>Protect</code>, and <code>Agg</code>.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="fedbiomed.common.secagg.JoyeLibert._vector_encoder">_vector_encoder</span></code></td> <td> </td> <td> <div class=doc-md-description> <p>The vector encoding/decoding scheme</p> </div> </td> </tr> </tbody> </table> <p>VEParameters.TARGET_RANGE + VEParameters.WEIGHT_RANGE should be equal or less than 2**32</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_jls.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="620 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos="621 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructs the class</span>
<span class=linenos data-linenos="622 "></span>
<span class=linenos data-linenos="623 "></span><span class=sd>    VEParameters.TARGET_RANGE + VEParameters.WEIGHT_RANGE should be</span>
<span class=linenos data-linenos="624 "></span><span class=sd>    equal or less than 2**32</span>
<span class=linenos data-linenos="625 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="626 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_vector_encoder</span> <span class=o>=</span> <span class=n>VES</span><span class=p>(</span>
<span class=linenos data-linenos="627 "></span>        <span class=n>ptsize</span><span class=o>=</span><span class=n>SAParameters</span><span class=o>.</span><span class=n>KEY_SIZE</span> <span class=o>//</span> <span class=mi>2</span><span class=p>,</span>
<span class=linenos data-linenos="628 "></span>        <span class=n>valuesize</span><span class=o>=</span><span class=n>ceil</span><span class=p>(</span><span class=n>log2</span><span class=p>(</span><span class=n>SAParameters</span><span class=o>.</span><span class=n>TARGET_RANGE</span><span class=p>)</span> <span class=o>+</span> <span class=n>log2</span><span class=p>(</span><span class=n>SAParameters</span><span class=o>.</span><span class=n>WEIGHT_RANGE</span><span class=p>))</span>
<span class=linenos data-linenos="629 "></span>    <span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.secagg.JoyeLibert-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.JoyeLibert.aggregate class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">aggregate</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>aggregate</span><span class=p>(</span><span class=n>sk_0</span><span class=p>,</span> <span class=n>tau</span><span class=p>,</span> <span class=n>list_y_u_tau</span><span class=p>,</span> <span class=n>num_expected_params</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Aggregates users protected inputs with the server's secret key</p> <p><span class=arithmatex>\(X_{\tau} \gets \textbf{JL.Agg}(public_param, sk_0,\tau, \{y_{u,\tau}\}_{u \in \{1,..,n\}})\)</span></p> <p>This algorithm aggregates the <span class=arithmatex>\(n\)</span> ciphers received at time period <span class=arithmatex>\(\tau\)</span> to obtain <span class=arithmatex>\(y_{\tau} = \prod_1^n{y_{u,\tau}}\)</span> and decrypts the result. It obtains the sum of the private inputs ( <span class=arithmatex>\( X_{\tau} = \sum_{1}^n{x_{u,\tau}} \)</span> ) as follows:</p> <div class=arithmatex>\[V_{\tau} = H(\tau)^{sk_0} \cdot y_{\tau} \qquad \qquad X_{\tau} = \frac{V_{\tau}-1}{N} \mod N\]</div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>sk_0</code></td> <td> <code><span title="fedbiomed.common.secagg._jls.ServerKey">ServerKey</span></code> </td> <td> <div class=doc-md-description> <p>The server's secret key <span class=arithmatex>\(sk_0\)</span></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>tau</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>The time period <span class=arithmatex>\(\tau\)</span></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>list_y_u_tau</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.secagg._jls.EncryptedNumber" href="#fedbiomed.common.secagg.EncryptedNumber">EncryptedNumber</a>]]</code> </td> <td> <div class=doc-md-description> <p>A list of the users' protected inputs <span class=arithmatex>\(\{y_{u,\tau}\}_{u \in \{1,..,n\}}\)</span></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>num_expected_params</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Number of parameters to decode from the decrypted vectors</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>The sum of the users' inputs of type <code>int</code></p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument value</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_jls.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="680 "></span><span class=k>def</span> <span class=nf>aggregate</span><span class=p>(</span>
<span class=linenos data-linenos="681 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="682 "></span>        <span class=n>sk_0</span><span class=p>:</span> <span class=n>ServerKey</span><span class=p>,</span>
<span class=linenos data-linenos="683 "></span>        <span class=n>tau</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="684 "></span>        <span class=n>list_y_u_tau</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=n>EncryptedNumber</span><span class=p>]],</span>
<span class=linenos data-linenos="685 "></span>        <span class=n>num_expected_params</span><span class=p>:</span> <span class=nb>int</span>
<span class=linenos data-linenos="686 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<span class=linenos data-linenos="687 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Aggregates users protected inputs with the server&#39;s secret key</span>
<span class=linenos data-linenos="688 "></span>
<span class=linenos data-linenos="689 "></span>
<span class=linenos data-linenos="690 "></span><span class=sd>    \\(X_{\\tau} \\gets \\textbf{JL.Agg}(public_param, sk_0,\\tau, \\{y_{u,\\tau}\\}_{u \\in \\{1,..,n\\}})\\)</span>
<span class=linenos data-linenos="691 "></span>
<span class=linenos data-linenos="692 "></span><span class=sd>    This algorithm aggregates the \\(n\\) ciphers received at time period \\(\\tau\\) to obtain</span>
<span class=linenos data-linenos="693 "></span><span class=sd>    \\(y_{\\tau} = \\prod_1^n{y_{u,\\tau}}\\) and decrypts the result.</span>
<span class=linenos data-linenos="694 "></span><span class=sd>    It obtains the sum of the private inputs ( \\( X_{\\tau} = \\sum_{1}^n{x_{u,\\tau}} \\) )</span>
<span class=linenos data-linenos="695 "></span><span class=sd>    as follows:</span>
<span class=linenos data-linenos="696 "></span>
<span class=linenos data-linenos="697 "></span><span class=sd>    $$V_{\\tau} = H(\\tau)^{sk_0} \\cdot y_{\\tau} \\qquad \\qquad X_{\\tau} = \\frac{V_{\\tau}-1}{N} \\mod N$$</span>
<span class=linenos data-linenos="698 "></span>
<span class=linenos data-linenos="699 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="700 "></span><span class=sd>        sk_0: The server&#39;s secret key \\(sk_0\\)</span>
<span class=linenos data-linenos="701 "></span><span class=sd>        tau: The time period \\(\\tau\\)</span>
<span class=linenos data-linenos="702 "></span><span class=sd>        list_y_u_tau: A list of the users&#39; protected inputs \\(\\{y_{u,\\tau}\\}_{u \\in \\{1,..,n\\}}\\)</span>
<span class=linenos data-linenos="703 "></span><span class=sd>        num_expected_params: Number of parameters to decode from the decrypted vectors</span>
<span class=linenos data-linenos="704 "></span>
<span class=linenos data-linenos="705 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="706 "></span><span class=sd>        The sum of the users&#39; inputs of type `int`</span>
<span class=linenos data-linenos="707 "></span>
<span class=linenos data-linenos="708 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="709 "></span><span class=sd>        ValueError: bad argument value</span>
<span class=linenos data-linenos="710 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="711 "></span>
<span class=linenos data-linenos="712 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>sk_0</span><span class=p>,</span> <span class=n>ServerKey</span><span class=p>):</span>
<span class=linenos data-linenos="713 "></span>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Key must be an instance of `ServerKey`&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="714 "></span>
<span class=linenos data-linenos="715 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>list_y_u_tau</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>list_y_u_tau</span><span class=p>:</span>
<span class=linenos data-linenos="716 "></span>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;list_y_u_tau should be a non-empty list.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="717 "></span>
<span class=linenos data-linenos="718 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>list_y_u_tau</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nb>list</span><span class=p>):</span>
<span class=linenos data-linenos="719 "></span>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;list_y_u_tau should be a list that contains list of encrypted numbers&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="720 "></span>
<span class=linenos data-linenos="721 "></span>    <span class=n>n_user</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>list_y_u_tau</span><span class=p>)</span>
<span class=linenos data-linenos="722 "></span>
<span class=linenos data-linenos="723 "></span>    <span class=n>sum_of_vectors</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>EncryptedNumber</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=nb>sum</span><span class=p>(</span><span class=n>ep</span><span class=p>)</span> <span class=k>for</span> <span class=n>ep</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=o>*</span><span class=n>list_y_u_tau</span><span class=p>)]</span>
<span class=linenos data-linenos="724 "></span>
<span class=linenos data-linenos="725 "></span>    <span class=n>decrypted_vector</span> <span class=o>=</span> <span class=n>sk_0</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>sum_of_vectors</span><span class=p>,</span> <span class=n>tau</span><span class=p>)</span>
<span class=linenos data-linenos="726 "></span>
<span class=linenos data-linenos="727 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_vector_encoder</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>decrypted_vector</span><span class=p>,</span> <span class=n>add_ops</span><span class=o>=</span><span class=n>n_user</span><span class=p>,</span> <span class=n>v_expected</span><span class=o>=</span><span class=n>num_expected_params</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.JoyeLibert.protect class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">protect</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>protect</span><span class=p>(</span><span class=n>public_param</span><span class=p>,</span> <span class=n>user_key</span><span class=p>,</span> <span class=n>tau</span><span class=p>,</span> <span class=n>x_u_tau</span><span class=p>,</span> <span class=n>n_users</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Protect user input with the user's secret key:</p> <p><span class=arithmatex>\(y_{u,\tau} \gets \textbf{JL.Protect}(public_param,sk_u,\tau,x_{u,\tau})\)</span></p> <p>This algorithm encrypts private inputs <span class=arithmatex>\(x_{u,\tau} \in \mathbb{Z}_N\)</span> for time period <span class=arithmatex>\(\tau\)</span> using secret key <span class=arithmatex>\(sk_u \in \mathbb{Z}_N^2\)</span> . It outputs cipher <span class=arithmatex>\(y_{u,\tau}\)</span> such that:</p> <div class=arithmatex>\[y_{u,\tau} = (1 + x_{u,\tau} N) H(\tau)^{sk_u} \mod N^2\]</div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>public_param</code></td> <td> <code><span title="fedbiomed.common.secagg._jls.PublicParam">PublicParam</span></code> </td> <td> <div class=doc-md-description> <p>The public parameters <span class=arithmatex>\(public_param\)</span></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>user_key</code></td> <td> <code><span title="fedbiomed.common.secagg._jls.UserKey">UserKey</span></code> </td> <td> <div class=doc-md-description> <p>The user's secret key <span class=arithmatex>\(sk_u\)</span></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>tau</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>The time period <span class=arithmatex>\(\tau\)</span></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>x_u_tau</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>The user's input <span class=arithmatex>\(x_{u,\tau}\)</span></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>n_users</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Number of nodes/users that participates secure aggregation</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<span title="gmpy2.mpz">mpz</span>]</code> </td> <td> <div class=doc-md-description> <p>The protected input of type <code>EncryptedNumber</code> or a list of <code>EncryptedNumber</code></p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#TypeError">TypeError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument value</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_jls.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="631 "></span><span class=k>def</span> <span class=nf>protect</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="632 "></span>            <span class=n>public_param</span><span class=p>:</span> <span class=n>PublicParam</span><span class=p>,</span>
<span class=linenos data-linenos="633 "></span>            <span class=n>user_key</span><span class=p>:</span> <span class=n>UserKey</span><span class=p>,</span>
<span class=linenos data-linenos="634 "></span>            <span class=n>tau</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="635 "></span>            <span class=n>x_u_tau</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span>
<span class=linenos data-linenos="636 "></span>            <span class=n>n_users</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="637 "></span>            <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>mpz</span><span class=p>]:</span>
<span class=linenos data-linenos="638 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Protect user input with the user&#39;s secret key:</span>
<span class=linenos data-linenos="639 "></span>
<span class=linenos data-linenos="640 "></span><span class=sd>    \\(y_{u,\\tau} \\gets \\textbf{JL.Protect}(public_param,sk_u,\\tau,x_{u,\\tau})\\)</span>
<span class=linenos data-linenos="641 "></span>
<span class=linenos data-linenos="642 "></span><span class=sd>    This algorithm encrypts private inputs</span>
<span class=linenos data-linenos="643 "></span><span class=sd>    \\(x_{u,\\tau} \\in \\mathbb{Z}_N\\) for time period \\(\\tau\\)</span>
<span class=linenos data-linenos="644 "></span><span class=sd>    using secret key \\(sk_u \\in \\mathbb{Z}_N^2\\) . It outputs cipher \\(y_{u,\\tau}\\) such that:</span>
<span class=linenos data-linenos="645 "></span>
<span class=linenos data-linenos="646 "></span><span class=sd>    $$y_{u,\\tau} = (1 + x_{u,\\tau} N) H(\\tau)^{sk_u} \\mod N^2$$</span>
<span class=linenos data-linenos="647 "></span>
<span class=linenos data-linenos="648 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="649 "></span><span class=sd>        public_param: The public parameters \\(public_param\\)</span>
<span class=linenos data-linenos="650 "></span><span class=sd>        user_key: The user&#39;s secret key \\(sk_u\\)</span>
<span class=linenos data-linenos="651 "></span><span class=sd>        tau: The time period \\(\\tau\\)</span>
<span class=linenos data-linenos="652 "></span><span class=sd>        x_u_tau: The user&#39;s input \\(x_{u,\\tau}\\)</span>
<span class=linenos data-linenos="653 "></span><span class=sd>        n_users: Number of nodes/users that participates secure aggregation</span>
<span class=linenos data-linenos="654 "></span>
<span class=linenos data-linenos="655 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="656 "></span><span class=sd>            The protected input of type `EncryptedNumber` or a list of `EncryptedNumber`</span>
<span class=linenos data-linenos="657 "></span>
<span class=linenos data-linenos="658 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="659 "></span><span class=sd>            TypeError: bad argument type</span>
<span class=linenos data-linenos="660 "></span><span class=sd>            ValueError: bad argument value</span>
<span class=linenos data-linenos="661 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="662 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>user_key</span><span class=p>,</span> <span class=n>UserKey</span><span class=p>):</span>
<span class=linenos data-linenos="663 "></span>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Expected key for encryption type is UserKey. but got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>user_key</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="664 "></span>
<span class=linenos data-linenos="665 "></span>    <span class=k>if</span> <span class=n>user_key</span><span class=o>.</span><span class=n>public_param</span> <span class=o>!=</span> <span class=n>public_param</span><span class=p>:</span>
<span class=linenos data-linenos="666 "></span>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Bad public parameter. The public parameter of user key does not match the &quot;</span>
<span class=linenos data-linenos="667 "></span>                         <span class=s2>&quot;one given for encryption&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="668 "></span>
<span class=linenos data-linenos="669 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>x_u_tau</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
<span class=linenos data-linenos="670 "></span>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Bad vector for encryption. Excepted argument `x_u_tau` type list but &quot;</span>
<span class=linenos data-linenos="671 "></span>                        <span class=sa>f</span><span class=s2>&quot;got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>x_u_tau</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="672 "></span>
<span class=linenos data-linenos="673 "></span>    <span class=n>x_u_tau</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_vector_encoder</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span>
<span class=linenos data-linenos="674 "></span>        <span class=n>V</span><span class=o>=</span><span class=n>x_u_tau</span><span class=p>,</span>
<span class=linenos data-linenos="675 "></span>        <span class=n>add_ops</span><span class=o>=</span><span class=n>n_users</span>
<span class=linenos data-linenos="676 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="677 "></span>
<span class=linenos data-linenos="678 "></span>    <span class=k>return</span> <span class=n>user_key</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>x_u_tau</span><span class=p>,</span> <span class=n>tau</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.secagg.LOM class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">LOM</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>LOM</span><span class=p>(</span><span class=n>nonce</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Lightweight Obfuscation Mechanism (LOM) class for protecting and aggregating data.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="fedbiomed.common.secagg.LOM._prf">_prf</span></code></td> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.secagg._lom.PRF" href="#fedbiomed.common.secagg.PRF">PRF</a></code> </td> <td> <div class=doc-md-description> <p>An instance of the PRF class.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code><span title="fedbiomed.common.secagg.LOM._vector_dtype">_vector_dtype</span></code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>The data type of the vector.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_lom.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 94 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos=" 95 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos=" 96 "></span>    <span class=n>nonce</span><span class=p>:</span> <span class=nb>bytes</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 97 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos=" 98 "></span>
<span class=linenos data-linenos=" 99 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=n>nonce</span><span class=p>:</span>
<span class=linenos data-linenos="100 "></span>        <span class=n>nonce</span> <span class=o>=</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_bytes</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
<span class=linenos data-linenos="101 "></span>
<span class=linenos data-linenos="102 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_prf</span><span class=p>:</span> <span class=n>PRF</span> <span class=o>=</span> <span class=n>PRF</span><span class=p>(</span><span class=n>nonce</span><span class=p>)</span>
<span class=linenos data-linenos="103 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_vector_dtype</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;uint32&#39;</span>
<span class=linenos data-linenos="104 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_values_bit</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>iinfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>dtype</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_vector_dtype</span><span class=p>))</span><span class=o>.</span><span class=n>bits</span>  <span class=c1># should be equal to 32 bit</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.secagg.LOM-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.LOM.aggregate class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">aggregate</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>aggregate</span><span class=p>(</span><span class=n>list_y_u_tau</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Aggregates multiple vectors into a single vector.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list_y_u_tau</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>A dictionary of vectors from different nodes.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>The aggregated vector.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_lom.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="174 "></span><span class=k>def</span> <span class=nf>aggregate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>list_y_u_tau</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<span class=linenos data-linenos="175 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="176 "></span><span class=sd>    Aggregates multiple vectors into a single vector.</span>
<span class=linenos data-linenos="177 "></span>
<span class=linenos data-linenos="178 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="179 "></span><span class=sd>        list_y_u_tau: A dictionary of vectors from different nodes.</span>
<span class=linenos data-linenos="180 "></span>
<span class=linenos data-linenos="181 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="182 "></span><span class=sd>        The aggregated vector.</span>
<span class=linenos data-linenos="183 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="184 "></span>    <span class=n>list_y_u_tau</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>list_y_u_tau</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_vector_dtype</span><span class=p>)</span>
<span class=linenos data-linenos="185 "></span>    <span class=n>decrypted_vector</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>list_y_u_tau</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=linenos data-linenos="186 "></span>    <span class=n>decrypted_vector</span> <span class=o>=</span> <span class=n>decrypted_vector</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
<span class=linenos data-linenos="187 "></span>    <span class=n>decrypted_vector</span> <span class=o>=</span> <span class=n>decrypted_vector</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
<span class=linenos data-linenos="188 "></span>
<span class=linenos data-linenos="189 "></span>    <span class=k>return</span> <span class=n>decrypted_vector</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.LOM.protect class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">protect</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>protect</span><span class=p>(</span><span class=n>node_id</span><span class=p>,</span> <span class=n>pairwise_secrets</span><span class=p>,</span> <span class=n>tau</span><span class=p>,</span> <span class=n>x_u_tau</span><span class=p>,</span> <span class=n>node_ids</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Protects the input vector by applying a mask based on pairwise secrets.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>node_id</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>Id of the node that applies encryption</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>pairwise_secrets</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a>]</code> </td> <td> <div class=doc-md-description> <p>DH agreed secrets between node that applies encryption and others</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>tau</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>The current round number.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>x_u_tau</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>The input vector to be protected.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>node_ids</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>A list of node IDs participates aggregation.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>FedBioMedError</code> </td> <td> <div class=doc-md-description> <p>raises if the input vector <code>x_u_tau</code> contains any values that exceed <code>32 - log_2(numner_of_nodes)</code>, where <code>32</code> is the number of bit for each value (<code>uint32</code>). Not respecting the above condition can lead to computation overflow.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>The protected (masked) vector.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_lom.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="107 "></span><span class=k>def</span> <span class=nf>protect</span><span class=p>(</span>
<span class=linenos data-linenos="108 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="109 "></span>    <span class=n>node_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
<span class=linenos data-linenos="110 "></span>    <span class=n>pairwise_secrets</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>],</span>
<span class=linenos data-linenos="111 "></span>    <span class=n>tau</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="112 "></span>    <span class=n>x_u_tau</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span>
<span class=linenos data-linenos="113 "></span>    <span class=n>node_ids</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
<span class=linenos data-linenos="114 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<span class=linenos data-linenos="115 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="116 "></span><span class=sd>    Protects the input vector by applying a mask based on pairwise secrets.</span>
<span class=linenos data-linenos="117 "></span>
<span class=linenos data-linenos="118 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="119 "></span><span class=sd>        node_id: Id of the node that applies encryption</span>
<span class=linenos data-linenos="120 "></span><span class=sd>        pairwise_secrets: DH agreed secrets between node that applies encryption and others</span>
<span class=linenos data-linenos="121 "></span><span class=sd>        tau: The current round number.</span>
<span class=linenos data-linenos="122 "></span><span class=sd>        x_u_tau: The input vector to be protected.</span>
<span class=linenos data-linenos="123 "></span><span class=sd>        node_ids: A list of node IDs participates aggregation.</span>
<span class=linenos data-linenos="124 "></span>
<span class=linenos data-linenos="125 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="126 "></span><span class=sd>        FedBioMedError: raises if the input vector `x_u_tau` contains any </span>
<span class=linenos data-linenos="127 "></span><span class=sd>            values that exceed  `32 - log_2(numner_of_nodes)`, where `32` is </span>
<span class=linenos data-linenos="128 "></span><span class=sd>            the number of bit for each value (`uint32`). Not respecting the above condition </span>
<span class=linenos data-linenos="129 "></span><span class=sd>            can lead to computation overflow.</span>
<span class=linenos data-linenos="130 "></span>
<span class=linenos data-linenos="131 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="132 "></span><span class=sd>        The protected (masked) vector.</span>
<span class=linenos data-linenos="133 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="134 "></span>
<span class=linenos data-linenos="135 "></span>    <span class=n>num_nodes</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>node_ids</span><span class=p>)</span>
<span class=linenos data-linenos="136 "></span>    <span class=n>_max_bit_length</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_values_bit</span> <span class=o>-</span> <span class=n>math</span><span class=o>.</span><span class=n>log2</span><span class=p>(</span><span class=n>num_nodes</span><span class=p>)</span>
<span class=linenos data-linenos="137 "></span>    <span class=c1># FIXME: is a ceiling missing in this equation (ceil(math.log2(num_nodes)))</span>
<span class=linenos data-linenos="138 "></span>    <span class=k>if</span> <span class=nb>any</span><span class=p>(</span><span class=n>val</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span> <span class=o>&gt;</span> <span class=n>_max_bit_length</span> <span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>x_u_tau</span><span class=p>):</span>
<span class=linenos data-linenos="139 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggError</span><span class=p>(</span>
<span class=linenos data-linenos="140 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB417</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Bit length of one or more values of input vector has more bits &quot;</span>
<span class=linenos data-linenos="141 "></span>            <span class=sa>f</span><span class=s2>&quot;that </span><span class=si>{</span><span class=n>_max_bit_length</span><span class=si>}</span><span class=s2>. This could lead to computation overflow&quot;</span>
<span class=linenos data-linenos="142 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="143 "></span>
<span class=linenos data-linenos="144 "></span>    <span class=n>x_u_tau</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>x_u_tau</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_vector_dtype</span><span class=p>)</span>
<span class=linenos data-linenos="145 "></span>    <span class=n>mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x_u_tau</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_vector_dtype</span><span class=p>)</span>
<span class=linenos data-linenos="146 "></span>    <span class=k>for</span> <span class=n>pair_id</span> <span class=ow>in</span> <span class=n>node_ids</span><span class=p>:</span>
<span class=linenos data-linenos="147 "></span>
<span class=linenos data-linenos="148 "></span>        <span class=k>if</span> <span class=n>pair_id</span> <span class=o>==</span> <span class=n>node_id</span><span class=p>:</span>
<span class=linenos data-linenos="149 "></span>            <span class=k>continue</span>
<span class=linenos data-linenos="150 "></span>
<span class=linenos data-linenos="151 "></span>        <span class=n>secret</span> <span class=o>=</span> <span class=n>pairwise_secrets</span><span class=p>[</span><span class=n>pair_id</span><span class=p>]</span>
<span class=linenos data-linenos="152 "></span>
<span class=linenos data-linenos="153 "></span>        <span class=n>pairwise_seed</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_prf</span><span class=o>.</span><span class=n>eval_key</span><span class=p>(</span>
<span class=linenos data-linenos="154 "></span>            <span class=n>pairwise_secret</span><span class=o>=</span><span class=n>secret</span><span class=p>,</span>
<span class=linenos data-linenos="155 "></span>            <span class=n>tau</span><span class=o>=</span><span class=n>tau</span><span class=p>)</span>
<span class=linenos data-linenos="156 "></span>
<span class=linenos data-linenos="157 "></span>        <span class=c1># print(len(pairwise_seed))</span>
<span class=linenos data-linenos="158 "></span>        <span class=n>pairwise_vector</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_prf</span><span class=o>.</span><span class=n>eval_vector</span><span class=p>(</span>
<span class=linenos data-linenos="159 "></span>            <span class=n>seed</span><span class=o>=</span><span class=n>pairwise_seed</span><span class=p>,</span>
<span class=linenos data-linenos="160 "></span>            <span class=n>tau</span><span class=o>=</span><span class=n>tau</span><span class=p>,</span>
<span class=linenos data-linenos="161 "></span>            <span class=n>input_size</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>x_u_tau</span><span class=p>))</span>
<span class=linenos data-linenos="162 "></span>
<span class=linenos data-linenos="163 "></span>        <span class=n>pairwise_vector</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>frombuffer</span><span class=p>(</span><span class=n>pairwise_vector</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_vector_dtype</span><span class=p>)</span>
<span class=linenos data-linenos="164 "></span>
<span class=linenos data-linenos="165 "></span>        <span class=k>if</span> <span class=n>pair_id</span> <span class=o>&lt;</span> <span class=n>node_id</span><span class=p>:</span>
<span class=linenos data-linenos="166 "></span>            <span class=n>mask</span> <span class=o>+=</span> <span class=n>pairwise_vector</span>
<span class=linenos data-linenos="167 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="168 "></span>            <span class=n>mask</span> <span class=o>-=</span> <span class=n>pairwise_vector</span>
<span class=linenos data-linenos="169 "></span>
<span class=linenos data-linenos="170 "></span>    <span class=n>encrypted_params</span> <span class=o>=</span> <span class=n>mask</span> <span class=o>+</span> <span class=n>x_u_tau</span>
<span class=linenos data-linenos="171 "></span>
<span class=linenos data-linenos="172 "></span>    <span class=k>return</span> <span class=n>encrypted_params</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.secagg.PRF class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">PRF</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>PRF</span><span class=p>(</span><span class=n>nonce</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Pseudorandom Function (PRF) class using the ChaCha20 stream cipher.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="fedbiomed.common.secagg.PRF.nonce">nonce</span></code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a></code> </td> <td> <div class=doc-md-description> <p>A 12-byte nonce used for encryption.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_lom.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="26 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>nonce</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="27 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_nonce</span> <span class=o>=</span> <span class=n>nonce</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.secagg.PRF-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.PRF.eval_key class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">eval_key</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>eval_key</span><span class=p>(</span><span class=n>pairwise_secret</span><span class=p>,</span> <span class=n>tau</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Evaluates a pseudorandom key for a given round.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>pairwise_secret</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a></code> </td> <td> <div class=doc-md-description> <p>A secret key shared between nodes.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>round</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>The current round number.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bytes</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a></code> </td> <td> <div class=doc-md-description> <p>A 32-byte pseudorandom key.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_lom.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="30 "></span><span class=k>def</span> <span class=nf>eval_key</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pairwise_secret</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>tau</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
<span class=linenos data-linenos="31 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="32 "></span><span class=sd>    Evaluates a pseudorandom key for a given round.</span>
<span class=linenos data-linenos="33 "></span>
<span class=linenos data-linenos="34 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="35 "></span><span class=sd>        pairwise_secret (bytes): A secret key shared between nodes.</span>
<span class=linenos data-linenos="36 "></span><span class=sd>        round (int): The current round number.</span>
<span class=linenos data-linenos="37 "></span>
<span class=linenos data-linenos="38 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="39 "></span><span class=sd>        bytes: A 32-byte pseudorandom key.</span>
<span class=linenos data-linenos="40 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="41 "></span>    <span class=n>tau</span> <span class=o>=</span> <span class=n>tau</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=s1>&#39;big&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="42 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="43 "></span>        <span class=n>encryptor</span> <span class=o>=</span> <span class=n>Cipher</span><span class=p>(</span>
<span class=linenos data-linenos="44 "></span>            <span class=n>algorithms</span><span class=o>.</span><span class=n>ChaCha20</span><span class=p>(</span><span class=n>pairwise_secret</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nonce</span><span class=p>),</span>
<span class=linenos data-linenos="45 "></span>            <span class=n>mode</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="46 "></span>            <span class=n>backend</span><span class=o>=</span><span class=n>default_backend</span><span class=p>()</span>
<span class=linenos data-linenos="47 "></span>        <span class=p>)</span><span class=o>.</span><span class=n>encryptor</span><span class=p>()</span>
<span class=linenos data-linenos="48 "></span>    <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>ve</span><span class=p>:</span>
<span class=linenos data-linenos="49 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB417</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Error while ciphering: got exception </span><span class=si>{</span><span class=n>ve</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="50 "></span>    <span class=n>c</span> <span class=o>=</span> <span class=n>encryptor</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>tau</span><span class=p>)</span> <span class=o>+</span> <span class=n>encryptor</span><span class=o>.</span><span class=n>finalize</span><span class=p>()</span>
<span class=linenos data-linenos="51 "></span>    <span class=c1># the output is a 16 bytes string, pad it to 32 bytes</span>
<span class=linenos data-linenos="52 "></span>    <span class=n>c</span> <span class=o>=</span> <span class=n>c</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=mi>16</span>
<span class=linenos data-linenos="53 "></span>
<span class=linenos data-linenos="54 "></span>    <span class=k>return</span> <span class=n>c</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.PRF.eval_vector class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">eval_vector</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>eval_vector</span><span class=p>(</span><span class=n>seed</span><span class=p>,</span> <span class=n>tau</span><span class=p>,</span> <span class=n>input_size</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Evaluates a pseudorandom vector based on the seed.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>seed</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a></code> </td> <td> <div class=doc-md-description> <p>A 32-byte seed for generating the vector.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>tau</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>The current round number.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>input_size</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>The size of the input vector.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bytes</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a></code> </td> <td> <div class=doc-md-description> <p>A pseudorandom vector of the specified size.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_lom.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="56 "></span><span class=k>def</span> <span class=nf>eval_vector</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>seed</span><span class=p>:</span> <span class=nb>bytes</span><span class=p>,</span> <span class=n>tau</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>input_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bytes</span><span class=p>:</span>
<span class=linenos data-linenos="57 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="58 "></span><span class=sd>    Evaluates a pseudorandom vector based on the seed.</span>
<span class=linenos data-linenos="59 "></span>
<span class=linenos data-linenos="60 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="61 "></span><span class=sd>        seed (bytes): A 32-byte seed for generating the vector.</span>
<span class=linenos data-linenos="62 "></span><span class=sd>        tau (int): The current round number.</span>
<span class=linenos data-linenos="63 "></span><span class=sd>        input_size (int): The size of the input vector.</span>
<span class=linenos data-linenos="64 "></span>
<span class=linenos data-linenos="65 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="66 "></span><span class=sd>        bytes: A pseudorandom vector of the specified size.</span>
<span class=linenos data-linenos="67 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="68 "></span>    <span class=n>encryptor</span> <span class=o>=</span> <span class=n>Cipher</span><span class=p>(</span>
<span class=linenos data-linenos="69 "></span>        <span class=n>algorithms</span><span class=o>.</span><span class=n>ChaCha20</span><span class=p>(</span><span class=n>seed</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nonce</span><span class=p>),</span>
<span class=linenos data-linenos="70 "></span>        <span class=n>mode</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="71 "></span>        <span class=n>backend</span><span class=o>=</span><span class=n>default_backend</span><span class=p>()</span>
<span class=linenos data-linenos="72 "></span>    <span class=p>)</span><span class=o>.</span><span class=n>encryptor</span><span class=p>()</span>
<span class=linenos data-linenos="73 "></span>
<span class=linenos data-linenos="74 "></span>    <span class=c1># TODO: Better handling limits for secure aggregation</span>
<span class=linenos data-linenos="75 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>input_size</span> <span class=o>+</span> <span class=n>_MAX_ROUND</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>2</span><span class=o>**</span><span class=mi>32</span><span class=p>:</span>
<span class=linenos data-linenos="76 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggError</span><span class=p>(</span>
<span class=linenos data-linenos="77 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB417</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Can not perform encryiton due to large input vector. input_size &quot;</span>
<span class=linenos data-linenos="78 "></span>            <span class=sa>f</span><span class=s2>&quot;(</span><span class=si>{</span><span class=n>input_size</span><span class=si>}</span><span class=s2>) + MAX_ROUND (</span><span class=si>{</span><span class=n>_MAX_ROUND</span><span class=si>}</span><span class=s2>) allowed is greater than 2**32&quot;</span>
<span class=linenos data-linenos="79 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="80 "></span>
<span class=linenos data-linenos="81 "></span>    <span class=c1># create a list of indices from 0 to input_size where each element is concatenated with tau</span>
<span class=linenos data-linenos="82 "></span>    <span class=n>taus</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([(</span><span class=n>i</span> <span class=o>+</span> <span class=n>tau</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;big&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>input_size</span><span class=p>)])</span>
<span class=linenos data-linenos="83 "></span>    <span class=k>return</span> <span class=n>encryptor</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>taus</span><span class=p>)</span> <span class=o>+</span> <span class=n>encryptor</span><span class=o>.</span><span class=n>finalize</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.secagg.SecaggCrypter class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">SecaggCrypter</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>SecaggCrypter</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Secure aggregation encryption and decryption manager.</p> <p>This class is responsible for encrypting model parameters using Joye-Libert secure aggregation scheme. It also aggregates encrypted model parameters and decrypts to retrieve final model parameters as vector. This vector can be loaded into model by converting it proper format for the framework.</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_secagg_crypter.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="39 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="40 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructs ParameterEncrypter&quot;&quot;&quot;</span>
<span class=linenos data-linenos="41 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_jls</span> <span class=o>=</span> <span class=n>JoyeLibert</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.secagg.SecaggCrypter-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.SecaggCrypter.aggregate class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">aggregate</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>aggregate</span><span class=p>(</span><span class=n>current_round</span><span class=p>,</span> <span class=n>num_nodes</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>biprime</span><span class=p>,</span> <span class=n>total_sample_size</span><span class=p>,</span> <span class=n>clipping_range</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>num_expected_params</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Decrypt given parameters</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>current_round</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>The round that the aggregation will be done</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>params</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]]</code> </td> <td> <div class=doc-md-description> <p>Aggregated/Summed encrypted parameters</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>num_nodes</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>number of nodes</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>key</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>The key that will be used for decryption</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>biprime</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Biprime number of <code>PublicParam</code></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>total_sample_size</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>sum of number of samples from all nodes</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>clipping_range</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Clipping range for reverse-quantization, should be the same clipping range used for quantization</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>num_expected_params</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>number of parameters to decode from the <code>params</code></p> </div> </td> <td> <code>1</code> </td> </tr> </tbody> </table> <p>Returns: Aggregated parameters decrypted and structured</p> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedSecaggCrypterError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedSecaggCrypterError">FedbiomedSecaggCrypterError</a></code> </td> <td> <div class=doc-md-description> <p>bad parameters</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedSecaggCrypterError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedSecaggCrypterError">FedbiomedSecaggCrypterError</a></code> </td> <td> <div class=doc-md-description> <p>aggregation issue</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_secagg_crypter.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="149 "></span><span class=k>def</span> <span class=nf>aggregate</span><span class=p>(</span>
<span class=linenos data-linenos="150 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="151 "></span>        <span class=n>current_round</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="152 "></span>        <span class=n>num_nodes</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="153 "></span>        <span class=n>params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]],</span>
<span class=linenos data-linenos="154 "></span>        <span class=n>key</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="155 "></span>        <span class=n>biprime</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="156 "></span>        <span class=n>total_sample_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="157 "></span>        <span class=n>clipping_range</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="158 "></span>        <span class=n>num_expected_params</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span>
<span class=linenos data-linenos="159 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
<span class=linenos data-linenos="160 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Decrypt given parameters</span>
<span class=linenos data-linenos="161 "></span>
<span class=linenos data-linenos="162 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="163 "></span><span class=sd>        current_round: The round that the aggregation will be done</span>
<span class=linenos data-linenos="164 "></span><span class=sd>        params: Aggregated/Summed encrypted parameters</span>
<span class=linenos data-linenos="165 "></span><span class=sd>        num_nodes: number of nodes</span>
<span class=linenos data-linenos="166 "></span><span class=sd>        key: The key that will be used for decryption</span>
<span class=linenos data-linenos="167 "></span><span class=sd>        biprime: Biprime number of `PublicParam`</span>
<span class=linenos data-linenos="168 "></span><span class=sd>        total_sample_size: sum of number of samples from all nodes</span>
<span class=linenos data-linenos="169 "></span><span class=sd>        clipping_range: Clipping range for reverse-quantization, should be the</span>
<span class=linenos data-linenos="170 "></span><span class=sd>            same clipping range used for quantization</span>
<span class=linenos data-linenos="171 "></span><span class=sd>        num_expected_params: number of parameters to decode from the `params`</span>
<span class=linenos data-linenos="172 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="173 "></span><span class=sd>        Aggregated parameters decrypted and structured</span>
<span class=linenos data-linenos="174 "></span>
<span class=linenos data-linenos="175 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="176 "></span><span class=sd>         FedbiomedSecaggCrypterError: bad parameters</span>
<span class=linenos data-linenos="177 "></span><span class=sd>         FedbiomedSecaggCrypterError: aggregation issue</span>
<span class=linenos data-linenos="178 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="179 "></span>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>process_time</span><span class=p>()</span>
<span class=linenos data-linenos="180 "></span>
<span class=linenos data-linenos="181 "></span>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>params</span><span class=p>)</span> <span class=o>!=</span> <span class=n>num_nodes</span><span class=p>:</span>
<span class=linenos data-linenos="182 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="183 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Num of parameters that are received from nodes &quot;</span>
<span class=linenos data-linenos="184 "></span>            <span class=sa>f</span><span class=s2>&quot;does not match the number of nodes has been set for the encrypter. There might &quot;</span>
<span class=linenos data-linenos="185 "></span>            <span class=sa>f</span><span class=s2>&quot;be some nodes did not answered to training request or num of clients of &quot;</span>
<span class=linenos data-linenos="186 "></span>            <span class=s2>&quot;`ParameterEncrypter` has not been set properly before train request.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="187 "></span>
<span class=linenos data-linenos="188 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>or</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>params</span><span class=p>):</span>
<span class=linenos data-linenos="189 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=si>}</span><span class=s2>: The parameters to aggregate should be a &quot;</span>
<span class=linenos data-linenos="190 "></span>                                          <span class=sa>f</span><span class=s2>&quot;list containing list of parameters&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="191 "></span>
<span class=linenos data-linenos="192 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p_</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=k>for</span> <span class=n>p_</span> <span class=ow>in</span> <span class=n>p</span><span class=p>)</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>params</span><span class=p>):</span>
<span class=linenos data-linenos="193 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=si>}</span><span class=s2>: Invalid parameter type. The parameters &quot;</span>
<span class=linenos data-linenos="194 "></span>                                          <span class=sa>f</span><span class=s2>&quot;should be of type of integers.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="195 "></span>
<span class=linenos data-linenos="196 "></span>    <span class=c1># TODO provide dynamically created biprime. Biprime that is used</span>
<span class=linenos data-linenos="197 "></span>    <span class=c1>#  on the node-side should matched the one used for decryption</span>
<span class=linenos data-linenos="198 "></span>    <span class=n>public_param</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_setup_public_param</span><span class=p>(</span><span class=n>biprime</span><span class=o>=</span><span class=n>biprime</span><span class=p>)</span>
<span class=linenos data-linenos="199 "></span>    <span class=n>key</span> <span class=o>=</span> <span class=n>ServerKey</span><span class=p>(</span><span class=n>public_param</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
<span class=linenos data-linenos="200 "></span>
<span class=linenos data-linenos="201 "></span>    <span class=n>params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_convert_to_encrypted_number</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>public_param</span><span class=p>)</span>
<span class=linenos data-linenos="202 "></span>
<span class=linenos data-linenos="203 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="204 "></span>        <span class=n>sum_of_weights</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_jls</span><span class=o>.</span><span class=n>aggregate</span><span class=p>(</span>
<span class=linenos data-linenos="205 "></span>            <span class=n>sk_0</span><span class=o>=</span><span class=n>key</span><span class=p>,</span>
<span class=linenos data-linenos="206 "></span>            <span class=n>tau</span><span class=o>=</span><span class=n>current_round</span><span class=p>,</span>  <span class=c1># The time period \\(\\tau\\)</span>
<span class=linenos data-linenos="207 "></span>            <span class=n>list_y_u_tau</span><span class=o>=</span><span class=n>params</span><span class=p>,</span>
<span class=linenos data-linenos="208 "></span>            <span class=n>num_expected_params</span><span class=o>=</span><span class=n>num_expected_params</span>
<span class=linenos data-linenos="209 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="210 "></span>    <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos="211 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: The aggregation of encrypted parameters &quot;</span>
<span class=linenos data-linenos="212 "></span>                                          <span class=sa>f</span><span class=s2>&quot;is not successful: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="213 "></span>
<span class=linenos data-linenos="214 "></span>    <span class=c1># Reverse quantize and division (averaging)</span>
<span class=linenos data-linenos="215 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Aggregating </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>params</span><span class=p>)</span><span class=si>}</span><span class=s2> parameters from </span><span class=si>{</span><span class=n>num_nodes</span><span class=si>}</span><span class=s2> nodes.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="216 "></span>    <span class=n>aggregated_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_average</span><span class=p>(</span><span class=n>sum_of_weights</span><span class=p>,</span> <span class=n>total_sample_size</span><span class=p>)</span>
<span class=linenos data-linenos="217 "></span>
<span class=linenos data-linenos="218 "></span>    <span class=n>aggregated_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>reverse_quantize</span><span class=p>(</span>
<span class=linenos data-linenos="219 "></span>        <span class=n>aggregated_params</span><span class=p>,</span>
<span class=linenos data-linenos="220 "></span>        <span class=n>clipping_range</span><span class=o>=</span><span class=n>clipping_range</span>
<span class=linenos data-linenos="221 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="222 "></span>    <span class=n>time_elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>process_time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=linenos data-linenos="223 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Aggregation is completed in </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>time_elapsed</span><span class=p>,</span><span class=w> </span><span class=n>ndigits</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2> seconds.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="224 "></span>
<span class=linenos data-linenos="225 "></span>    <span class=k>return</span> <span class=n>aggregated_params</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.SecaggCrypter.encrypt class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">encrypt</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>encrypt</span><span class=p>(</span><span class=n>num_nodes</span><span class=p>,</span> <span class=n>current_round</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>biprime</span><span class=p>,</span> <span class=n>clipping_range</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>weight</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Encrypts model parameters.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>num_nodes</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Number of nodes that is expected to encrypt parameters for aggregation</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>current_round</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Current round of federated training</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>params</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code> </td> <td> <div class=doc-md-description> <p>List of flatten parameters</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>key</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Key to encrypt</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>biprime</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Prime number to create public parameter</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>weight</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>Weight for the params</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>clipping_range</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Clipping-range for quantization of float model parameters. Clipping range must grater than minimum model parameters</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>List of encrypted parameters</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedSecaggCrypterError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedSecaggCrypterError">FedbiomedSecaggCrypterError</a></code> </td> <td> <div class=doc-md-description> <p>bad parameters</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedSecaggCrypterError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedSecaggCrypterError">FedbiomedSecaggCrypterError</a></code> </td> <td> <div class=doc-md-description> <p>encryption issue</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_secagg_crypter.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 61 "></span><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span>
<span class=linenos data-linenos=" 62 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos=" 63 "></span>        <span class=n>num_nodes</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos=" 64 "></span>        <span class=n>current_round</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos=" 65 "></span>        <span class=n>params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>],</span>
<span class=linenos data-linenos=" 66 "></span>        <span class=n>key</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos=" 67 "></span>        <span class=n>biprime</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos=" 68 "></span>        <span class=n>clipping_range</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 69 "></span>        <span class=n>weight</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 70 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<span class=linenos data-linenos=" 71 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Encrypts model parameters.</span>
<span class=linenos data-linenos=" 72 "></span>
<span class=linenos data-linenos=" 73 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos=" 74 "></span><span class=sd>        num_nodes: Number of nodes that is expected to encrypt parameters for aggregation</span>
<span class=linenos data-linenos=" 75 "></span><span class=sd>        current_round: Current round of federated training</span>
<span class=linenos data-linenos=" 76 "></span><span class=sd>        params: List of flatten parameters</span>
<span class=linenos data-linenos=" 77 "></span><span class=sd>        key: Key to encrypt</span>
<span class=linenos data-linenos=" 78 "></span><span class=sd>        biprime: Prime number to create public parameter</span>
<span class=linenos data-linenos=" 79 "></span><span class=sd>        weight: Weight for the params</span>
<span class=linenos data-linenos=" 80 "></span><span class=sd>        clipping_range: Clipping-range for quantization of float model parameters. Clipping range</span>
<span class=linenos data-linenos=" 81 "></span><span class=sd>            must grater than minimum model parameters</span>
<span class=linenos data-linenos=" 82 "></span>
<span class=linenos data-linenos=" 83 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos=" 84 "></span><span class=sd>        List of encrypted parameters</span>
<span class=linenos data-linenos=" 85 "></span>
<span class=linenos data-linenos=" 86 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos=" 87 "></span><span class=sd>        FedbiomedSecaggCrypterError: bad parameters</span>
<span class=linenos data-linenos=" 88 "></span><span class=sd>        FedbiomedSecaggCrypterError: encryption issue</span>
<span class=linenos data-linenos=" 89 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos=" 90 "></span>
<span class=linenos data-linenos=" 91 "></span>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>process_time</span><span class=p>()</span>
<span class=linenos data-linenos=" 92 "></span>
<span class=linenos data-linenos=" 93 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
<span class=linenos data-linenos=" 94 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos=" 95 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Expected argument `params` type list but got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>params</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos=" 96 "></span>        <span class=p>)</span>
<span class=linenos data-linenos=" 97 "></span>
<span class=linenos data-linenos=" 98 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>([</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=nb>float</span><span class=p>)</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>params</span><span class=p>]):</span>
<span class=linenos data-linenos=" 99 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="100 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: The parameters to encrypt should list of floats. &quot;</span>
<span class=linenos data-linenos="101 "></span>            <span class=sa>f</span><span class=s2>&quot;There are one or more than a value that is not type of float.&quot;</span>
<span class=linenos data-linenos="102 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="103 "></span>
<span class=linenos data-linenos="104 "></span>    <span class=c1># Make use the key is instance of</span>
<span class=linenos data-linenos="105 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos="106 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="107 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: The argument `key` must be integer&quot;</span>
<span class=linenos data-linenos="108 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="109 "></span>
<span class=linenos data-linenos="110 "></span>    <span class=c1># first we quantize the parameters, and we get params in the range [0, 2^VEParameters.TARGET_RANGE]</span>
<span class=linenos data-linenos="111 "></span>    <span class=n>params</span> <span class=o>=</span> <span class=n>quantize</span><span class=p>(</span><span class=n>weights</span><span class=o>=</span><span class=n>params</span><span class=p>,</span>
<span class=linenos data-linenos="112 "></span>                      <span class=n>clipping_range</span><span class=o>=</span><span class=n>clipping_range</span><span class=p>)</span>
<span class=linenos data-linenos="113 "></span>
<span class=linenos data-linenos="114 "></span>    <span class=c1># We multiply the parameters with the weight, and we get params in</span>
<span class=linenos data-linenos="115 "></span>    <span class=c1># the range [0, 2^(log2(VEParameters.TARGET_RANGE) + log2(VEParameters.WEIGHT_RANGE)) - 1]</span>
<span class=linenos data-linenos="116 "></span>    <span class=c1># Check if weight if num_bits of weight is less than VEParameters.WEIGHT_RANGE</span>
<span class=linenos data-linenos="117 "></span>    <span class=k>if</span> <span class=n>weight</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="118 "></span>        <span class=k>if</span> <span class=mi>2</span><span class=o>**</span><span class=n>weight</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span> <span class=o>&gt;</span> <span class=n>SAParameters</span><span class=o>.</span><span class=n>WEIGHT_RANGE</span><span class=p>:</span>
<span class=linenos data-linenos="119 "></span>            <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="120 "></span>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: The weight is too large. The weight should be less than &quot;</span>
<span class=linenos data-linenos="121 "></span>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>SAParameters</span><span class=o>.</span><span class=n>WEIGHT_RANGE</span><span class=si>}</span><span class=s2>, but got </span><span class=si>{</span><span class=n>weight</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="122 "></span>            <span class=p>)</span>
<span class=linenos data-linenos="123 "></span>        <span class=n>params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_weighting</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>weight</span><span class=p>)</span>
<span class=linenos data-linenos="124 "></span>
<span class=linenos data-linenos="125 "></span>
<span class=linenos data-linenos="126 "></span>    <span class=n>public_param</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_setup_public_param</span><span class=p>(</span><span class=n>biprime</span><span class=o>=</span><span class=n>biprime</span><span class=p>)</span>
<span class=linenos data-linenos="127 "></span>
<span class=linenos data-linenos="128 "></span>    <span class=c1># Instantiates UserKey object</span>
<span class=linenos data-linenos="129 "></span>    <span class=n>key</span> <span class=o>=</span> <span class=n>UserKey</span><span class=p>(</span><span class=n>public_param</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
<span class=linenos data-linenos="130 "></span>
<span class=linenos data-linenos="131 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="132 "></span>        <span class=c1># Encrypt parameters</span>
<span class=linenos data-linenos="133 "></span>        <span class=n>encrypted_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>mpz</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_jls</span><span class=o>.</span><span class=n>protect</span><span class=p>(</span>
<span class=linenos data-linenos="134 "></span>            <span class=n>public_param</span><span class=o>=</span><span class=n>public_param</span><span class=p>,</span>
<span class=linenos data-linenos="135 "></span>            <span class=n>user_key</span><span class=o>=</span><span class=n>key</span><span class=p>,</span>
<span class=linenos data-linenos="136 "></span>            <span class=n>tau</span><span class=o>=</span><span class=n>current_round</span><span class=p>,</span>
<span class=linenos data-linenos="137 "></span>            <span class=n>x_u_tau</span><span class=o>=</span><span class=n>params</span><span class=p>,</span>
<span class=linenos data-linenos="138 "></span>            <span class=n>n_users</span><span class=o>=</span><span class=n>num_nodes</span>
<span class=linenos data-linenos="139 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="140 "></span>    <span class=k>except</span> <span class=p>(</span><span class=ne>TypeError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>)</span> <span class=k>as</span> <span class=n>exp</span><span class=p>:</span>
<span class=linenos data-linenos="141 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="142 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2> Error during parameter encryption. </span><span class=si>{</span><span class=n>exp</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span> <span class=kn>from</span> <span class=nn>exp</span>
<span class=linenos data-linenos="143 "></span>
<span class=linenos data-linenos="144 "></span>    <span class=n>time_elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>process_time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=linenos data-linenos="145 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Encryption of the parameters took </span><span class=si>{</span><span class=n>time_elapsed</span><span class=si>}</span><span class=s2> seconds.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="146 "></span>
<span class=linenos data-linenos="147 "></span>    <span class=k>return</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>e_p</span><span class=p>)</span> <span class=k>for</span> <span class=n>e_p</span> <span class=ow>in</span> <span class=n>encrypted_params</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.secagg.SecaggLomCrypter class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">SecaggLomCrypter</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>SecaggLomCrypter</span><span class=p>(</span><span class=n>nonce</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="fedbiomed.common.secagg._secagg_crypter.SecaggCrypter" href="#fedbiomed.common.secagg.SecaggCrypter">SecaggCrypter</a></code></p> <p>Low-Overhead Masking secure aggregation controller</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>nonce</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code> </td> <td> <div class=doc-md-description> <p><code>nonce</code> to use in encryption</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_secagg_crypter.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="298 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos="299 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="300 "></span>    <span class=n>nonce</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="301 "></span><span class=p>):</span>
<span class=linenos data-linenos="302 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;LOM Secure aggregation to encrypt and aggregate</span>
<span class=linenos data-linenos="303 "></span>
<span class=linenos data-linenos="304 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="305 "></span><span class=sd>        nonce: `nonce` to use in encryption</span>
<span class=linenos data-linenos="306 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="307 "></span>    <span class=k>if</span> <span class=n>nonce</span><span class=p>:</span>
<span class=linenos data-linenos="308 "></span>        <span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=n>nonce</span><span class=p>)</span>
<span class=linenos data-linenos="309 "></span>        <span class=n>nonce</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>getrandbits</span><span class=p>(</span><span class=mi>128</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=s1>&#39;big&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="310 "></span>
<span class=linenos data-linenos="311 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_lom</span> <span class=o>=</span> <span class=n>LOM</span><span class=p>(</span><span class=n>nonce</span><span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.secagg.SecaggLomCrypter-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.SecaggLomCrypter.aggregate class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">aggregate</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>aggregate</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>total_sample_size</span><span class=p>,</span> <span class=n>clipping_range</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Decrypt given parameters</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>params</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]]</code> </td> <td> <div class=doc-md-description> <p>Aggregated/Summed encrypted parameters</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>total_sample_size</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>sum of number of samples from all nodes</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>clipping_range</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Clipping range for reverse-quantization, should be the same clipping range used for quantization</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p>Returns: Aggregated parameters decrypted and structured</p> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedSecaggCrypterError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedSecaggCrypterError">FedbiomedSecaggCrypterError</a></code> </td> <td> <div class=doc-md-description> <p>bad parameters</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedSecaggCrypterError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedSecaggCrypterError">FedbiomedSecaggCrypterError</a></code> </td> <td> <div class=doc-md-description> <p>aggregation issue</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_secagg_crypter.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="387 "></span><span class=k>def</span> <span class=nf>aggregate</span><span class=p>(</span>
<span class=linenos data-linenos="388 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="389 "></span>        <span class=n>params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]],</span>
<span class=linenos data-linenos="390 "></span>        <span class=n>total_sample_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="391 "></span>        <span class=n>clipping_range</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="392 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
<span class=linenos data-linenos="393 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Decrypt given parameters</span>
<span class=linenos data-linenos="394 "></span>
<span class=linenos data-linenos="395 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="396 "></span><span class=sd>        params: Aggregated/Summed encrypted parameters</span>
<span class=linenos data-linenos="397 "></span><span class=sd>        total_sample_size: sum of number of samples from all nodes</span>
<span class=linenos data-linenos="398 "></span><span class=sd>        clipping_range: Clipping range for reverse-quantization, should be the</span>
<span class=linenos data-linenos="399 "></span><span class=sd>            same clipping range used for quantization</span>
<span class=linenos data-linenos="400 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="401 "></span><span class=sd>        Aggregated parameters decrypted and structured</span>
<span class=linenos data-linenos="402 "></span>
<span class=linenos data-linenos="403 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="404 "></span><span class=sd>         FedbiomedSecaggCrypterError: bad parameters</span>
<span class=linenos data-linenos="405 "></span><span class=sd>         FedbiomedSecaggCrypterError: aggregation issue</span>
<span class=linenos data-linenos="406 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="407 "></span>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>process_time</span><span class=p>()</span>
<span class=linenos data-linenos="408 "></span>
<span class=linenos data-linenos="409 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>or</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>params</span><span class=p>):</span>
<span class=linenos data-linenos="410 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=si>}</span><span class=s2>: The parameters to aggregate should be a &quot;</span>
<span class=linenos data-linenos="411 "></span>                                          <span class=sa>f</span><span class=s2>&quot;list containing list of parameters&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="412 "></span>
<span class=linenos data-linenos="413 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p_</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=k>for</span> <span class=n>p_</span> <span class=ow>in</span> <span class=n>p</span><span class=p>)</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>params</span><span class=p>):</span>
<span class=linenos data-linenos="414 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=si>}</span><span class=s2>: Invalid parameter type. The parameters &quot;</span>
<span class=linenos data-linenos="415 "></span>                                          <span class=sa>f</span><span class=s2>&quot;should be of type of integers.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="416 "></span>
<span class=linenos data-linenos="417 "></span>    <span class=n>num_nodes</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
<span class=linenos data-linenos="418 "></span>
<span class=linenos data-linenos="419 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="420 "></span>        <span class=n>sum_of_weights</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_lom</span><span class=o>.</span><span class=n>aggregate</span><span class=p>(</span>
<span class=linenos data-linenos="421 "></span>            <span class=n>list_y_u_tau</span><span class=o>=</span><span class=n>params</span><span class=p>,</span>
<span class=linenos data-linenos="422 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="423 "></span>    <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos="424 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="425 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: The aggregation of encrypted parameters &quot;</span>
<span class=linenos data-linenos="426 "></span>            <span class=sa>f</span><span class=s2>&quot;is not successful: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span> <span class=kn>from</span> <span class=nn>e</span>
<span class=linenos data-linenos="427 "></span>
<span class=linenos data-linenos="428 "></span>
<span class=linenos data-linenos="429 "></span>    <span class=c1># Reverse quantize and division (averaging)</span>
<span class=linenos data-linenos="430 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Aggregating </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>params</span><span class=p>)</span><span class=si>}</span><span class=s2> parameters from </span><span class=si>{</span><span class=n>num_nodes</span><span class=si>}</span><span class=s2> nodes.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="431 "></span>    <span class=n>aggregated_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_average</span><span class=p>(</span><span class=n>sum_of_weights</span><span class=p>,</span> <span class=n>total_sample_size</span><span class=p>)</span>
<span class=linenos data-linenos="432 "></span>
<span class=linenos data-linenos="433 "></span>    <span class=n>aggregated_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>reverse_quantize</span><span class=p>(</span>
<span class=linenos data-linenos="434 "></span>        <span class=n>aggregated_params</span><span class=p>,</span>
<span class=linenos data-linenos="435 "></span>        <span class=n>clipping_range</span><span class=o>=</span><span class=n>clipping_range</span>
<span class=linenos data-linenos="436 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="437 "></span>    <span class=n>time_elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>process_time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=linenos data-linenos="438 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Aggregation is completed in </span><span class=si>{</span><span class=nb>round</span><span class=p>(</span><span class=n>time_elapsed</span><span class=p>,</span><span class=w> </span><span class=n>ndigits</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2> seconds.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="439 "></span>
<span class=linenos data-linenos="440 "></span>    <span class=k>return</span> <span class=n>aggregated_params</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.secagg.SecaggLomCrypter.encrypt class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">encrypt</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>encrypt</span><span class=p>(</span><span class=n>current_round</span><span class=p>,</span> <span class=n>node_id</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>pairwise_secrets</span><span class=p>,</span> <span class=n>node_ids</span><span class=p>,</span> <span class=n>clipping_range</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>weight</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Encrypts model parameters.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>current_round</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Current round of federated training</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>node_id</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>ID of the node applies encryption</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>params</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code> </td> <td> <div class=doc-md-description> <p>List of flatten parameters</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>pairwise_secrets</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a>]</code> </td> <td> <div class=doc-md-description> <p>DH agreed secrets between node that applies encryption and others</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>node_ids</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>All nodes that participates secure aggregation</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>weight</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>Weight for the params</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>clipping_range</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Clipping-range for quantization of float model parameters. Clipping range must grater than minimum model parameters</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>List of encrypted parameters</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedSecaggCrypterError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedSecaggCrypterError">FedbiomedSecaggCrypterError</a></code> </td> <td> <div class=doc-md-description> <p>bad parameters</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedSecaggCrypterError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedSecaggCrypterError">FedbiomedSecaggCrypterError</a></code> </td> <td> <div class=doc-md-description> <p>encryption issue</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/secagg/_secagg_crypter.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="314 "></span><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span>
<span class=linenos data-linenos="315 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="316 "></span>    <span class=n>current_round</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
<span class=linenos data-linenos="317 "></span>    <span class=n>node_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
<span class=linenos data-linenos="318 "></span>    <span class=n>params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>],</span>
<span class=linenos data-linenos="319 "></span>    <span class=n>pairwise_secrets</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>],</span>
<span class=linenos data-linenos="320 "></span>    <span class=n>node_ids</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
<span class=linenos data-linenos="321 "></span>    <span class=n>clipping_range</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="322 "></span>    <span class=n>weight</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="323 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<span class=linenos data-linenos="324 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Encrypts model parameters.</span>
<span class=linenos data-linenos="325 "></span>
<span class=linenos data-linenos="326 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="327 "></span><span class=sd>        current_round: Current round of federated training</span>
<span class=linenos data-linenos="328 "></span><span class=sd>        node_id: ID of the node applies encryption</span>
<span class=linenos data-linenos="329 "></span><span class=sd>        params: List of flatten parameters</span>
<span class=linenos data-linenos="330 "></span><span class=sd>        pairwise_secrets: DH agreed secrets between node that applies encryption and others</span>
<span class=linenos data-linenos="331 "></span><span class=sd>        node_ids: All nodes that participates secure aggregation</span>
<span class=linenos data-linenos="332 "></span><span class=sd>        weight: Weight for the params</span>
<span class=linenos data-linenos="333 "></span><span class=sd>        clipping_range: Clipping-range for quantization of float model parameters. Clipping range</span>
<span class=linenos data-linenos="334 "></span><span class=sd>            must grater than minimum model parameters</span>
<span class=linenos data-linenos="335 "></span>
<span class=linenos data-linenos="336 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="337 "></span><span class=sd>        List of encrypted parameters</span>
<span class=linenos data-linenos="338 "></span>
<span class=linenos data-linenos="339 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="340 "></span><span class=sd>        FedbiomedSecaggCrypterError: bad parameters</span>
<span class=linenos data-linenos="341 "></span><span class=sd>        FedbiomedSecaggCrypterError: encryption issue</span>
<span class=linenos data-linenos="342 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="343 "></span>
<span class=linenos data-linenos="344 "></span>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>process_time</span><span class=p>()</span>
<span class=linenos data-linenos="345 "></span>
<span class=linenos data-linenos="346 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
<span class=linenos data-linenos="347 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="348 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Expected argument `params` type list but got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>params</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="349 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="350 "></span>
<span class=linenos data-linenos="351 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=nb>float</span><span class=p>)</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>params</span><span class=p>):</span>
<span class=linenos data-linenos="352 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="353 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: The parameters to encrypt should list of floats. &quot;</span>
<span class=linenos data-linenos="354 "></span>            <span class=sa>f</span><span class=s2>&quot;There are one or more than a value that is not type of float.&quot;</span>
<span class=linenos data-linenos="355 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="356 "></span>
<span class=linenos data-linenos="357 "></span>    <span class=n>params</span> <span class=o>=</span> <span class=n>quantize</span><span class=p>(</span><span class=n>weights</span><span class=o>=</span><span class=n>params</span><span class=p>,</span>
<span class=linenos data-linenos="358 "></span>                      <span class=n>clipping_range</span><span class=o>=</span><span class=n>clipping_range</span><span class=p>)</span>
<span class=linenos data-linenos="359 "></span>
<span class=linenos data-linenos="360 "></span>    <span class=k>if</span> <span class=n>weight</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="361 "></span>        <span class=k>if</span> <span class=mi>2</span><span class=o>**</span><span class=n>weight</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span> <span class=o>&gt;</span> <span class=n>SAParameters</span><span class=o>.</span><span class=n>WEIGHT_RANGE</span><span class=p>:</span>
<span class=linenos data-linenos="362 "></span>            <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="363 "></span>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: The weight is too large. The weight should be less than &quot;</span>
<span class=linenos data-linenos="364 "></span>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>SAParameters</span><span class=o>.</span><span class=n>WEIGHT_RANGE</span><span class=si>}</span><span class=s2>.&quot;</span>
<span class=linenos data-linenos="365 "></span>            <span class=p>)</span>
<span class=linenos data-linenos="366 "></span>        <span class=n>params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_weighting</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>weight</span><span class=p>)</span>
<span class=linenos data-linenos="367 "></span>
<span class=linenos data-linenos="368 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="369 "></span>        <span class=c1># Encrypt parameters</span>
<span class=linenos data-linenos="370 "></span>        <span class=n>encrypted_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_lom</span><span class=o>.</span><span class=n>protect</span><span class=p>(</span>
<span class=linenos data-linenos="371 "></span>            <span class=n>pairwise_secrets</span><span class=o>=</span><span class=n>pairwise_secrets</span><span class=p>,</span>
<span class=linenos data-linenos="372 "></span>            <span class=n>node_id</span><span class=o>=</span><span class=n>node_id</span><span class=p>,</span>
<span class=linenos data-linenos="373 "></span>            <span class=n>tau</span><span class=o>=</span><span class=n>current_round</span><span class=p>,</span>
<span class=linenos data-linenos="374 "></span>            <span class=n>x_u_tau</span><span class=o>=</span><span class=n>params</span><span class=p>,</span>
<span class=linenos data-linenos="375 "></span>            <span class=n>node_ids</span><span class=o>=</span><span class=n>node_ids</span>
<span class=linenos data-linenos="376 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="377 "></span>    <span class=k>except</span> <span class=p>(</span><span class=ne>TypeError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>)</span> <span class=k>as</span> <span class=n>exp</span><span class=p>:</span>
<span class=linenos data-linenos="378 "></span>        <span class=k>raise</span> <span class=n>FedbiomedSecaggCrypterError</span><span class=p>(</span>
<span class=linenos data-linenos="379 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB624</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2> Error during parameter encryption. </span><span class=si>{</span><span class=n>exp</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span> <span class=kn>from</span> <span class=nn>exp</span>
<span class=linenos data-linenos="380 "></span>
<span class=linenos data-linenos="381 "></span>
<span class=linenos data-linenos="382 "></span>    <span class=n>time_elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>process_time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=linenos data-linenos="383 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Encryption of the parameters took </span><span class=si>{</span><span class=n>time_elapsed</span><span class=si>}</span><span class=s2> seconds.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="384 "></span>
<span class=linenos data-linenos="385 "></span>    <span class=k>return</span> <span class=n>encrypted_params</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </article> </main> </div> <div class=right-col> <div id=right-sidebar class=sidebar-right> <nav class=toc> <!-- Render item list --> <label class=toc-title for=__toc> <span class=toc-icon></span> </label> <ul class=toc-list data-md-component=toc data-md-scrollfix> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg-classes class=md-nav__link> Classes </a> <nav class=toc-nav aria-label=Classes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKey class=md-nav__link> DHKey </a> <nav class=toc-nav aria-label=DHKey> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKey-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKey.private_key class=md-nav__link> private_key </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKey.public_key class=md-nav__link> public_key </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKey-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKey.export_private_key class=md-nav__link> export_private_key </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKey.export_public_key class=md-nav__link> export_public_key </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKeyAgreement class=md-nav__link> DHKeyAgreement </a> <nav class=toc-nav aria-label=DHKeyAgreement> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKeyAgreement-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKeyAgreement.session_salt class=md-nav__link> session_salt </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKeyAgreement-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.DHKeyAgreement.agree class=md-nav__link> agree </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.EncryptedNumber class=md-nav__link> EncryptedNumber </a> <nav class=toc-nav aria-label=EncryptedNumber> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.EncryptedNumber-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.EncryptedNumber.ciphertext class=md-nav__link> ciphertext </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.EncryptedNumber.public_param class=md-nav__link> public_param </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.JoyeLibert class=md-nav__link> JoyeLibert </a> <nav class=toc-nav aria-label=JoyeLibert> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.JoyeLibert-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.JoyeLibert.aggregate class=md-nav__link> aggregate </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.JoyeLibert.protect class=md-nav__link> protect </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.LOM class=md-nav__link> LOM </a> <nav class=toc-nav aria-label=LOM> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.LOM-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.LOM.aggregate class=md-nav__link> aggregate </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.LOM.protect class=md-nav__link> protect </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.PRF class=md-nav__link> PRF </a> <nav class=toc-nav aria-label=PRF> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.PRF-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.PRF.eval_key class=md-nav__link> eval_key </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.PRF.eval_vector class=md-nav__link> eval_vector </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.SecaggCrypter class=md-nav__link> SecaggCrypter </a> <nav class=toc-nav aria-label=SecaggCrypter> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.SecaggCrypter-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.SecaggCrypter.aggregate class=md-nav__link> aggregate </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.SecaggCrypter.encrypt class=md-nav__link> encrypt </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.SecaggLomCrypter class=md-nav__link> SecaggLomCrypter </a> <nav class=toc-nav aria-label=SecaggLomCrypter> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.SecaggLomCrypter-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.SecaggLomCrypter.aggregate class=md-nav__link> aggregate </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.secagg.SecaggLomCrypter.encrypt class=md-nav__link> encrypt </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> </div> <!-- News Main Page--> </div> <footer> <div class=container-fluid> <div class=footer-first-inner> <div class=container> <div class=row> <div class=col-md-6> <div class=footer-contact> <strong>Address:</strong> <p>2004 Rte des Lucioles, 06902 Sophia Antipolis</p> <strong>E-mail:</strong> <p>fedbiomed _at_ inria _dot_ fr</p> </div> </div> <div class=col-md-6> <div class=footer-contact> <p>Fed-BioMed © 2022</p> </div> </div> </div> </div> </div> </div> </footer> <!-- JQuery --> <script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script> <!-- Latest compiled and minified JavaScript --> <script src=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../../assets/javascript/lunr.js></script> <script src=../../../../assets/javascript/theme.js></script> </body> </html>