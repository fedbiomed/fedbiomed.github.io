<!DOCTYPE html><html> <head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1"><meta name=robots context="index, archive"><!--  --><script>
      const versions_json = "../../../../../versions.json";
      const search_worker_js = "../../../../assets/javascript/search-worker.js";
      const search_index_json = "../../../../search/search_index.json";
      const base_url = '../../../..';
    </script><!-- Site title --><title>Controller - Fed-BioMed</title><link rel=icon type=image/x-icon href=../../../../favicon.ico><!-- Page description --><meta name=description content="Open, Transparent and Trusted Collaborative Learning for Real-world Healthcare Applications"><!-- Page keywords --><!-- Page author --><!-- Latest compiled and minified CSS --><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><!-- Bootstrap Icons --><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link href=../../../../assets/_mkdocstrings.css rel=stylesheet><link href=../../../../assets/css/style.css rel=stylesheet></head> <body> <header> <div class="container-fluid top-bar"> <div class=brand> <a href=/ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <nav class=top> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class="container-fluid top-bar-mobile"> <div class=mobile-bar> <div class=brand> <a href=../../../../ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <div class=hum-menu> <img class=open src=../../../../assets/img/menu.svg> <img class=close style=display:none src=../../../../assets/img/cancel.svg> </div> </div> <nav class=top-mobile> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> </header> <div class=main> <!-- Home page --> <div class=container-fluid> <div class=doc-row> <div class=left-col> <div class=sidebar-doc> <nav class=sidebar-inner> <ul class="sidebar-menu-left sub"> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Getting Started <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ class>What's Fed-BioMed</a> </li> <li class> <a href=../../../../getting-started/getting-started/ class>Basic Example</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-architecture/ class>Fedbiomed Architecture</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-workflow/ class>Fedbiomed Workflow</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Tutorials <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Installation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/installation/0-basic-software-installation/ class>Software Installation</a> </li> <li class> <a href=../../../../tutorials/installation/1-setting-up-environment/ class>Setting Up Environment</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> PyTorch <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/pytorch/01_PyTorch_MNIST_Single_Node_Tutorial/ class>PyTorch MNIST Basic Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/02_Create_Your_Custom_Training_Plan/ class>How to Create Your Custom PyTorch Training Plan</a> </li> <li class> <a href=../../../../tutorials/pytorch/03_PyTorch_Used_Cars_Dataset_Example/ class>PyTorch Used Cars Dataset Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/04-Aggregation_in_Fed-BioMed/ class>PyTorch aggregation methods in Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/pytorch/05_Transfer-learning_tutorial_usingDenseNet-121/ class>Transfer-learning in Fed-BioMed tutorial</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> MONAI <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/monai/01_monai-2d-image-classification/ class>Federated 2d image classification with MONAI</a> </li> <li class> <a href=../../../../tutorials/monai/02_monai-2d-image-registration/ class>Federated 2d XRay registration with MONAI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Scikit-Learn <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/scikit-learn/01_sklearn_MNIST_classification_tutorial/ class>MNIST classification with Scikit-Learn Classifier (Perceptron)</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/02_sklearn_sgd_regressor_tutorial/ class>Fed-BioMed to train a federated SGD regressor model</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/03-other-scikit-learn-models/ class>Implementing other Scikit Learn models for Federated Learning</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Optimizers <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/optimizers/01-fedopt-and-scaffold/ class>Advanced optimizers in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> FLamby <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/flamby/flamby/ class>General Concepts</a> </li> <li class> <a href=../../../../tutorials/flamby/flamby-integration-into-fedbiomed/ class>FLamby integration in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Advanced <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/advanced/in-depth-experiment-configuration/ class>In Depth Experiment Configuration</a> </li> <li class> <a href=../../../../tutorials/advanced/training-with-gpu/ class>PyTorch model training using a GPU</a> </li> <li class> <a href=../../../../tutorials/advanced/breakpoints/ class>Breakpoints</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Security <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/security/differential-privacy-with-opacus-on-fedbiomed/ class>Using Differential Privacy with OPACUS on Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/security/non-private-local-central-dp-monai-2d-image-registration/ class>Local and Central DP with Fed-BioMed: MONAI 2d image registration</a> </li> <li class> <a href=../../../../tutorials/security/training-with-approved-training-plans/ class>Training Process with Training Plan Management</a> </li> <li class> <a href=../../../../tutorials/security/secure-aggregation/ class>Training with Secure Aggregation</a> </li> <li class> <a href=../../../../tutorials/concrete-ml/concrete-ml/ class>End-to-end Privacy Preserving Training and Inference on Medical Data</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Biomedical data <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/medical/medical-image-segmentation-unet-library/ class>Brain Segmentation</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> User Guide <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/glossary/ class>Glossary</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Deployment <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/deployment/deployment/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/deployment/deployment-vpn/ class>VPN Deployment</a> </li> <li class> <a href=../../../../user-guide/deployment/matrix/ class>Network matrix</a> </li> <li class> <a href=../../../../user-guide/deployment/security-model/ class>Security model</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/nodes/configuring-nodes/ class>Configuring Nodes</a> </li> <li class> <a href=../../../../user-guide/nodes/deploying-datasets/ class>Deploying Datasets</a> </li> <li class> <a href=../../../../user-guide/nodes/training-plan-security-manager/ class>Training Plan Management</a> </li> <li class> <a href=../../../../user-guide/nodes/using-gpu/ class>Using GPU</a> </li> <li class> <a href=../../../../user-guide/nodes/node-gui/ class>Node GUI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/researcher/training-plan/ class>Training Plan</a> </li> <li class> <a href=../../../../user-guide/researcher/training-data/ class>Training Data</a> </li> <li class> <a href=../../../../user-guide/researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../../../user-guide/researcher/aggregation/ class>Aggregation</a> </li> <li class> <a href=../../../../user-guide/researcher/listing-datasets-and-selecting-nodes/ class>Listing Datasets and Selecting Nodes</a> </li> <li class> <a href=../../../../user-guide/researcher/model-testing-during-federated-training/ class>Model Validation on the Node Side</a> </li> <li class> <a href=../../../../user-guide/researcher/tensorboard/ class>Tensorboard</a> </li> </ul> </li> <li class> <a href=../../../../user-guide/advanced-optimization/ class>Optimization</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Secure Aggregation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/secagg/introduction/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/secagg/configuration/ class>Configuration</a> </li> <li class> <a href=../../../../user-guide/secagg/researcher-interface/ class>Managing Secure Aggregation in Researcher</a> </li> <li class> <a href=../../../../user-guide/secagg/certificate-registration/ class>Joye-Libert Cert. Registration</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Developer <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> API Reference <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Common <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../common/certificate_manager/ class>Certificate Manager</a> </li> <li class> <a href=../../common/cli/ class>CLI</a> </li> <li class> <a href=../../common/config/ class>Config</a> </li> <li class> <a href=../../common/constants/ class>Constants</a> </li> <li class> <a href=../../common/data/ class>Data</a> </li> <li class> <a href=../../common/db/ class>DB</a> </li> <li class> <a href=../../common/environ/ class>Environ</a> </li> <li class> <a href=../../common/exceptions/ class>Exceptions</a> </li> <li class> <a href=../../common/ipython/ class>IPython</a> </li> <li class> <a href=../../common/json/ class>Json</a> </li> <li class> <a href=../../common/logger/ class>Logger</a> </li> <li class> <a href=../../common/message/ class>Message</a> </li> <li class> <a href=../../common/metrics/ class>Metrics</a> </li> <li class> <a href=../../common/models/ class>Model</a> </li> <li class> <a href=../../common/mpc_controller/ class>MPC controller</a> </li> <li class> <a href=../../common/optimizers/ class>Optimizers</a> </li> <li class> <a href=../../common/privacy/ class>Privacy</a> </li> <li class> <a href=../../common/secagg/ class>Secagg</a> </li> <li class> <a href=../../common/secagg_manager/ class>Secagg Manager</a> </li> <li class> <a href=../../common/serializer/ class>Serializer</a> </li> <li class> <a href=../../common/singleton/ class>Singleton</a> </li> <li class> <a href=../../common/synchro/ class>Synchro</a> </li> <li class> <a href=../../common/tasks_queue/ class>TasksQueue</a> </li> <li class> <a href=../../common/training_plans/ class>TrainingPlans</a> </li> <li class> <a href=../../common/training_args/ class>TrainingArgs</a> </li> <li class> <a href=../../common/utils/ class>Utils</a> </li> <li class> <a href=../../common/validator/ class>Validator</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../node/cli/ class>CLI</a> </li> <li class> <a href=../../node/cli_utils/ class>CLI Utils</a> </li> <li class> <a href=../../node/config/ class>Config</a> </li> <li class> <a href=../../node/dataset_manager/ class>DatasetManager</a> </li> <li class> <a href=../../node/environ/ class>Environ</a> </li> <li class> <a href=../../node/history_monitor/ class>HistoryMonitor</a> </li> <li class> <a href=../../node/node/ class>Node</a> </li> <li class> <a href=../../node/node_state_manager/ class>NodeStateManager</a> </li> <li class> <a href=../../node/requests/ class>Requests</a> </li> <li class> <a href=../../node/round/ class>Round</a> </li> <li class> <a href=../../node/secagg/ class>Secagg</a> </li> <li class> <a href=../../node/secagg_manager/ class>Secagg Manager</a> </li> <li class> <a href=../../node/training_plan_security_manager/ class>TrainingPlanSecurityManager</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../researcher/aggregators/ class>Aggregators</a> </li> <li class> <a href=../../researcher/cli/ class>CLI</a> </li> <li class> <a href=../../researcher/config/ class>Config</a> </li> <li class> <a href=../../researcher/datasets/ class>Datasets</a> </li> <li class> <a href=../../researcher/environ/ class>Environ</a> </li> <li class> <a href=../../researcher/federated_workflows/ class>Federated Workflows</a> </li> <li class> <a href=../../researcher/filetools/ class>Filetools</a> </li> <li class> <a href=../../researcher/jobs/ class>Jobs</a> </li> <li class> <a href=../../researcher/monitor/ class>Monitor</a> </li> <li class> <a href=../../researcher/node_state_agent/ class>NodeStateAgent</a> </li> <li class> <a href=../../researcher/requests/ class>Requests</a> </li> <li class> <a href=../../researcher/secagg/ class>Secagg</a> </li> <li class> <a href=../../researcher/strategies/ class>Strategies</a> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Transport <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li class> <a href=../client/ class>Client</a> </li> <li class=current> <a href=./ class="link current">Controller</a> </li> <li class> <a href=../node_agent/ class>NodeAgent</a> </li> <li class> <a href=../server/ class>Server</a> </li> </ul> </li> </ul> </li> <li class> <a href=../../../usage_and_tools/ class>Usage and Tools</a> </li> <li class> <a href=../../../ci/ class>Continuous Integration</a> </li> <li class> <a href=../../../definition-of-done/ class>Definition of Done</a> </li> <li class> <a href=../../../testing-in-fedbiomed/ class>Testing in Fed-BioMed</a> </li> <li class> <a href=../../../messaging/ class>RPC Protocol and Messages</a> </li> </ul> </li> </ul> </nav> </div> </div> <div class=main-col> <main class=main-docs> <h1>Controller</h1> <article> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <div class="doc doc-children"> <h2 id=fedbiomed.transport.controller-attributes>Attributes</h2> <h2 id=fedbiomed.transport.controller-classes>Classes</h2> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.transport.controller.GrpcAsyncTaskController class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">GrpcAsyncTaskController</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>GrpcAsyncTaskController</span><span class=p>(</span><span class=n>node_id</span><span class=p>,</span> <span class=n>researchers</span><span class=p>,</span> <span class=n>on_message</span><span class=p>,</span> <span class=n>debug</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>RPC asynchronous task controller</p> <p>Launches async tasks for listening the requests/tasks coming from researcher as well as listener to send the replies that are created by the node. All the methods of this class are awaitable, except the constructor.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>node_id</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>The ID of the node component that runs RPC client</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>researchers</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-internal" title="fedbiomed.transport.client.ResearcherCredentials" href="../client/#fedbiomed.transport.client.ResearcherCredentials">ResearcherCredentials</a>]</code> </td> <td> <div class=doc-md-description> <p>List of researchers that the RPC client will connect to.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>on_message</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></code> </td> <td> <div class=doc-md-description> <p>Callback function to be executed once a task received from the researcher</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>debug</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>Activates debug mode for <code>asyncio</code></p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedCommunicationError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedCommunicationError">FedbiomedCommunicationError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/transport/controller.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="20 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos="21 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="22 "></span>        <span class=n>node_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
<span class=linenos data-linenos="23 "></span>        <span class=n>researchers</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ResearcherCredentials</span><span class=p>],</span>
<span class=linenos data-linenos="24 "></span>        <span class=n>on_message</span><span class=p>:</span> <span class=n>Callable</span><span class=p>,</span>
<span class=linenos data-linenos="25 "></span>        <span class=n>debug</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
<span class=linenos data-linenos="26 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="27 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructs GrpcAsyncTaskController</span>
<span class=linenos data-linenos="28 "></span>
<span class=linenos data-linenos="29 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="30 "></span><span class=sd>        node_id: The ID of the node component that runs RPC client</span>
<span class=linenos data-linenos="31 "></span><span class=sd>        researchers: List of researchers that the RPC client will connect to.</span>
<span class=linenos data-linenos="32 "></span><span class=sd>        on_message: Callback function to be executed once a task received from the researcher</span>
<span class=linenos data-linenos="33 "></span><span class=sd>        debug: Activates debug mode for `asyncio`</span>
<span class=linenos data-linenos="34 "></span>
<span class=linenos data-linenos="35 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="36 "></span><span class=sd>        FedbiomedCommunicationError: bad argument type</span>
<span class=linenos data-linenos="37 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="38 "></span>
<span class=linenos data-linenos="39 "></span>    <span class=c1># inform all threads whether communication client is started</span>
<span class=linenos data-linenos="40 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_is_started</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Event</span><span class=p>()</span>
<span class=linenos data-linenos="41 "></span>
<span class=linenos data-linenos="42 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_node_id</span> <span class=o>=</span> <span class=n>node_id</span>
<span class=linenos data-linenos="43 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_researchers</span> <span class=o>=</span> <span class=n>researchers</span>
<span class=linenos data-linenos="44 "></span>
<span class=linenos data-linenos="45 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_loop</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="46 "></span>
<span class=linenos data-linenos="47 "></span>    <span class=c1># Maps researcher ip to corresponding ids</span>
<span class=linenos data-linenos="48 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_ip_id_map_lock</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="49 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_ip_id_map</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="50 "></span>
<span class=linenos data-linenos="51 "></span>    <span class=c1># Clients lock not needed for now (client list not modified after initialization)</span>
<span class=linenos data-linenos="52 "></span>    <span class=c1># but guarantees to be future safe for dynamic researcher clients&#39; list</span>
<span class=linenos data-linenos="53 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_clients_lock</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="54 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_clients</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>GrpcClient</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="55 "></span>
<span class=linenos data-linenos="56 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_debug</span> <span class=o>=</span> <span class=n>debug</span>
<span class=linenos data-linenos="57 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_on_message</span> <span class=o>=</span> <span class=n>on_message</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.transport.controller.GrpcAsyncTaskController-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.transport.controller.GrpcAsyncTaskController.is_connected class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">is_connected</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>is_connected</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Checks if there is running tasks</p> <details class=quote> <summary>Source code in <code>fedbiomed/transport/controller.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="121 "></span><span class=k>async</span> <span class=k>def</span> <span class=nf>is_connected</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="122 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Checks if there is running tasks&quot;&quot;&quot;</span>
<span class=linenos data-linenos="123 "></span>
<span class=linenos data-linenos="124 "></span>    <span class=k>async</span> <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>_clients_lock</span><span class=p>:</span>
<span class=linenos data-linenos="125 "></span>        <span class=n>tasks</span> <span class=o>=</span> <span class=p>[</span><span class=ow>not</span> <span class=n>task</span><span class=o>.</span><span class=n>done</span><span class=p>()</span> <span class=k>for</span> <span class=n>client</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_clients</span><span class=o>.</span><span class=n>values</span><span class=p>()</span> <span class=k>for</span> <span class=n>task</span> <span class=ow>in</span> <span class=n>client</span><span class=o>.</span><span class=n>tasks</span><span class=p>]</span>
<span class=linenos data-linenos="126 "></span>        <span class=k>return</span> <span class=nb>all</span><span class=p>(</span><span class=n>tasks</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.transport.controller.GrpcAsyncTaskController.send class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">send</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>send</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>broadcast</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sends message to researcher.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>message</code></td> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.message.Message" href="../../common/message/#fedbiomed.common.message.Message">Message</a></code> </td> <td> <div class=doc-md-description> <p>Message to send</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>broadcast</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>Broadcast the message to all available researcher. This option should be used for general node state messages (e.g. general Error)</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/transport/controller.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="83 "></span><span class=k>async</span> <span class=k>def</span> <span class=nf>send</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>message</span><span class=p>:</span> <span class=n>Message</span><span class=p>,</span> <span class=n>broadcast</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="84 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sends message to researcher.</span>
<span class=linenos data-linenos="85 "></span>
<span class=linenos data-linenos="86 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="87 "></span><span class=sd>        message: Message to send</span>
<span class=linenos data-linenos="88 "></span><span class=sd>        broadcast: Broadcast the message to all available researcher. This option should be used for general</span>
<span class=linenos data-linenos="89 "></span><span class=sd>            node state messages (e.g. general Error)</span>
<span class=linenos data-linenos="90 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="91 "></span>    <span class=k>if</span> <span class=n>broadcast</span><span class=p>:</span>
<span class=linenos data-linenos="92 "></span>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_broadcast</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
<span class=linenos data-linenos="93 "></span>
<span class=linenos data-linenos="94 "></span>    <span class=k>async</span> <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>_clients_lock</span><span class=p>:</span>
<span class=linenos data-linenos="95 "></span>        <span class=k>async</span> <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>_ip_id_map_lock</span><span class=p>:</span>
<span class=linenos data-linenos="96 "></span>            <span class=n>researcher</span> <span class=o>=</span> <span class=n>message</span><span class=o>.</span><span class=n>researcher_id</span>
<span class=linenos data-linenos="97 "></span>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_clients</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_ip_id_map</span><span class=p>[</span><span class=n>researcher</span><span class=p>]]</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.transport.controller.GrpcAsyncTaskController.start class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">start</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>start</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>"Starts the tasks for each GrpcClient</p> <details class=quote> <summary>Source code in <code>fedbiomed/transport/controller.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="60 "></span><span class=k>async</span> <span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="61 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;&quot;Starts the tasks for each GrpcClient&quot;&quot;&quot;</span>
<span class=linenos data-linenos="62 "></span>
<span class=linenos data-linenos="63 "></span>    <span class=n>tasks</span> <span class=o>=</span> <span class=p>[]</span>
<span class=linenos data-linenos="64 "></span>    <span class=k>for</span> <span class=n>researcher</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_researchers</span><span class=p>:</span>
<span class=linenos data-linenos="65 "></span>        <span class=n>client</span> <span class=o>=</span> <span class=n>GrpcClient</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_node_id</span><span class=p>,</span> <span class=n>researcher</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_update_id_ip_map</span><span class=p>)</span>
<span class=linenos data-linenos="66 "></span>        <span class=n>tasks</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>client</span><span class=o>.</span><span class=n>start</span><span class=p>(</span><span class=n>on_task</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_on_message</span><span class=p>))</span>
<span class=linenos data-linenos="67 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_clients</span><span class=p>[</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>researcher</span><span class=o>.</span><span class=n>host</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>researcher</span><span class=o>.</span><span class=n>port</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>client</span>
<span class=linenos data-linenos="68 "></span>
<span class=linenos data-linenos="69 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_loop</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>get_running_loop</span><span class=p>()</span>
<span class=linenos data-linenos="70 "></span>
<span class=linenos data-linenos="71 "></span>    <span class=c1># Create asyncio locks</span>
<span class=linenos data-linenos="72 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_ip_id_map_lock</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Lock</span><span class=p>()</span>
<span class=linenos data-linenos="73 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_clients_lock</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Lock</span><span class=p>()</span>
<span class=linenos data-linenos="74 "></span>
<span class=linenos data-linenos="75 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_is_started</span><span class=o>.</span><span class=n>set</span><span class=p>()</span>
<span class=linenos data-linenos="76 "></span>
<span class=linenos data-linenos="77 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Starting task listeners&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="78 "></span>
<span class=linenos data-linenos="79 "></span>    <span class=c1># Run GrpcClient asyncio tasks</span>
<span class=linenos data-linenos="80 "></span>    <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.transport.controller.GrpcController class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">GrpcController</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>GrpcController</span><span class=p>(</span><span class=n>node_id</span><span class=p>,</span> <span class=n>researchers</span><span class=p>,</span> <span class=n>on_message</span><span class=p>,</span> <span class=n>debug</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="fedbiomed.transport.controller.GrpcAsyncTaskController" href="#fedbiomed.transport.controller.GrpcAsyncTaskController">GrpcAsyncTaskController</a></code></p> <p>"gRPC Controller class</p> <p>This class is responsible of managing GrpcConnections with researcher components. It is wrapper class of GrpcClients. It has been designed to be called main or different threads than the one grpc client runs.</p> <p><span class=doc-section-title>Attributes:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code><span title="fedbiomed.transport.controller.GrpcController._thread">_thread</span></code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="threading.Thread" href="https://docs.python.org/3/library/threading.html#threading.Thread">Thread</a>]</code> </td> <td> <div class=doc-md-description> <p>background thread of gRPC controller</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>node_id</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>The ID of the node component that runs RPC client</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>researchers</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-internal" title="fedbiomed.transport.client.ResearcherCredentials" href="../client/#fedbiomed.transport.client.ResearcherCredentials">ResearcherCredentials</a>]</code> </td> <td> <div class=doc-md-description> <p>List of researchers that the RPC client will connect to.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>on_message</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></code> </td> <td> <div class=doc-md-description> <p>Callback function to be executed once a task received from the researcher</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>debug</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>Activates debug mode for <code>asyncio</code></p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedCommunicationError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedCommunicationError">FedbiomedCommunicationError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/transport/controller.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="20 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos="21 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="22 "></span>        <span class=n>node_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
<span class=linenos data-linenos="23 "></span>        <span class=n>researchers</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ResearcherCredentials</span><span class=p>],</span>
<span class=linenos data-linenos="24 "></span>        <span class=n>on_message</span><span class=p>:</span> <span class=n>Callable</span><span class=p>,</span>
<span class=linenos data-linenos="25 "></span>        <span class=n>debug</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
<span class=linenos data-linenos="26 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="27 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructs GrpcAsyncTaskController</span>
<span class=linenos data-linenos="28 "></span>
<span class=linenos data-linenos="29 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="30 "></span><span class=sd>        node_id: The ID of the node component that runs RPC client</span>
<span class=linenos data-linenos="31 "></span><span class=sd>        researchers: List of researchers that the RPC client will connect to.</span>
<span class=linenos data-linenos="32 "></span><span class=sd>        on_message: Callback function to be executed once a task received from the researcher</span>
<span class=linenos data-linenos="33 "></span><span class=sd>        debug: Activates debug mode for `asyncio`</span>
<span class=linenos data-linenos="34 "></span>
<span class=linenos data-linenos="35 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="36 "></span><span class=sd>        FedbiomedCommunicationError: bad argument type</span>
<span class=linenos data-linenos="37 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="38 "></span>
<span class=linenos data-linenos="39 "></span>    <span class=c1># inform all threads whether communication client is started</span>
<span class=linenos data-linenos="40 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_is_started</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Event</span><span class=p>()</span>
<span class=linenos data-linenos="41 "></span>
<span class=linenos data-linenos="42 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_node_id</span> <span class=o>=</span> <span class=n>node_id</span>
<span class=linenos data-linenos="43 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_researchers</span> <span class=o>=</span> <span class=n>researchers</span>
<span class=linenos data-linenos="44 "></span>
<span class=linenos data-linenos="45 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_loop</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="46 "></span>
<span class=linenos data-linenos="47 "></span>    <span class=c1># Maps researcher ip to corresponding ids</span>
<span class=linenos data-linenos="48 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_ip_id_map_lock</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="49 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_ip_id_map</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="50 "></span>
<span class=linenos data-linenos="51 "></span>    <span class=c1># Clients lock not needed for now (client list not modified after initialization)</span>
<span class=linenos data-linenos="52 "></span>    <span class=c1># but guarantees to be future safe for dynamic researcher clients&#39; list</span>
<span class=linenos data-linenos="53 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_clients_lock</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="54 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_clients</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>GrpcClient</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="55 "></span>
<span class=linenos data-linenos="56 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_debug</span> <span class=o>=</span> <span class=n>debug</span>
<span class=linenos data-linenos="57 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_on_message</span> <span class=o>=</span> <span class=n>on_message</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.transport.controller.GrpcController-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.transport.controller.GrpcController.is_connected class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">is_connected</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>is_connected</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>"Checks GrpcController is connected to any RPC client.</p> <p>This method should only be called from different thread than the one that asyncio loop running in.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>Connection status</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedCommunicationError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedCommunicationError">FedbiomedCommunicationError</a></code> </td> <td> <div class=doc-md-description> <p>node is not started</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/transport/controller.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="200 "></span><span class=k>def</span> <span class=nf>is_connected</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="201 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;&quot;Checks GrpcController is connected to any RPC client.</span>
<span class=linenos data-linenos="202 "></span>
<span class=linenos data-linenos="203 "></span><span class=sd>    This method should only be called from different thread than the one that asyncio loop running in.</span>
<span class=linenos data-linenos="204 "></span>
<span class=linenos data-linenos="205 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="206 "></span><span class=sd>        Connection status</span>
<span class=linenos data-linenos="207 "></span>
<span class=linenos data-linenos="208 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="209 "></span><span class=sd>        FedbiomedCommunicationError: node is not started</span>
<span class=linenos data-linenos="210 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="211 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_started</span><span class=o>.</span><span class=n>is_set</span><span class=p>():</span>
<span class=linenos data-linenos="212 "></span>        <span class=k>raise</span> <span class=n>FedbiomedCommunicationError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB628</span><span class=si>}</span><span class=s2>: Communication client is not initialized.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="213 "></span>
<span class=linenos data-linenos="214 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span><span class=o>.</span><span class=n>is_alive</span><span class=p>():</span>
<span class=linenos data-linenos="215 "></span>        <span class=k>return</span> <span class=kc>False</span>
<span class=linenos data-linenos="216 "></span>
<span class=linenos data-linenos="217 "></span>    <span class=n>future</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>run_coroutine_threadsafe</span><span class=p>(</span>
<span class=linenos data-linenos="218 "></span>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>is_connected</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>_loop</span>
<span class=linenos data-linenos="219 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="220 "></span>    <span class=k>return</span> <span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.transport.controller.GrpcController.send class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">send</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>send</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>broadcast</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sends given message to researcher</p> <p>Researcher id must exist in the message.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>message</code></td> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.message.Message" href="../../common/message/#fedbiomed.common.message.Message">Message</a></code> </td> <td> <div class=doc-md-description> <p>Message to send to researcher</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>broadcast</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>If True, broadcasts the given message to all available. This does not prevent adding <code>researcher_id</code> to the message. The attribute <code>researcher_id</code> in the message should be <code>&lt;unknown&gt;</code></p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedCommunicationError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedCommunicationError">FedbiomedCommunicationError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedCommunicationError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedCommunicationError">FedbiomedCommunicationError</a></code> </td> <td> <div class=doc-md-description> <p>node is not started</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/transport/controller.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="173 "></span><span class=k>def</span> <span class=nf>send</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>message</span><span class=p>:</span> <span class=n>Message</span><span class=p>,</span> <span class=n>broadcast</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="174 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sends given message to researcher</span>
<span class=linenos data-linenos="175 "></span>
<span class=linenos data-linenos="176 "></span><span class=sd>    Researcher id must exist in the message.</span>
<span class=linenos data-linenos="177 "></span>
<span class=linenos data-linenos="178 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="179 "></span><span class=sd>        message: Message to send to researcher</span>
<span class=linenos data-linenos="180 "></span><span class=sd>        broadcast: If True, broadcasts the given message to all available.</span>
<span class=linenos data-linenos="181 "></span><span class=sd>            This does not prevent adding `researcher_id` to the message.</span>
<span class=linenos data-linenos="182 "></span><span class=sd>            The attribute `researcher_id` in the message should be `&lt;unknown&gt;`</span>
<span class=linenos data-linenos="183 "></span>
<span class=linenos data-linenos="184 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="185 "></span><span class=sd>        FedbiomedCommunicationError: bad argument type</span>
<span class=linenos data-linenos="186 "></span><span class=sd>        FedbiomedCommunicationError: node is not started</span>
<span class=linenos data-linenos="187 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="188 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>Message</span><span class=p>):</span>
<span class=linenos data-linenos="189 "></span>        <span class=k>raise</span> <span class=n>FedbiomedCommunicationError</span><span class=p>(</span>
<span class=linenos data-linenos="190 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB628</span><span class=si>}</span><span class=s2>: bad argument type for message, expected `Message`, got `</span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>message</span><span class=p>)</span><span class=si>}</span><span class=s2>`&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="191 "></span>
<span class=linenos data-linenos="192 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_started</span><span class=o>.</span><span class=n>is_set</span><span class=p>():</span>
<span class=linenos data-linenos="193 "></span>        <span class=k>raise</span> <span class=n>FedbiomedCommunicationError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB628</span><span class=si>}</span><span class=s2>: Communication client is not initialized.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="194 "></span>
<span class=linenos data-linenos="195 "></span>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run_coroutine_threadsafe</span><span class=p>(</span>
<span class=linenos data-linenos="196 "></span>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>broadcast</span><span class=p>),</span> <span class=bp>self</span><span class=o>.</span><span class=n>_loop</span>
<span class=linenos data-linenos="197 "></span>    <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.transport.controller.GrpcController.start class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">start</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>start</span><span class=p>(</span><span class=n>on_finish</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Start GRPCClients in a thread.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>on_finish</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>]</code> </td> <td> <div class=doc-md-description> <p>Called when the tasks for handling all known researchers have finished. Callable has no argument. If None, then no action is taken.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/transport/controller.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="160 "></span><span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>on_finish</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Callable</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="161 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Start GRPCClients in a thread.</span>
<span class=linenos data-linenos="162 "></span>
<span class=linenos data-linenos="163 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="164 "></span><span class=sd>        on_finish: Called when the tasks for handling all known researchers have finished. </span>
<span class=linenos data-linenos="165 "></span><span class=sd>            Callable has no argument. If None, then no action is taken.</span>
<span class=linenos data-linenos="166 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="167 "></span>    <span class=c1># Adds grpc handler to send node logs to researchers</span>
<span class=linenos data-linenos="168 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>add_grpc_handler</span><span class=p>(</span><span class=n>on_log</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>send</span><span class=p>,</span> <span class=n>node_id</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_node_id</span><span class=p>)</span>
<span class=linenos data-linenos="169 "></span>
<span class=linenos data-linenos="170 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_run</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=n>on_finish</span><span class=p>,),</span> <span class=n>daemon</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=linenos data-linenos="171 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </article> </main> </div> <div class=right-col> <div id=right-sidebar class=sidebar-right> <nav class=toc> <!-- Render item list --> <label class=toc-title for=__toc> <span class=toc-icon></span> </label> <ul class=toc-list data-md-component=toc data-md-scrollfix> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller-attributes class=md-nav__link> Attributes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller-classes class=md-nav__link> Classes </a> <nav class=toc-nav aria-label=Classes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcAsyncTaskController class=md-nav__link> GrpcAsyncTaskController </a> <nav class=toc-nav aria-label=GrpcAsyncTaskController> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcAsyncTaskController-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcAsyncTaskController.is_connected class=md-nav__link> is_connected </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcAsyncTaskController.send class=md-nav__link> send </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcAsyncTaskController.start class=md-nav__link> start </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcController class=md-nav__link> GrpcController </a> <nav class=toc-nav aria-label=GrpcController> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcController-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcController.is_connected class=md-nav__link> is_connected </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcController.send class=md-nav__link> send </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.transport.controller.GrpcController.start class=md-nav__link> start </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> </div> <!-- News Main Page--> </div> <footer> <div class=container-fluid> <div class=footer-first-inner> <div class=container> <div class=row> <div class=col-md-6> <div class=footer-contact> <strong>Address:</strong> <p>2004 Rte des Lucioles, 06902 Sophia Antipolis</p> <strong>E-mail:</strong> <p>fedbiomed _at_ inria _dot_ fr</p> </div> </div> <div class=col-md-6> <div class=footer-contact> <p>Fed-BioMed © 2022</p> </div> </div> </div> </div> </div> </div> </footer> <!-- JQuery --> <script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script> <!-- Latest compiled and minified JavaScript --> <script src=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../../assets/javascript/lunr.js></script> <script src=../../../../assets/javascript/theme.js></script> </body> </html>