<!DOCTYPE html><html> <head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1"><meta name=robots context="index, archive"><!--  --><script>
      const versions_json = "../../../../../versions.json";
      const search_worker_js = "../../../../assets/javascript/search-worker.js";
      const search_index_json = "../../../../search/search_index.json";
      const base_url = '../../../..';
    </script><!-- Site title --><title>TrainingPlans - Fed-BioMed</title><link rel=icon type=image/x-icon href=../../../../favicon.ico><!-- Page description --><meta name=description content="Open, Transparent and Trusted Collaborative Learning for Real-world Healthcare Applications"><!-- Page keywords --><!-- Page author --><!-- Latest compiled and minified CSS --><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><!-- Bootstrap Icons --><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link href=../../../../assets/_mkdocstrings.css rel=stylesheet><link href=../../../../assets/css/style.css rel=stylesheet></head> <body> <header> <div class="container-fluid top-bar"> <div class=brand> <a href=/ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <nav class=top> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class="container-fluid top-bar-mobile"> <div class=mobile-bar> <div class=brand> <a href=../../../../ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <div class=hum-menu> <img class=open src=../../../../assets/img/menu.svg> <img class=close style=display:none src=../../../../assets/img/cancel.svg> </div> </div> <nav class=top-mobile> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> </header> <div class=main> <!-- Home page --> <div class=container-fluid> <div class=doc-row> <div class=left-col> <div class=sidebar-doc> <nav class=sidebar-inner> <ul class="sidebar-menu-left sub"> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Getting Started <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ class>What's Fed-BioMed</a> </li> <li class> <a href=../../../../getting-started/getting-started/ class>Basic Example</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-architecture/ class>Fedbiomed Architecture</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-workflow/ class>Fedbiomed Workflow</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Tutorials <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Installation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/installation/0-basic-software-installation/ class>Software Installation</a> </li> <li class> <a href=../../../../tutorials/installation/1-setting-up-environment/ class>Setting Up Environment</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> PyTorch <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/pytorch/01_PyTorch_MNIST_Single_Node_Tutorial/ class>PyTorch MNIST Basic Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/02_Create_Your_Custom_Training_Plan/ class>How to Create Your Custom PyTorch Training Plan</a> </li> <li class> <a href=../../../../tutorials/pytorch/03_PyTorch_MNIST_local_vs_Federated/ class>MNIST classification with PyTorch, comparing federated model vs model trained locally</a> </li> <li class> <a href=../../../../tutorials/pytorch/04_PyTorch_Used_Cars_Dataset_Example/ class>PyTorch Used Cars Dataset Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/05-Aggregation_in_Fed-BioMed/ class>PyTorch aggregation methods in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> MONAI <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/monai/01_monai-2d-image-classification/ class>Federated 2d image classification with MONAI</a> </li> <li class> <a href=../../../../tutorials/monai/02_monai-2d-image-registration/ class>Federated 2d XRay registration with MONAI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Scikit-Learn <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/scikit-learn/01_sklearn_MNIST_classification_tutorial/ class>MNIST classification with Scikit-Learn Classifier (Perceptron)</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/02_sklearn_sgd_regressor_tutorial/ class>Fed-BioMed to train a federated SGD regressor model</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/03-other-scikit-learn-models/ class>Implementing other Scikit Learn models for Federated Learning</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Optimizers <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/optimizers/01-fedopt-and-scaffold/ class>Advanced optimizers in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> FLamby <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/flamby/flamby/ class>General Concepts</a> </li> <li class> <a href=../../../../tutorials/flamby/flamby-integration-into-fedbiomed/ class>FLamby integration in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Advanced <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/advanced/in-depth-experiment-configuration/ class>In Depth Experiment Configuration</a> </li> <li class> <a href=../../../../tutorials/advanced/training-with-gpu/ class>PyTorch model training using a GPU</a> </li> <li class> <a href=../../../../tutorials/advanced/breakpoints/ class>Breakpoints</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Security <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/security/differential-privacy-with-opacus-on-fedbiomed/ class>Using Differential Privacy with OPACUS on Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/security/non-private-local-central-dp-monai-2d-image-registration/ class>Local and Central DP with Fed-BioMed: MONAI 2d image registration</a> </li> <li class> <a href=../../../../tutorials/security/training-with-approved-training-plans/ class>Training Process with Training Plan Management</a> </li> <li class> <a href=../../../../tutorials/security/secure-aggregation/ class>Training with Secure Aggregation</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Biomedical data <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/medical/medical-image-segmentation-unet-library/ class>Brain Segmentation</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> User Guide <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/glossary/ class>Glossary</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Deployment <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/deployment/deployment/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/deployment/deployment-vpn/ class>VPN Deployment</a> </li> <li class> <a href=../../../../user-guide/deployment/matrix/ class>Network matrix</a> </li> <li class> <a href=../../../../user-guide/deployment/security-model/ class>Security model</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/nodes/configuring-nodes/ class>Configuring Nodes</a> </li> <li class> <a href=../../../../user-guide/nodes/deploying-datasets/ class>Deploying Datasets</a> </li> <li class> <a href=../../../../user-guide/nodes/training-plan-security-manager/ class>Training Plan Management</a> </li> <li class> <a href=../../../../user-guide/nodes/using-gpu/ class>Using GPU</a> </li> <li class> <a href=../../../../user-guide/nodes/node-gui/ class>Node GUI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/researcher/training-plan/ class>Training Plan</a> </li> <li class> <a href=../../../../user-guide/researcher/training-data/ class>Training Data</a> </li> <li class> <a href=../../../../user-guide/researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../../../user-guide/researcher/aggregation/ class>Aggregation</a> </li> <li class> <a href=../../../../user-guide/researcher/listing-datasets-and-selecting-nodes/ class>Listing Datasets and Selecting Nodes</a> </li> <li class> <a href=../../../../user-guide/researcher/model-testing-during-federated-training/ class>Model Validation on the Node Side</a> </li> <li class> <a href=../../../../user-guide/researcher/tensorboard/ class>Tensorboard</a> </li> </ul> </li> <li class> <a href=../../../../user-guide/advanced-optimization/ class>Optimization</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Secure Aggregation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/secagg/introduction/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/secagg/configuration/ class>Configuration</a> </li> <li class> <a href=../../../../user-guide/secagg/certificate-registration/ class>Certificate Registration</a> </li> <li class> <a href=../../../../user-guide/secagg/researcher-interface/ class>Managing Secure Aggregation in Researcher</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Developer <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> API Reference <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Common <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li class> <a href=../constants/ class>Constants</a> </li> <li class> <a href=../data/ class>Data</a> </li> <li class> <a href=../environ/ class>Environ</a> </li> <li class> <a href=../exceptions/ class>Exceptions</a> </li> <li class> <a class href=../json.md>Json</a> </li> <li class> <a href=../logger/ class>Logger</a> </li> <li class> <a href=../message/ class>Message</a> </li> <li class> <a class href=../messaging.md>Messaging</a> </li> <li class> <a href=../models/ class>Model</a> </li> <li class> <a href=../optimizers/ class>Optimizers</a> </li> <li class> <a class href=../repository.md>Repository</a> </li> <li class> <a href=../tasks_queue/ class>TasksQueue</a> </li> <li class=current> <a href=./ class="link current">TrainingPlans</a> </li> <li class> <a href=../training_args/ class>TrainingArgs</a> </li> <li class> <a href=../utils/ class>Utils</a> </li> <li class> <a href=../validator/ class>Validator</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../node/cli/ class>CLI</a> </li> <li class> <a href=../../node/dataset_manager/ class>DatasetManager</a> </li> <li class> <a href=../../node/node/ class>Node</a> </li> <li class> <a href=../../node/node_state_manager/ class>NodeStateManager</a> </li> <li class> <a href=../../node/training_plan_security_manager/ class>TrainingPlanSecurityManager</a> </li> <li class> <a href=../../node/history_monitor/ class>HistoryMonitor</a> </li> <li class> <a href=../../node/round/ class>Round</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../researcher/aggregators/ class>Aggregators</a> </li> <li class> <a href=../../researcher/datasets/ class>Datasets</a> </li> <li class> <a href=../../researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../researcher/filetools/ class>Filetools</a> </li> <li class> <a href=../../researcher/job/ class>Job</a> </li> <li class> <a href=../../researcher/monitor/ class>Monitor</a> </li> <li class> <a href=../../researcher/node_state_agent/ class>NodeStateAgent</a> </li> <li class> <a href=../../researcher/requests/ class>Requests</a> </li> <li class> <a href=../../researcher/strategies/ class>Strategies</a> </li> <li class> <a href=../../researcher/secagg/ class>Secagg</a> </li> </ul> </li> </ul> </li> <li class> <a href=../../../usage_and_tools/ class>Usage and Tools</a> </li> <li class> <a href=../../../ci/ class>Continuous Integration</a> </li> <li class> <a href=../../../definition-of-done/ class>Definition of Done</a> </li> <li class> <a href=../../../testing-in-fedbiomed/ class>Testing in Fed-BioMed</a> </li> <li class> <a href=../../../messaging/ class>RPC Protocol and Messages</a> </li> </ul> </li> </ul> </nav> </div> </div> <div class=main-col> <main class=main-docs> <h1>TrainingPlans</h1> <article> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>The <code>fedbiomed.common.training_plans</code> module includes training plan classes that are used for federated training</p> <div class="doc doc-children"> <h2 id=fedbiomed.common.training_plans-classes>Classes</h2> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.training_plans.BaseTrainingPlan class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">BaseTrainingPlan</span> </h3> <div class=highlight><pre><span></span><code><span class=n>BaseTrainingPlan</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Base class for training plan</p> <p>All concrete, framework- and/or model-specific training plans should inherit from this class, and implement: * the <code>post_init</code> method: to process model and training hyper-parameters * the <code>training_routine</code> method: to train the model for one round * the <code>predict</code> method: to compute predictions over a given batch * (opt.) the <code>testing_step</code> method: to override the evaluation behavior and compute a batch-wise (set of) metric(s)</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>dataset_path</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, None]</code> </td> <td> <div class=doc-md-description> <p>The path that indicates where dataset has been stored</p> </div> </td> </tr> <tr> <td><code>pre_processes</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="fedbiomed.common.training_plans._base_training_plan.PreProcessDict">PreProcessDict</span>]</code> </td> <td> <div class=doc-md-description> <p>Preprocess functions that will be applied to the training data at the beginning of the training routine.</p> </div> </td> </tr> <tr> <td><code>training_data_loader</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="torch.utils.data.DataLoader" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader">DataLoader</a>, <a class="autorefs autorefs-internal" title="fedbiomed.common.data.NPDataLoader" href="../data/#fedbiomed.common.data.NPDataLoader">NPDataLoader</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Data loader used in the training routine.</p> </div> </td> </tr> <tr> <td><code>testing_data_loader</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="torch.utils.data.DataLoader" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader">DataLoader</a>, <a class="autorefs autorefs-internal" title="fedbiomed.common.data.NPDataLoader" href="../data/#fedbiomed.common.data.NPDataLoader">NPDataLoader</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Data loader used in the validation routine.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_base_training_plan.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="61 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="62 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Construct the base training plan.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="63 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_dependencies</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
<span class=linenos data-linenos="64 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="65 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>pre_processes</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>PreProcessDict</span><span class=p>]</span> <span class=o>=</span> <span class=n>OrderedDict</span><span class=p>()</span>
<span class=linenos data-linenos="66 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>training_data_loader</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>DataLoader</span><span class=p>,</span> <span class=n>NPDataLoader</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="67 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>testing_data_loader</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>DataLoader</span><span class=p>,</span> <span class=n>NPDataLoader</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="68 "></span>
<span class=linenos data-linenos="69 "></span>    <span class=c1># Arguments provided by the researcher; they will be populated by post_init</span>
<span class=linenos data-linenos="70 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="71 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator_args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="72 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_optimizer_args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="73 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_loader_args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="74 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.training_plans.BaseTrainingPlan-attributes>Attributes</h4> <h4 id=fedbiomed.common.training_plans.BaseTrainingPlan-functions>Functions</h4> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.training_plans.FedPerceptron class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">FedPerceptron</span> </h3> <div class=highlight><pre><span></span><code><span class=n>FedPerceptron</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="fedbiomed.common.training_plans._sklearn_models.FedSGDClassifier" href="#fedbiomed.common.training_plans.FedSGDClassifier">FedSGDClassifier</a></code></p> <p>Fed-BioMed training plan for scikit-learn Perceptron models.</p> <p>This class inherits from FedSGDClassifier, and forces the wrapped scikit-learn SGDClassifier model to use a "perceptron" loss, that makes it equivalent to an actual scikit-learn Perceptron model.</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_sklearn_models.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="255 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="256 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Class constructor.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="257 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.training_plans.FedPerceptron-functions>Functions</h4> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.training_plans.FedSGDClassifier class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">FedSGDClassifier</span> </h3> <div class=highlight><pre><span></span><code><span class=n>FedSGDClassifier</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="fedbiomed.common.training_plans._sklearn_models.SKLearnTrainingPlanPartialFit">SKLearnTrainingPlanPartialFit</span></code></p> <p>Fed-BioMed training plan for scikit-learn SGDClassifier models.</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_sklearn_models.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="217 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="218 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the sklearn SGDClassifier training plan.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="219 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.training_plans.FedSGDRegressor class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">FedSGDRegressor</span> </h3> <div class=highlight><pre><span></span><code><span class=n>FedSGDRegressor</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="fedbiomed.common.training_plans._sklearn_models.SKLearnTrainingPlanPartialFit">SKLearnTrainingPlanPartialFit</span></code></p> <p>Fed-BioMed training plan for scikit-learn SGDRegressor models.</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_sklearn_models.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="203 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="204 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the sklearn SGDRegressor training plan.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="205 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.training_plans.SKLearnTrainingPlan class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">SKLearnTrainingPlan</span> </h3> <div class=highlight><pre><span></span><code><span class=n>SKLearnTrainingPlan</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="fedbiomed.common.training_plans._base_training_plan.BaseTrainingPlan" href="#fedbiomed.common.training_plans.BaseTrainingPlan">BaseTrainingPlan</a></code></p> <p>Base class for Fed-BioMed wrappers of sklearn classes.</p> <p>Classes that inherit from this abstract class must: - Specify a <code>_model_cls</code> class attribute that defines the type of scikit-learn model being wrapped for training. - Implement a <code>set_init_params</code> method that: - sets and assigns the model's initial trainable weights attributes. - populates the <code>_param_list</code> attribute with names of these attributes. - Implement a <code>_training_routine</code> method that performs a training round based on <code>self.train_data_loader</code> (which is a <code>NPDataLoader</code>).</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>dataset_path</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>The path that indicates where dataset has been stored</p> </div> </td> </tr> <tr> <td><code>pre_processes</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>Preprocess functions that will be applied to the training data at the beginning of the training routine.</p> </div> </td> </tr> <tr> <td><code>training_data_loader</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>Data loader used in the training routine.</p> </div> </td> </tr> <tr> <td><code>testing_data_loader</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>Data loader used in the validation routine.</p> </div> </td> </tr> </tbody> </table> <div class="admonition info"> <p class=admonition-title>Notes</p> <p>The trained model may be exported via the <code>export_model</code> method, resulting in a dump file that may be reloded using <code>joblib.load</code> outside of Fed-BioMed.</p> </div> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_sklearn_training_plan.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="59 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="60 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the SKLearnTrainingPlan.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="61 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
<span class=linenos data-linenos="62 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_model</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>SkLearnModel</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="63 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># type: Dict[str, Any]</span>
<span class=linenos data-linenos="64 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>__type</span> <span class=o>=</span> <span class=n>TrainingPlans</span><span class=o>.</span><span class=n>SkLearnTrainingPlan</span>
<span class=linenos data-linenos="65 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_batch_maxnum</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="66 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="67 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_optimizer</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BaseOptimizer</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="68 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_add_dependency</span><span class=p>([</span>
<span class=linenos data-linenos="69 "></span>        <span class=s2>&quot;import inspect&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="70 "></span>        <span class=s2>&quot;import numpy as np&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="71 "></span>        <span class=s2>&quot;import pandas as pd&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="72 "></span>        <span class=s2>&quot;from fedbiomed.common.training_plans import SKLearnTrainingPlan&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="73 "></span>        <span class=s2>&quot;from fedbiomed.common.data import DataManager&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="74 "></span>    <span class=p>])</span>
<span class=linenos data-linenos="75 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_add_dependency</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_model_dep</span><span class=p>))</span>
<span class=linenos data-linenos="76 "></span>
<span class=linenos data-linenos="77 "></span>    <span class=c1># Add dependencies</span>
<span class=linenos data-linenos="78 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_configure_dependencies</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.training_plans.SKLearnTrainingPlan-attributes>Attributes</h4> <h4 id=fedbiomed.common.training_plans.SKLearnTrainingPlan-functions>Functions</h4> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.training_plans.TorchTrainingPlan class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">TorchTrainingPlan</span> </h3> <div class=highlight><pre><span></span><code><span class=n>TorchTrainingPlan</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="fedbiomed.common.training_plans._base_training_plan.BaseTrainingPlan" href="#fedbiomed.common.training_plans.BaseTrainingPlan">BaseTrainingPlan</a></code></p> <p>Implements TrainingPlan for torch NN framework</p> <p>An abstraction over pytorch module to run pytorch models and scripts on node side. Researcher model (resp. params) will be:</p> <ol> <li>saved on a '<em>.py' (resp. '</em>.mpk') files,</li> <li>uploaded on a HTTP server (network layer),</li> <li>then Downloaded from the HTTP server on node side,</li> <li>finally, read and executed on node side.</li> </ol> <p>Researcher must define/override: - a <code>training_data()</code> function - a <code>training_step()</code> function</p> <p>Researcher may have to add extra dependencies/python imports, by using <code>init_dependencies</code> method.</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>dataset_path</code></td> <td> </td> <td> <div class=doc-md-description> <p>The path that indicates where dataset has been stored</p> </div> </td> </tr> <tr> <td><code>pre_processes</code></td> <td> </td> <td> <div class=doc-md-description> <p>Preprocess functions that will be applied to the training data at the beginning of the training routine.</p> </div> </td> </tr> <tr> <td><code>training_data_loader</code></td> <td> </td> <td> <div class=doc-md-description> <p>Data loader used in the training routine.</p> </div> </td> </tr> <tr> <td><code>testing_data_loader</code></td> <td> </td> <td> <div class=doc-md-description> <p>Data loader used in the validation routine.</p> </div> </td> </tr> <tr> <td><code>correction_state</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.OrderedDict" href="https://docs.python.org/3/library/typing.html#typing.OrderedDict">OrderedDict</a></code> </td> <td> <div class=doc-md-description> <p>an OrderedDict of {'parameter name': torch.Tensor} where the keys correspond to the names of the model parameters contained in self._model.named_parameters(), and the values correspond to the correction to be applied to that parameter.</p> </div> </td> </tr> </tbody> </table> <div class="admonition info"> <p class=admonition-title>Notes</p> <p>The trained model may be exported via the <code>export_model</code> method, resulting in a dump file that may be reloded using <code>torch.save</code> outside of Fed-BioMed.</p> </div> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_torchnn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 65 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos=" 66 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Construct training plan &quot;&quot;&quot;</span>
<span class=linenos data-linenos=" 67 "></span>
<span class=linenos data-linenos=" 68 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
<span class=linenos data-linenos=" 69 "></span>
<span class=linenos data-linenos=" 70 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>__type</span> <span class=o>=</span> <span class=n>TrainingPlans</span><span class=o>.</span><span class=n>TorchTrainingPlan</span>
<span class=linenos data-linenos=" 71 "></span>
<span class=linenos data-linenos=" 72 "></span>    <span class=c1># Differential privacy support</span>
<span class=linenos data-linenos=" 73 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_dp_controller</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>DPController</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 74 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_optimizer</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>BaseOptimizer</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 75 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_model</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>TorchModel</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 76 "></span>
<span class=linenos data-linenos=" 77 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_use_gpu</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
<span class=linenos data-linenos=" 78 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_share_persistent_buffers</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 79 "></span>
<span class=linenos data-linenos=" 80 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_batch_maxnum</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span>
<span class=linenos data-linenos=" 81 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_fedprox_mu</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 82 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_log_interval</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>10</span>
<span class=linenos data-linenos=" 83 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_epochs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span>
<span class=linenos data-linenos=" 84 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_dry_run</span> <span class=o>=</span> <span class=kc>False</span>
<span class=linenos data-linenos=" 85 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_num_updates</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 86 "></span>
<span class=linenos data-linenos=" 87 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>correction_state</span><span class=p>:</span> <span class=n>OrderedDict</span> <span class=o>=</span> <span class=n>OrderedDict</span><span class=p>()</span>
<span class=linenos data-linenos=" 88 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>aggregator_name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 89 "></span>
<span class=linenos data-linenos=" 90 "></span>    <span class=c1># TODO : add random seed init</span>
<span class=linenos data-linenos=" 91 "></span>    <span class=c1># self.random_seed_params = None</span>
<span class=linenos data-linenos=" 92 "></span>    <span class=c1># self.random_seed_shuffling_data = None</span>
<span class=linenos data-linenos=" 93 "></span>
<span class=linenos data-linenos=" 94 "></span>    <span class=c1># device to use: cpu/gpu</span>
<span class=linenos data-linenos=" 95 "></span>    <span class=c1># - all operations except training only use cpu</span>
<span class=linenos data-linenos=" 96 "></span>    <span class=c1># - researcher doesn&#39;t request to use gpu by default</span>
<span class=linenos data-linenos=" 97 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_device_init</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;cpu&quot;</span>
<span class=linenos data-linenos=" 98 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_device</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_device_init</span>
<span class=linenos data-linenos=" 99 "></span>
<span class=linenos data-linenos="100 "></span>    <span class=c1># list dependencies of the model</span>
<span class=linenos data-linenos="101 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_add_dependency</span><span class=p>([</span><span class=s2>&quot;import torch&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="102 "></span>                         <span class=s2>&quot;import torch.nn as nn&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="103 "></span>                         <span class=s2>&quot;import torch.nn.functional as F&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="104 "></span>                         <span class=s2>&quot;from fedbiomed.common.training_plans import TorchTrainingPlan&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="105 "></span>                         <span class=s2>&quot;from fedbiomed.common.data import DataManager&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="106 "></span>                         <span class=s2>&quot;from fedbiomed.common.constants import ProcessTypes&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="107 "></span>                         <span class=s2>&quot;from torch.utils.data import DataLoader&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="108 "></span>                         <span class=s2>&quot;from torchvision import datasets, transforms&quot;</span>
<span class=linenos data-linenos="109 "></span>                         <span class=p>])</span>
<span class=linenos data-linenos="110 "></span>
<span class=linenos data-linenos="111 "></span>    <span class=c1># Aggregated model parameters</span>
<span class=linenos data-linenos="112 "></span>    <span class=c1>#self._init_params: List[torch.Tensor] = None</span>
<span class=linenos data-linenos="113 "></span>
<span class=linenos data-linenos="114 "></span>    <span class=c1># Add dependencies</span>
<span class=linenos data-linenos="115 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_configure_dependencies</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.training_plans.TorchTrainingPlan-attributes>Attributes</h4> <h4 id=fedbiomed.common.training_plans.TorchTrainingPlan-functions>Functions</h4> </div> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <div class="doc doc-contents first"> <p>Accounting class for keeping track of training iterations.</p> <p>This class has the following responsibilities:</p> <div class=highlight><pre><span></span><code>- manage iterators for epochs and batches
- provide up-to-date values for reporting
- handle different semantics in case the researcher asked for num_updates or epochs
</code></pre></div> <p>We assume that the underlying implementation for the training loop is always made in terms of epochs and batches. So the primary purpose of this class is to provide a way to correctly convert the number of updates into epochs and batches.</p> <p>For reporting purposes, in the case of num_updates then we think of the training as a single big loop, while in the case of epochs and batches we think of it as two nested loops. This changes the meaning of the values outputted by the reporting functions (see their docstrings for more details).</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>_training_plan</code></td> <td> </td> <td> <div class=doc-md-description> <p>a reference to the training plan executing the training iterations</p> </div> </td> </tr> <tr> <td><code>cur_epoch</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the index of the current epoch during iterations</p> </div> </td> </tr> <tr> <td><code>cur_batch</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the index of the current batch during iterations</p> </div> </td> </tr> <tr> <td><code>epochs</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the total number of epochs to be performed (we always perform one additional -- possibly empty -- epoch</p> </div> </td> </tr> <tr> <td><code>num_batches_per_epoch</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the number of iterations per epoch</p> </div> </td> </tr> <tr> <td><code>num_batches_in_last_epoch</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the number of iterations in the last epoch (can be zero)</p> </div> </td> </tr> <tr> <td><code>num_samples_observed_in_epoch</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>a counter for the number of samples observed in the current epoch, for reporting</p> </div> </td> </tr> <tr> <td><code>num_samples_observed_in_total</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>a counter for the number of samples observed total, for reporting</p> </div> </td> </tr> </tbody> </table> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>training_plan</code></td> <td> <code><span title="fedbiomed.common.training_plans._training_iterations.TBaseTrainingPlan">TBaseTrainingPlan</span></code> </td> <td> <div class=doc-md-description> <p>a reference to the training plan that is executing the training iterations</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="47 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>training_plan</span><span class=p>:</span> <span class=n>TBaseTrainingPlan</span><span class=p>):</span>
<span class=linenos data-linenos="48 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the class.</span>
<span class=linenos data-linenos="49 "></span>
<span class=linenos data-linenos="50 "></span><span class=sd>    Arguments:</span>
<span class=linenos data-linenos="51 "></span><span class=sd>        training_plan: a reference to the training plan that is executing the training iterations</span>
<span class=linenos data-linenos="52 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="53 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span> <span class=o>=</span> <span class=n>training_plan</span>
<span class=linenos data-linenos="54 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>cur_epoch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="55 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>cur_batch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="56 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>epochs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="57 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_per_epoch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="58 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_in_last_epoch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="59 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>num_samples_observed_in_epoch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="60 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>num_samples_observed_in_total</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="61 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_n_training_iterations</span><span class=p>()</span>
</code></pre></div> </details> <div class="doc doc-children"> <h2 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant-attributes>Attributes</h2> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.cur_batch class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">cur_batch</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>cur_batch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.cur_epoch class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">cur_epoch</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>cur_epoch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.epochs class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">epochs</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>epochs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_batches_in_last_epoch class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">num_batches_in_last_epoch</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>num_batches_in_last_epoch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_batches_per_epoch class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">num_batches_per_epoch</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>num_batches_per_epoch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_samples_observed_in_epoch class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">num_samples_observed_in_epoch</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>num_samples_observed_in_epoch</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_samples_observed_in_total class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">num_samples_observed_in_total</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>num_samples_observed_in_total</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h2 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant-classes>Classes</h2> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.BatchIter class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">BatchIter</span> </h3> <div class=highlight><pre><span></span><code><span class=n>BatchIter</span><span class=p>(</span><span class=n>accountant</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Iterator over batches.</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>_accountant</code></td> <td> </td> <td> <div class=doc-md-description> <p>an instance of the class that created this iterator</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="229 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>accountant</span><span class=p>:</span> <span class=n>TTrainingIterationsAccountant</span><span class=p>):</span>
<span class=linenos data-linenos="230 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_accountant</span> <span class=o>=</span> <span class=n>accountant</span>
</code></pre></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.EpochsIter class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">EpochsIter</span> </h3> <div class=highlight><pre><span></span><code><span class=n>EpochsIter</span><span class=p>(</span><span class=n>accountant</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Iterator over epochs.</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>_accountant</code></td> <td> </td> <td> <div class=doc-md-description> <p>an instance of the class that created this iterator</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="200 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>accountant</span><span class=p>:</span> <span class=n>TTrainingIterationsAccountant</span><span class=p>):</span>
<span class=linenos data-linenos="201 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_accountant</span> <span class=o>=</span> <span class=n>accountant</span>
</code></pre></div> </details> <div class="doc doc-children"> </div> </div> </div> <h2 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant-functions>Functions</h2> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.increment_sample_counters class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">increment_sample_counters</span> </h3> <div class=highlight><pre><span></span><code><span class=n>increment_sample_counters</span><span class=p>(</span><span class=n>n_samples</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Increments internal counter for numbers of observed samples</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="70 "></span><span class=k>def</span> <span class=nf>increment_sample_counters</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n_samples</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos="71 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Increments internal counter for numbers of observed samples&quot;&quot;&quot;</span>
<span class=linenos data-linenos="72 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>num_samples_observed_in_epoch</span> <span class=o>+=</span> <span class=n>n_samples</span>
<span class=linenos data-linenos="73 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>num_samples_observed_in_total</span> <span class=o>+=</span> <span class=n>n_samples</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.iterate_batches class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">iterate_batches</span> </h3> <div class=highlight><pre><span></span><code><span class=n>iterate_batches</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Returns an instance of a batches iterator.</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="252 "></span><span class=k>def</span> <span class=nf>iterate_batches</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos="253 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns an instance of a batches iterator.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="254 "></span>    <span class=k>return</span> <span class=n>MiniBatchTrainingIterationsAccountant</span><span class=o>.</span><span class=n>BatchIter</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.iterate_epochs class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">iterate_epochs</span> </h3> <div class=highlight><pre><span></span><code><span class=n>iterate_epochs</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Returns an instance of an epochs iterator.</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="248 "></span><span class=k>def</span> <span class=nf>iterate_epochs</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos="249 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns an instance of an epochs iterator.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="250 "></span>    <span class=k>return</span> <span class=n>MiniBatchTrainingIterationsAccountant</span><span class=o>.</span><span class=n>EpochsIter</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_batches_in_this_epoch class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">num_batches_in_this_epoch</span> </h3> <div class=highlight><pre><span></span><code><span class=n>num_batches_in_this_epoch</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Returns the number of iterations to be performed in the current epoch</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="63 "></span><span class=k>def</span> <span class=nf>num_batches_in_this_epoch</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=linenos data-linenos="64 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns the number of iterations to be performed in the current epoch&quot;&quot;&quot;</span>
<span class=linenos data-linenos="65 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>cur_epoch</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>epochs</span><span class=p>:</span>
<span class=linenos data-linenos="66 "></span>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_in_last_epoch</span>
<span class=linenos data-linenos="67 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="68 "></span>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_per_epoch</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.reporting_on_epoch class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">reporting_on_epoch</span> </h3> <div class=highlight><pre><span></span><code><span class=n>reporting_on_epoch</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Returns the optional index of the current epoch, for reporting.</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="126 "></span><span class=k>def</span> <span class=nf>reporting_on_epoch</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<span class=linenos data-linenos="127 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns the optional index of the current epoch, for reporting.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="128 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span><span class=o>.</span><span class=n>training_args</span><span class=p>()[</span><span class=s1>&#39;num_updates&#39;</span><span class=p>]</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="129 "></span>        <span class=k>return</span> <span class=kc>None</span>
<span class=linenos data-linenos="130 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="131 "></span>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cur_epoch</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.reporting_on_num_iter class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">reporting_on_num_iter</span> </h3> <div class=highlight><pre><span></span><code><span class=n>reporting_on_num_iter</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Outputs useful reporting information about the number of iterations</p> <p>If the researcher specified num_updates, then the iteration number will be the cumulated total, and similarly the maximum number of iterations will be equal to the requested number of updates. If the researcher specified epochs, then the iteration number will be the batch index in the current epoch, while the maximum number of iterations will be computed specifically for the current epoch.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the iteration number</p> </div> </td> </tr> <tr> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the maximum number of iterations to be reported</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="104 "></span><span class=k>def</span> <span class=nf>reporting_on_num_iter</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
<span class=linenos data-linenos="105 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Outputs useful reporting information about the number of iterations</span>
<span class=linenos data-linenos="106 "></span>
<span class=linenos data-linenos="107 "></span><span class=sd>    If the researcher specified num_updates, then the iteration number will be the cumulated total, and</span>
<span class=linenos data-linenos="108 "></span><span class=sd>    similarly the maximum number of iterations will be equal to the requested number of updates.</span>
<span class=linenos data-linenos="109 "></span><span class=sd>    If the researcher specified epochs, then the iteration number will be the batch index in the current epoch,</span>
<span class=linenos data-linenos="110 "></span><span class=sd>    while the maximum number of iterations will be computed specifically for the current epoch.</span>
<span class=linenos data-linenos="111 "></span>
<span class=linenos data-linenos="112 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="113 "></span><span class=sd>        the iteration number</span>
<span class=linenos data-linenos="114 "></span><span class=sd>        the maximum number of iterations to be reported</span>
<span class=linenos data-linenos="115 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="116 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span><span class=o>.</span><span class=n>training_args</span><span class=p>()[</span><span class=s1>&#39;num_updates&#39;</span><span class=p>]</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="117 "></span>        <span class=n>num_iter</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>cur_epoch</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_per_epoch</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>cur_batch</span>
<span class=linenos data-linenos="118 "></span>        <span class=n>total_batches_to_be_observed</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>epochs</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_per_epoch</span> <span class=o>+</span> \
<span class=linenos data-linenos="119 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_in_last_epoch</span>
<span class=linenos data-linenos="120 "></span>        <span class=n>num_iter_max</span> <span class=o>=</span> <span class=n>total_batches_to_be_observed</span>
<span class=linenos data-linenos="121 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="122 "></span>        <span class=n>num_iter</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cur_batch</span>
<span class=linenos data-linenos="123 "></span>        <span class=n>num_iter_max</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_per_epoch</span>
<span class=linenos data-linenos="124 "></span>    <span class=k>return</span> <span class=n>num_iter</span><span class=p>,</span> <span class=n>num_iter_max</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.reporting_on_num_samples class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">reporting_on_num_samples</span> </h3> <div class=highlight><pre><span></span><code><span class=n>reporting_on_num_samples</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Outputs useful reporting information about the number of observed samples</p> <p>If the researcher specified num_updates, then the number of observed samples will be the grand total, and similarly the maximum number of samples will be the grand total over all iterations. If the researcher specified epochs, then both values will be specific to the current epoch.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the number of samples observed until the current iteration</p> </div> </td> </tr> <tr> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>the maximum number of samples to be observed</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 75 "></span><span class=k>def</span> <span class=nf>reporting_on_num_samples</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
<span class=linenos data-linenos=" 76 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Outputs useful reporting information about the number of observed samples</span>
<span class=linenos data-linenos=" 77 "></span>
<span class=linenos data-linenos=" 78 "></span><span class=sd>    If the researcher specified num_updates, then the number of observed samples will be the grand total, and</span>
<span class=linenos data-linenos=" 79 "></span><span class=sd>    similarly the maximum number of samples will be the grand total over all iterations.</span>
<span class=linenos data-linenos=" 80 "></span><span class=sd>    If the researcher specified epochs, then both values will be specific to the current epoch.</span>
<span class=linenos data-linenos=" 81 "></span>
<span class=linenos data-linenos=" 82 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos=" 83 "></span><span class=sd>        the number of samples observed until the current iteration</span>
<span class=linenos data-linenos=" 84 "></span><span class=sd>        the maximum number of samples to be observed</span>
<span class=linenos data-linenos=" 85 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos=" 86 "></span>    <span class=c1># get batch size</span>
<span class=linenos data-linenos=" 87 "></span>    <span class=k>if</span> <span class=s1>&#39;batch_size&#39;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span><span class=o>.</span><span class=n>loader_args</span><span class=p>():</span>
<span class=linenos data-linenos=" 88 "></span>        <span class=n>batch_size</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span><span class=o>.</span><span class=n>loader_args</span><span class=p>()[</span><span class=s1>&#39;batch_size&#39;</span><span class=p>]</span>
<span class=linenos data-linenos=" 89 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos=" 90 "></span>        <span class=k>raise</span> <span class=n>FedbiomedUserInputError</span><span class=p>(</span><span class=s1>&#39;Missing required key `batch_size` in `loader_args`.&#39;</span><span class=p>)</span>
<span class=linenos data-linenos=" 91 "></span>    <span class=c1># compute number of observed samples</span>
<span class=linenos data-linenos=" 92 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span><span class=o>.</span><span class=n>training_args</span><span class=p>()[</span><span class=s1>&#39;num_updates&#39;</span><span class=p>]</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos=" 93 "></span>        <span class=n>num_samples</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_samples_observed_in_total</span>
<span class=linenos data-linenos=" 94 "></span>        <span class=n>total_batches_to_be_observed</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>epochs</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_per_epoch</span> <span class=o>+</span> \
<span class=linenos data-linenos=" 95 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_in_last_epoch</span>
<span class=linenos data-linenos=" 96 "></span>        <span class=n>total_n_samples_to_be_observed</span> <span class=o>=</span> <span class=n>batch_size</span> <span class=o>*</span> <span class=n>total_batches_to_be_observed</span>
<span class=linenos data-linenos=" 97 "></span>        <span class=n>num_samples_max</span> <span class=o>=</span> <span class=n>total_n_samples_to_be_observed</span>
<span class=linenos data-linenos=" 98 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos=" 99 "></span>        <span class=n>num_samples</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_samples_observed_in_epoch</span>
<span class=linenos data-linenos="100 "></span>        <span class=n>num_samples_max</span> <span class=o>=</span> <span class=n>batch_size</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>num_batches_in_this_epoch</span><span class=p>()</span> <span class=k>if</span> \
<span class=linenos data-linenos="101 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>cur_batch</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_in_this_epoch</span><span class=p>()</span> <span class=k>else</span> <span class=n>num_samples</span>
<span class=linenos data-linenos="102 "></span>    <span class=k>return</span> <span class=n>num_samples</span><span class=p>,</span> <span class=n>num_samples_max</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.should_log_this_batch class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">should_log_this_batch</span> </h3> <div class=highlight><pre><span></span><code><span class=n>should_log_this_batch</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Whether the current batch should be logged or not.</p> <p>A batch shall be logged if at least one of the following conditions is True:</p> <div class=highlight><pre><span></span><code>- the cumulative batch index is a multiple of the logging interval
- the dry_run condition was specified by the researcher
- it is the last batch of the epoch
- it is the first batch of the epoch
</code></pre></div> <details class=quote> <summary>Source code in <code>fedbiomed/common/training_plans/_training_iterations.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="133 "></span><span class=k>def</span> <span class=nf>should_log_this_batch</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="134 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Whether the current batch should be logged or not.</span>
<span class=linenos data-linenos="135 "></span>
<span class=linenos data-linenos="136 "></span><span class=sd>    A batch shall be logged if at least one of the following conditions is True:</span>
<span class=linenos data-linenos="137 "></span>
<span class=linenos data-linenos="138 "></span><span class=sd>        - the cumulative batch index is a multiple of the logging interval</span>
<span class=linenos data-linenos="139 "></span><span class=sd>        - the dry_run condition was specified by the researcher</span>
<span class=linenos data-linenos="140 "></span><span class=sd>        - it is the last batch of the epoch</span>
<span class=linenos data-linenos="141 "></span><span class=sd>        - it is the first batch of the epoch</span>
<span class=linenos data-linenos="142 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="143 "></span>    <span class=n>current_iter</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>cur_epoch</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_per_epoch</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>cur_batch</span>
<span class=linenos data-linenos="144 "></span>    <span class=k>return</span> <span class=p>(</span><span class=n>current_iter</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span><span class=o>.</span><span class=n>training_args</span><span class=p>()[</span><span class=s1>&#39;log_interval&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>or</span>
<span class=linenos data-linenos="145 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span><span class=o>.</span><span class=n>training_args</span><span class=p>()[</span><span class=s1>&#39;dry_run&#39;</span><span class=p>]</span> <span class=ow>or</span>
<span class=linenos data-linenos="146 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>cur_batch</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_batches_in_this_epoch</span><span class=p>()</span> <span class=ow>or</span>  <span class=c1># last batch</span>
<span class=linenos data-linenos="147 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>cur_batch</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># first batch</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> </article> </main> </div> <div class=right-col> <div id=right-sidebar class=sidebar-right> <nav class=toc> <!-- Render item list --> <label class=toc-title for=__toc> <span class=toc-icon></span> </label> <ul class=toc-list data-md-component=toc data-md-scrollfix> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans-classes class=md-nav__link> Classes </a> <nav class=toc-nav aria-label=Classes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.BaseTrainingPlan class=md-nav__link> BaseTrainingPlan </a> <nav class=toc-nav aria-label=BaseTrainingPlan> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.BaseTrainingPlan-attributes class=md-nav__link> Attributes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.BaseTrainingPlan-functions class=md-nav__link> Functions </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.FedPerceptron class=md-nav__link> FedPerceptron </a> <nav class=toc-nav aria-label=FedPerceptron> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.FedPerceptron-functions class=md-nav__link> Functions </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.FedSGDClassifier class=md-nav__link> FedSGDClassifier </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.FedSGDRegressor class=md-nav__link> FedSGDRegressor </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.SKLearnTrainingPlan class=md-nav__link> SKLearnTrainingPlan </a> <nav class=toc-nav aria-label=SKLearnTrainingPlan> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.SKLearnTrainingPlan-attributes class=md-nav__link> Attributes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.SKLearnTrainingPlan-functions class=md-nav__link> Functions </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.TorchTrainingPlan class=md-nav__link> TorchTrainingPlan </a> <nav class=toc-nav aria-label=TorchTrainingPlan> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.TorchTrainingPlan-attributes class=md-nav__link> Attributes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans.TorchTrainingPlan-functions class=md-nav__link> Functions </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.cur_batch class=md-nav__link> cur_batch </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.cur_epoch class=md-nav__link> cur_epoch </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.epochs class=md-nav__link> epochs </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_batches_in_last_epoch class=md-nav__link> num_batches_in_last_epoch </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_batches_per_epoch class=md-nav__link> num_batches_per_epoch </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_samples_observed_in_epoch class=md-nav__link> num_samples_observed_in_epoch </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_samples_observed_in_total class=md-nav__link> num_samples_observed_in_total </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant-classes class=md-nav__link> Classes </a> <nav class=toc-nav aria-label=Classes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.BatchIter class=md-nav__link> BatchIter </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.EpochsIter class=md-nav__link> EpochsIter </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.increment_sample_counters class=md-nav__link> increment_sample_counters() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.iterate_batches class=md-nav__link> iterate_batches() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.iterate_epochs class=md-nav__link> iterate_epochs() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.num_batches_in_this_epoch class=md-nav__link> num_batches_in_this_epoch() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.reporting_on_epoch class=md-nav__link> reporting_on_epoch() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.reporting_on_num_iter class=md-nav__link> reporting_on_num_iter() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.reporting_on_num_samples class=md-nav__link> reporting_on_num_samples() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.training_plans._training_iterations.MiniBatchTrainingIterationsAccountant.should_log_this_batch class=md-nav__link> should_log_this_batch() </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> </div> <!-- News Main Page--> </div> <footer> <div class=container-fluid> <div class=footer-first-inner> <div class=container> <div class=row> <div class=col-md-6> <div class=footer-contact> <strong>Address:</strong> <p>2004 Rte des Lucioles, 06902 Sophia Antipolis</p> <strong>E-mail:</strong> <p>fedbiomed _at_ inria _dot_ fr</p> </div> </div> <div class=col-md-6> <div class=footer-contact> <p>Fed-BioMed © 2022</p> </div> </div> </div> </div> </div> </div> </footer> <!-- JQuery --> <script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script> <!-- Latest compiled and minified JavaScript --> <script src=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../../assets/javascript/lunr.js></script> <script src=../../../../assets/javascript/theme.js></script> </body> </html>