<!DOCTYPE html><html> <head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1"><!--  --><script>
      const versions_json = "../../../../../versions.json";
      const search_worker_js = "../../../../assets/javascript/search-worker.js";
      const search_index_json = "../../../../search/search_index.json";
      const base_url = '../../../..';
    </script><!-- Site title --><title>Model - Fed-BioMed</title><link rel=icon type=image/x-icon href=../../../../favicon.ico><!-- Page description --><meta name=description content="Open, Transparent and Trusted Federated Learning for Real-world Healthcare Applications"><!-- Page keywords --><!-- Page author --><!-- Latest compiled and minified CSS --><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><!-- Bootstrap Icons --><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link href=../../../../assets/_mkdocstrings.css rel=stylesheet><link href=../../../../assets/css/style.css rel=stylesheet></head> <body> <div class="container-fluid top-bar"> <div class=brand> <a href=/ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <nav class=top> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class="container-fluid top-bar-mobile"> <div class=mobile-bar> <div class=brand> <a href=../../../../ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <div class=hum-menu> <img class=open src=../../../../assets/img/menu.svg> <img class=close style=display:none src=../../../../assets/img/cancel.svg> </div> </div> <nav class=top-mobile> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class=main> <!-- Home page --> <div class=container-fluid> <div class=doc-row> <div class=left-col> <div class=sidebar-doc> <div class=sidebar-inner> <ul class="sidebar-menu-left sub"> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Getting Started <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ class>What's Fed-BioMed</a> </li> <li class> <a href=../../../../getting-started/getting-started/ class>Basic Example</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-architecture/ class>Fedbiomed Architecture</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-workflow/ class>Fedbiomed Workflow</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Tutorials <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Installation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/installation/0-basic-software-installation/ class>Software Installation</a> </li> <li class> <a href=../../../../tutorials/installation/1-setting-up-environment/ class>Setting Up Environment</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> PyTorch <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/pytorch/01_PyTorch_MNIST_Single_Node_Tutorial/ class>PyTorch MNIST Basic Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/02_Create_Your_Custom_Training_Plan/ class>How to Create Your Custom PyTorch Training Plan</a> </li> <li class> <a href=../../../../tutorials/pytorch/03_PyTorch_MNIST_local_vs_Federated/ class>MNIST classification with PyTorch, comparing federated model vs model trained locally</a> </li> <li class> <a href=../../../../tutorials/pytorch/04_PyTorch_Used_Cars_Dataset_Example/ class>PyTorch Used Cars Dataset Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/05-Aggregation_in_Fed-BioMed/ class>PyTorch aggregation methods in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> MONAI <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/monai/01_monai-2d-image-classification/ class>Federated 2d image classification with MONAI</a> </li> <li class> <a href=../../../../tutorials/monai/02_monai-2d-image-registration/ class>Federated 2d XRay registration with MONAI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Scikit-Learn <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/scikit-learn/01_sklearn_MNIST_classification_tutorial/ class>MNIST classification with Scikit-Learn Classifier (Perceptron)</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/02_sklearn_sgd_regressor_tutorial/ class>Fed-BioMed to train a federated SGD regressor model</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/03-other-scikit-learn-models/ class>Implementing other Scikit Learn models for Federated Learning</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> FLamby <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/flamby/flamby/ class>General Concepts</a> </li> <li class> <a href=../../../../tutorials/flamby/flamby-integration-into-fedbiomed/ class>FLamby integration in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Advanced <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/advanced/in-depth-experiment-configuration/ class>In Depth Experiment Configuration</a> </li> <li class> <a href=../../../../tutorials/advanced/training-with-gpu/ class>PyTorch model training using a GPU</a> </li> <li class> <a href=../../../../tutorials/advanced/breakpoints/ class>Breakpoints</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Security <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/security/differential-privacy-with-opacus-on-fedbiomed/ class>Using Differential Privacy with OPACUS on Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/security/non-private-local-central-dp-monai-2d-image-registration/ class>Local and Central DP with Fed-BioMed: MONAI 2d image registration</a> </li> <li class> <a href=../../../../tutorials/security/training-with-approved-training-plans/ class>Training Process with Training Plan Management</a> </li> <li class> <a href=../../../../tutorials/security/secure-aggregation/ class>Training with Secure Aggregation</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Biomedical data <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/medical/medical-image-segmentation-unet-library/ class>Brain Segmentation</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> User Guide <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/glossary/ class>Glossary</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Deployment <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/deployment/deployment/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/deployment/deployment-vpn/ class>VPN Deployment</a> </li> <li class> <a href=../../../../user-guide/deployment/matrix/ class>Network matrix</a> </li> <li class> <a href=../../../../user-guide/deployment/security-model/ class>Security model</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/nodes/configuring-nodes/ class>Configuring Nodes</a> </li> <li class> <a href=../../../../user-guide/nodes/deploying-datasets/ class>Deploying Datasets</a> </li> <li class> <a href=../../../../user-guide/nodes/training-plan-security-manager/ class>Training Plan Management</a> </li> <li class> <a href=../../../../user-guide/nodes/using-gpu/ class>Using GPU</a> </li> <li class> <a href=../../../../user-guide/nodes/node-gui/ class>Node GUI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/researcher/training-plan/ class>Training Plan</a> </li> <li class> <a href=../../../../user-guide/researcher/training-data/ class>Training Data</a> </li> <li class> <a href=../../../../user-guide/researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../../../user-guide/researcher/aggregation/ class>Aggregation</a> </li> <li class> <a href=../../../../user-guide/researcher/listing-datasets-and-selecting-nodes/ class>Listing Datasets and Selecting Nodes</a> </li> <li class> <a href=../../../../user-guide/researcher/model-testing-during-federated-training/ class>Model Validation on the Node Side</a> </li> <li class> <a href=../../../../user-guide/researcher/tensorboard/ class>Tensorboard</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Secure Aggregation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/secagg/introduction/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/secagg/configuration/ class>Configuration</a> </li> <li class> <a href=../../../../user-guide/secagg/certificate-registration/ class>Certificate Registration</a> </li> <li class> <a href=../../../../user-guide/secagg/researcher-interface/ class>Managing Secure Aggregation in Researcher</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Developer <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> API Reference <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Common <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li class> <a href=../constants/ class>Constants</a> </li> <li class> <a href=../data/ class>Data</a> </li> <li class> <a href=../environ/ class>Environ</a> </li> <li class> <a href=../exceptions/ class>Exceptions</a> </li> <li class> <a href=../json/ class>Json</a> </li> <li class> <a href=../logger/ class>Logger</a> </li> <li class> <a href=../message/ class>Message</a> </li> <li class> <a href=../messaging/ class>Messaging</a> </li> <li class=current> <a href=./ class="link current">Model</a> </li> <li class> <a href=../optimizer/ class>Optimizer</a> </li> <li class> <a href=../repository/ class>Repository</a> </li> <li class> <a href=../tasks_queue/ class>TasksQueue</a> </li> <li class> <a href=../training_plans/ class>TrainingPlans</a> </li> <li class> <a href=../training_args/ class>TrainingArgs</a> </li> <li class> <a href=../utils/ class>Utils</a> </li> <li class> <a href=../validator/ class>Validator</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../node/cli/ class>CLI</a> </li> <li class> <a href=../../node/dataset_manager/ class>DatasetManager</a> </li> <li class> <a href=../../node/node/ class>Node</a> </li> <li class> <a href=../../node/training_plan_security_manager/ class>TrainingPlanSecurityManager</a> </li> <li class> <a href=../../node/history_monitor/ class>HistoryMonitor</a> </li> <li class> <a href=../../node/round/ class>Round</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../researcher/aggregators/ class>Aggregators</a> </li> <li class> <a href=../../researcher/datasets/ class>Datasets</a> </li> <li class> <a href=../../researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../researcher/filetools/ class>Filetools</a> </li> <li class> <a href=../../researcher/job/ class>Job</a> </li> <li class> <a href=../../researcher/monitor/ class>Monitor</a> </li> <li class> <a href=../../researcher/responses/ class>Responses</a> </li> <li class> <a href=../../researcher/requests/ class>Requests</a> </li> <li class> <a href=../../researcher/strategies/ class>Strategies</a> </li> <li class> <a href=../../researcher/secagg/ class>Secagg</a> </li> </ul> </li> </ul> </li> <li class> <a href=../../../usage_and_tools/ class>Usage and Tools</a> </li> <li class> <a href=../../../ci/ class>Continuous Integration</a> </li> <li class> <a href=../../../definition-of-done/ class>Definition of Done</a> </li> </ul> </li> </ul> </div> </div> </div> <div class=main-col> <div class=main-docs> <div class="doc doc-object doc-module"> <h1 id=fedbiomed.common.models class="doc doc-heading module"> fedbiomed.common.models </h1> <span>Module: <code>fedbiomed.common.models</code></span> <div class="doc doc-contents first"> <p>The <code>fedbiomed.common.models</code> module includes model abstraction classes that can be used with plain framework specific models.</p> <p>Please visit <a href=https://gitlab.inria.fr/magnet/declearn/declearn2/-/tree/r2.1>Declearn</a> repository for the "TorchVector" and "NumpyVector" classes used in this module.</p> <div class="doc doc-children"> <h2 id=fedbiomed.common.models-classes class=api-section-header>Classes</h2> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.models.BaseSkLearnModel class="doc doc-heading"> BaseSkLearnModel<!--        --> <!--          <code>BaseSkLearnModel</code>--> <!--        --> </h3> <div class=main-class-init> <span>CLASS </span> <div class=highlight><pre><span></span><code><span class=n>BaseSkLearnModel</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><!--fedbiomed.common.models.Model--><a class="autorefs autorefs-internal" title="fedbiomed.common.models.Model" href="#fedbiomed.common.models.Model">Model</a></code></p> <p>Wrapper of Scikit learn models.</p> <p>This class implements all abstract methods from the <code>Model</code> API, but adds some scikit-learn-specific ones that need implementing by its children.</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code><!--sklearn.base.BaseEstimator--><a class="autorefs autorefs-external" title="sklearn.base.BaseEstimator" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator">BaseEstimator</a></code> </td> <td><p>Wrapped model</p></td> </tr> <tr> <td><code>param_list</code></td> <td> <code><!--typing.List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]</code> </td> <td><p>List that contains layer attributes. Should be set when calling <code>set_init_params</code> method</p></td> </tr> </tbody> </table> <p><strong>Class attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>is_classification</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>Boolean flag indicating whether the wrapped model is designed for classification or for regression supervised-learning tasks.</p></td> </tr> </tbody> </table> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code><!--sklearn.base.BaseEstimator--><a class="autorefs autorefs-external" title="sklearn.base.BaseEstimator" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator">BaseEstimator</a></code> </td> <td><p>Model object as an instance of <a class="autorefs autorefs-external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator">BaseEstimator</a></p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedModelError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedModelError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedModelError">FedbiomedModelError</a></code> </td> <td><p>if model is not as scikit learn <a class="autorefs autorefs-external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator">BaseEstimator</a> object</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="72 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos="73 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="74 "></span>    <span class=n>model</span><span class=p>:</span> <span class=n>BaseEstimator</span><span class=p>,</span>
<span class=linenos data-linenos="75 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="76 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Instantiate the wrapper over a scikit-learn BaseEstimator.</span>
<span class=linenos data-linenos="77 "></span>
<span class=linenos data-linenos="78 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="79 "></span><span class=sd>        model: Model object as an instance of [BaseEstimator][sklearn.base.BaseEstimator]</span>
<span class=linenos data-linenos="80 "></span>
<span class=linenos data-linenos="81 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="82 "></span><span class=sd>        FedbiomedModelError: if model is not as scikit learn [BaseEstimator][sklearn.base.BaseEstimator] object</span>
<span class=linenos data-linenos="83 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="84 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
<span class=linenos data-linenos="85 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_gradients</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="86 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>param_list</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
<span class=linenos data-linenos="87 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_optim_params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.models.BaseSkLearnModel-attributes class=api-section-header>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.is_classification class="doc doc-heading attribute"> is_classification <span class="doc doc-properties"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>is_classification</span><span class=p>:</span> <span class=nb>bool</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.model class="doc doc-heading attribute"> model <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>model</span><span class=p>:</span> <span class=n>BaseEstimator</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.param_list class="doc doc-heading attribute"> param_list <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>param_list</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.common.models.BaseSkLearnModel-functions class=api-section-header>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.apply_updates class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>apply_updates</span><span class=p>(</span><span class=n>updates</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Apply incoming updates to the wrapped model's parameters.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>updates</code></td> <td> <code><!--typing.Dict[str, numpy.ndarray]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, numpy.ndarray--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a><!---->]</code> </td> <td><p>Model parameters' updates to add (apply) to existing parameters' values.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="197 "></span><span class=k>def</span> <span class=nf>apply_updates</span><span class=p>(</span>
<span class=linenos data-linenos="198 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="199 "></span>    <span class=n>updates</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>],</span>
<span class=linenos data-linenos="200 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="201 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Apply incoming updates to the wrapped model&#39;s parameters.</span>
<span class=linenos data-linenos="202 "></span>
<span class=linenos data-linenos="203 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="204 "></span><span class=sd>        updates: Model parameters&#39; updates to add (apply) to existing</span>
<span class=linenos data-linenos="205 "></span><span class=sd>            parameters&#39; values.</span>
<span class=linenos data-linenos="206 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="207 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_assert_dict_inputs</span><span class=p>(</span><span class=n>updates</span><span class=p>)</span>
<span class=linenos data-linenos="208 "></span>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>updates</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="209 "></span>        <span class=n>weights</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
<span class=linenos data-linenos="210 "></span>        <span class=nb>setattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>weights</span> <span class=o>+</span> <span class=n>val</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.disable_internal_optimizer class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>disable_internal_optimizer</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Disable the scikit-learn internal optimizer.</p> <p>Calling this method alters the wrapped model so that raw gradients are computed and attached to it (rather than relying on scikit-learn to apply a learning rate that may be scheduled to vary along time).</p> <p>''' warning "Call it only if using an external optimizer"</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="346 "></span><span class=k>def</span> <span class=nf>disable_internal_optimizer</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="347 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Disable the scikit-learn internal optimizer.</span>
<span class=linenos data-linenos="348 "></span>
<span class=linenos data-linenos="349 "></span><span class=sd>    Calling this method alters the wrapped model so that raw gradients are</span>
<span class=linenos data-linenos="350 "></span><span class=sd>    computed and attached to it (rather than relying on scikit-learn to</span>
<span class=linenos data-linenos="351 "></span><span class=sd>    apply a learning rate that may be scheduled to vary along time).</span>
<span class=linenos data-linenos="352 "></span>
<span class=linenos data-linenos="353 "></span><span class=sd>    &#39;&#39;&#39; warning &quot;Call it only if using an external optimizer&quot;</span>
<span class=linenos data-linenos="354 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="355 "></span>    <span class=c1># Record initial params, then override optimizer ones.</span>
<span class=linenos data-linenos="356 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_optim_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_params</span><span class=p>()</span>
<span class=linenos data-linenos="357 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_params</span><span class=p>(</span><span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>_null_optim_params</span><span class=p>)</span>
<span class=linenos data-linenos="358 "></span>    <span class=c1># Warn about overridden values.</span>
<span class=linenos data-linenos="359 "></span>    <span class=n>changed_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
<span class=linenos data-linenos="360 "></span>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_null_optim_params</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="361 "></span>        <span class=n>param</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_optim_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
<span class=linenos data-linenos="362 "></span>        <span class=k>if</span> <span class=n>param</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>param</span> <span class=o>!=</span> <span class=n>val</span><span class=p>:</span>
<span class=linenos data-linenos="363 "></span>            <span class=n>changed_params</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
<span class=linenos data-linenos="364 "></span>    <span class=k>if</span> <span class=n>changed_params</span><span class=p>:</span>
<span class=linenos data-linenos="365 "></span>        <span class=n>changed</span> <span class=o>=</span> <span class=s2>&quot;,</span><span class=se>\n\t</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>changed_params</span><span class=p>)</span>
<span class=linenos data-linenos="366 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<span class=linenos data-linenos="367 "></span>            <span class=s2>&quot;The following non-default model parameters were overridden &quot;</span>
<span class=linenos data-linenos="368 "></span>            <span class=sa>f</span><span class=s2>&quot;due to the disabling of the scikit-learn internal optimizer:</span><span class=se>\n\t</span><span class=si>{</span><span class=n>changed</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="369 "></span>        <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.enable_internal_optimizer class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>enable_internal_optimizer</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Enable the scikit-learn internal optimizer.</p> <p>Calling this method restores any model parameter previously overridden due to calling the counterpart <code>disable_internal_optimizer</code> method.</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="371 "></span><span class=k>def</span> <span class=nf>enable_internal_optimizer</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="372 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Enable the scikit-learn internal optimizer.</span>
<span class=linenos data-linenos="373 "></span>
<span class=linenos data-linenos="374 "></span><span class=sd>    Calling this method restores any model parameter previously overridden</span>
<span class=linenos data-linenos="375 "></span><span class=sd>    due to calling the counterpart `disable_internal_optimizer` method.</span>
<span class=linenos data-linenos="376 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="377 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_optim_params</span><span class=p>:</span>
<span class=linenos data-linenos="378 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>set_params</span><span class=p>(</span><span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>_optim_params</span><span class=p>)</span>
<span class=linenos data-linenos="379 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Internal Optimizer restored&quot;</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.export class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>export</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Export the wrapped model to a dump file.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>filename</code></td> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>path to the file where the model will be saved.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p>!!! info "Notes": This method is designed to save the model to a local dump file for easy re-use by the same user, possibly outside of Fed-BioMed. It is not designed to produce trustworthy data dumps and is not used to exchange models and their weights as part of the federated learning process.</p> <p>!!! warning "Warning": This method uses <code>joblib.dump</code>, which relies on pickle and is therefore hard to trust by third-party loading methods.</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="381 "></span><span class=k>def</span> <span class=nf>export</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filename</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="382 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Export the wrapped model to a dump file.</span>
<span class=linenos data-linenos="383 "></span>
<span class=linenos data-linenos="384 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="385 "></span><span class=sd>        filename: path to the file where the model will be saved.</span>
<span class=linenos data-linenos="386 "></span>
<span class=linenos data-linenos="387 "></span><span class=sd>    !!! info &quot;Notes&quot;:</span>
<span class=linenos data-linenos="388 "></span><span class=sd>        This method is designed to save the model to a local dump</span>
<span class=linenos data-linenos="389 "></span><span class=sd>        file for easy re-use by the same user, possibly outside of</span>
<span class=linenos data-linenos="390 "></span><span class=sd>        Fed-BioMed. It is not designed to produce trustworthy data</span>
<span class=linenos data-linenos="391 "></span><span class=sd>        dumps and is not used to exchange models and their weights</span>
<span class=linenos data-linenos="392 "></span><span class=sd>        as part of the federated learning process.</span>
<span class=linenos data-linenos="393 "></span>
<span class=linenos data-linenos="394 "></span><span class=sd>    !!! warning &quot;Warning&quot;:</span>
<span class=linenos data-linenos="395 "></span><span class=sd>        This method uses `joblib.dump`, which relies on pickle and</span>
<span class=linenos data-linenos="396 "></span><span class=sd>        is therefore hard to trust by third-party loading methods.</span>
<span class=linenos data-linenos="397 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="398 "></span>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
<span class=linenos data-linenos="399 "></span>        <span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.flatten class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>flatten</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Gets weights as flatten vector</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>to_list</code></td> <td> <code><!--typing.List[float]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a><!---->]</code> </td> <td><p>Convert np.ndarray to a list if it is True.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="140 "></span><span class=k>def</span> <span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
<span class=linenos data-linenos="141 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Gets weights as flatten vector</span>
<span class=linenos data-linenos="142 "></span>
<span class=linenos data-linenos="143 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="144 "></span><span class=sd>        to_list: Convert np.ndarray to a list if it is True.</span>
<span class=linenos data-linenos="145 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="146 "></span>
<span class=linenos data-linenos="147 "></span>    <span class=n>weights</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_weights</span><span class=p>()</span>
<span class=linenos data-linenos="148 "></span>    <span class=n>flatten</span> <span class=o>=</span> <span class=p>[]</span>
<span class=linenos data-linenos="149 "></span>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>weights</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="150 "></span>        <span class=n>w_</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>w</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>))</span>
<span class=linenos data-linenos="151 "></span>        <span class=n>flatten</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>w_</span><span class=p>)</span>
<span class=linenos data-linenos="152 "></span>
<span class=linenos data-linenos="153 "></span>    <span class=k>return</span> <span class=n>flatten</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.get_gradients class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_gradients</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Return computed gradients attached to the model.</p> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedModelError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedModelError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedModelError">FedbiomedModelError</a></code> </td> <td><p>If no gradients have been computed yet (i.e. the model has not been trained).</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, numpy.ndarray]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, numpy.ndarray--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a><!---->]</code> </td> <td><p>Gradients, as a dict mapping parameters' names to their gradient's numpy array.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="287 "></span><span class=k>def</span> <span class=nf>get_gradients</span><span class=p>(</span>
<span class=linenos data-linenos="288 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="289 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]:</span>
<span class=linenos data-linenos="290 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return computed gradients attached to the model.</span>
<span class=linenos data-linenos="291 "></span>
<span class=linenos data-linenos="292 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="293 "></span><span class=sd>        FedbiomedModelError: If no gradients have been computed yet</span>
<span class=linenos data-linenos="294 "></span><span class=sd>            (i.e. the model has not been trained).</span>
<span class=linenos data-linenos="295 "></span>
<span class=linenos data-linenos="296 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="297 "></span><span class=sd>        Gradients, as a dict mapping parameters&#39; names to their</span>
<span class=linenos data-linenos="298 "></span><span class=sd>            gradient&#39;s numpy array.</span>
<span class=linenos data-linenos="299 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="300 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_gradients</span><span class=p>:</span>
<span class=linenos data-linenos="301 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="302 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>. Cannot get gradients if the &quot;</span>
<span class=linenos data-linenos="303 "></span>            <span class=s2>&quot;model has not been trained beforehand.&quot;</span>
<span class=linenos data-linenos="304 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="305 "></span>    <span class=n>gradients</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_gradients</span>
<span class=linenos data-linenos="306 "></span>    <span class=k>return</span> <span class=n>gradients</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.get_learning_rate class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_learning_rate</span><span class=p>()</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Retrieves learning rate of the model. Method implementation will depend on the attribute used to set up these arbitrary arguments</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.List[float]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a><!---->]</code> </td> <td><p>Initial learning rate value(s); a single value if only on learning rate has been used, and a list of several learning rates, one for each layer of the model.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="428 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="429 "></span><span class=k>def</span> <span class=nf>get_learning_rate</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
<span class=linenos data-linenos="430 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves learning rate of the model. Method implementation will</span>
<span class=linenos data-linenos="431 "></span><span class=sd>    depend on the attribute used to set up these arbitrary arguments</span>
<span class=linenos data-linenos="432 "></span>
<span class=linenos data-linenos="433 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="434 "></span><span class=sd>        Initial learning rate value(s); a single value if only on learning rate has been used, and</span>
<span class=linenos data-linenos="435 "></span><span class=sd>            a list of several learning rates, one for each layer of the model.</span>
<span class=linenos data-linenos="436 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.get_params class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_params</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Return the wrapped scikit-learn model's hyperparameters.</p> <p>Please refer to [<code>baseEstimator documentation</code>] [<a href=https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html>https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html</a>] <code>get_params</code> method for further details.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>value</code></td> <td> <code><!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code> </td> <td><p>if specified, returns a specific hyperparameter, otherwise, returns a dictionary with all the hyperparameters. Defaults to None.</p></td> <td> <code><!---->None</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, typing.Any]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, typing.Any--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a><!---->]</code> </td> <td><p>Dictionary mapping model hyperparameter names to their values</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="312 "></span><span class=k>def</span> <span class=nf>get_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<span class=linenos data-linenos="313 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the wrapped scikit-learn model&#39;s hyperparameters.</span>
<span class=linenos data-linenos="314 "></span>
<span class=linenos data-linenos="315 "></span><span class=sd>    Please refer to [`baseEstimator documentation`]</span>
<span class=linenos data-linenos="316 "></span><span class=sd>    [https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html] `get_params` method</span>
<span class=linenos data-linenos="317 "></span><span class=sd>    for further details.</span>
<span class=linenos data-linenos="318 "></span>
<span class=linenos data-linenos="319 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="320 "></span><span class=sd>        value: if specified, returns a specific hyperparameter, otherwise, returns a dictionary</span>
<span class=linenos data-linenos="321 "></span><span class=sd>            with all the hyperparameters. Defaults to None.</span>
<span class=linenos data-linenos="322 "></span>
<span class=linenos data-linenos="323 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="324 "></span><span class=sd>        Dictionary mapping model hyperparameter names to their values</span>
<span class=linenos data-linenos="325 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="326 "></span>    <span class=k>if</span> <span class=n>value</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="327 "></span>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>get_params</span><span class=p>()</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
<span class=linenos data-linenos="328 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>get_params</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.get_weights class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_weights</span><span class=p>(</span><span class=n>only_trainable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Return a copy of the model's trainable weights.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>only_trainable</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>Unused for scikit-learn models. (Whether to ignore non-trainable model parameters.)</p></td> <td> <code><!---->False</code> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedModelError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedModelError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedModelError">FedbiomedModelError</a></code> </td> <td><p>If the model parameters are not initialized.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, numpy.ndarray]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, numpy.ndarray--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a><!---->]</code> </td> <td><p>Model weights, as a dictionary mapping parameters' names to their numpy array, or as a declearn NumpyVector wrapping such a dict.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="101 "></span><span class=k>def</span> <span class=nf>get_weights</span><span class=p>(</span>
<span class=linenos data-linenos="102 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="103 "></span>    <span class=n>only_trainable</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=linenos data-linenos="104 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]:</span>
<span class=linenos data-linenos="105 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a copy of the model&#39;s trainable weights.</span>
<span class=linenos data-linenos="106 "></span>
<span class=linenos data-linenos="107 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="108 "></span><span class=sd>        only_trainable: Unused for scikit-learn models. (Whether to ignore</span>
<span class=linenos data-linenos="109 "></span><span class=sd>            non-trainable model parameters.)</span>
<span class=linenos data-linenos="110 "></span>
<span class=linenos data-linenos="111 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="112 "></span><span class=sd>        FedbiomedModelError: If the model parameters are not initialized.</span>
<span class=linenos data-linenos="113 "></span>
<span class=linenos data-linenos="114 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="115 "></span><span class=sd>        Model weights, as a dictionary mapping parameters&#39; names to their</span>
<span class=linenos data-linenos="116 "></span><span class=sd>            numpy array, or as a declearn NumpyVector wrapping such a dict.</span>
<span class=linenos data-linenos="117 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="118 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>param_list</span><span class=p>:</span>
<span class=linenos data-linenos="119 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="120 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>. Attribute `param_list` is empty. You should &quot;</span>
<span class=linenos data-linenos="121 "></span>            <span class=sa>f</span><span class=s2>&quot;have initialized the model beforehand (try calling `set_init_params`)&quot;</span>
<span class=linenos data-linenos="122 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="123 "></span>    <span class=c1># Gather copies of the model weights.</span>
<span class=linenos data-linenos="124 "></span>    <span class=n>weights</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># type: Dict[str, np.ndarray]</span>
<span class=linenos data-linenos="125 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="126 "></span>        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>param_list</span><span class=p>:</span>
<span class=linenos data-linenos="127 "></span>            <span class=n>val</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
<span class=linenos data-linenos="128 "></span>            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
<span class=linenos data-linenos="129 "></span>                <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="130 "></span>                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: SklearnModel parameter is not a numpy array.&quot;</span>
<span class=linenos data-linenos="131 "></span>                <span class=p>)</span>
<span class=linenos data-linenos="132 "></span>            <span class=n>weights</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=linenos data-linenos="133 "></span>    <span class=k>except</span> <span class=ne>AttributeError</span> <span class=k>as</span> <span class=n>err</span><span class=p>:</span>
<span class=linenos data-linenos="134 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="135 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>. Unable to access weights of BaseEstimator &quot;</span>
<span class=linenos data-linenos="136 "></span>            <span class=sa>f</span><span class=s2>&quot;model </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=si>}</span><span class=s2> (details </span><span class=si>{</span><span class=n>err</span><span class=si>}</span><span class=s2>)&quot;</span>
<span class=linenos data-linenos="137 "></span>        <span class=p>)</span> <span class=kn>from</span> <span class=nn>err</span>
<span class=linenos data-linenos="138 "></span>    <span class=k>return</span> <span class=n>weights</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.init_training class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>init_training</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Initialises the training by setting up attributes.</p> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedModelError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedModelError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedModelError">FedbiomedModelError</a></code> </td> <td><p>raised if <code>param_list</code> has not been defined</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="89 "></span><span class=k>def</span> <span class=nf>init_training</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos="90 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialises the training by setting up attributes.</span>
<span class=linenos data-linenos="91 "></span>
<span class=linenos data-linenos="92 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="93 "></span><span class=sd>        FedbiomedModelError: raised if `param_list` has not been defined</span>
<span class=linenos data-linenos="94 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="95 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>param_list</span><span class=p>:</span>
<span class=linenos data-linenos="96 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="97 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>. Attribute `param_list` is empty. You should &quot;</span>
<span class=linenos data-linenos="98 "></span>            <span class=sa>f</span><span class=s2>&quot;have initialized the model beforehand (try calling `set_init_params`)&quot;</span>
<span class=linenos data-linenos="99 "></span>        <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.predict class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>predict</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Computes prediction given input data.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>inputs</code></td> <td> <code><!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code> </td> <td><p>input data</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code> </td> <td><p>Model predictions</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="212 "></span><span class=k>def</span> <span class=nf>predict</span><span class=p>(</span>
<span class=linenos data-linenos="213 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="214 "></span>    <span class=n>inputs</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<span class=linenos data-linenos="215 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
<span class=linenos data-linenos="216 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Computes prediction given input data.</span>
<span class=linenos data-linenos="217 "></span>
<span class=linenos data-linenos="218 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="219 "></span><span class=sd>        inputs: input data</span>
<span class=linenos data-linenos="220 "></span>
<span class=linenos data-linenos="221 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="222 "></span><span class=sd>        Model predictions</span>
<span class=linenos data-linenos="223 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="224 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.set_gradients class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_gradients</span><span class=p>(</span><span class=n>gradients</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="308 "></span><span class=k>def</span> <span class=nf>set_gradients</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>gradients</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="309 "></span>    <span class=c1># TODO: either document or remove this (useless) method</span>
<span class=linenos data-linenos="310 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_gradients</span> <span class=o>=</span> <span class=n>gradients</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.set_init_params class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_init_params</span><span class=p>(</span><span class=n>model_args</span><span class=p>)</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Zeroes scikit learn model parameters.</p> <p>Should be used before any training, as it sets the scikit learn model parameters and makes them accessible through the use of attributes. Model parameter attribute names will depend on the scikit learn model wrapped.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model_args</code></td> <td> <code><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a></code> </td> <td><p>dictionary that contains specifications for setting initial model</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="416 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="417 "></span><span class=k>def</span> <span class=nf>set_init_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model_args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="418 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Zeroes scikit learn model parameters.</span>
<span class=linenos data-linenos="419 "></span>
<span class=linenos data-linenos="420 "></span><span class=sd>    Should be used before any training, as it sets the scikit learn model parameters</span>
<span class=linenos data-linenos="421 "></span><span class=sd>    and makes them accessible through the use of attributes. Model parameter attribute names</span>
<span class=linenos data-linenos="422 "></span><span class=sd>    will depend on the scikit learn model wrapped.</span>
<span class=linenos data-linenos="423 "></span>
<span class=linenos data-linenos="424 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="425 "></span><span class=sd>        model_args: dictionary that contains specifications for setting initial model</span>
<span class=linenos data-linenos="426 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.set_params class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_params</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Assign some hyperparameters to the wrapped scikit-learn model.</p> <p>Please refer to <a class="autorefs autorefs-external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator">BaseEstimator</a> [<a href=https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html>https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html</a>] <code>set_params</code> method for further details.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>params</code></td> <td> <code><!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code> </td> <td><p>new hyperparameters to assign to the model.</p></td> <td> <code><!---->{}</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, typing.Any]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, typing.Any--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a><!---->]</code> </td> <td><p>Dict[str, Any]: dictionary containing new hyperparameter values.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="330 "></span><span class=k>def</span> <span class=nf>set_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<span class=linenos data-linenos="331 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Assign some hyperparameters to the wrapped scikit-learn model.</span>
<span class=linenos data-linenos="332 "></span>
<span class=linenos data-linenos="333 "></span><span class=sd>    Please refer to [BaseEstimator][sklearn.base.BaseEstimator]</span>
<span class=linenos data-linenos="334 "></span><span class=sd>    [https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html] `set_params` method</span>
<span class=linenos data-linenos="335 "></span><span class=sd>    for further details.</span>
<span class=linenos data-linenos="336 "></span>
<span class=linenos data-linenos="337 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="338 "></span><span class=sd>        params: new hyperparameters to assign to the model.</span>
<span class=linenos data-linenos="339 "></span>
<span class=linenos data-linenos="340 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="341 "></span><span class=sd>        Dict[str, Any]: dictionary containing new hyperparameter values.</span>
<span class=linenos data-linenos="342 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="343 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>set_params</span><span class=p>(</span><span class=o>**</span><span class=n>params</span><span class=p>)</span>
<span class=linenos data-linenos="344 "></span>    <span class=k>return</span> <span class=n>params</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.set_weights class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_weights</span><span class=p>(</span><span class=n>weights</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Assign new values to the model's trainable weights.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>weights</code></td> <td> <code><!--typing.Dict[str, numpy.ndarray]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, numpy.ndarray--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a><!---->]</code> </td> <td><p>Model weights, as a dict mapping parameters' names to their numpy array.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="183 "></span><span class=k>def</span> <span class=nf>set_weights</span><span class=p>(</span>
<span class=linenos data-linenos="184 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="185 "></span>    <span class=n>weights</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>],</span>
<span class=linenos data-linenos="186 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="187 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Assign new values to the model&#39;s trainable weights.</span>
<span class=linenos data-linenos="188 "></span>
<span class=linenos data-linenos="189 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="190 "></span><span class=sd>        weights: Model weights, as a dict mapping parameters&#39; names</span>
<span class=linenos data-linenos="191 "></span><span class=sd>            to their numpy array.</span>
<span class=linenos data-linenos="192 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="193 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_assert_dict_inputs</span><span class=p>(</span><span class=n>weights</span><span class=p>)</span>
<span class=linenos data-linenos="194 "></span>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>weights</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="195 "></span>        <span class=nb>setattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span><span class=o>.</span><span class=n>copy</span><span class=p>())</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.train class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>train</span><span class=p>(</span><span class=n>inputs</span><span class=p>,</span> <span class=n>targets</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>kwargs</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Run a training step, and record associated gradients.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>inputs</code></td> <td> <code><!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code> </td> <td><p>inputs data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>targets</code></td> <td> <code><!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code> </td> <td><p>targets, to be fit with inputs data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>stdout</code></td> <td> <code><!--typing.Optional[typing.List[typing.List[str]]]--><!--typing.Optional--><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a><!---->[<!--typing.List[typing.List[str]]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--typing.List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->]<!---->]</code> </td> <td><p>list of console outputs that have been collected during training, that contains losses values. Used to plot model losses. Defaults to None.</p></td> <td> <code><!---->None</code> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedModelError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedModelError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedModelError">FedbiomedModelError</a></code> </td> <td><p>if training has not been initialized.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="226 "></span><span class=k>def</span> <span class=nf>train</span><span class=p>(</span>
<span class=linenos data-linenos="227 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="228 "></span>    <span class=n>inputs</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<span class=linenos data-linenos="229 "></span>    <span class=n>targets</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
<span class=linenos data-linenos="230 "></span>    <span class=n>stdout</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="231 "></span>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
<span class=linenos data-linenos="232 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="233 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run a training step, and record associated gradients.</span>
<span class=linenos data-linenos="234 "></span>
<span class=linenos data-linenos="235 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="236 "></span><span class=sd>        inputs: inputs data.</span>
<span class=linenos data-linenos="237 "></span><span class=sd>        targets: targets, to be fit with inputs data.</span>
<span class=linenos data-linenos="238 "></span><span class=sd>        stdout: list of console outputs that have been collected</span>
<span class=linenos data-linenos="239 "></span><span class=sd>            during training, that contains losses values.</span>
<span class=linenos data-linenos="240 "></span><span class=sd>            Used to plot model losses. Defaults to None.</span>
<span class=linenos data-linenos="241 "></span>
<span class=linenos data-linenos="242 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="243 "></span><span class=sd>        FedbiomedModelError: if training has not been initialized.</span>
<span class=linenos data-linenos="244 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="245 "></span>    <span class=n>batch_size</span> <span class=o>=</span> <span class=n>inputs</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<span class=linenos data-linenos="246 "></span>    <span class=n>w_init</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_weights</span><span class=p>()</span>
<span class=linenos data-linenos="247 "></span>    <span class=n>w_updt</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>val</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>w_init</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
<span class=linenos data-linenos="248 "></span>    <span class=c1># Iterate over the batch; accumulate sample-wise gradients (and loss).</span>
<span class=linenos data-linenos="249 "></span>    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>batch_size</span><span class=p>):</span>
<span class=linenos data-linenos="250 "></span>        <span class=c1># Compute updated weights based on the sample. Capture loss prints.</span>
<span class=linenos data-linenos="251 "></span>        <span class=k>with</span> <span class=n>capture_stdout</span><span class=p>()</span> <span class=k>as</span> <span class=n>console</span><span class=p>:</span>
<span class=linenos data-linenos="252 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>partial_fit</span><span class=p>(</span><span class=n>inputs</span><span class=p>[</span><span class=n>idx</span> <span class=p>:</span> <span class=n>idx</span> <span class=o>+</span> <span class=mi>1</span><span class=p>],</span> <span class=n>targets</span><span class=p>[</span><span class=n>idx</span><span class=p>])</span>
<span class=linenos data-linenos="253 "></span>        <span class=k>if</span> <span class=n>stdout</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="254 "></span>            <span class=n>stdout</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>console</span><span class=p>)</span>
<span class=linenos data-linenos="255 "></span>        <span class=c1># Accumulate updated weights (weights + sum of gradients).</span>
<span class=linenos data-linenos="256 "></span>        <span class=c1># Reset the model&#39;s weights and iteration counter.</span>
<span class=linenos data-linenos="257 "></span>        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>param_list</span><span class=p>:</span>
<span class=linenos data-linenos="258 "></span>            <span class=n>w_updt</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>+=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
<span class=linenos data-linenos="259 "></span>            <span class=nb>setattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>w_init</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>())</span>
<span class=linenos data-linenos="260 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>n_iter_</span> <span class=o>-=</span> <span class=mi>1</span>
<span class=linenos data-linenos="261 "></span>    <span class=c1># Compute the batch-averaged, learning-rate-scaled gradients.</span>
<span class=linenos data-linenos="262 "></span>    <span class=c1># Note: w_init: {w_t}, w_updt: {w_t - eta_t * sum_{s=1}^B(grad_s)}</span>
<span class=linenos data-linenos="263 "></span>    <span class=c1>#       hence eta_t * avg(grad_s) = w_init - (w_updt / B)</span>
<span class=linenos data-linenos="264 "></span>
<span class=linenos data-linenos="265 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_gradients</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="266 "></span>        <span class=n>key</span><span class=p>:</span> <span class=n>w_init</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=n>w_updt</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>/</span> <span class=n>batch_size</span><span class=p>)</span>
<span class=linenos data-linenos="267 "></span>        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>param_list</span>
<span class=linenos data-linenos="268 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="269 "></span>
<span class=linenos data-linenos="270 "></span>    <span class=c1># ------------------------------ WARNINGS ----------------------------------</span>
<span class=linenos data-linenos="271 "></span>    <span class=c1>#</span>
<span class=linenos data-linenos="272 "></span>    <span class=c1># Warning 1: if `disable_internal_optimizer` has not been called before, gradients won&#39;t be scaled</span>
<span class=linenos data-linenos="273 "></span>    <span class=c1># (you will get un-scaled gradients, that need to be scaled back by dividing gradients by the learning rate)</span>
<span class=linenos data-linenos="274 "></span>    <span class=c1># here is a way to do so (with `lrate` as the learning rate): </span>
<span class=linenos data-linenos="275 "></span>    <span class=c1># ```python</span>
<span class=linenos data-linenos="276 "></span>    <span class=c1># for key, val in self._gradients.items():</span>
<span class=linenos data-linenos="277 "></span>    <span class=c1>#        val /= lrate</span>
<span class=linenos data-linenos="278 "></span>    <span class=c1># ````</span>
<span class=linenos data-linenos="279 "></span>    <span class=c1># Warning 2:  `_gradients` has different meanings, when using `disable_internal_optimizer`</span>
<span class=linenos data-linenos="280 "></span>    <span class=c1># if it is not called (ie when using native sklearn optimizer), it is not plain gradients, </span>
<span class=linenos data-linenos="281 "></span>    <span class=c1># but rather the quantity `lr * grads`</span>
<span class=linenos data-linenos="282 "></span>
<span class=linenos data-linenos="283 "></span>    <span class=c1># Finally, increment the model&#39;s iteration counter.</span>
<span class=linenos data-linenos="284 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>n_iter_</span> <span class=o>+=</span> <span class=mi>1</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.BaseSkLearnModel.unflatten class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>unflatten</span><span class=p>(</span><span class=n>weights_vector</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Unflatten vectorized model weights</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>weights_vector</code></td> <td> <code><!--typing.List[float]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a><!---->]</code> </td> <td><p>Vectorized model weights to convert dict</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, numpy.ndarray]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, numpy.ndarray--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a><!---->]</code> </td> <td><p>Model dictionary</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="155 "></span><span class=k>def</span> <span class=nf>unflatten</span><span class=p>(</span>
<span class=linenos data-linenos="156 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="157 "></span>        <span class=n>weights_vector</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span>
<span class=linenos data-linenos="158 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]:</span>
<span class=linenos data-linenos="159 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Unflatten vectorized model weights</span>
<span class=linenos data-linenos="160 "></span>
<span class=linenos data-linenos="161 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="162 "></span><span class=sd>        weights_vector: Vectorized model weights to convert dict</span>
<span class=linenos data-linenos="163 "></span>
<span class=linenos data-linenos="164 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="165 "></span><span class=sd>        Model dictionary</span>
<span class=linenos data-linenos="166 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="167 "></span>
<span class=linenos data-linenos="168 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>unflatten</span><span class=p>(</span><span class=n>weights_vector</span><span class=p>)</span>
<span class=linenos data-linenos="169 "></span>
<span class=linenos data-linenos="170 "></span>    <span class=n>weights_vector</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>weights_vector</span><span class=p>)</span>
<span class=linenos data-linenos="171 "></span>    <span class=n>weights</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_weights</span><span class=p>()</span>
<span class=linenos data-linenos="172 "></span>    <span class=n>pointer</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos="173 "></span>
<span class=linenos data-linenos="174 "></span>    <span class=n>params</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="175 "></span>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>weights</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="176 "></span>        <span class=n>num_param</span> <span class=o>=</span> <span class=n>w</span><span class=o>.</span><span class=n>size</span>
<span class=linenos data-linenos="177 "></span>        <span class=n>params</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>weights_vector</span><span class=p>[</span><span class=n>pointer</span><span class=p>:</span> <span class=n>pointer</span> <span class=o>+</span> <span class=n>num_param</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>w</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<span class=linenos data-linenos="178 "></span>
<span class=linenos data-linenos="179 "></span>        <span class=n>pointer</span> <span class=o>+=</span> <span class=n>num_param</span>
<span class=linenos data-linenos="180 "></span>
<span class=linenos data-linenos="181 "></span>    <span class=k>return</span> <span class=n>params</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.models.MLPSklearnModel class="doc doc-heading"> MLPSklearnModel<!--        --> <!--          <code>MLPSklearnModel</code>--> <!--        --> </h3> <div class=main-class-init> <span>CLASS </span> <div class=highlight><pre><span></span><code><span class=n>MLPSklearnModel</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><!--fedbiomed.common.models._sklearn.BaseSkLearnModel--><a class="autorefs autorefs-internal" title="fedbiomed.common.models._sklearn.BaseSkLearnModel" href="#fedbiomed.common.models.BaseSkLearnModel">BaseSkLearnModel</a></code></p> <p>BaseSklearnModel abstract subclass for multi-layer perceptron models.</p> <details class=quote> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="512 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=n>BaseEstimator</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="513 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_null_optim_params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="514 "></span>        <span class=s2>&quot;learning_rate_init&quot;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span>
<span class=linenos data-linenos="515 "></span>        <span class=s2>&quot;learning_rate&quot;</span><span class=p>:</span> <span class=s2>&quot;constant&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="516 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="517 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.models.MLPSklearnModel-attributes class=api-section-header>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._sklearn.MLPSklearnModel.model class="doc doc-heading attribute"> model <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>model</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>MLPClassifier</span><span class=p>,</span> <span class=n>MLPRegressor</span><span class=p>]</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.common.models.MLPSklearnModel-functions class=api-section-header>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.MLPSklearnModel.get_learning_rate class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_learning_rate</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="519 "></span><span class=k>def</span> <span class=nf>get_learning_rate</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
<span class=linenos data-linenos="520 "></span>    <span class=k>return</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>learning_rate_init</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.models.Model class="doc doc-heading"> Model<!--        --> <!--          <code>Model</code>--> <!--        --> </h3> <div class=main-class-init> <span>CLASS </span> <div class=highlight><pre><span></span><code><span class=n>Model</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><!--typing.Generic[fedbiomed.common.models._model._MT, fedbiomed.common.models._model.DT]--><!--typing.Generic--><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a><!---->[<!--fedbiomed.common.models._model._MT, fedbiomed.common.models._model.DT--><!--fedbiomed.common.models._model._MT--><span title="fedbiomed.common.models._model._MT">_MT</span><!---->, <!--fedbiomed.common.models._model.DT--><span title="fedbiomed.common.models._model.DT">DT</span><!---->]</code></p> <p>Model abstraction, that wraps and handles both native models</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code><!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code> </td> <td><p>native model, written in a framework supported by Fed-BioMed.</p></td> </tr> </tbody> </table> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code><!--fedbiomed.common.models._model._MT--><span title="fedbiomed.common.models._model._MT">_MT</span></code> </td> <td><p>native model wrapped, of child-class-specific type.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="29 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=n>_MT</span><span class=p>):</span>
<span class=linenos data-linenos="30 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructor of Model abstract class</span>
<span class=linenos data-linenos="31 "></span>
<span class=linenos data-linenos="32 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="33 "></span><span class=sd>        model: native model wrapped, of child-class-specific type.</span>
<span class=linenos data-linenos="34 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="35 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_validate_model_type</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
<span class=linenos data-linenos="36 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=n>model</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.models.Model-attributes class=api-section-header>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._model.Model.model class="doc doc-heading attribute"> model <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>model</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=n>model</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.common.models.Model-functions class=api-section-header>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.apply_updates class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>apply_updates</span><span class=p>(</span><span class=n>updates</span><span class=p>)</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Applies updates to the model.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>updates</code></td> <td> <code><!--typing.Dict[str, fedbiomed.common.models._model.DT]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, fedbiomed.common.models._model.DT--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--fedbiomed.common.models._model.DT--><span title="fedbiomed.common.models._model.DT">DT</span><!---->]</code> </td> <td><p>model updates.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="89 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="90 "></span><span class=k>def</span> <span class=nf>apply_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>updates</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>DT</span><span class=p>]):</span>
<span class=linenos data-linenos="91 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Applies updates to the model.</span>
<span class=linenos data-linenos="92 "></span>
<span class=linenos data-linenos="93 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="94 "></span><span class=sd>        updates: model updates.</span>
<span class=linenos data-linenos="95 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.export class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>export</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Export the wrapped model to a dump file.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>filename</code></td> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>path to the file where the model will be saved.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p>!!! info "Notes": This method is designed to save the model to a local dump file for easy re-use by the same user, possibly outside of Fed-BioMed. It is not designed to produce trustworthy data dumps and is not used to exchange models and their weights as part of the federated learning process.</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="136 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="137 "></span><span class=k>def</span> <span class=nf>export</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filename</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="138 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Export the wrapped model to a dump file.</span>
<span class=linenos data-linenos="139 "></span>
<span class=linenos data-linenos="140 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="141 "></span><span class=sd>        filename: path to the file where the model will be saved.</span>
<span class=linenos data-linenos="142 "></span>
<span class=linenos data-linenos="143 "></span><span class=sd>    !!! info &quot;Notes&quot;:</span>
<span class=linenos data-linenos="144 "></span><span class=sd>        This method is designed to save the model to a local dump</span>
<span class=linenos data-linenos="145 "></span><span class=sd>        file for easy re-use by the same user, possibly outside of</span>
<span class=linenos data-linenos="146 "></span><span class=sd>        Fed-BioMed. It is not designed to produce trustworthy data</span>
<span class=linenos data-linenos="147 "></span><span class=sd>        dumps and is not used to exchange models and their weights</span>
<span class=linenos data-linenos="148 "></span><span class=sd>        as part of the federated learning process.</span>
<span class=linenos data-linenos="149 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.flatten class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>flatten</span><span class=p>()</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Flattens model weights</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.List[float]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a><!---->]</code> </td> <td><p>List of model weights as float.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="128 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="129 "></span><span class=k>def</span> <span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
<span class=linenos data-linenos="130 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Flattens model weights</span>
<span class=linenos data-linenos="131 "></span>
<span class=linenos data-linenos="132 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="133 "></span><span class=sd>        List of model weights as float.</span>
<span class=linenos data-linenos="134 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.get_gradients class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_gradients</span><span class=p>()</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Return computed gradients attached to the model.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, fedbiomed.common.models._model.DT]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, fedbiomed.common.models._model.DT--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--fedbiomed.common.models._model.DT--><span title="fedbiomed.common.models._model.DT">DT</span><!---->]</code> </td> <td><p>Gradients, as a dict mapping parameters' names to their gradient's value.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="119 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="120 "></span><span class=k>def</span> <span class=nf>get_gradients</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>DT</span><span class=p>]:</span>
<span class=linenos data-linenos="121 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return computed gradients attached to the model.</span>
<span class=linenos data-linenos="122 "></span>
<span class=linenos data-linenos="123 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="124 "></span><span class=sd>        Gradients, as a dict mapping parameters&#39; names to their</span>
<span class=linenos data-linenos="125 "></span><span class=sd>            gradient&#39;s value.</span>
<span class=linenos data-linenos="126 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.get_weights class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_weights</span><span class=p>()</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Return a copy of the model's trainable weights.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>only_trainable</code></td> <td> </td> <td><p>Whether to ignore non-trainable model parameters from outputs (e.g. frozen neural network layers' parameters), or include all model parameters (the default).</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, fedbiomed.common.models._model.DT]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, fedbiomed.common.models._model.DT--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--fedbiomed.common.models._model.DT--><span title="fedbiomed.common.models._model.DT">DT</span><!---->]</code> </td> <td><p>Model weights, as a dict mapping parameters' names to their value.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 97 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos=" 98 "></span><span class=k>def</span> <span class=nf>get_weights</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>DT</span><span class=p>]:</span>
<span class=linenos data-linenos=" 99 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a copy of the model&#39;s trainable weights.</span>
<span class=linenos data-linenos="100 "></span>
<span class=linenos data-linenos="101 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="102 "></span><span class=sd>        only_trainable: Whether to ignore non-trainable model parameters</span>
<span class=linenos data-linenos="103 "></span><span class=sd>            from outputs (e.g. frozen neural network layers&#39; parameters),</span>
<span class=linenos data-linenos="104 "></span><span class=sd>            or include all model parameters (the default).</span>
<span class=linenos data-linenos="105 "></span>
<span class=linenos data-linenos="106 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="107 "></span><span class=sd>        Model weights, as a dict mapping parameters&#39; names to their value.</span>
<span class=linenos data-linenos="108 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.init_training class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>init_training</span><span class=p>()</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Initialize parameters before model training.</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="57 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="58 "></span><span class=k>def</span> <span class=nf>init_training</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos="59 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize parameters before model training.&quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.predict class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>predict</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Return model predictions given input values.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>inputs</code></td> <td> <code><!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code> </td> <td><p>input values.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Any</code></td> <td> <code><!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code> </td> <td><p>predictions.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="78 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="79 "></span><span class=k>def</span> <span class=nf>predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inputs</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
<span class=linenos data-linenos="80 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return model predictions given input values.</span>
<span class=linenos data-linenos="81 "></span>
<span class=linenos data-linenos="82 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="83 "></span><span class=sd>        inputs: input values.</span>
<span class=linenos data-linenos="84 "></span>
<span class=linenos data-linenos="85 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="86 "></span><span class=sd>        Any: predictions.</span>
<span class=linenos data-linenos="87 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.reload class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>reload</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Import and replace the wrapped model from a dump file.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>filename</code></td> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>path to the file where the model has been exported.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p>!!! info "Notes": This method is designed to load the model from a local dump file, that might not be in a trustworthy format. It should therefore only be used to re-load data exported locally and not received from someone else, including other FL peers.</p> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedModelError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedModelError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedModelError">FedbiomedModelError</a></code> </td> <td><p>if the reloaded instance is of unproper type.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="151 "></span><span class=k>def</span> <span class=nf>reload</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filename</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="152 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Import and replace the wrapped model from a dump file.</span>
<span class=linenos data-linenos="153 "></span>
<span class=linenos data-linenos="154 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="155 "></span><span class=sd>        filename: path to the file where the model has been exported.</span>
<span class=linenos data-linenos="156 "></span>
<span class=linenos data-linenos="157 "></span><span class=sd>    !!! info &quot;Notes&quot;:</span>
<span class=linenos data-linenos="158 "></span><span class=sd>        This method is designed to load the model from a local dump</span>
<span class=linenos data-linenos="159 "></span><span class=sd>        file, that might not be in a trustworthy format. It should</span>
<span class=linenos data-linenos="160 "></span><span class=sd>        therefore only be used to re-load data exported locally and</span>
<span class=linenos data-linenos="161 "></span><span class=sd>        not received from someone else, including other FL peers.</span>
<span class=linenos data-linenos="162 "></span>
<span class=linenos data-linenos="163 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="164 "></span><span class=sd>        FedbiomedModelError: if the reloaded instance is of unproper type.</span>
<span class=linenos data-linenos="165 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="166 "></span>    <span class=n>model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_reload</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
<span class=linenos data-linenos="167 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_type</span><span class=p>):</span>
<span class=linenos data-linenos="168 "></span>        <span class=n>err_msg</span> <span class=o>=</span> <span class=p>(</span>
<span class=linenos data-linenos="169 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: unproper type for imported model&quot;</span>
<span class=linenos data-linenos="170 "></span>            <span class=sa>f</span><span class=s2>&quot;: expected &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_model_type</span><span class=si>}</span><span class=s2>&#39;, but &#39;got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>model</span><span class=p>)</span><span class=si>}</span><span class=s2>&#39;.&quot;</span>
<span class=linenos data-linenos="171 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="172 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>err_msg</span><span class=p>)</span>
<span class=linenos data-linenos="173 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span><span class=n>err_msg</span><span class=p>)</span>
<span class=linenos data-linenos="174 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span> <span class=o>=</span> <span class=n>model</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.set_model class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_model</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Replace the wrapped model with a new one.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code><!--fedbiomed.common.models._model._MT--><span title="fedbiomed.common.models._model._MT">_MT</span></code> </td> <td><p>New model instance that needs assignment as the <code>model</code> attribute.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="38 "></span><span class=k>def</span> <span class=nf>set_model</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=n>_MT</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="39 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Replace the wrapped model with a new one.</span>
<span class=linenos data-linenos="40 "></span>
<span class=linenos data-linenos="41 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="42 "></span><span class=sd>        model: New model instance that needs assignment as the `model`</span>
<span class=linenos data-linenos="43 "></span><span class=sd>            attribute.</span>
<span class=linenos data-linenos="44 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="45 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_validate_model_type</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
<span class=linenos data-linenos="46 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span> <span class=o>=</span> <span class=n>model</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.set_weights class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_weights</span><span class=p>(</span><span class=n>weights</span><span class=p>)</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Assign new values to the model's trainable weights.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>weights</code></td> <td> <code><!--typing.Dict[str, fedbiomed.common.models._model.DT]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, fedbiomed.common.models._model.DT--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--fedbiomed.common.models._model.DT--><span title="fedbiomed.common.models._model.DT">DT</span><!---->]</code> </td> <td><p>Model weights, as a dict mapping parameters' names to their value.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="110 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="111 "></span><span class=k>def</span> <span class=nf>set_weights</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>weights</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>DT</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="112 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Assign new values to the model&#39;s trainable weights.</span>
<span class=linenos data-linenos="113 "></span>
<span class=linenos data-linenos="114 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="115 "></span><span class=sd>        weights: Model weights, as a dict mapping parameters&#39; names</span>
<span class=linenos data-linenos="116 "></span><span class=sd>            to their value.</span>
<span class=linenos data-linenos="117 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.train class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>train</span><span class=p>(</span><span class=n>inputs</span><span class=p>,</span> <span class=n>targets</span><span class=p>,</span> <span class=n>kwargs</span><span class=p>)</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Perform a training step given inputs and targets data.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Please run <code>init_training</code> method before running <code>train</code> method, so to initialize parameters needed for model training"</p> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>This function usually does not update weights. You need to call <code>apply_updates</code> to ensure updates are applied to the model.</p> </div> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>inputs</code></td> <td> <code><!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code> </td> <td><p>input (training) data.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>targets</code></td> <td> <code><!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code> </td> <td><p>target values.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="61 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="62 "></span><span class=k>def</span> <span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inputs</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=n>targets</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="63 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Perform a training step given inputs and targets data.</span>
<span class=linenos data-linenos="64 "></span>
<span class=linenos data-linenos="65 "></span><span class=sd>    !!! warning &quot;Warning&quot;</span>
<span class=linenos data-linenos="66 "></span><span class=sd>        Please run `init_training` method before running `train` method,</span>
<span class=linenos data-linenos="67 "></span><span class=sd>        so to initialize parameters needed for model training&quot;</span>
<span class=linenos data-linenos="68 "></span>
<span class=linenos data-linenos="69 "></span><span class=sd>    !!! warning &quot;Warning&quot;</span>
<span class=linenos data-linenos="70 "></span><span class=sd>        This function usually does not update weights. You need to call</span>
<span class=linenos data-linenos="71 "></span><span class=sd>        `apply_updates` to ensure updates are applied to the model.</span>
<span class=linenos data-linenos="72 "></span>
<span class=linenos data-linenos="73 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="74 "></span><span class=sd>        inputs: input (training) data.</span>
<span class=linenos data-linenos="75 "></span><span class=sd>        targets: target values.</span>
<span class=linenos data-linenos="76 "></span><span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._model.Model.unflatten class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>unflatten</span><span class=p>(</span><span class=n>weights_vector</span><span class=p>)</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Revert flatten model weights back model-dict form.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>weights_vector</code></td> <td> <code><!--typing.List[float]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a><!---->]</code> </td> <td><p>Vectorized model weights to convert dict</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!---->None</code> </td> <td><p>Model dictionary</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_model.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="197 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="198 "></span><span class=k>def</span> <span class=nf>unflatten</span><span class=p>(</span>
<span class=linenos data-linenos="199 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="200 "></span>        <span class=n>weights_vector</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span>
<span class=linenos data-linenos="201 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="202 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Revert flatten model weights back model-dict form.</span>
<span class=linenos data-linenos="203 "></span>
<span class=linenos data-linenos="204 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="205 "></span><span class=sd>        weights_vector: Vectorized model weights to convert dict</span>
<span class=linenos data-linenos="206 "></span>
<span class=linenos data-linenos="207 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="208 "></span><span class=sd>        Model dictionary</span>
<span class=linenos data-linenos="209 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="210 "></span>
<span class=linenos data-linenos="211 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>weights_vector</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>or</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>([</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=nb>float</span><span class=p>)</span> <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>weights_vector</span><span class=p>]):</span>
<span class=linenos data-linenos="212 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="213 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=si>}</span><span class=s2> `weights_vector should be 1D list of float containing flatten model parameters`&quot;</span>
<span class=linenos data-linenos="214 "></span>        <span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.models.SGDClassifierSKLearnModel class="doc doc-heading"> SGDClassifierSKLearnModel<!--        --> <!--          <code>SGDClassifierSKLearnModel</code>--> <!--        --> </h3> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><!--fedbiomed.common.models._sklearn.SGDSkLearnModel--><span title="fedbiomed.common.models._sklearn.SGDSkLearnModel">SGDSkLearnModel</span></code></p> <p>BaseSkLearnModel subclass for SGDClassifier models.</p> <div class="doc doc-children"> <h4 id=fedbiomed.common.models.SGDClassifierSKLearnModel-attributes class=api-section-header>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._sklearn.SGDClassifierSKLearnModel.is_classification class="doc doc-heading attribute"> is_classification <span class="doc doc-properties"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>is_classification</span> <span class=o>=</span> <span class=kc>True</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._sklearn.SGDClassifierSKLearnModel.model class="doc doc-heading attribute"> model <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>model</span><span class=p>:</span> <span class=n>SGDClassifier</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.common.models.SGDClassifierSKLearnModel-functions class=api-section-header>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.SGDClassifierSKLearnModel.set_init_params class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_init_params</span><span class=p>(</span><span class=n>model_args</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Initialize the model's trainable parameters.</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="483 "></span><span class=k>def</span> <span class=nf>set_init_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model_args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="484 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the model&#39;s trainable parameters.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="485 "></span>    <span class=c1># Set up zero-valued start weights, for binary of multiclass classif.</span>
<span class=linenos data-linenos="486 "></span>    <span class=n>n_classes</span> <span class=o>=</span> <span class=n>model_args</span><span class=p>[</span><span class=s2>&quot;n_classes&quot;</span><span class=p>]</span>
<span class=linenos data-linenos="487 "></span>    <span class=k>if</span> <span class=n>n_classes</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
<span class=linenos data-linenos="488 "></span>        <span class=n>init_params</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="489 "></span>            <span class=s2>&quot;intercept_&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,)),</span>
<span class=linenos data-linenos="490 "></span>            <span class=s2>&quot;coef_&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>model_args</span><span class=p>[</span><span class=s2>&quot;n_features&quot;</span><span class=p>])),</span>
<span class=linenos data-linenos="491 "></span>        <span class=p>}</span>
<span class=linenos data-linenos="492 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="493 "></span>        <span class=n>init_params</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="494 "></span>            <span class=s2>&quot;intercept_&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>n_classes</span><span class=p>,)),</span>
<span class=linenos data-linenos="495 "></span>            <span class=s2>&quot;coef_&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>n_classes</span><span class=p>,</span> <span class=n>model_args</span><span class=p>[</span><span class=s2>&quot;n_features&quot;</span><span class=p>])),</span>
<span class=linenos data-linenos="496 "></span>        <span class=p>}</span>
<span class=linenos data-linenos="497 "></span>    <span class=c1># Assign these initialization parameters and retain their names.</span>
<span class=linenos data-linenos="498 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>param_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>init_params</span><span class=p>)</span>
<span class=linenos data-linenos="499 "></span>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>init_params</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="500 "></span>        <span class=nb>setattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span><span class=p>)</span>
<span class=linenos data-linenos="501 "></span>    <span class=c1># Also initialize the &quot;classes_&quot; slot with unique predictable labels.</span>
<span class=linenos data-linenos="502 "></span>    <span class=c1># FIXME: this assumes target values are integers in range(n_classes).</span>
<span class=linenos data-linenos="503 "></span>    <span class=nb>setattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=s2>&quot;classes_&quot;</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>n_classes</span><span class=p>))</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.models.SGDRegressorSKLearnModel class="doc doc-heading"> SGDRegressorSKLearnModel<!--        --> <!--          <code>SGDRegressorSKLearnModel</code>--> <!--        --> </h3> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><!--fedbiomed.common.models._sklearn.SGDSkLearnModel--><span title="fedbiomed.common.models._sklearn.SGDSkLearnModel">SGDSkLearnModel</span></code></p> <p>BaseSkLearnModel subclass for SGDRegressor models.</p> <div class="doc doc-children"> <h4 id=fedbiomed.common.models.SGDRegressorSKLearnModel-attributes class=api-section-header>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._sklearn.SGDRegressorSKLearnModel.is_classification class="doc doc-heading attribute"> is_classification <span class="doc doc-properties"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>is_classification</span> <span class=o>=</span> <span class=kc>False</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._sklearn.SGDRegressorSKLearnModel.model class="doc doc-heading attribute"> model <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>model</span><span class=p>:</span> <span class=n>SGDRegressor</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.common.models.SGDRegressorSKLearnModel-functions class=api-section-header>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._sklearn.SGDRegressorSKLearnModel.set_init_params class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_init_params</span><span class=p>(</span><span class=n>model_args</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Initialize the model's trainable parameters.</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="464 "></span><span class=k>def</span> <span class=nf>set_init_params</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model_args</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]):</span>
<span class=linenos data-linenos="465 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialize the model&#39;s trainable parameters.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="466 "></span>    <span class=n>init_params</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="467 "></span>        <span class=s2>&quot;intercept_&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.0</span><span class=p>]),</span>
<span class=linenos data-linenos="468 "></span>        <span class=s2>&quot;coef_&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.0</span><span class=p>]</span> <span class=o>*</span> <span class=n>model_args</span><span class=p>[</span><span class=s2>&quot;n_features&quot;</span><span class=p>]),</span>
<span class=linenos data-linenos="469 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="470 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>param_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>init_params</span><span class=p>)</span>
<span class=linenos data-linenos="471 "></span>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>init_params</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="472 "></span>        <span class=nb>setattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.models.SkLearnModel class="doc doc-heading"> SkLearnModel<!--        --> <!--          <code>SkLearnModel</code>--> <!--        --> </h3> <div class=main-class-init> <span>CLASS </span> <div class=highlight><pre><span></span><code><span class=n>SkLearnModel</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>Sklearn model builder.</p> <p>It wraps one of Fed-BioMed <code>BaseSkLearnModel</code> object children, by passing a (BaseEstimator)(<a href=https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html>https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html</a>) object to the constructor, as shown below.</p> <p><strong>Usage</strong> <div class=highlight><pre><span></span><code>    <span class=kn>from</span> <span class=nn>sklearn.linear_model</span> <span class=kn>import</span> <span class=n>SGDClassifier</span>
    <span class=n>model</span> <span class=o>=</span> <span class=n>SkLearnModel</span><span class=p>(</span><span class=n>SGDClassifier</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>set_weights</span><span class=p>(</span><span class=n>some_weights</span><span class=p>)</span>
    <span class=nb>type</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>model</span><span class=p>)</span>
    <span class=c1># Output: &lt;class &#39;sklearn.linear_model._stochastic_gradient.SGDClassifier&#39;&gt;</span>
</code></pre></div></p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>_instance</code></td> <td> <code><!--fedbiomed.common.models._sklearn.BaseSkLearnModel--><a class="autorefs autorefs-internal" title="fedbiomed.common.models._sklearn.BaseSkLearnModel" href="#fedbiomed.common.models.BaseSkLearnModel">BaseSkLearnModel</a></code> </td> <td><p>instance of BaseSkLearnModel</p></td> </tr> </tbody> </table> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code><!--typing.Type[sklearn.base.BaseEstimator]--><!--typing.Type--><a class="autorefs autorefs-external" title="typing.Type" href="https://docs.python.org/3/library/typing.html#typing.Type">Type</a><!---->[<!--sklearn.base.BaseEstimator--><a class="autorefs autorefs-external" title="sklearn.base.BaseEstimator" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator">BaseEstimator</a><!---->]</code> </td> <td><p>non-initialized <a class="autorefs autorefs-external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator">BaseEstimator</a> object</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedModelError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedModelError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedModelError">FedbiomedModelError</a></code> </td> <td><p>raised if model does not belong to the implemented models.</p></td> </tr> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedModelError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedModelError" href="../exceptions/#fedbiomed.common.exceptions.FedbiomedModelError">FedbiomedModelError</a></code> </td> <td><p>raised if <code>__name__</code> attribute does not belong to object. This may happen when passing an instantiated object instead of the class object (e.g. instance of SGDClassifier() instead of SGDClassifier object)</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/models/_sklearn.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="549 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=n>Type</span><span class=p>[</span><span class=n>BaseEstimator</span><span class=p>]):</span>
<span class=linenos data-linenos="550 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructor of the model builder.</span>
<span class=linenos data-linenos="551 "></span>
<span class=linenos data-linenos="552 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="553 "></span><span class=sd>        model: non-initialized [BaseEstimator][sklearn.base.BaseEstimator] object</span>
<span class=linenos data-linenos="554 "></span>
<span class=linenos data-linenos="555 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="556 "></span><span class=sd>        FedbiomedModelError: raised if model does not belong to the implemented models.</span>
<span class=linenos data-linenos="557 "></span><span class=sd>        FedbiomedModelError: raised if `__name__` attribute does not belong to object. This may happen</span>
<span class=linenos data-linenos="558 "></span><span class=sd>            when passing an instantiated object instead of the class object (e.g. instance of</span>
<span class=linenos data-linenos="559 "></span><span class=sd>            SGDClassifier() instead of SGDClassifier object)</span>
<span class=linenos data-linenos="560 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="561 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=nb>type</span><span class=p>):</span>
<span class=linenos data-linenos="562 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="563 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: &#39;SkLearnModel&#39; received a &#39;</span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>model</span><span class=p>)</span><span class=si>}</span><span class=s2>&#39; instance as &#39;model&#39; &quot;</span>
<span class=linenos data-linenos="564 "></span>            <span class=s2>&quot;input while it was expecting a scikit-learn BaseEstimator subclass constructor.&quot;</span>
<span class=linenos data-linenos="565 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="566 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>BaseEstimator</span><span class=p>):</span>
<span class=linenos data-linenos="567 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="568 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: &#39;SkLearnModel&#39; received a &#39;model&#39; class that is not &quot;</span>
<span class=linenos data-linenos="569 "></span>            <span class=sa>f</span><span class=s2>&quot;a scikit-learn BaseEstimator subclass: &#39;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2>&#39;.&quot;</span>
<span class=linenos data-linenos="570 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="571 "></span>    <span class=k>if</span> <span class=n>model</span><span class=o>.</span><span class=vm>__name__</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>SKLEARN_MODELS</span><span class=p>:</span>
<span class=linenos data-linenos="572 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="573 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: &#39;SkLearnModel&#39; received &#39;</span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2>&#39; as &#39;model&#39; class, &quot;</span>
<span class=linenos data-linenos="574 "></span>            <span class=sa>f</span><span class=s2>&quot;support for which has not yet been implemented in Fed-BioMed.&quot;</span>
<span class=linenos data-linenos="575 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="576 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_instance</span><span class=p>:</span> <span class=n>BaseSkLearnModel</span> <span class=o>=</span> <span class=n>SKLEARN_MODELS</span><span class=p>[</span><span class=n>model</span><span class=o>.</span><span class=vm>__name__</span><span class=p>](</span><span class=n>model</span><span class=p>())</span>
</code></pre></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.common.models.TorchModel class="doc doc-heading"> TorchModel<!--        --> <!--          <code>TorchModel</code>--> <!--        --> </h3> <div class=main-class-init> <span>CLASS </span> <div class=highlight><pre><span></span><code><span class=n>TorchModel</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><!--fedbiomed.common.models.Model--><a class="autorefs autorefs-internal" title="fedbiomed.common.models.Model" href="#fedbiomed.common.models.Model">Model</a></code></p> <p>PyTorch model wrapper that ease the handling of a pytorch model</p> <p><strong>Attributes:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>model</code></td> <td> <code><!--torch.nn.Module--><!--torch.nn--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.nn--><a class="autorefs autorefs-external" title="torch.nn" href="https://pytorch.org/docs/stable/nn.html#module-torch.nn">nn</a><!---->.<!--torch.nn.Module--><a class="autorefs autorefs-external" title="torch.nn.Module" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module">Module</a></code> </td> <td><p>torch.nn.Module. Pytorch model wrapped.</p></td> </tr> <tr> <td><code>init_params</code></td> <td> <code><!--typing.Dict[str, torch.Tensor]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, torch.Tensor--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--torch.Tensor--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.Tensor--><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a><!---->]</code> </td> <td><p>OrderedDict. Model initial parameters. Set when calling <code>init_training</code>.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="30 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="31 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Instantiates the wrapper over a torch Module instance.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="32 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>
<span class=linenos data-linenos="33 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>init_params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.common.models.TorchModel-attributes class=api-section-header>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._torch.TorchModel.init_params class="doc doc-heading attribute"> init_params <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>init_params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.common.models._torch.TorchModel.model class="doc doc-heading attribute"> model <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>model</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.common.models.TorchModel-functions class=api-section-header>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.add_corrections_to_gradients class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>add_corrections_to_gradients</span><span class=p>(</span><span class=n>corrections</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Add values to the gradients currently attached to the model.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>corrections</code></td> <td> <code><!--typing.Dict[str, torch.Tensor]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, torch.Tensor--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--torch.Tensor--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.Tensor--><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a><!---->]</code> </td> <td><p>corrections to be added to the model's gradients.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="171 "></span><span class=k>def</span> <span class=nf>add_corrections_to_gradients</span><span class=p>(</span>
<span class=linenos data-linenos="172 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="173 "></span>    <span class=n>corrections</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>],</span>
<span class=linenos data-linenos="174 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="175 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Add values to the gradients currently attached to the model.</span>
<span class=linenos data-linenos="176 "></span>
<span class=linenos data-linenos="177 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="178 "></span><span class=sd>        corrections: corrections to be added to the model&#39;s gradients.</span>
<span class=linenos data-linenos="179 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="180 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_assert_dict_inputs</span><span class=p>(</span><span class=n>corrections</span><span class=p>)</span>
<span class=linenos data-linenos="181 "></span>    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>update</span> <span class=ow>in</span> <span class=n>corrections</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="182 "></span>        <span class=n>param</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>get_parameter</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
<span class=linenos data-linenos="183 "></span>        <span class=k>if</span> <span class=n>param</span><span class=o>.</span><span class=n>grad</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="184 "></span>            <span class=n>param</span><span class=o>.</span><span class=n>grad</span><span class=o>.</span><span class=n>add_</span><span class=p>(</span><span class=n>update</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>param</span><span class=o>.</span><span class=n>grad</span><span class=o>.</span><span class=n>device</span><span class=p>))</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.apply_updates class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>apply_updates</span><span class=p>(</span><span class=n>updates</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Apply incoming updates to the wrapped model's parameters.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>updates</code></td> <td> <code><!--typing.Dict[str, torch.Tensor]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, torch.Tensor--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--torch.Tensor--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.Tensor--><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a><!---->]</code> </td> <td><p>model updates to be added to the model.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="156 "></span><span class=k>def</span> <span class=nf>apply_updates</span><span class=p>(</span>
<span class=linenos data-linenos="157 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="158 "></span>    <span class=n>updates</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>],</span>
<span class=linenos data-linenos="159 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="160 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Apply incoming updates to the wrapped model&#39;s parameters.</span>
<span class=linenos data-linenos="161 "></span>
<span class=linenos data-linenos="162 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="163 "></span><span class=sd>        updates: model updates to be added to the model.</span>
<span class=linenos data-linenos="164 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="165 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_assert_dict_inputs</span><span class=p>(</span><span class=n>updates</span><span class=p>)</span>
<span class=linenos data-linenos="166 "></span>    <span class=k>with</span> <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>():</span>
<span class=linenos data-linenos="167 "></span>        <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>update</span> <span class=ow>in</span> <span class=n>updates</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="168 "></span>            <span class=n>param</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>get_parameter</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
<span class=linenos data-linenos="169 "></span>            <span class=n>param</span><span class=o>.</span><span class=n>add_</span><span class=p>(</span><span class=n>update</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>param</span><span class=o>.</span><span class=n>device</span><span class=p>))</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.export class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>export</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Export the wrapped model to a dump file.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>filename</code></td> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>path to the file where the model will be saved.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p>!!! info "Notes": This method is designed to save the model to a local dump file for easy re-use by the same user, possibly outside of Fed-BioMed. It is not designed to produce trustworthy data dumps and is not used to exchange models and their weights as part of the federated learning process.</p> <p>!!! warning "Warning": This method uses <code>torch.save</code>, which relies on pickle and is therefore hard to trust by third-party loading methods.</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="239 "></span><span class=k>def</span> <span class=nf>export</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filename</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="240 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Export the wrapped model to a dump file.</span>
<span class=linenos data-linenos="241 "></span>
<span class=linenos data-linenos="242 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="243 "></span><span class=sd>        filename: path to the file where the model will be saved.</span>
<span class=linenos data-linenos="244 "></span>
<span class=linenos data-linenos="245 "></span><span class=sd>    !!! info &quot;Notes&quot;:</span>
<span class=linenos data-linenos="246 "></span><span class=sd>        This method is designed to save the model to a local dump</span>
<span class=linenos data-linenos="247 "></span><span class=sd>        file for easy re-use by the same user, possibly outside of</span>
<span class=linenos data-linenos="248 "></span><span class=sd>        Fed-BioMed. It is not designed to produce trustworthy data</span>
<span class=linenos data-linenos="249 "></span><span class=sd>        dumps and is not used to exchange models and their weights</span>
<span class=linenos data-linenos="250 "></span><span class=sd>        as part of the federated learning process.</span>
<span class=linenos data-linenos="251 "></span>
<span class=linenos data-linenos="252 "></span><span class=sd>    !!! warning &quot;Warning&quot;:</span>
<span class=linenos data-linenos="253 "></span><span class=sd>        This method uses `torch.save`, which relies on pickle and</span>
<span class=linenos data-linenos="254 "></span><span class=sd>        is therefore hard to trust by third-party loading methods.</span>
<span class=linenos data-linenos="255 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="256 "></span>    <span class=n>torch</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.flatten class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>flatten</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Gets weights as flatten vector</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>to_list</code></td> <td> <code><!--typing.List[float]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a><!---->]</code> </td> <td><p>Convert np.ndarray to a list if it is True.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="80 "></span><span class=k>def</span> <span class=nf>flatten</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
<span class=linenos data-linenos="81 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Gets weights as flatten vector</span>
<span class=linenos data-linenos="82 "></span>
<span class=linenos data-linenos="83 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="84 "></span><span class=sd>        to_list: Convert np.ndarray to a list if it is True.</span>
<span class=linenos data-linenos="85 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="86 "></span>
<span class=linenos data-linenos="87 "></span>    <span class=n>params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>utils</span><span class=o>.</span><span class=n>parameters_to_vector</span><span class=p>(</span>
<span class=linenos data-linenos="88 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>parameters</span><span class=p>()</span>
<span class=linenos data-linenos="89 "></span>    <span class=p>)</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
<span class=linenos data-linenos="90 "></span>
<span class=linenos data-linenos="91 "></span>    <span class=k>return</span> <span class=n>params</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.get_gradients class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_gradients</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Return the gradients attached to the model.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, torch.Tensor]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, torch.Tensor--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--torch.Tensor--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.Tensor--><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a><!---->]</code> </td> <td><p>Gradients, as a dict mapping parameters' names to their gradient's torch tensor.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="35 "></span><span class=k>def</span> <span class=nf>get_gradients</span><span class=p>(</span>
<span class=linenos data-linenos="36 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="37 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]:</span>
<span class=linenos data-linenos="38 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the gradients attached to the model.</span>
<span class=linenos data-linenos="39 "></span>
<span class=linenos data-linenos="40 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="41 "></span><span class=sd>        Gradients, as a dict mapping parameters&#39; names to their gradient&#39;s</span>
<span class=linenos data-linenos="42 "></span><span class=sd>            torch tensor.</span>
<span class=linenos data-linenos="43 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="44 "></span>    <span class=n>gradients</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="45 "></span>        <span class=n>name</span><span class=p>:</span> <span class=n>param</span><span class=o>.</span><span class=n>grad</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span>
<span class=linenos data-linenos="46 "></span>        <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>param</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>named_parameters</span><span class=p>()</span>
<span class=linenos data-linenos="47 "></span>        <span class=k>if</span> <span class=p>(</span><span class=n>param</span><span class=o>.</span><span class=n>requires_grad</span> <span class=ow>and</span> <span class=n>param</span><span class=o>.</span><span class=n>grad</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>)</span>
<span class=linenos data-linenos="48 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="49 "></span>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>gradients</span><span class=p>)</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>named_parameters</span><span class=p>())):</span>
<span class=linenos data-linenos="50 "></span>        <span class=c1># FIXME: this will be triggered when having some frozen weights</span>
<span class=linenos data-linenos="51 "></span>        <span class=c1>#        even if training was properly conducted</span>
<span class=linenos data-linenos="52 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<span class=linenos data-linenos="53 "></span>            <span class=s2>&quot;Warning: can not retrieve all gradients from the model. &quot;</span>
<span class=linenos data-linenos="54 "></span>            <span class=s2>&quot;Are you sure you have trained the model beforehand?&quot;</span>
<span class=linenos data-linenos="55 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="56 "></span>    <span class=k>return</span> <span class=n>gradients</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.get_weights class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>get_weights</span><span class=p>(</span><span class=n>only_trainable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Return the model's parameters.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>only_trainable</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>Whether to ignore non-trainable model parameters from outputs (e.g. frozen neural network layers' parameters), or include all model parameters (the default).</p></td> <td> <code><!---->False</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, torch.Tensor]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, torch.Tensor--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--torch.Tensor--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.Tensor--><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a><!---->]</code> </td> <td><p>Model weights, as a dictionary mapping parameters' names to their torch tensor.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="58 "></span><span class=k>def</span> <span class=nf>get_weights</span><span class=p>(</span>
<span class=linenos data-linenos="59 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="60 "></span>    <span class=n>only_trainable</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=linenos data-linenos="61 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]:</span>
<span class=linenos data-linenos="62 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the model&#39;s parameters.</span>
<span class=linenos data-linenos="63 "></span>
<span class=linenos data-linenos="64 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="65 "></span><span class=sd>        only_trainable: Whether to ignore non-trainable model parameters</span>
<span class=linenos data-linenos="66 "></span><span class=sd>            from outputs (e.g. frozen neural network layers&#39; parameters),</span>
<span class=linenos data-linenos="67 "></span><span class=sd>            or include all model parameters (the default).</span>
<span class=linenos data-linenos="68 "></span>
<span class=linenos data-linenos="69 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="70 "></span><span class=sd>        Model weights, as a dictionary mapping parameters&#39; names to their</span>
<span class=linenos data-linenos="71 "></span><span class=sd>            torch tensor.</span>
<span class=linenos data-linenos="72 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="73 "></span>    <span class=n>parameters</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="74 "></span>        <span class=n>name</span><span class=p>:</span> <span class=n>param</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span>
<span class=linenos data-linenos="75 "></span>        <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>param</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>named_parameters</span><span class=p>()</span>
<span class=linenos data-linenos="76 "></span>        <span class=k>if</span> <span class=n>param</span><span class=o>.</span><span class=n>requires_grad</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>only_trainable</span>
<span class=linenos data-linenos="77 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="78 "></span>    <span class=k>return</span> <span class=n>parameters</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.init_training class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>init_training</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Initializes and sets attributes before the training.</p> <p>Initializes <code>init_params</code> as a copy of the initial parameters of the model</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="214 "></span><span class=k>def</span> <span class=nf>init_training</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="215 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initializes and sets attributes before the training.</span>
<span class=linenos data-linenos="216 "></span>
<span class=linenos data-linenos="217 "></span><span class=sd>    Initializes `init_params` as a copy of the initial parameters of the model</span>
<span class=linenos data-linenos="218 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="219 "></span>    <span class=c1># initial aggregated model parameters</span>
<span class=linenos data-linenos="220 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>init_params</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="221 "></span>        <span class=n>key</span><span class=p>:</span> <span class=n>param</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span>
<span class=linenos data-linenos="222 "></span>        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>param</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>named_parameters</span><span class=p>()</span>
<span class=linenos data-linenos="223 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="224 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>train</span><span class=p>()</span>  <span class=c1># pytorch switch for training</span>
<span class=linenos data-linenos="225 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>zero_grad</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.predict class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>predict</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Computes prediction given input data.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>inputs</code></td> <td> <code><!--torch.Tensor--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.Tensor--><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a></code> </td> <td><p>input data</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--numpy.ndarray--><!--numpy--><a class="autorefs autorefs-external" title="numpy" href="https://numpy.org/doc/stable/reference/index.html#module-numpy">np</a><!---->.<!--numpy.ndarray--><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code> </td> <td><p>Model predictions returned as a numpy array</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="186 "></span><span class=k>def</span> <span class=nf>predict</span><span class=p>(</span>
<span class=linenos data-linenos="187 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="188 "></span>    <span class=n>inputs</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span>
<span class=linenos data-linenos="189 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
<span class=linenos data-linenos="190 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Computes prediction given input data.</span>
<span class=linenos data-linenos="191 "></span>
<span class=linenos data-linenos="192 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="193 "></span><span class=sd>        inputs: input data</span>
<span class=linenos data-linenos="194 "></span>
<span class=linenos data-linenos="195 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="196 "></span><span class=sd>        Model predictions returned as a numpy array</span>
<span class=linenos data-linenos="197 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="198 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>eval</span><span class=p>()</span>  <span class=c1># pytorch switch for model inference-mode</span>
<span class=linenos data-linenos="199 "></span>    <span class=k>with</span> <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>():</span>
<span class=linenos data-linenos="200 "></span>        <span class=n>pred</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
<span class=linenos data-linenos="201 "></span>    <span class=k>return</span> <span class=n>pred</span><span class=o>.</span><span class=n>cpu</span><span class=p>()</span><span class=o>.</span><span class=n>numpy</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.send_to_device class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>send_to_device</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sends model to device</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>device</code></td> <td> <code><!--torch.device--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.device--><a class="autorefs autorefs-external" title="torch.device" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device">device</a></code> </td> <td><p>device set for using GPU or CPU.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="203 "></span><span class=k>def</span> <span class=nf>send_to_device</span><span class=p>(</span>
<span class=linenos data-linenos="204 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="205 "></span>    <span class=n>device</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>device</span><span class=p>,</span>
<span class=linenos data-linenos="206 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="207 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sends model to device</span>
<span class=linenos data-linenos="208 "></span>
<span class=linenos data-linenos="209 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="210 "></span><span class=sd>        device: device set for using GPU or CPU.</span>
<span class=linenos data-linenos="211 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="212 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.set_weights class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_weights</span><span class=p>(</span><span class=n>weights</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets model weights.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>weights</code></td> <td> <code><!--typing.Dict[str, torch.Tensor]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, torch.Tensor--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--torch.Tensor--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.Tensor--><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a><!---->]</code> </td> <td><p>Model weights, as a dict mapping parameters' names to their torch tensor.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="124 "></span><span class=k>def</span> <span class=nf>set_weights</span><span class=p>(</span>
<span class=linenos data-linenos="125 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="126 "></span>    <span class=n>weights</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>],</span>
<span class=linenos data-linenos="127 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="128 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets model weights.</span>
<span class=linenos data-linenos="129 "></span>
<span class=linenos data-linenos="130 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="131 "></span><span class=sd>        weights: Model weights, as a dict mapping parameters&#39; names</span>
<span class=linenos data-linenos="132 "></span><span class=sd>            to their torch tensor.</span>
<span class=linenos data-linenos="133 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="134 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_assert_dict_inputs</span><span class=p>(</span><span class=n>weights</span><span class=p>)</span>
<span class=linenos data-linenos="135 "></span>    <span class=n>incompatible</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>load_state_dict</span><span class=p>(</span><span class=n>weights</span><span class=p>,</span> <span class=n>strict</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=linenos data-linenos="136 "></span>    <span class=c1># Warn about (probably-)missing trainable weights.</span>
<span class=linenos data-linenos="137 "></span>    <span class=c1># Note: state_dict may include values that do not belong to the model&#39;s</span>
<span class=linenos data-linenos="138 "></span>    <span class=c1># parameters, and/or input weights may exclude non-trainable weights,</span>
<span class=linenos data-linenos="139 "></span>    <span class=c1># without requiring a warning.</span>
<span class=linenos data-linenos="140 "></span>    <span class=k>if</span> <span class=n>incompatible</span><span class=o>.</span><span class=n>missing_keys</span><span class=p>:</span>
<span class=linenos data-linenos="141 "></span>        <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>prm</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>named_parameters</span><span class=p>()</span> <span class=k>if</span> <span class=n>prm</span><span class=o>.</span><span class=n>requires_grad</span><span class=p>}</span>
<span class=linenos data-linenos="142 "></span>        <span class=n>missing</span> <span class=o>=</span> <span class=n>params</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=n>incompatible</span><span class=o>.</span><span class=n>missing_keys</span><span class=p>)</span>
<span class=linenos data-linenos="143 "></span>        <span class=k>if</span> <span class=n>missing</span><span class=p>:</span>
<span class=linenos data-linenos="144 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<span class=linenos data-linenos="145 "></span>                <span class=s2>&quot;&#39;TorchModel.set_weights&#39; received inputs that did not cover all&quot;</span>
<span class=linenos data-linenos="146 "></span>                <span class=s2>&quot;trainable model parameters; missing weights: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="147 "></span>                <span class=n>missing</span>
<span class=linenos data-linenos="148 "></span>            <span class=p>)</span>
<span class=linenos data-linenos="149 "></span>    <span class=c1># Warn about invalid (hence, unused) inputs.</span>
<span class=linenos data-linenos="150 "></span>    <span class=k>if</span> <span class=n>incompatible</span><span class=o>.</span><span class=n>unexpected_keys</span><span class=p>:</span>
<span class=linenos data-linenos="151 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<span class=linenos data-linenos="152 "></span>            <span class=s2>&quot;&#39;TorchModel.set_weights&#39; received inputs with unexpected names: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="153 "></span>            <span class=n>incompatible</span><span class=o>.</span><span class=n>unexpected_keys</span>
<span class=linenos data-linenos="154 "></span>        <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.train class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>train</span><span class=p>(</span><span class=n>inputs</span><span class=p>,</span> <span class=n>targets</span><span class=p>,</span> <span class=n>kwargs</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="227 "></span><span class=k>def</span> <span class=nf>train</span><span class=p>(</span>
<span class=linenos data-linenos="228 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="229 "></span>    <span class=n>inputs</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span>
<span class=linenos data-linenos="230 "></span>    <span class=n>targets</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>,</span>
<span class=linenos data-linenos="231 "></span>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
<span class=linenos data-linenos="232 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="233 "></span>    <span class=c1># TODO: should we pass loss function here? and do the backward prop?</span>
<span class=linenos data-linenos="234 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>init_params</span><span class=p>:</span>
<span class=linenos data-linenos="235 "></span>        <span class=k>raise</span> <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="236 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>. Training has not been initialized, please initialize it beforehand&quot;</span>
<span class=linenos data-linenos="237 "></span>        <span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.common.models._torch.TorchModel.unflatten class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>unflatten</span><span class=p>(</span><span class=n>weights_vector</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Unflatten vectorized model weights using <a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/generated/torch.nn.utils.vector_to_parameters.html#torch.nn.utils.vector_to_parameters"><code>vector_to_parameters</code></a></p> <p>This method does not manipulate current model weights modify model parameters.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>weights_vector</code></td> <td> <code><!--typing.List[float]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a><!---->]</code> </td> <td><p>Vectorized model weights to convert dict</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--typing.Dict[str, torch.Tensor]--><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, torch.Tensor--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--torch.Tensor--><!--torch--><a class="autorefs autorefs-external" href="https://pytorch.org/docs/stable/torch.html#module-torch">torch</a><!---->.<!--torch.Tensor--><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a><!---->]</code> </td> <td><p>Model dictionary</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/common/models/_torch.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 93 "></span><span class=k>def</span> <span class=nf>unflatten</span><span class=p>(</span>
<span class=linenos data-linenos=" 94 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos=" 95 "></span>        <span class=n>weights_vector</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span>
<span class=linenos data-linenos=" 96 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>torch</span><span class=o>.</span><span class=n>Tensor</span><span class=p>]:</span>
<span class=linenos data-linenos=" 97 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Unflatten vectorized model weights using [`vector_to_parameters`][torch.nn.utils.vector_to_parameters]</span>
<span class=linenos data-linenos=" 98 "></span>
<span class=linenos data-linenos=" 99 "></span><span class=sd>    This method does not manipulate current model weights modify model parameters.</span>
<span class=linenos data-linenos="100 "></span>
<span class=linenos data-linenos="101 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="102 "></span><span class=sd>        weights_vector: Vectorized model weights to convert dict</span>
<span class=linenos data-linenos="103 "></span>
<span class=linenos data-linenos="104 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="105 "></span><span class=sd>        Model dictionary</span>
<span class=linenos data-linenos="106 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="107 "></span>
<span class=linenos data-linenos="108 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>unflatten</span><span class=p>(</span><span class=n>weights_vector</span><span class=p>)</span>
<span class=linenos data-linenos="109 "></span>
<span class=linenos data-linenos="110 "></span>    <span class=c1># Copy model to make sure global model parameters won&#39;t be overwritten</span>
<span class=linenos data-linenos="111 "></span>    <span class=n>model</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=p>)</span>
<span class=linenos data-linenos="112 "></span>    <span class=n>vector</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>as_tensor</span><span class=p>(</span><span class=n>weights_vector</span><span class=p>)</span><span class=o>.</span><span class=n>type</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>DoubleTensor</span><span class=p>)</span>
<span class=linenos data-linenos="113 "></span>
<span class=linenos data-linenos="114 "></span>    <span class=c1># Following operation updates model parameters of copied model object</span>
<span class=linenos data-linenos="115 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="116 "></span>        <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>utils</span><span class=o>.</span><span class=n>vector_to_parameters</span><span class=p>(</span><span class=n>vector</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>parameters</span><span class=p>())</span>
<span class=linenos data-linenos="117 "></span>    <span class=k>except</span> <span class=ne>TypeError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos="118 "></span>        <span class=n>FedbiomedModelError</span><span class=p>(</span>
<span class=linenos data-linenos="119 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB622</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2> Can not unflatten model parameters. </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="120 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="121 "></span>
<span class=linenos data-linenos="122 "></span>    <span class=k>return</span> <span class=n>TorchModel</span><span class=p>(</span><span class=n>model</span><span class=p>)</span><span class=o>.</span><span class=n>get_weights</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <div class=right-col> <div id=right-sidebar class=sidebar-right> <nav class=toc> <!-- Render item list --> <label class=toc-title for=__toc> <span class=toc-icon></span> </label> <ul class=toc-list data-md-component=toc data-md-scrollfix> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models-classes class=md-nav__link> Classes </a> <nav class=toc-nav aria-label=Classes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.BaseSkLearnModel class=md-nav__link> BaseSkLearnModel </a> <nav class=toc-nav aria-label=BaseSkLearnModel> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.BaseSkLearnModel-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.is_classification class=md-nav__link> is_classification </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.model class=md-nav__link> model </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.param_list class=md-nav__link> param_list </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.BaseSkLearnModel-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.apply_updates class=md-nav__link> apply_updates() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.disable_internal_optimizer class=md-nav__link> disable_internal_optimizer() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.enable_internal_optimizer class=md-nav__link> enable_internal_optimizer() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.export class=md-nav__link> export() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.flatten class=md-nav__link> flatten() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.get_gradients class=md-nav__link> get_gradients() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.get_learning_rate class=md-nav__link> get_learning_rate() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.get_params class=md-nav__link> get_params() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.get_weights class=md-nav__link> get_weights() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.init_training class=md-nav__link> init_training() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.predict class=md-nav__link> predict() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.set_gradients class=md-nav__link> set_gradients() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.set_init_params class=md-nav__link> set_init_params() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.set_params class=md-nav__link> set_params() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.set_weights class=md-nav__link> set_weights() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.train class=md-nav__link> train() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.BaseSkLearnModel.unflatten class=md-nav__link> unflatten() </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.MLPSklearnModel class=md-nav__link> MLPSklearnModel </a> <nav class=toc-nav aria-label=MLPSklearnModel> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.MLPSklearnModel-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.MLPSklearnModel.model class=md-nav__link> model </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.MLPSklearnModel-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.MLPSklearnModel.get_learning_rate class=md-nav__link> get_learning_rate() </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.Model class=md-nav__link> Model </a> <nav class=toc-nav aria-label=Model> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.Model-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.model class=md-nav__link> model </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.Model-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.apply_updates class=md-nav__link> apply_updates() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.export class=md-nav__link> export() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.flatten class=md-nav__link> flatten() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.get_gradients class=md-nav__link> get_gradients() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.get_weights class=md-nav__link> get_weights() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.init_training class=md-nav__link> init_training() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.predict class=md-nav__link> predict() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.reload class=md-nav__link> reload() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.set_model class=md-nav__link> set_model() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.set_weights class=md-nav__link> set_weights() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.train class=md-nav__link> train() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._model.Model.unflatten class=md-nav__link> unflatten() </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.SGDClassifierSKLearnModel class=md-nav__link> SGDClassifierSKLearnModel </a> <nav class=toc-nav aria-label=SGDClassifierSKLearnModel> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.SGDClassifierSKLearnModel-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.SGDClassifierSKLearnModel.is_classification class=md-nav__link> is_classification </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.SGDClassifierSKLearnModel.model class=md-nav__link> model </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.SGDClassifierSKLearnModel-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.SGDClassifierSKLearnModel.set_init_params class=md-nav__link> set_init_params() </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.SGDRegressorSKLearnModel class=md-nav__link> SGDRegressorSKLearnModel </a> <nav class=toc-nav aria-label=SGDRegressorSKLearnModel> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.SGDRegressorSKLearnModel-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.SGDRegressorSKLearnModel.is_classification class=md-nav__link> is_classification </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.SGDRegressorSKLearnModel.model class=md-nav__link> model </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.SGDRegressorSKLearnModel-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._sklearn.SGDRegressorSKLearnModel.set_init_params class=md-nav__link> set_init_params() </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.SkLearnModel class=md-nav__link> SkLearnModel </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.TorchModel class=md-nav__link> TorchModel </a> <nav class=toc-nav aria-label=TorchModel> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.TorchModel-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.init_params class=md-nav__link> init_params </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.model class=md-nav__link> model </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models.TorchModel-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.add_corrections_to_gradients class=md-nav__link> add_corrections_to_gradients() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.apply_updates class=md-nav__link> apply_updates() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.export class=md-nav__link> export() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.flatten class=md-nav__link> flatten() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.get_gradients class=md-nav__link> get_gradients() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.get_weights class=md-nav__link> get_weights() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.init_training class=md-nav__link> init_training() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.predict class=md-nav__link> predict() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.send_to_device class=md-nav__link> send_to_device() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.set_weights class=md-nav__link> set_weights() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.train class=md-nav__link> train() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.common.models._torch.TorchModel.unflatten class=md-nav__link> unflatten() </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> </div> <!-- News Main Page--> </div> <footer> <div class=container-fluid> <div class=footer-first-inner> <div class=container> <div class=row> <div class=col-md-6> <div class=footer-contact> <strong>Address:</strong> <p>2004 Rte des Lucioles, 06902 Sophia Antipolis</p> <strong>E-mail:</strong> <p>fedbiomed _at_ inria _dot_ fr</p> </div> </div> <div class=col-md-6> <div class=footer-contact> <p>Fed-BioMed © 2022</p> </div> </div> </div> </div> </div> </div> </footer> <!-- JQuery --> <script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script> <!-- Latest compiled and minified JavaScript --> <script src=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../../assets/javascript/lunr.js></script> <script src=../../../../assets/javascript/theme.js></script> </body> </html>