<!DOCTYPE html><html> <head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1"><meta name=robots context="index, archive"><!--  --><script>
      const versions_json = "../../../versions.json";
      const search_worker_js = "../../assets/javascript/search-worker.js";
      const search_index_json = "../../search/search_index.json";
      const base_url = '../..';
    </script><!-- Site title --><title>Basic Example - Fed-BioMed</title><link rel=icon type=image/x-icon href=../../favicon.ico><!-- Page description --><meta name=description content="Open, Transparent and Trusted Collaborative Learning for Real-world Healthcare Applications"><!-- Page keywords --><!-- Page author --><!-- Latest compiled and minified CSS --><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><!-- Bootstrap Icons --><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link href=../../assets/_mkdocstrings.css rel=stylesheet><link href=../../assets/css/style.css rel=stylesheet></head> <body> <header> <div class="container-fluid top-bar"> <div class=brand> <a href=/ > <img src=../../assets/img/fedbiomed-logo-small.png> </a> </div> <nav class=top> <ul> <li class> <a href=../..>Home</a> </li> <li class> <a href=../what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../#funding>Funding</a> </li> <li class> <a href=../../news/ >News</a> </li> <li class> <a href=../../#contributors>Contributors</a> </li> <li class> <a href=../../#users>Users</a> </li> <li class> <a href=../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class="container-fluid top-bar-mobile"> <div class=mobile-bar> <div class=brand> <a href=../../ > <img src=../../assets/img/fedbiomed-logo-small.png> </a> </div> <div class=hum-menu> <img class=open src=../../assets/img/menu.svg> <img class=close style=display:none src=../../assets/img/cancel.svg> </div> </div> <nav class=top-mobile> <ul> <li class> <a href=../..>Home</a> </li> <li class> <a href=../what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../#funding>Funding</a> </li> <li class> <a href=../../news/ >News</a> </li> <li class> <a href=../../#contributors>Contributors</a> </li> <li class> <a href=../../#users>Users</a> </li> <li class> <a href=../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> </header> <div class=main> <!-- Home page --> <div class=container-fluid> <div class=doc-row> <div class=left-col> <div class=sidebar-doc> <nav class=sidebar-inner> <ul class="sidebar-menu-left sub"> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Getting Started <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li class> <a href=../what-is-fedbiomed/ class>What's Fed-BioMed</a> </li> <li class> <a href=../fedbiomed-architecture/ class>Fedbiomed Architecture</a> </li> <li class> <a href=../fedbiomed-workflow/ class>Fedbiomed Workflow</a> </li> <li class> <a href=../installation/ class>Installation</a> </li> <li class=current> <a href=./ class="link current">Basic Example</a> </li> <li class> <a href=../configuration/ class>Configuration</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Tutorials <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> PyTorch <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../tutorials/pytorch/01_PyTorch_MNIST_Single_Node_Tutorial/ class>PyTorch MNIST Basic Example</a> </li> <li class> <a href=../../tutorials/pytorch/02_Create_Your_Custom_Training_Plan/ class>How to Create Your Custom PyTorch Training Plan</a> </li> <li class> <a href=../../tutorials/pytorch/03_PyTorch_Used_Cars_Dataset_Example/ class>PyTorch Used Cars Dataset Example</a> </li> <li class> <a href=../../tutorials/pytorch/04-Aggregation_in_Fed-BioMed/ class>PyTorch aggregation methods in Fed-BioMed</a> </li> <li class> <a href=../../tutorials/pytorch/05_Transfer-learning_tutorial_usingDenseNet-121/ class>Transfer-learning in Fed-BioMed tutorial</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> MONAI <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../tutorials/monai/01_monai-2d-image-classification/ class>Federated 2d image classification with MONAI</a> </li> <li class> <a href=../../tutorials/monai/02_monai-2d-image-registration/ class>Federated 2d XRay registration with MONAI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Scikit-Learn <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../tutorials/scikit-learn/01_sklearn_MNIST_classification_tutorial/ class>MNIST classification with Scikit-Learn Classifier (Perceptron)</a> </li> <li class> <a href=../../tutorials/scikit-learn/02_sklearn_sgd_regressor_tutorial/ class>Fed-BioMed to train a federated SGD regressor model</a> </li> <li class> <a href=../../tutorials/scikit-learn/03-other-scikit-learn-models/ class>Implementing other Scikit Learn models for Federated Learning</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Optimizers <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../tutorials/optimizers/01-fedopt-and-scaffold/ class>Advanced optimizers in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> FLamby <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../tutorials/flamby/flamby/ class>General Concepts</a> </li> <li class> <a href=../../tutorials/flamby/flamby-integration-into-fedbiomed/ class>FLamby integration in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Advanced <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../tutorials/advanced/in-depth-experiment-configuration/ class>In Depth Experiment Configuration</a> </li> <li class> <a href=../../tutorials/advanced/training-with-gpu/ class>PyTorch model training using a GPU</a> </li> <li class> <a href=../../tutorials/advanced/breakpoints/ class>Breakpoints</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Security <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../tutorials/security/differential-privacy-with-opacus-on-fedbiomed/ class>Using Differential Privacy with OPACUS on Fed-BioMed</a> </li> <li class> <a href=../../tutorials/security/non-private-local-central-dp-monai-2d-image-registration/ class>Local and Central DP with Fed-BioMed: MONAI 2d image registration</a> </li> <li class> <a href=../../tutorials/security/training-with-approved-training-plans/ class>Training Process with Training Plan Management</a> </li> <li class> <a href=../../tutorials/security/secure-aggregation/ class>Training with Secure Aggregation</a> </li> <li class> <a href=../../tutorials/concrete-ml/concrete-ml/ class>End-to-end Privacy Preserving Training and Inference on Medical Data</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Biomedical data <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../tutorials/medical/medical-image-segmentation-unet-library/ class>Brain Segmentation</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> User Guide <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../user-guide/glossary/ class>Glossary</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Deployment <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../user-guide/deployment/deployment/ class>Introduction</a> </li> <li class> <a href=../../user-guide/deployment/deployment-vpn/ class>VPN Deployment</a> </li> <li class> <a href=../../user-guide/deployment/matrix/ class>Network matrix</a> </li> <li class> <a href=../../user-guide/deployment/security-model/ class>Security model</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../user-guide/nodes/configuring-nodes/ class>Configuring Nodes</a> </li> <li class> <a href=../../user-guide/nodes/deploying-datasets/ class>Deploying Datasets</a> </li> <li class> <a href=../../user-guide/nodes/training-plan-security-manager/ class>Training Plan Management</a> </li> <li class> <a href=../../user-guide/nodes/using-gpu/ class>Using GPU</a> </li> <li class> <a href=../../user-guide/nodes/node-gui/ class>Node GUI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../user-guide/researcher/training-plan/ class>Training Plan</a> </li> <li class> <a href=../../user-guide/researcher/training-data/ class>Training Data</a> </li> <li class> <a href=../../user-guide/researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../user-guide/researcher/aggregation/ class>Aggregation</a> </li> <li class> <a href=../../user-guide/researcher/listing-datasets-and-selecting-nodes/ class>Listing Datasets and Selecting Nodes</a> </li> <li class> <a href=../../user-guide/researcher/model-testing-during-federated-training/ class>Model Validation on the Node Side</a> </li> <li class> <a href=../../user-guide/researcher/tensorboard/ class>Tensorboard</a> </li> </ul> </li> <li class> <a href=../../user-guide/advanced-optimization/ class>Optimization</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Secure Aggregation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../user-guide/secagg/introduction/ class>Introduction</a> </li> <li class> <a href=../../user-guide/secagg/configuration/ class>Configuration</a> </li> <li class> <a href=../../user-guide/secagg/researcher-interface/ class>Managing Secure Aggregation in Researcher</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Developer <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> API Reference <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Common <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../developer/api/common/certificate_manager/ class>Certificate Manager</a> </li> <li class> <a href=../../developer/api/common/cli/ class>CLI</a> </li> <li class> <a href=../../developer/api/common/config/ class>Config</a> </li> <li class> <a href=../../developer/api/common/constants/ class>Constants</a> </li> <li class> <a href=../../developer/api/common/data/ class>Data</a> </li> <li class> <a href=../../developer/api/common/db/ class>DB</a> </li> <li class> <a href=../../developer/api/common/exceptions/ class>Exceptions</a> </li> <li class> <a href=../../developer/api/common/ipython/ class>IPython</a> </li> <li class> <a href=../../developer/api/common/json/ class>Json</a> </li> <li class> <a href=../../developer/api/common/logger/ class>Logger</a> </li> <li class> <a href=../../developer/api/common/message/ class>Message</a> </li> <li class> <a href=../../developer/api/common/metrics/ class>Metrics</a> </li> <li class> <a href=../../developer/api/common/models/ class>Model</a> </li> <li class> <a class href=../../developer/api/common/mpc_controller.md>MPC controller</a> </li> <li class> <a href=../../developer/api/common/optimizers/ class>Optimizers</a> </li> <li class> <a href=../../developer/api/common/privacy/ class>Privacy</a> </li> <li class> <a href=../../developer/api/common/secagg/ class>Secagg</a> </li> <li class> <a href=../../developer/api/common/secagg_manager/ class>Secagg Manager</a> </li> <li class> <a href=../../developer/api/common/serializer/ class>Serializer</a> </li> <li class> <a href=../../developer/api/common/singleton/ class>Singleton</a> </li> <li class> <a href=../../developer/api/common/synchro/ class>Synchro</a> </li> <li class> <a href=../../developer/api/common/tasks_queue/ class>TasksQueue</a> </li> <li class> <a href=../../developer/api/common/training_plans/ class>TrainingPlans</a> </li> <li class> <a href=../../developer/api/common/training_args/ class>TrainingArgs</a> </li> <li class> <a href=../../developer/api/common/utils/ class>Utils</a> </li> <li class> <a href=../../developer/api/common/validator/ class>Validator</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../developer/api/node/cli/ class>CLI</a> </li> <li class> <a href=../../developer/api/node/cli_utils/ class>CLI Utils</a> </li> <li class> <a href=../../developer/api/node/config/ class>Config</a> </li> <li class> <a href=../../developer/api/node/dataset_manager/ class>DatasetManager</a> </li> <li class> <a href=../../developer/api/node/history_monitor/ class>HistoryMonitor</a> </li> <li class> <a href=../../developer/api/node/node/ class>Node</a> </li> <li class> <a href=../../developer/api/node/node_state_manager/ class>NodeStateManager</a> </li> <li class> <a href=../../developer/api/node/requests/ class>Requests</a> </li> <li class> <a href=../../developer/api/node/round/ class>Round</a> </li> <li class> <a href=../../developer/api/node/secagg/ class>Secagg</a> </li> <li class> <a href=../../developer/api/node/secagg_manager/ class>Secagg Manager</a> </li> <li class> <a href=../../developer/api/node/training_plan_security_manager/ class>TrainingPlanSecurityManager</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../developer/api/researcher/aggregators/ class>Aggregators</a> </li> <li class> <a href=../../developer/api/researcher/cli/ class>CLI</a> </li> <li class> <a href=../../developer/api/researcher/config/ class>Config</a> </li> <li class> <a href=../../developer/api/researcher/datasets/ class>Datasets</a> </li> <li class> <a href=../../developer/api/researcher/federated_workflows/ class>Federated Workflows</a> </li> <li class> <a href=../../developer/api/researcher/filetools/ class>Filetools</a> </li> <li class> <a href=../../developer/api/researcher/jobs/ class>Jobs</a> </li> <li class> <a href=../../developer/api/researcher/monitor/ class>Monitor</a> </li> <li class> <a href=../../developer/api/researcher/node_state_agent/ class>NodeStateAgent</a> </li> <li class> <a href=../../developer/api/researcher/requests/ class>Requests</a> </li> <li class> <a href=../../developer/api/researcher/secagg/ class>Secagg</a> </li> <li class> <a href=../../developer/api/researcher/strategies/ class>Strategies</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Transport <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../developer/api/transport/client/ class>Client</a> </li> <li class> <a href=../../developer/api/transport/controller/ class>Controller</a> </li> <li class> <a href=../../developer/api/transport/node_agent/ class>NodeAgent</a> </li> <li class> <a href=../../developer/api/transport/server/ class>Server</a> </li> </ul> </li> </ul> </li> <li class> <a href=../../developer/usage_and_tools/ class>Usage and Tools</a> </li> <li class> <a href=../../developer/ci/ class>Continuous Integration</a> </li> <li class> <a href=../../developer/definition-of-done/ class>Definition of Done</a> </li> <li class> <a href=../../developer/development-environment/ class>Development Environment</a> </li> <li class> <a href=../../developer/testing-in-fedbiomed/ class>Testing in Fed-BioMed</a> </li> <li class> <a href=../../developer/messaging/ class>RPC Protocol and Messages</a> </li> </ul> </li> <li class> <a href=../../support/troubleshooting/ class>FAQ & Troubleshooting</a> </li> </ul> </nav> </div> </div> <div class=main-col> <main class=main-docs> <article> <h1 id=basic-collaborative-learning-setup>Basic Collaborative Learning Setup</h1> <p>Fed-BioMed enables users to quickly create a basic collaborative learning setup within seconds, providing an intuitive framework for exploring federated learning. This article serves as a comprehensive guide, walking you through the process of creating multiple nodes, designing a training plan for collaborative learning, and executing an experiment that performs model training.</p> <h2 id=setup-your-working-directory>Setup your working directory</h2> <p>It is essential to set up a dedicated working directory in your local environment to organize all Fed-BioMed components. Additionally, create a <code>data</code> directory within the working directory to store the dataset that will be used in this guide.</p> <h2 id=create-your-nodes>Create your nodes</h2> <p>The following two commands will create two node components. The directory that components will be initialized will be relative to the path that these commands are executed. Therefore, please make sure that you changed your directory to the working directory that you've created for Fed-BioMed.</p> <div class=highlight><pre><span></span><code>fedbiomed component create -c node -p ./fbm-node
fedbiomed component create -c node -p ./fbm-second-node
</code></pre></div> <h2 id=deploy-mnist-dataset>Deploy MNIST Dataset</h2> <p>The Fed-BioMed CLI comes with a predefined MNIST dataset configuration that automatically downloads the MNIST dataset and deploys it onto the nodes. The following commands will download the MNIST dataset into the <code>data</code> directory you created and deploy it to <code>my-node</code> and <code>my-second-node</code>.</p> <div class=highlight><pre><span></span><code>fedbiomed node -p ./fbm-node dataset add --mnist
fedbiomed node -p ./fbm-second-node dataset add --mnist
</code></pre></div> <h2 id=start-your-nodes>Start your Nodes</h2> <p>Please open a separate terminal window and start your nodes by running the appropriate commands for each node in their respective directories. For example:</p> <ol> <li> <p>For <code>fbm-node</code>, run: <div class=highlight><pre><span></span><code>fedbiomed<span class=w> </span>node<span class=w> </span>--path<span class=w> </span>./fbm-node<span class=w> </span>start
</code></pre></div></p> </li> <li> <p>For <code>fbm-second-node</code>, run: <div class=highlight><pre><span></span><code>fedbiomed<span class=w> </span>node<span class=w> </span>--path<span class=w> </span>./fbm-second-node<span class=w> </span>start
</code></pre></div></p> </li> </ol> <p>Ensure each node is started in its own terminal window so that both can run concurrently.</p> <h2 id=researcher>Researcher</h2> <p>The Researcher component is the central entity that orchestrates the collaborative learning experiment across multiple nodes by allowing users to define the training plan and experiment.</p> <p>To create your Researcher component in the same working directory, execute the following command:</p> <div class=highlight><pre><span></span><code>fedbiomed<span class=w> </span>component<span class=w> </span>create<span class=w> </span>-c<span class=w> </span>researcher
</code></pre></div> <p>The command above will create a <code>fbm-researcher</code> folder in your working directory, where the Researcher component assets will be stored. By starting the Researcher component, you will launch a Jupyter Notebook that is configured to use the Researcher component created in your working directory.</p> <p>To start the Researcher component, run the following command:</p> <div class=highlight><pre><span></span><code>fedbiomed<span class=w> </span>researcher<span class=w> </span>start
</code></pre></div> <p>This will open a Jupyter Notebook, allowing you to interact with the Researcher component and begin configuring your collaborative learning experiment.</p> <h3 id=create-and-train-your-federated-learning-model>Create and train your Federated Learning model</h3> <p>Fed-BioMed does not require you to modify your machine learning models to perform collaborative learning. Instead, it requires you to create a training plan where you can integrate your existing model, optimizer, and training steps. The following example demonstrates how to define a training plan using an existing PyTorch model and training loop.</p> <p><br> Template of a <strong>model definition</strong> in Pytorch (left) and in Fed-BioMed using Pytorch (right) <br></p> <table> <thead> <tr> <th style="text-align: center;">Classical Pytorch</th> <th style="text-align: center;">Fed-BioMed</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;"><img alt="alt text" src=../../assets/img/getting-started/classical-pytorch-model-definition.jpg></td> <td style="text-align: center;"><img alt=fed-bio-med src=../../assets/img/getting-started/fedbiomed-pytorch-model-definition.jpg></td> </tr> </tbody> </table> <p><br><br> Template of a <strong>model training loop</strong> in Pytorch (left) and in Fed-BioMed using Pytorch (right)</p> <table> <thead> <tr> <th style="text-align: center;">Classical Pytorch</th> <th style="text-align: center;">Fed-BioMed</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;"><img alt=classic-pytroch src=../../assets/img/getting-started/classical-pytorch-training.jpg></td> <td style="text-align: center;"><img alt=fed-bio-med-pytorch src=../../assets/img/getting-started/fedbiomed-experiment-definition.jpg></td> </tr> </tbody> </table> <h2 id=executing-your-training>Executing your training</h2> <p>Once the Jupyter Notebook has started, you can define your training plan and set up your experiment. After configuring the necessary parameters, you can execute your experiment to initiate the collaborative learning process.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>torch</span>
<span class=kn>import</span> <span class=nn>torch.nn</span> <span class=k>as</span> <span class=nn>nn</span>
<span class=kn>import</span> <span class=nn>torch.nn.functional</span> <span class=k>as</span> <span class=nn>F</span>
<span class=kn>from</span> <span class=nn>torchvision</span> <span class=kn>import</span> <span class=n>datasets</span><span class=p>,</span> <span class=n>transforms</span>
<span class=kn>from</span> <span class=nn>fedbiomed.common.training_plans</span> <span class=kn>import</span> <span class=n>TorchTrainingPlan</span>
<span class=kn>from</span> <span class=nn>fedbiomed.common.data</span> <span class=kn>import</span> <span class=n>DataManager</span>


<span class=k>class</span> <span class=nc>MyRemoteTrainingPlan</span><span class=p>(</span><span class=n>TorchTrainingPlan</span><span class=p>):</span>

    <span class=k>def</span> <span class=nf>init_model</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>Net</span><span class=p>()</span>

    <span class=k>def</span> <span class=nf>init_optimizer</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=n>torch</span><span class=o>.</span><span class=n>optim</span><span class=o>.</span><span class=n>SGD</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>parameters</span><span class=p>(),</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.01</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>init_dependencies</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=p>[</span><span class=s2>&quot;from torchvision import datasets, transforms&quot;</span><span class=p>]</span>

    <span class=k>class</span> <span class=nc>Net</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
        <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model_args</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=p>{}):</span>
            <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>in_features</span> <span class=o>=</span> <span class=mi>28</span><span class=o>*</span><span class=mi>28</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>out_features</span> <span class=o>=</span> <span class=mi>10</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>fc1</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>in_features</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>fc2</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>out_features</span><span class=p>)</span>


        <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
            <span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>28</span><span class=o>*</span><span class=mi>28</span><span class=p>)</span>
            <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fc1</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
            <span class=n>x</span> <span class=o>=</span> <span class=n>F</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
            <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fc2</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
            <span class=n>output</span> <span class=o>=</span> <span class=n>F</span><span class=o>.</span><span class=n>log_softmax</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>dim</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>output</span>

    <span class=k>def</span> <span class=nf>training_step</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>target</span><span class=p>):</span>
        <span class=n>output</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
        <span class=n>loss</span>   <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>functional</span><span class=o>.</span><span class=n>nll_loss</span><span class=p>(</span><span class=n>output</span><span class=p>,</span> <span class=n>target</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>loss</span>

    <span class=k>def</span> <span class=nf>training_data</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=c1># Custom torch Dataloader for MNIST data</span>
        <span class=n>transform</span> <span class=o>=</span> <span class=n>transforms</span><span class=o>.</span><span class=n>Compose</span><span class=p>([</span><span class=n>transforms</span><span class=o>.</span><span class=n>ToTensor</span><span class=p>(),</span>
        <span class=n>transforms</span><span class=o>.</span><span class=n>Normalize</span><span class=p>((</span><span class=mf>0.1307</span><span class=p>,),</span> <span class=p>(</span><span class=mf>0.3081</span><span class=p>,))])</span>
        <span class=n>mnist_dataset</span> <span class=o>=</span> <span class=n>datasets</span><span class=o>.</span><span class=n>MNIST</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dataset_path</span><span class=p>,</span>
                                       <span class=n>train</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                       <span class=n>download</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                                       <span class=n>transform</span><span class=o>=</span><span class=n>transform</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>DataManager</span><span class=p>(</span><span class=n>mnist_dataset</span><span class=p>,</span>  <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <p>Next, create your training arguments and experiment, then initiate collaborative learning using the two previously started nodes.</p> <div class=highlight><pre><span></span><code><span class=n>model_args</span> <span class=o>=</span> <span class=p>{}</span>

<span class=n>training_args</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;loader_args&#39;</span><span class=p>:</span> <span class=p>{</span>
        <span class=s1>&#39;batch_size&#39;</span><span class=p>:</span> <span class=mi>48</span><span class=p>,</span>
    <span class=p>},</span>
    <span class=s1>&#39;epochs&#39;</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>
    <span class=s1>&#39;dry_run&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
<span class=p>}</span>

<span class=kn>from</span> <span class=nn>fedbiomed.researcher.federated_workflows</span> <span class=kn>import</span> <span class=n>Experiment</span>
<span class=kn>from</span> <span class=nn>fedbiomed.researcher.aggregators.fedavg</span> <span class=kn>import</span> <span class=n>FedAverage</span>

<span class=n>tags</span> <span class=o>=</span>  <span class=p>[</span><span class=s1>&#39;#MNIST&#39;</span><span class=p>,</span> <span class=s1>&#39;#dataset&#39;</span><span class=p>]</span>
<span class=n>rounds</span> <span class=o>=</span> <span class=mi>2</span>

<span class=c1># model training</span>
<span class=n>exp</span> <span class=o>=</span> <span class=n>Experiment</span><span class=p>(</span><span class=n>tags</span><span class=o>=</span><span class=n>tags</span><span class=p>,</span>
                 <span class=n>model_args</span><span class=o>=</span><span class=n>model_args</span><span class=p>,</span>
                 <span class=n>training_plan_class</span><span class=o>=</span><span class=n>MyRemoteTrainingPlan</span><span class=p>,</span>
                 <span class=n>training_args</span><span class=o>=</span><span class=n>training_args</span><span class=p>,</span>
                 <span class=n>round_limit</span><span class=o>=</span><span class=n>rounds</span><span class=p>,</span>
                 <span class=n>aggregator</span><span class=o>=</span><span class=n>FedAverage</span><span class=p>(),</span>
                 <span class=n>node_selection_strategy</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
<span class=n>exp</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>

<span class=c1># model saving</span>
<span class=n>exp</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>export_model</span><span class=p>(</span><span class=s1>&#39;./my_trained_model&#39;</span><span class=p>)</span>
</code></pre></div> <h2 id=going-further>Going Further</h2> <p>Please visit the <a href=../configuration/ >Configuration Guide</a> to learn more about using the Fed-BioMed CLI to initialize and manage Fed-BioMed components. The Configuration Guide will help you establish the basics of Fed-BioMed federated learning infrastructure needed to follow the tutorials provided in this documentation.</p> </article> </main> </div> <div class=right-col> <div id=right-sidebar class=sidebar-right> <nav class=toc> <!-- Render item list --> <label class=toc-title for=__toc> <span class=toc-icon></span> </label> <ul class=toc-list data-md-component=toc data-md-scrollfix> <!-- Table of contents item --> <li class=toc-item> <a href=#setup-your-working-directory class=md-nav__link> Setup your working directory </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#create-your-nodes class=md-nav__link> Create your nodes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#deploy-mnist-dataset class=md-nav__link> Deploy MNIST Dataset </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#start-your-nodes class=md-nav__link> Start your Nodes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#researcher class=md-nav__link> Researcher </a> <nav class=toc-nav aria-label=Researcher> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#create-and-train-your-federated-learning-model class=md-nav__link> Create and train your Federated Learning model </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#executing-your-training class=md-nav__link> Executing your training </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#going-further class=md-nav__link> Going Further </a> </li> </ul> </nav> </div> </div> </div> </div> <!-- News Main Page--> </div> <footer> <div class=container-fluid> <div class=footer-first-inner> <div class=container> <div class=row> <div class=col-md-6> <div class=footer-contact> <strong>Address:</strong> <p>2004 Rte des Lucioles, 06902 Sophia Antipolis</p> <strong>E-mail:</strong> <p>fedbiomed _at_ inria _dot_ fr</p> </div> </div> <div class=col-md-6> <div class=footer-contact> <p>Fed-BioMed © 2022</p> </div> </div> </div> </div> </div> </div> </footer> <!-- JQuery --> <script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script> <!-- Latest compiled and minified JavaScript --> <script src=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../assets/javascript/lunr.js></script> <script src=../../assets/javascript/theme.js></script> <!-- GitHub buttons --> <script async defer src=https://buttons.github.io/buttons.js></script> </body> </html>