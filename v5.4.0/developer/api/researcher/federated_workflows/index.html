<!DOCTYPE html><html> <head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1"><meta name=robots context="index, archive"><!--  --><script>
      const versions_json = "../../../../../versions.json";
      const search_worker_js = "../../../../assets/javascript/search-worker.js";
      const search_index_json = "../../../../search/search_index.json";
      const base_url = '../../../..';
    </script><!-- Site title --><title>Federated Workflows - Fed-BioMed</title><link rel=icon type=image/x-icon href=../../../../favicon.ico><!-- Page description --><meta name=description content="Open, Transparent and Trusted Collaborative Learning for Real-world Healthcare Applications"><!-- Page keywords --><!-- Page author --><!-- Latest compiled and minified CSS --><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><!-- Bootstrap Icons --><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link href=../../../../assets/_mkdocstrings.css rel=stylesheet><link href=../../../../assets/css/style.css rel=stylesheet></head> <body> <header> <div class="container-fluid top-bar"> <div class=brand> <a href=/ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <nav class=top> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class="container-fluid top-bar-mobile"> <div class=mobile-bar> <div class=brand> <a href=../../../../ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <div class=hum-menu> <img class=open src=../../../../assets/img/menu.svg> <img class=close style=display:none src=../../../../assets/img/cancel.svg> </div> </div> <nav class=top-mobile> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> </header> <div class=main> <!-- Home page --> <div class=container-fluid> <div class=doc-row> <div class=left-col> <div class=sidebar-doc> <nav class=sidebar-inner> <ul class="sidebar-menu-left sub"> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Getting Started <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ class>What's Fed-BioMed</a> </li> <li class> <a href=../../../../getting-started/getting-started/ class>Basic Example</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-architecture/ class>Fedbiomed Architecture</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-workflow/ class>Fedbiomed Workflow</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Tutorials <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Installation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/installation/0-basic-software-installation/ class>Software Installation</a> </li> <li class> <a href=../../../../tutorials/installation/1-setting-up-environment/ class>Setting Up Environment</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> PyTorch <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/pytorch/01_PyTorch_MNIST_Single_Node_Tutorial/ class>PyTorch MNIST Basic Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/02_Create_Your_Custom_Training_Plan/ class>How to Create Your Custom PyTorch Training Plan</a> </li> <li class> <a href=../../../../tutorials/pytorch/03_PyTorch_Used_Cars_Dataset_Example/ class>PyTorch Used Cars Dataset Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/04-Aggregation_in_Fed-BioMed/ class>PyTorch aggregation methods in Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/pytorch/05_Transfer-learning_tutorial_usingDenseNet-121/ class>Transfer-learning in Fed-BioMed tutorial</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> MONAI <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/monai/01_monai-2d-image-classification/ class>Federated 2d image classification with MONAI</a> </li> <li class> <a href=../../../../tutorials/monai/02_monai-2d-image-registration/ class>Federated 2d XRay registration with MONAI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Scikit-Learn <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/scikit-learn/01_sklearn_MNIST_classification_tutorial/ class>MNIST classification with Scikit-Learn Classifier (Perceptron)</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/02_sklearn_sgd_regressor_tutorial/ class>Fed-BioMed to train a federated SGD regressor model</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/03-other-scikit-learn-models/ class>Implementing other Scikit Learn models for Federated Learning</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Optimizers <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/optimizers/01-fedopt-and-scaffold/ class>Advanced optimizers in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> FLamby <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/flamby/flamby/ class>General Concepts</a> </li> <li class> <a href=../../../../tutorials/flamby/flamby-integration-into-fedbiomed/ class>FLamby integration in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Advanced <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/advanced/in-depth-experiment-configuration/ class>In Depth Experiment Configuration</a> </li> <li class> <a href=../../../../tutorials/advanced/training-with-gpu/ class>PyTorch model training using a GPU</a> </li> <li class> <a href=../../../../tutorials/advanced/breakpoints/ class>Breakpoints</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Security <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/security/differential-privacy-with-opacus-on-fedbiomed/ class>Using Differential Privacy with OPACUS on Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/security/non-private-local-central-dp-monai-2d-image-registration/ class>Local and Central DP with Fed-BioMed: MONAI 2d image registration</a> </li> <li class> <a href=../../../../tutorials/security/training-with-approved-training-plans/ class>Training Process with Training Plan Management</a> </li> <li class> <a href=../../../../tutorials/security/secure-aggregation/ class>Training with Secure Aggregation</a> </li> <li class> <a href=../../../../tutorials/concrete-ml/concrete-ml/ class>End-to-end Privacy Preserving Training and Inference on Medical Data</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Biomedical data <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/medical/medical-image-segmentation-unet-library/ class>Brain Segmentation</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> User Guide <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/glossary/ class>Glossary</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Deployment <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/deployment/deployment/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/deployment/deployment-vpn/ class>VPN Deployment</a> </li> <li class> <a href=../../../../user-guide/deployment/matrix/ class>Network matrix</a> </li> <li class> <a href=../../../../user-guide/deployment/security-model/ class>Security model</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/nodes/configuring-nodes/ class>Configuring Nodes</a> </li> <li class> <a href=../../../../user-guide/nodes/deploying-datasets/ class>Deploying Datasets</a> </li> <li class> <a href=../../../../user-guide/nodes/training-plan-security-manager/ class>Training Plan Management</a> </li> <li class> <a href=../../../../user-guide/nodes/using-gpu/ class>Using GPU</a> </li> <li class> <a href=../../../../user-guide/nodes/node-gui/ class>Node GUI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/researcher/training-plan/ class>Training Plan</a> </li> <li class> <a href=../../../../user-guide/researcher/training-data/ class>Training Data</a> </li> <li class> <a href=../../../../user-guide/researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../../../user-guide/researcher/aggregation/ class>Aggregation</a> </li> <li class> <a href=../../../../user-guide/researcher/listing-datasets-and-selecting-nodes/ class>Listing Datasets and Selecting Nodes</a> </li> <li class> <a href=../../../../user-guide/researcher/model-testing-during-federated-training/ class>Model Validation on the Node Side</a> </li> <li class> <a href=../../../../user-guide/researcher/tensorboard/ class>Tensorboard</a> </li> </ul> </li> <li class> <a href=../../../../user-guide/advanced-optimization/ class>Optimization</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Secure Aggregation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/secagg/introduction/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/secagg/configuration/ class>Configuration</a> </li> <li class> <a href=../../../../user-guide/secagg/researcher-interface/ class>Managing Secure Aggregation in Researcher</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Developer <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> API Reference <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Common <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../common/certificate_manager/ class>Certificate Manager</a> </li> <li class> <a href=../../common/cli/ class>CLI</a> </li> <li class> <a href=../../common/config/ class>Config</a> </li> <li class> <a href=../../common/constants/ class>Constants</a> </li> <li class> <a href=../../common/data/ class>Data</a> </li> <li class> <a href=../../common/db/ class>DB</a> </li> <li class> <a href=../../common/environ/ class>Environ</a> </li> <li class> <a href=../../common/exceptions/ class>Exceptions</a> </li> <li class> <a href=../../common/ipython/ class>IPython</a> </li> <li class> <a href=../../common/json/ class>Json</a> </li> <li class> <a href=../../common/logger/ class>Logger</a> </li> <li class> <a href=../../common/message/ class>Message</a> </li> <li class> <a href=../../common/metrics/ class>Metrics</a> </li> <li class> <a href=../../common/models/ class>Model</a> </li> <li class> <a class href=../../common/mpc_controller.md>MPC controller</a> </li> <li class> <a href=../../common/optimizers/ class>Optimizers</a> </li> <li class> <a href=../../common/privacy/ class>Privacy</a> </li> <li class> <a href=../../common/secagg/ class>Secagg</a> </li> <li class> <a href=../../common/secagg_manager/ class>Secagg Manager</a> </li> <li class> <a href=../../common/serializer/ class>Serializer</a> </li> <li class> <a href=../../common/singleton/ class>Singleton</a> </li> <li class> <a href=../../common/synchro/ class>Synchro</a> </li> <li class> <a href=../../common/tasks_queue/ class>TasksQueue</a> </li> <li class> <a href=../../common/training_plans/ class>TrainingPlans</a> </li> <li class> <a href=../../common/training_args/ class>TrainingArgs</a> </li> <li class> <a href=../../common/utils/ class>Utils</a> </li> <li class> <a href=../../common/validator/ class>Validator</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../node/cli/ class>CLI</a> </li> <li class> <a href=../../node/cli_utils/ class>CLI Utils</a> </li> <li class> <a href=../../node/config/ class>Config</a> </li> <li class> <a href=../../node/dataset_manager/ class>DatasetManager</a> </li> <li class> <a href=../../node/environ/ class>Environ</a> </li> <li class> <a href=../../node/history_monitor/ class>HistoryMonitor</a> </li> <li class> <a href=../../node/node/ class>Node</a> </li> <li class> <a href=../../node/node_state_manager/ class>NodeStateManager</a> </li> <li class> <a href=../../node/requests/ class>Requests</a> </li> <li class> <a href=../../node/round/ class>Round</a> </li> <li class> <a href=../../node/secagg/ class>Secagg</a> </li> <li class> <a href=../../node/secagg_manager/ class>Secagg Manager</a> </li> <li class> <a href=../../node/training_plan_security_manager/ class>TrainingPlanSecurityManager</a> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li class> <a href=../aggregators/ class>Aggregators</a> </li> <li class> <a href=../cli/ class>CLI</a> </li> <li class> <a href=../config/ class>Config</a> </li> <li class> <a href=../datasets/ class>Datasets</a> </li> <li class> <a href=../environ/ class>Environ</a> </li> <li class=current> <a href=./ class="link current">Federated Workflows</a> </li> <li class> <a href=../filetools/ class>Filetools</a> </li> <li class> <a href=../jobs/ class>Jobs</a> </li> <li class> <a href=../monitor/ class>Monitor</a> </li> <li class> <a href=../node_state_agent/ class>NodeStateAgent</a> </li> <li class> <a href=../requests/ class>Requests</a> </li> <li class> <a href=../secagg/ class>Secagg</a> </li> <li class> <a href=../strategies/ class>Strategies</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Transport <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../transport/client/ class>Client</a> </li> <li class> <a href=../../transport/controller/ class>Controller</a> </li> <li class> <a href=../../transport/node_agent/ class>NodeAgent</a> </li> <li class> <a href=../../transport/server/ class>Server</a> </li> </ul> </li> </ul> </li> <li class> <a href=../../../usage_and_tools/ class>Usage and Tools</a> </li> <li class> <a href=../../../ci/ class>Continuous Integration</a> </li> <li class> <a href=../../../definition-of-done/ class>Definition of Done</a> </li> <li class> <a href=../../../testing-in-fedbiomed/ class>Testing in Fed-BioMed</a> </li> <li class> <a href=../../../messaging/ class>RPC Protocol and Messages</a> </li> </ul> </li> </ul> </nav> </div> </div> <div class=main-col> <main class=main-docs> <h1>Federated Workflows</h1> <article> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <div class="doc doc-children"> <h2 id=fedbiomed.researcher.federated_workflows-classes>Classes</h2> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.researcher.federated_workflows.Experiment class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">Experiment</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>Experiment</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>aggregator</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>agg_optimizer</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>node_selection_strategy</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>round_limit</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>tensorboard</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>retain_full_history</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="fedbiomed.researcher.federated_workflows._training_plan_workflow.TrainingPlanWorkflow" href="#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow">TrainingPlanWorkflow</a></code></p> <p>A Federated Learning Experiment based on a Training Plan.</p> <p>This class provides a comprehensive entry point for the management and orchestration of a FL experiment, including definition, execution, and interpretation of results.</p> <div class="admonition note"> <p class=admonition-title>Managing model parameters</p> <p>The model parameters should be managed through the corresponding methods in the training_plan by accessing the experiment's <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan"><code>training_plan()</code></a> attribute and using the <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans.BaseTrainingPlan.set_model_params"><code>set_model_params</code></a> and <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans.BaseTrainingPlan.get_model_params"><code>get_model_params</code></a> functions, e.g. <div class=highlight><pre><span></span><code><span class=n>exp</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>set_model_params</span><span class=p>(</span><span class=n>params_dict</span><span class=p>)</span>
</code></pre></div></p> </div> <div class="admonition warning"> <p class=admonition-title>Do not set the training plan attribute directly</p> <p>Setting the <code>training_plan</code> attribute directly is not allowed. Instead, use the <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_training_plan_class"><code>set_training_plan_class</code></a> method to set the training plan type, and the underlying model will be correctly constructed and initialized.</p> </div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>aggregator</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a>]</code> </td> <td> <div class=doc-md-description> <p>object defining the method for aggregating local updates. Default to None (use <a class="autorefs autorefs-internal" href="../aggregators/#fedbiomed.researcher.aggregators.FedAverage"><code>FedAverage</code></a> for aggregation)</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>agg_optimizer</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.optimizers.Optimizer" href="../../common/optimizers/#fedbiomed.common.optimizers.Optimizer">Optimizer</a>]</code> </td> <td> <div class=doc-md-description> <p><a class="autorefs autorefs-internal" href="../../common/optimizers/#fedbiomed.common.optimizers.Optimizer"><code>Optimizer</code></a> instance, to refine aggregated model updates prior to their application. If None, merely apply the aggregated updates.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>node_selection_strategy</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a>]</code> </td> <td> <div class=doc-md-description> <p>object defining how nodes are sampled at each round for training, and how non-responding nodes are managed. Defaults to None: - use <a class="autorefs autorefs-internal" href="../strategies/#fedbiomed.researcher.strategies.DefaultStrategy"><code>DefaultStrategy</code></a> if training_data is initialized - else strategy is None (cannot be initialized), experiment cannot be launched yet</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>round_limit</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, None]</code> </td> <td> <div class=doc-md-description> <p>the maximum number of training rounds (nodes &lt;-&gt; central server) that should be executed for the experiment. <code>None</code> means that no limit is defined. Defaults to None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>tensorboard</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>whether to save scalar values for displaying in Tensorboard during training for each node. Currently, it is only used for loss values. - If it is true, monitor instantiates a <code>Monitor</code> object that write scalar logs into <code>./runs</code> directory. - If it is False, it stops monitoring if it was active.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td><code>retain_full_history</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>whether to retain in memory the full history of node replies and aggregated params for the experiment. If False, only the last round's replies and aggregated params will be available. Defaults to True.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td> </td> <td> <div class=doc-md-description> <p>Extra positional arguments from parent class <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow"><code>TrainingPlanWorkflow</code></a></p> </div> </td> <td> <code>()</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Arguments of parent class <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow"><code>TrainingPlanWorkflow</code></a></p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 70 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos=" 71 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos=" 72 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos=" 73 "></span>    <span class=o>*</span><span class=n>args</span><span class=p>,</span>
<span class=linenos data-linenos=" 74 "></span>    <span class=n>aggregator</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Aggregator</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 75 "></span>    <span class=n>agg_optimizer</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Optimizer</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 76 "></span>    <span class=n>node_selection_strategy</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Strategy</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 77 "></span>    <span class=n>round_limit</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 78 "></span>    <span class=n>tensorboard</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=linenos data-linenos=" 79 "></span>    <span class=n>retain_full_history</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<span class=linenos data-linenos=" 80 "></span>    <span class=o>**</span><span class=n>kwargs</span>
<span class=linenos data-linenos=" 81 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos=" 82 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructor of the class.</span>
<span class=linenos data-linenos=" 83 "></span>
<span class=linenos data-linenos=" 84 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos=" 85 "></span><span class=sd>        aggregator: object defining the method for aggregating</span>
<span class=linenos data-linenos=" 86 "></span><span class=sd>            local updates. Default to None (use</span>
<span class=linenos data-linenos=" 87 "></span><span class=sd>            [`FedAverage`][fedbiomed.researcher.aggregators.FedAverage] for aggregation)</span>
<span class=linenos data-linenos=" 88 "></span>
<span class=linenos data-linenos=" 89 "></span><span class=sd>        agg_optimizer: [`Optimizer`][fedbiomed.common.optimizers.Optimizer] instance,</span>
<span class=linenos data-linenos=" 90 "></span><span class=sd>            to refine aggregated model updates prior to their application. If None,</span>
<span class=linenos data-linenos=" 91 "></span><span class=sd>            merely apply the aggregated updates.</span>
<span class=linenos data-linenos=" 92 "></span>
<span class=linenos data-linenos=" 93 "></span><span class=sd>        node_selection_strategy: object defining how nodes are sampled at</span>
<span class=linenos data-linenos=" 94 "></span><span class=sd>            each round for training, and how non-responding nodes are managed.</span>
<span class=linenos data-linenos=" 95 "></span><span class=sd>            Defaults to None:</span>
<span class=linenos data-linenos=" 96 "></span><span class=sd>            - use [`DefaultStrategy`][fedbiomed.researcher.strategies.DefaultStrategy]</span>
<span class=linenos data-linenos=" 97 "></span><span class=sd>                if training_data is initialized</span>
<span class=linenos data-linenos=" 98 "></span><span class=sd>            - else strategy is None (cannot be initialized), experiment cannot be launched yet</span>
<span class=linenos data-linenos=" 99 "></span>
<span class=linenos data-linenos="100 "></span><span class=sd>        round_limit: the maximum number of training rounds (nodes &lt;-&gt; central server)</span>
<span class=linenos data-linenos="101 "></span><span class=sd>            that should be executed for the experiment. `None` means that no limit is</span>
<span class=linenos data-linenos="102 "></span><span class=sd>            defined. Defaults to None.</span>
<span class=linenos data-linenos="103 "></span>
<span class=linenos data-linenos="104 "></span><span class=sd>        tensorboard: whether to save scalar values  for displaying in Tensorboard</span>
<span class=linenos data-linenos="105 "></span><span class=sd>            during training for each node. Currently, it is only used for loss values.</span>
<span class=linenos data-linenos="106 "></span><span class=sd>            - If it is true, monitor instantiates a `Monitor` object</span>
<span class=linenos data-linenos="107 "></span><span class=sd>                that write scalar logs into `./runs` directory.</span>
<span class=linenos data-linenos="108 "></span><span class=sd>            - If it is False, it stops monitoring if it was active.</span>
<span class=linenos data-linenos="109 "></span>
<span class=linenos data-linenos="110 "></span><span class=sd>        retain_full_history: whether to retain in memory the full history</span>
<span class=linenos data-linenos="111 "></span><span class=sd>            of node replies and aggregated params for the experiment. If False, only the</span>
<span class=linenos data-linenos="112 "></span><span class=sd>            last round&#39;s replies and aggregated params will be available. Defaults to True.</span>
<span class=linenos data-linenos="113 "></span><span class=sd>        *args: Extra positional arguments from parent class</span>
<span class=linenos data-linenos="114 "></span><span class=sd>            [`TrainingPlanWorkflow`][fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow]</span>
<span class=linenos data-linenos="115 "></span><span class=sd>        **kwargs: Arguments of parent class</span>
<span class=linenos data-linenos="116 "></span><span class=sd>            [`TrainingPlanWorkflow`][fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow]</span>
<span class=linenos data-linenos="117 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="118 "></span>    <span class=c1># define new members</span>
<span class=linenos data-linenos="119 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=p>:</span> <span class=n>Strategy</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="120 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="121 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="122 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="123 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_agg_optimizer</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="124 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>aggregator_args</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="125 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="126 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_replies</span><span class=p>:</span> <span class=n>Dict</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="127 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_retain_full_history</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="128 "></span>
<span class=linenos data-linenos="129 "></span>    <span class=c1># initialize object</span>
<span class=linenos data-linenos="130 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
<span class=linenos data-linenos="131 "></span>
<span class=linenos data-linenos="132 "></span>    <span class=c1># set self._aggregator : type Aggregator</span>
<span class=linenos data-linenos="133 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_aggregator</span><span class=p>(</span><span class=n>aggregator</span><span class=p>)</span>
<span class=linenos data-linenos="134 "></span>
<span class=linenos data-linenos="135 "></span>    <span class=c1># set self._agg_optimizer: type Optional[Optimizer]</span>
<span class=linenos data-linenos="136 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_agg_optimizer</span><span class=p>(</span><span class=n>agg_optimizer</span><span class=p>)</span>
<span class=linenos data-linenos="137 "></span>
<span class=linenos data-linenos="138 "></span>    <span class=c1># set self._node_selection_strategy: type Union[Strategy, None]</span>
<span class=linenos data-linenos="139 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_strategy</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=p>)</span>
<span class=linenos data-linenos="140 "></span>
<span class=linenos data-linenos="141 "></span>    <span class=c1># &quot;current&quot; means number of rounds already trained</span>
<span class=linenos data-linenos="142 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_set_round_current</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=linenos data-linenos="143 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_round_limit</span><span class=p>(</span><span class=n>round_limit</span><span class=p>)</span>
<span class=linenos data-linenos="144 "></span>
<span class=linenos data-linenos="145 "></span>    <span class=c1># always create a monitoring process</span>
<span class=linenos data-linenos="146 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span> <span class=o>=</span> <span class=n>Monitor</span><span class=p>()</span>
<span class=linenos data-linenos="147 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span><span class=o>.</span><span class=n>add_monitor_callback</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span><span class=o>.</span><span class=n>on_message_handler</span><span class=p>)</span>
<span class=linenos data-linenos="148 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_tensorboard</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>)</span>
<span class=linenos data-linenos="149 "></span>
<span class=linenos data-linenos="150 "></span>    <span class=c1># whether to retain the full experiment history or not</span>
<span class=linenos data-linenos="151 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_retain_full_history</span><span class=p>(</span><span class=n>retain_full_history</span><span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.researcher.federated_workflows.Experiment-attributes>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.aggregator_args class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">aggregator_args</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=n>aggregator_args</span> <span class=o>=</span> <span class=p>{}</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h4 id=fedbiomed.researcher.federated_workflows.Experiment-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.agg_optimizer class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">agg_optimizer</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>agg_optimizer</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the optional Optimizer used to refine aggregated model updates.</p> <p>To set or update that optimizer: <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_agg_optimizer"><code>set_agg_optimizer</code></a>.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.optimizers.Optimizer" href="../../common/optimizers/#fedbiomed.common.optimizers.Optimizer">Optimizer</a>]</code> </td> <td> <div class=doc-md-description> <p>An <a class="autorefs autorefs-internal" href="../../common/optimizers/#fedbiomed.common.optimizers.Optimizer">Optimizer</a> instance,</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.optimizers.Optimizer" href="../../common/optimizers/#fedbiomed.common.optimizers.Optimizer">Optimizer</a>]</code> </td> <td> <div class=doc-md-description> <p>or None.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="172 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="173 "></span><span class=k>def</span> <span class=nf>agg_optimizer</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Optimizer</span><span class=p>]:</span>
<span class=linenos data-linenos="174 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the optional Optimizer used to refine aggregated model updates.</span>
<span class=linenos data-linenos="175 "></span>
<span class=linenos data-linenos="176 "></span><span class=sd>    To set or update that optimizer:</span>
<span class=linenos data-linenos="177 "></span><span class=sd>    [`set_agg_optimizer`][fedbiomed.researcher.federated_workflows.Experiment.set_agg_optimizer].</span>
<span class=linenos data-linenos="178 "></span>
<span class=linenos data-linenos="179 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="180 "></span><span class=sd>        An [Optimizer][fedbiomed.common.optimizers.Optimizer] instance,</span>
<span class=linenos data-linenos="181 "></span><span class=sd>        or None.</span>
<span class=linenos data-linenos="182 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="183 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_agg_optimizer</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.aggregated_params class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">aggregated_params</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>aggregated_params</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves all aggregated parameters of each round of training</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>Dictionary of aggregated parameters keys stand for each round of training</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="300 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="301 "></span><span class=k>def</span> <span class=nf>aggregated_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="302 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves all aggregated parameters of each round of training</span>
<span class=linenos data-linenos="303 "></span>
<span class=linenos data-linenos="304 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="305 "></span><span class=sd>        Dictionary of aggregated parameters keys stand for each round of training</span>
<span class=linenos data-linenos="306 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="307 "></span>
<span class=linenos data-linenos="308 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.aggregator class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">aggregator</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>aggregator</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves aggregator class that will be used for aggregating model parameters.</p> <p>To set or update aggregator: <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_aggregator"><code>set_aggregator</code></a>.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a></code> </td> <td> <div class=doc-md-description> <p>A class or an object that is an instance of <a class="autorefs autorefs-internal" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a></p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="159 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="160 "></span><span class=k>def</span> <span class=nf>aggregator</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Aggregator</span><span class=p>:</span>
<span class=linenos data-linenos="161 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves aggregator class that will be used for aggregating model parameters.</span>
<span class=linenos data-linenos="162 "></span>
<span class=linenos data-linenos="163 "></span><span class=sd>    To set or update aggregator:</span>
<span class=linenos data-linenos="164 "></span><span class=sd>    [`set_aggregator`][fedbiomed.researcher.federated_workflows.Experiment.set_aggregator].</span>
<span class=linenos data-linenos="165 "></span>
<span class=linenos data-linenos="166 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="167 "></span><span class=sd>        A class or an object that is an instance of [Aggregator][fedbiomed.researcher.aggregators.Aggregator]</span>
<span class=linenos data-linenos="168 "></span>
<span class=linenos data-linenos="169 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="170 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.breakpoint class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">breakpoint</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nb>breakpoint</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Saves breakpoint with the state of the training at a current round.</p> <p>The following Experiment attributes will be saved:</p> <ul> <li>round_current</li> <li>round_limit</li> <li>aggregator</li> <li>agg_optimizer</li> <li>node_selection_strategy</li> <li>aggregated_params</li> </ul> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1036 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1037 "></span><span class=k>def</span> <span class=nf>breakpoint</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1038 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="1039 "></span><span class=sd>    Saves breakpoint with the state of the training at a current round.</span>
<span class=linenos data-linenos="1040 "></span>
<span class=linenos data-linenos="1041 "></span><span class=sd>    The following Experiment attributes will be saved:</span>
<span class=linenos data-linenos="1042 "></span>
<span class=linenos data-linenos="1043 "></span><span class=sd>      - round_current</span>
<span class=linenos data-linenos="1044 "></span><span class=sd>      - round_limit</span>
<span class=linenos data-linenos="1045 "></span><span class=sd>      - aggregator</span>
<span class=linenos data-linenos="1046 "></span><span class=sd>      - agg_optimizer</span>
<span class=linenos data-linenos="1047 "></span><span class=sd>      - node_selection_strategy</span>
<span class=linenos data-linenos="1048 "></span><span class=sd>      - aggregated_params</span>
<span class=linenos data-linenos="1049 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1050 "></span>    <span class=c1># need to have run at least 1 round to save a breakpoint</span>
<span class=linenos data-linenos="1051 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
<span class=linenos data-linenos="1052 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1053 "></span>            <span class=s1>&#39; - need to run at least 1 before saving a breakpoint&#39;</span>
<span class=linenos data-linenos="1054 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1055 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1056 "></span>
<span class=linenos data-linenos="1057 "></span>    <span class=c1># conditions are met, save breakpoint</span>
<span class=linenos data-linenos="1058 "></span>    <span class=n>breakpoint_path</span><span class=p>,</span> <span class=n>breakpoint_file_name</span> <span class=o>=</span> \
<span class=linenos data-linenos="1059 "></span>        <span class=n>choose_bkpt_file</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
<span class=linenos data-linenos="1060 "></span>
<span class=linenos data-linenos="1061 "></span>    <span class=c1># predefine several breakpoint states</span>
<span class=linenos data-linenos="1062 "></span>    <span class=n>agg_bkpt</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1063 "></span>    <span class=n>agg_optim_bkpt</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1064 "></span>    <span class=n>strategy_bkpt</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1065 "></span>    <span class=n>training_replies_bkpt</span>  <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1066 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1067 "></span>        <span class=n>agg_bkpt</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>save_state_breakpoint</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>,</span>
<span class=linenos data-linenos="1068 "></span>                                                          <span class=n>global_model</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>after_training_params</span><span class=p>())</span>
<span class=linenos data-linenos="1069 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_agg_optimizer</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1070 "></span>        <span class=c1># FIXME: harmonize naming of save_object</span>
<span class=linenos data-linenos="1071 "></span>        <span class=n>agg_optim_bkpt</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>save_optimizer</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>)</span>
<span class=linenos data-linenos="1072 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1073 "></span>        <span class=n>strategy_bkpt</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=o>.</span><span class=n>save_state_breakpoint</span><span class=p>()</span>
<span class=linenos data-linenos="1074 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_replies</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1075 "></span>        <span class=n>training_replies_bkpt</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>save_training_replies</span><span class=p>()</span>
<span class=linenos data-linenos="1076 "></span>
<span class=linenos data-linenos="1077 "></span>    <span class=n>state</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="1078 "></span>        <span class=s1>&#39;round_current&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="1079 "></span>        <span class=s1>&#39;round_limit&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span>
<span class=linenos data-linenos="1080 "></span>        <span class=s1>&#39;aggregator&#39;</span><span class=p>:</span> <span class=n>agg_bkpt</span><span class=p>,</span>
<span class=linenos data-linenos="1081 "></span>        <span class=s1>&#39;agg_optimizer&#39;</span><span class=p>:</span> <span class=n>agg_optim_bkpt</span><span class=p>,</span>
<span class=linenos data-linenos="1082 "></span>        <span class=s1>&#39;node_selection_strategy&#39;</span><span class=p>:</span> <span class=n>strategy_bkpt</span><span class=p>,</span>
<span class=linenos data-linenos="1083 "></span>        <span class=s1>&#39;aggregated_params&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>save_aggregated_params</span><span class=p>(</span>
<span class=linenos data-linenos="1084 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span><span class=p>,</span> <span class=n>breakpoint_path</span><span class=p>),</span>
<span class=linenos data-linenos="1085 "></span>        <span class=s1>&#39;training_replies&#39;</span><span class=p>:</span> <span class=n>training_replies_bkpt</span><span class=p>,</span>
<span class=linenos data-linenos="1086 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="1087 "></span>
<span class=linenos data-linenos="1088 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>breakpoint</span><span class=p>(</span><span class=n>state</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.commit_experiment_history class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">commit_experiment_history</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>commit_experiment_history</span><span class=p>(</span><span class=n>training_replies</span><span class=p>,</span> <span class=n>aggregated_params</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Commits the experiment history to memory.</p> <details class=the-experiment-history-is-defined-as open> <summary>The experiment history is defined as</summary> <ul> <li>training replies</li> <li>aggregated parameters</li> </ul> </details> <p>This function checks the retain_full_history flag: if it is True, it simply adds (or overwrites) the current round's entry for the training_replies and aggregated_params dictionary. If the flag is set to False, we simply store the last round's values in the same dictionary format.</p> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1408 "></span><span class=k>def</span> <span class=nf>commit_experiment_history</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="1409 "></span>                              <span class=n>training_replies</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]],</span>
<span class=linenos data-linenos="1410 "></span>                              <span class=n>aggregated_params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1411 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Commits the experiment history to memory.</span>
<span class=linenos data-linenos="1412 "></span>
<span class=linenos data-linenos="1413 "></span><span class=sd>    The experiment history is defined as:</span>
<span class=linenos data-linenos="1414 "></span><span class=sd>        - training replies</span>
<span class=linenos data-linenos="1415 "></span><span class=sd>        - aggregated parameters</span>
<span class=linenos data-linenos="1416 "></span>
<span class=linenos data-linenos="1417 "></span><span class=sd>    This function checks the retain_full_history flag: if it is True, it simply adds</span>
<span class=linenos data-linenos="1418 "></span><span class=sd>    (or overwrites) the current round&#39;s entry for the training_replies and aggregated_params</span>
<span class=linenos data-linenos="1419 "></span><span class=sd>    dictionary. If the flag is set to False, we simply store the last round&#39;s values in the</span>
<span class=linenos data-linenos="1420 "></span><span class=sd>    same dictionary format.</span>
<span class=linenos data-linenos="1421 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1422 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_retain_full_history</span><span class=p>:</span>
<span class=linenos data-linenos="1423 "></span>        <span class=c1># append to history</span>
<span class=linenos data-linenos="1424 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_replies</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>]</span> <span class=o>=</span> <span class=n>training_replies</span>
<span class=linenos data-linenos="1425 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;params&#39;</span><span class=p>:</span> <span class=n>aggregated_params</span><span class=p>}</span>
<span class=linenos data-linenos="1426 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1427 "></span>        <span class=c1># only store the last round&#39;s values</span>
<span class=linenos data-linenos="1428 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_replies</span> <span class=o>=</span> <span class=p>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>:</span> <span class=n>training_replies</span><span class=p>}</span>
<span class=linenos data-linenos="1429 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span> <span class=o>=</span> <span class=p>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;params&#39;</span><span class=p>:</span> <span class=n>aggregated_params</span><span class=p>}}</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.info class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">info</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>info</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Prints out the information about the current status of the experiment.</p> <p>Lists all the parameters/arguments of the experiment and informs whether the experiment can be run.</p> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>Inconsistent experiment due to missing variables</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="328 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="329 "></span><span class=k>def</span> <span class=nf>info</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]],</span> <span class=nb>str</span><span class=p>]:</span>
<span class=linenos data-linenos="330 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Prints out the information about the current status of the experiment.</span>
<span class=linenos data-linenos="331 "></span>
<span class=linenos data-linenos="332 "></span><span class=sd>    Lists  all the parameters/arguments of the experiment and informs whether the experiment can be run.</span>
<span class=linenos data-linenos="333 "></span>
<span class=linenos data-linenos="334 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="335 "></span><span class=sd>        FedbiomedExperimentError: Inconsistent experiment due to missing variables</span>
<span class=linenos data-linenos="336 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="337 "></span>    <span class=c1># at this point all attributes are initialized (in constructor)</span>
<span class=linenos data-linenos="338 "></span>
<span class=linenos data-linenos="339 "></span>    <span class=n>info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_default_info_structure</span><span class=p>()</span>
<span class=linenos data-linenos="340 "></span>
<span class=linenos data-linenos="341 "></span>    <span class=n>info</span><span class=p>[</span><span class=s1>&#39;Arguments&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
<span class=linenos data-linenos="342 "></span>        <span class=s1>&#39;Aggregator&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="343 "></span>        <span class=s1>&#39;Strategy&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="344 "></span>        <span class=s1>&#39;Aggregator Optimizer&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="345 "></span>        <span class=s1>&#39;Rounds already run&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="346 "></span>        <span class=s1>&#39;Rounds total&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="347 "></span>        <span class=s1>&#39;Breakpoint State&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="348 "></span>    <span class=p>])</span>
<span class=linenos data-linenos="349 "></span>    <span class=n>info</span><span class=p>[</span><span class=s1>&#39;Values&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;.{1,60}&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="350 "></span>                                     <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)))</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=p>[</span>
<span class=linenos data-linenos="351 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>aggregator_name</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="352 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=p>,</span>
<span class=linenos data-linenos="353 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_agg_optimizer</span><span class=p>,</span>
<span class=linenos data-linenos="354 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="355 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span>
<span class=linenos data-linenos="356 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span><span class=p>,</span>
<span class=linenos data-linenos="357 "></span>    <span class=p>]])</span>
<span class=linenos data-linenos="358 "></span>
<span class=linenos data-linenos="359 "></span>    <span class=n>missing</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_check_missing_objects</span><span class=p>()</span>
<span class=linenos data-linenos="360 "></span>    <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>info</span><span class=p>,</span> <span class=n>missing</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.load_breakpoint class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">load_breakpoint</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>load_breakpoint</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Loads breakpoint (provided a breakpoint has been saved) so experience can be resumed. Useful if training has crashed researcher side or if user wants to resume a given experiment.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>cls</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Type" href="https://docs.python.org/3/library/typing.html#typing.Type">Type</a>[<span title="fedbiomed.researcher.federated_workflows._experiment.TExperiment">TExperiment</span>]</code> </td> <td> <div class=doc-md-description> <p>Experiment class</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>breakpoint_folder_path</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, None]</code> </td> <td> <div class=doc-md-description> <p>path of the breakpoint folder. Path can be absolute or relative eg: "var/experiments/Experiment_xxxx/breakpoints_xxxx". If None, loads latest breakpoint of the latest experiment. Defaults to None.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title="fedbiomed.researcher.federated_workflows._experiment.TExperiment">TExperiment</span></code> </td> <td> <div class=doc-md-description> <p>Reinitialized experiment object. With given object, user can then use <code>.run()</code> method to pursue model training.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type, error when reading breakpoint or bad loaded breakpoint content (corrupted)</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1090 "></span><span class=nd>@classmethod</span>
<span class=linenos data-linenos="1091 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1092 "></span><span class=k>def</span> <span class=nf>load_breakpoint</span><span class=p>(</span><span class=bp>cls</span><span class=p>:</span> <span class=n>Type</span><span class=p>[</span><span class=n>TExperiment</span><span class=p>],</span>
<span class=linenos data-linenos="1093 "></span>                    <span class=n>breakpoint_folder_path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TExperiment</span><span class=p>:</span>
<span class=linenos data-linenos="1094 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="1095 "></span><span class=sd>    Loads breakpoint (provided a breakpoint has been saved)</span>
<span class=linenos data-linenos="1096 "></span><span class=sd>    so experience can be resumed. Useful if training has crashed</span>
<span class=linenos data-linenos="1097 "></span><span class=sd>    researcher side or if user wants to resume a given experiment.</span>
<span class=linenos data-linenos="1098 "></span>
<span class=linenos data-linenos="1099 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1100 "></span><span class=sd>      cls: Experiment class</span>
<span class=linenos data-linenos="1101 "></span><span class=sd>      breakpoint_folder_path: path of the breakpoint folder. Path can be absolute or relative eg:</span>
<span class=linenos data-linenos="1102 "></span><span class=sd>        &quot;var/experiments/Experiment_xxxx/breakpoints_xxxx&quot;. If None, loads latest breakpoint of the latest</span>
<span class=linenos data-linenos="1103 "></span><span class=sd>        experiment. Defaults to None.</span>
<span class=linenos data-linenos="1104 "></span>
<span class=linenos data-linenos="1105 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1106 "></span><span class=sd>        Reinitialized experiment object. With given object, user can then use `.run()`</span>
<span class=linenos data-linenos="1107 "></span><span class=sd>            method to pursue model training.</span>
<span class=linenos data-linenos="1108 "></span>
<span class=linenos data-linenos="1109 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1110 "></span><span class=sd>        FedbiomedExperimentError: bad argument type, error when reading breakpoint or bad loaded breakpoint</span>
<span class=linenos data-linenos="1111 "></span><span class=sd>            content (corrupted)</span>
<span class=linenos data-linenos="1112 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1113 "></span>    <span class=n>loaded_exp</span><span class=p>,</span> <span class=n>saved_state</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>load_breakpoint</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>)</span>
<span class=linenos data-linenos="1114 "></span>    <span class=c1># retrieve breakpoint sampling strategy</span>
<span class=linenos data-linenos="1115 "></span>    <span class=n>bkpt_sampling_strategy_args</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;node_selection_strategy&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1116 "></span>    <span class=n>bkpt_sampling_strategy</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_object</span><span class=p>(</span><span class=n>bkpt_sampling_strategy_args</span><span class=p>)</span>
<span class=linenos data-linenos="1117 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_strategy</span><span class=p>(</span><span class=n>bkpt_sampling_strategy</span><span class=p>)</span>
<span class=linenos data-linenos="1118 "></span>    <span class=c1># retrieve breakpoint researcher optimizer</span>
<span class=linenos data-linenos="1119 "></span>    <span class=n>bkpt_optim</span> <span class=o>=</span> <span class=n>Experiment</span><span class=o>.</span><span class=n>_load_optimizer</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;agg_optimizer&quot;</span><span class=p>))</span>
<span class=linenos data-linenos="1120 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_agg_optimizer</span><span class=p>(</span><span class=n>bkpt_optim</span><span class=p>)</span>
<span class=linenos data-linenos="1121 "></span>    <span class=c1># changing `Experiment` attributes</span>
<span class=linenos data-linenos="1122 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_set_round_current</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;round_current&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="1123 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_aggregated_params</span> <span class=o>=</span> <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_load_aggregated_params</span><span class=p>(</span>
<span class=linenos data-linenos="1124 "></span>        <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;aggregated_params&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1125 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="1126 "></span>    <span class=c1># retrieve and change aggregator</span>
<span class=linenos data-linenos="1127 "></span>    <span class=n>bkpt_aggregator_args</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;aggregator&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1128 "></span>    <span class=n>bkpt_aggregator</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_object</span><span class=p>(</span><span class=n>bkpt_aggregator_args</span><span class=p>,</span> <span class=n>training_plan</span><span class=o>=</span><span class=n>loaded_exp</span><span class=o>.</span><span class=n>training_plan</span><span class=p>())</span>
<span class=linenos data-linenos="1129 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_aggregator</span><span class=p>(</span><span class=n>bkpt_aggregator</span><span class=p>)</span>
<span class=linenos data-linenos="1130 "></span>    <span class=c1># load training replies</span>
<span class=linenos data-linenos="1131 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>load_training_replies</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;training_replies&quot;</span><span class=p>))</span>
<span class=linenos data-linenos="1132 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Experimentation reload from </span><span class=si>{</span><span class=n>breakpoint_folder_path</span><span class=si>}</span><span class=s2> successful!&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1133 "></span>
<span class=linenos data-linenos="1134 "></span>    <span class=k>return</span> <span class=n>loaded_exp</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.load_training_replies class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">load_training_replies</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>load_training_replies</span><span class=p>(</span><span class=n>bkpt_training_replies</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Reads training replies from a formatted breakpoint file.</p> <p>Builds a job training replies data structure .</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bkpt_training_replies</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]]]</code> </td> <td> <div class=doc-md-description> <p>Extract from training replies saved in breakpoint</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>None</code> </td> <td> <div class=doc-md-description> <p>Training replies of already executed rounds of the experiment</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1382 "></span><span class=k>def</span> <span class=nf>load_training_replies</span><span class=p>(</span>
<span class=linenos data-linenos="1383 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="1384 "></span>    <span class=n>bkpt_training_replies</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span>
<span class=linenos data-linenos="1385 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1386 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Reads training replies from a formatted breakpoint file.</span>
<span class=linenos data-linenos="1387 "></span>
<span class=linenos data-linenos="1388 "></span><span class=sd>    Builds a job training replies data structure .</span>
<span class=linenos data-linenos="1389 "></span>
<span class=linenos data-linenos="1390 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1391 "></span><span class=sd>        bkpt_training_replies: Extract from training replies saved in breakpoint</span>
<span class=linenos data-linenos="1392 "></span>
<span class=linenos data-linenos="1393 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1394 "></span><span class=sd>        Training replies of already executed rounds of the experiment</span>
<span class=linenos data-linenos="1395 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1396 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=n>bkpt_training_replies</span><span class=p>:</span>
<span class=linenos data-linenos="1397 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No Replies has been found in this breakpoint&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1398 "></span>
<span class=linenos data-linenos="1399 "></span>    <span class=n>rounds</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>bkpt_training_replies</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
<span class=linenos data-linenos="1400 "></span>    <span class=k>for</span> <span class=n>round_</span> <span class=ow>in</span> <span class=n>rounds</span><span class=p>:</span>
<span class=linenos data-linenos="1401 "></span>        <span class=c1># reload parameters from file params_path</span>
<span class=linenos data-linenos="1402 "></span>        <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>bkpt_training_replies</span><span class=p>[</span><span class=n>round_</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
<span class=linenos data-linenos="1403 "></span>            <span class=n>node</span><span class=p>[</span><span class=s2>&quot;params&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>Serializer</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>node</span><span class=p>[</span><span class=s2>&quot;params_path&quot;</span><span class=p>])</span>
<span class=linenos data-linenos="1404 "></span>        <span class=n>bkpt_training_replies</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>round_</span><span class=p>)]</span> <span class=o>=</span> <span class=n>bkpt_training_replies</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>round_</span><span class=p>)</span>
<span class=linenos data-linenos="1405 "></span>
<span class=linenos data-linenos="1406 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_replies</span> <span class=o>=</span> <span class=n>bkpt_training_replies</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.monitor class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">monitor</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>monitor</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the monitor object</p> <p>Monitor is responsible for receiving and parsing real-time training and validation feed-back from each node participate to federated training. See <a class="autorefs autorefs-internal" href="../monitor/#fedbiomed.researcher.monitor.Monitor"><code>Monitor</code></a></p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.researcher.monitor.Monitor" href="../monitor/#fedbiomed.researcher.monitor.Monitor">Monitor</a></code> </td> <td> <div class=doc-md-description> <p>Monitor object that will always exist with experiment to retrieve feed-back from the nodes.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="288 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="289 "></span><span class=k>def</span> <span class=nf>monitor</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Monitor</span><span class=p>:</span>
<span class=linenos data-linenos="290 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the monitor object</span>
<span class=linenos data-linenos="291 "></span>
<span class=linenos data-linenos="292 "></span><span class=sd>    Monitor is responsible for receiving and parsing real-time training and validation feed-back from each node</span>
<span class=linenos data-linenos="293 "></span><span class=sd>    participate to federated training. See [`Monitor`][fedbiomed.researcher.monitor.Monitor]</span>
<span class=linenos data-linenos="294 "></span>
<span class=linenos data-linenos="295 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="296 "></span><span class=sd>        Monitor object that will always exist with experiment to retrieve feed-back from the nodes.</span>
<span class=linenos data-linenos="297 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="298 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.retain_full_history class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">retain_full_history</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>retain_full_history</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the status of whether the full experiment history should be kept in memory.</p> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="322 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="323 "></span><span class=k>def</span> <span class=nf>retain_full_history</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<span class=linenos data-linenos="324 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the status of whether the full experiment history should be kept in memory.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="325 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_retain_full_history</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.round_current class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">round_current</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>round_current</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the round where the experiment is at.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Indicates the round number that the experiment will perform next.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="211 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="212 "></span><span class=k>def</span> <span class=nf>round_current</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=linenos data-linenos="213 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the round where the experiment is at.</span>
<span class=linenos data-linenos="214 "></span>
<span class=linenos data-linenos="215 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="216 "></span><span class=sd>        Indicates the round number that the experiment will perform next.</span>
<span class=linenos data-linenos="217 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="218 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.round_limit class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">round_limit</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>round_limit</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the round limit from the experiment object.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_round_limit"><code>set_round_limit</code></a> to change or set round limit.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Round limit that shows maximum number of rounds that can be performed. <code>None</code> if it isn't declared yet.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="199 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="200 "></span><span class=k>def</span> <span class=nf>round_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="201 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the round limit from the experiment object.</span>
<span class=linenos data-linenos="202 "></span>
<span class=linenos data-linenos="203 "></span><span class=sd>    Please see  also [`set_round_limit`][fedbiomed.researcher.federated_workflows.Experiment.set_round_limit]</span>
<span class=linenos data-linenos="204 "></span><span class=sd>    to change or set round limit.</span>
<span class=linenos data-linenos="205 "></span>
<span class=linenos data-linenos="206 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="207 "></span><span class=sd>        Round limit that shows maximum number of rounds that can be performed. `None` if it isn&#39;t declared yet.</span>
<span class=linenos data-linenos="208 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="209 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.run class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">run</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>run</span><span class=p>(</span><span class=n>rounds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>increase</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Run one or more rounds of an experiment, continuing from the point the experiment had reached.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>rounds</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code> </td> <td> <div class=doc-md-description> <p>Number of experiment rounds to run in this call. * <code>None</code> means "run all the rounds remaining in the experiment" computed as maximum rounds (<code>round_limit</code> for this experiment) minus the number of rounds already run rounds (<code>round_current</code> for this experiment). It does nothing and issues a warning if <code>round_limit</code> is <code>None</code> (no round limit defined for the experiment) * <code>int</code> &gt;= 1 means "run at most <code>rounds</code> rounds". If <code>round_limit</code> is <code>None</code> for the experiment, run exactly <code>rounds</code> rounds. If a <code>round_limit</code> is set for the experiment and the number or rounds would increase beyond the <code>round_limit</code> of the experiment: - if <code>increase</code> is True, increase the <code>round_limit</code> to (<code>round_current</code> + <code>rounds</code>) and run <code>rounds</code> rounds - if <code>increase</code> is False, run (<code>round_limit</code> - <code>round_current</code>) rounds, don't modify the maximum <code>round_limit</code> of the experiment and issue a warning.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>increase</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>automatically increase the <code>round_limit</code> of the experiment for executing the specified number of <code>rounds</code>. Does nothing if <code>round_limit</code> is <code>None</code> or <code>rounds</code> is None. Defaults to False</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Number of rounds have been run</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type or value</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 924 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos=" 925 "></span><span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>rounds</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>increase</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=linenos data-linenos=" 926 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run one or more rounds of an experiment, continuing from the point the</span>
<span class=linenos data-linenos=" 927 "></span><span class=sd>    experiment had reached.</span>
<span class=linenos data-linenos=" 928 "></span>
<span class=linenos data-linenos=" 929 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos=" 930 "></span><span class=sd>        rounds: Number of experiment rounds to run in this call.</span>
<span class=linenos data-linenos=" 931 "></span><span class=sd>            * `None` means &quot;run all the rounds remaining in the experiment&quot; computed as</span>
<span class=linenos data-linenos=" 932 "></span><span class=sd>                maximum rounds (`round_limit` for this experiment) minus the number of</span>
<span class=linenos data-linenos=" 933 "></span><span class=sd>                rounds already run rounds (`round_current` for this experiment).</span>
<span class=linenos data-linenos=" 934 "></span><span class=sd>                It does nothing and issues a warning if `round_limit` is `None` (no</span>
<span class=linenos data-linenos=" 935 "></span><span class=sd>                round limit defined for the experiment)</span>
<span class=linenos data-linenos=" 936 "></span><span class=sd>            * `int` &gt;= 1 means &quot;run at most `rounds` rounds&quot;.</span>
<span class=linenos data-linenos=" 937 "></span><span class=sd>                If `round_limit` is `None` for the experiment, run exactly `rounds` rounds.</span>
<span class=linenos data-linenos=" 938 "></span><span class=sd>                If a `round_limit` is set for the experiment and the number or rounds would</span>
<span class=linenos data-linenos=" 939 "></span><span class=sd>            increase beyond the `round_limit` of the experiment:</span>
<span class=linenos data-linenos=" 940 "></span><span class=sd>            - if `increase` is True, increase the `round_limit` to</span>
<span class=linenos data-linenos=" 941 "></span><span class=sd>              (`round_current` + `rounds`) and run `rounds` rounds</span>
<span class=linenos data-linenos=" 942 "></span><span class=sd>            - if `increase` is False, run (`round_limit` - `round_current`)</span>
<span class=linenos data-linenos=" 943 "></span><span class=sd>              rounds, don&#39;t modify the maximum `round_limit` of the experiment</span>
<span class=linenos data-linenos=" 944 "></span><span class=sd>              and issue a warning.</span>
<span class=linenos data-linenos=" 945 "></span><span class=sd>        increase: automatically increase the `round_limit`</span>
<span class=linenos data-linenos=" 946 "></span><span class=sd>            of the experiment for executing the specified number of `rounds`.</span>
<span class=linenos data-linenos=" 947 "></span><span class=sd>            Does nothing if `round_limit` is `None` or `rounds` is None.</span>
<span class=linenos data-linenos=" 948 "></span><span class=sd>            Defaults to False</span>
<span class=linenos data-linenos=" 949 "></span>
<span class=linenos data-linenos=" 950 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos=" 951 "></span><span class=sd>        Number of rounds have been run</span>
<span class=linenos data-linenos=" 952 "></span>
<span class=linenos data-linenos=" 953 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos=" 954 "></span><span class=sd>        FedbiomedExperimentError: bad argument type or value</span>
<span class=linenos data-linenos=" 955 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos=" 956 "></span>    <span class=c1># check rounds is a &gt;=1 integer or None</span>
<span class=linenos data-linenos=" 957 "></span>    <span class=k>if</span> <span class=n>rounds</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos=" 958 "></span>        <span class=k>pass</span>
<span class=linenos data-linenos=" 959 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos=" 960 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos=" 961 "></span>            <span class=sa>f</span><span class=s1>&#39;, in method `run` param `rounds` : value </span><span class=si>{</span><span class=n>rounds</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos=" 962 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_check_round_value_consistency</span><span class=p>(</span><span class=n>rounds</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos=" 963 "></span>
<span class=linenos data-linenos=" 964 "></span>    <span class=c1># check increase is a boolean</span>
<span class=linenos data-linenos=" 965 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>increase</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos=" 966 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos=" 967 "></span>            <span class=sa>f</span><span class=s1>&#39;, in method `run` param `increase` : type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>increase</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos=" 968 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos=" 969 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos=" 970 "></span>
<span class=linenos data-linenos=" 971 "></span>    <span class=c1># compute number of rounds to run + updated rounds limit</span>
<span class=linenos data-linenos=" 972 "></span>    <span class=k>if</span> <span class=n>rounds</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos=" 973 "></span>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos=" 974 "></span>            <span class=c1># run all remaining rounds in the experiment</span>
<span class=linenos data-linenos=" 975 "></span>            <span class=n>rounds</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span>
<span class=linenos data-linenos=" 976 "></span>            <span class=k>if</span> <span class=n>rounds</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<span class=linenos data-linenos=" 977 "></span>                <span class=c1># limit already reached</span>
<span class=linenos data-linenos=" 978 "></span>                <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Round limit of </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> already reached &#39;</span>
<span class=linenos data-linenos=" 979 "></span>                               <span class=s1>&#39;for this experiment, do nothing.&#39;</span><span class=p>)</span>
<span class=linenos data-linenos=" 980 "></span>                <span class=k>return</span> <span class=mi>0</span>
<span class=linenos data-linenos=" 981 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos=" 982 "></span>            <span class=c1># cannot run if no number of rounds given and no round limit exists</span>
<span class=linenos data-linenos=" 983 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s1>&#39;Cannot run, please specify a number of `rounds` to run or &#39;</span>
<span class=linenos data-linenos=" 984 "></span>                           <span class=s1>&#39;set a `round_limit` to the experiment&#39;</span><span class=p>)</span>
<span class=linenos data-linenos=" 985 "></span>            <span class=k>return</span> <span class=mi>0</span>
<span class=linenos data-linenos=" 986 "></span>
<span class=linenos data-linenos=" 987 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos=" 988 "></span>        <span class=c1># at this point, rounds is an int &gt;= 1</span>
<span class=linenos data-linenos=" 989 "></span>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos=" 990 "></span>            <span class=k>if</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+</span> <span class=n>rounds</span><span class=p>)</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>:</span>
<span class=linenos data-linenos=" 991 "></span>                <span class=k>if</span> <span class=n>increase</span><span class=p>:</span>
<span class=linenos data-linenos=" 992 "></span>                    <span class=c1># dont change rounds, but extend self._round_limit as necessary</span>
<span class=linenos data-linenos=" 993 "></span>                    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Auto increasing total rounds for experiment from </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> &#39;</span>
<span class=linenos data-linenos=" 994 "></span>                                 <span class=sa>f</span><span class=s1>&#39;to </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rounds</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos=" 995 "></span>                    <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+</span> <span class=n>rounds</span>
<span class=linenos data-linenos=" 996 "></span>                <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos=" 997 "></span>                    <span class=n>new_rounds</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span>
<span class=linenos data-linenos=" 998 "></span>                    <span class=k>if</span> <span class=n>new_rounds</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<span class=linenos data-linenos=" 999 "></span>                        <span class=c1># limit already reached</span>
<span class=linenos data-linenos="1000 "></span>                        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Round limit of </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> already reached &#39;</span>
<span class=linenos data-linenos="1001 "></span>                                       <span class=s1>&#39;for this experiment, do nothing.&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1002 "></span>                        <span class=k>return</span> <span class=mi>0</span>
<span class=linenos data-linenos="1003 "></span>                    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1004 "></span>                        <span class=c1># reduce the number of rounds to run in the experiment</span>
<span class=linenos data-linenos="1005 "></span>                        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Limit of </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> rounds for the experiment &#39;</span>
<span class=linenos data-linenos="1006 "></span>                                       <span class=sa>f</span><span class=s1>&#39;will be reached, reducing the number of rounds for this &#39;</span>
<span class=linenos data-linenos="1007 "></span>                                       <span class=sa>f</span><span class=s1>&#39;run from </span><span class=si>{</span><span class=n>rounds</span><span class=si>}</span><span class=s1> to </span><span class=si>{</span><span class=n>new_rounds</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1008 "></span>                        <span class=n>rounds</span> <span class=o>=</span> <span class=n>new_rounds</span>
<span class=linenos data-linenos="1009 "></span>
<span class=linenos data-linenos="1010 "></span>    <span class=c1># FIXME: should we print warning if both rounds and _round_limit are None?</span>
<span class=linenos data-linenos="1011 "></span>    <span class=c1># At this point `rounds` is an int &gt; 0 (not None)</span>
<span class=linenos data-linenos="1012 "></span>
<span class=linenos data-linenos="1013 "></span>    <span class=c1># run the rounds</span>
<span class=linenos data-linenos="1014 "></span>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rounds</span><span class=p>):</span>
<span class=linenos data-linenos="1015 "></span>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>==</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> \
<span class=linenos data-linenos="1016 "></span>                <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_global_updates&#39;</span><span class=p>]</span> <span class=ow>is</span> <span class=kc>True</span><span class=p>:</span>
<span class=linenos data-linenos="1017 "></span>            <span class=c1># Do &quot;validation after a round&quot; only if this a round limit is defined and we reached it</span>
<span class=linenos data-linenos="1018 "></span>            <span class=c1># and validation is active on global params</span>
<span class=linenos data-linenos="1019 "></span>            <span class=c1># When this condition is met, it also means we are running the last of</span>
<span class=linenos data-linenos="1020 "></span>            <span class=c1># the `rounds` rounds in this function</span>
<span class=linenos data-linenos="1021 "></span>            <span class=n>test_after</span> <span class=o>=</span> <span class=kc>True</span>
<span class=linenos data-linenos="1022 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1023 "></span>            <span class=n>test_after</span> <span class=o>=</span> <span class=kc>False</span>
<span class=linenos data-linenos="1024 "></span>
<span class=linenos data-linenos="1025 "></span>        <span class=n>increment</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>run_once</span><span class=p>(</span><span class=n>increase</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>test_after</span><span class=o>=</span><span class=n>test_after</span><span class=p>)</span>
<span class=linenos data-linenos="1026 "></span>
<span class=linenos data-linenos="1027 "></span>        <span class=k>if</span> <span class=n>increment</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<span class=linenos data-linenos="1028 "></span>            <span class=c1># should not happen</span>
<span class=linenos data-linenos="1029 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB400</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1030 "></span>                <span class=sa>f</span><span class=s1>&#39;, in method `run` method `run_once` returns </span><span class=si>{</span><span class=n>increment</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1031 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1032 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1033 "></span>
<span class=linenos data-linenos="1034 "></span>    <span class=k>return</span> <span class=n>rounds</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.run_once class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">run_once</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>run_once</span><span class=p>(</span><span class=n>increase</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>test_after</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Run at most one round of an experiment, continuing from the point the experiment had reached.</p> <p>If <code>round_limit</code> is <code>None</code> for the experiment (no round limit defined), run one round. If <code>round_limit</code> is not <code>None</code> and the <code>round_limit</code> of the experiment is already reached: * if <code>increase</code> is False, do nothing and issue a warning * if <code>increase</code> is True, increment total number of round <code>round_limit</code> and run one round</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>increase</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>automatically increase the <code>round_limit</code> of the experiment if needed. Does nothing if <code>round_limit</code> is <code>None</code>. Defaults to False</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td><code>test_after</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>if True, do a second request to the nodes after the round, only for validation on aggregated params. Intended to be used after the last training round of an experiment. Defaults to False.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td> <div class=doc-md-description> <p>Number of rounds really run</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type or value</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="681 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="682 "></span><span class=k>def</span> <span class=nf>run_once</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>increase</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>test_after</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=linenos data-linenos="683 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run at most one round of an experiment, continuing from the point the</span>
<span class=linenos data-linenos="684 "></span><span class=sd>    experiment had reached.</span>
<span class=linenos data-linenos="685 "></span>
<span class=linenos data-linenos="686 "></span><span class=sd>    If `round_limit` is `None` for the experiment (no round limit defined), run one round.</span>
<span class=linenos data-linenos="687 "></span><span class=sd>    If `round_limit` is not `None` and the `round_limit` of the experiment is already reached:</span>
<span class=linenos data-linenos="688 "></span><span class=sd>    * if `increase` is False, do nothing and issue a warning</span>
<span class=linenos data-linenos="689 "></span><span class=sd>    * if `increase` is True, increment total number of round `round_limit` and run one round</span>
<span class=linenos data-linenos="690 "></span>
<span class=linenos data-linenos="691 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="692 "></span><span class=sd>        increase: automatically increase the `round_limit` of the experiment if needed. Does nothing if</span>
<span class=linenos data-linenos="693 "></span><span class=sd>            `round_limit` is `None`. Defaults to False</span>
<span class=linenos data-linenos="694 "></span><span class=sd>        test_after: if True, do a second request to the nodes after the round, only for validation on aggregated</span>
<span class=linenos data-linenos="695 "></span><span class=sd>            params. Intended to be used after the last training round of an experiment. Defaults to False.</span>
<span class=linenos data-linenos="696 "></span>
<span class=linenos data-linenos="697 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="698 "></span><span class=sd>        Number of rounds really run</span>
<span class=linenos data-linenos="699 "></span>
<span class=linenos data-linenos="700 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="701 "></span><span class=sd>        FedbiomedExperimentError: bad argument type or value</span>
<span class=linenos data-linenos="702 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="703 "></span>    <span class=c1># check increase is a boolean</span>
<span class=linenos data-linenos="704 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>increase</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="705 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="706 "></span>            <span class=sa>f</span><span class=s1>&#39;, in method `run_once` param `increase` : type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>increase</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="707 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="708 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="709 "></span>
<span class=linenos data-linenos="710 "></span>    <span class=c1># nota:  we should never have self._round_current &gt; self._round_limit, only ==</span>
<span class=linenos data-linenos="711 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>:</span>
<span class=linenos data-linenos="712 "></span>        <span class=k>if</span> <span class=n>increase</span> <span class=ow>is</span> <span class=kc>True</span><span class=p>:</span>
<span class=linenos data-linenos="713 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Auto increasing total rounds for experiment from </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> &#39;</span>
<span class=linenos data-linenos="714 "></span>                         <span class=sa>f</span><span class=s1>&#39;to </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="715 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+</span> <span class=mi>1</span>
<span class=linenos data-linenos="716 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="717 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Round limit of </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> was reached, do nothing&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="718 "></span>            <span class=k>return</span> <span class=mi>0</span>
<span class=linenos data-linenos="719 "></span>
<span class=linenos data-linenos="720 "></span>    <span class=c1># check pre-requisites are met for running a round</span>
<span class=linenos data-linenos="721 "></span>    <span class=c1># From here, node_selection_strategy is never None</span>
<span class=linenos data-linenos="722 "></span>    <span class=c1># if self._node_selection_strategy is None:</span>
<span class=linenos data-linenos="723 "></span>    <span class=c1>#     msg = ErrorNumbers.FB411.value + &#39;, missing `node_selection_strategy`&#39;</span>
<span class=linenos data-linenos="724 "></span>    <span class=c1>#     logger.critical(msg)</span>
<span class=linenos data-linenos="725 "></span>    <span class=c1>#     raise FedbiomedExperimentError(msg)</span>
<span class=linenos data-linenos="726 "></span>
<span class=linenos data-linenos="727 "></span>    <span class=n>missing</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_check_missing_objects</span><span class=p>()</span>
<span class=linenos data-linenos="728 "></span>    <span class=k>if</span> <span class=n>missing</span><span class=p>:</span>
<span class=linenos data-linenos="729 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB411</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39;: missing one or several object needed for&#39;</span>
<span class=linenos data-linenos="730 "></span>                                       <span class=s1>&#39; starting the `Experiment`. Details:</span><span class=se>\n</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>missing</span><span class=p>)</span>
<span class=linenos data-linenos="731 "></span>    <span class=c1># Sample nodes for training</span>
<span class=linenos data-linenos="732 "></span>
<span class=linenos data-linenos="733 "></span>    <span class=n>training_nodes</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=o>.</span><span class=n>sample_nodes</span><span class=p>(</span>
<span class=linenos data-linenos="734 "></span>        <span class=n>from_nodes</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>filtered_federation_nodes</span><span class=p>(),</span>
<span class=linenos data-linenos="735 "></span>        <span class=n>round_i</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span>
<span class=linenos data-linenos="736 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="737 "></span>    <span class=c1># Setup Secure Aggregation (it&#39;s a noop if not active)</span>
<span class=linenos data-linenos="738 "></span>    <span class=n>secagg_arguments</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>secagg_setup</span><span class=p>(</span><span class=n>training_nodes</span><span class=p>)</span>
<span class=linenos data-linenos="739 "></span>
<span class=linenos data-linenos="740 "></span>    <span class=c1># Setup aggregator</span>
<span class=linenos data-linenos="741 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>set_training_plan_type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>type</span><span class=p>())</span>
<span class=linenos data-linenos="742 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>check_values</span><span class=p>(</span><span class=n>n_updates</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;num_updates&#39;</span><span class=p>),</span>
<span class=linenos data-linenos="743 "></span>                                  <span class=n>training_plan</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>())</span>
<span class=linenos data-linenos="744 "></span>    <span class=n>model_params_before_round</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>after_training_params</span><span class=p>()</span>
<span class=linenos data-linenos="745 "></span>    <span class=n>aggregator_args</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>create_aggregator_args</span><span class=p>(</span><span class=n>model_params_before_round</span><span class=p>,</span>
<span class=linenos data-linenos="746 "></span>                                                              <span class=n>training_nodes</span><span class=p>)</span>
<span class=linenos data-linenos="747 "></span>
<span class=linenos data-linenos="748 "></span>    <span class=c1># Collect auxiliary variables from the aggregator optimizer, if any.</span>
<span class=linenos data-linenos="749 "></span>    <span class=n>optim_aux_var</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_collect_optim_aux_var</span><span class=p>()</span>
<span class=linenos data-linenos="750 "></span>
<span class=linenos data-linenos="751 "></span>    <span class=c1># update node states when list of nodes has changed from one round to another</span>
<span class=linenos data-linenos="752 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_update_nodes_states_agent</span><span class=p>(</span><span class=n>before_training</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=linenos data-linenos="753 "></span>    <span class=c1># TODO check node state agent</span>
<span class=linenos data-linenos="754 "></span>    <span class=n>nodes_state_ids</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_state_agent</span><span class=o>.</span><span class=n>get_last_node_states</span><span class=p>()</span>
<span class=linenos data-linenos="755 "></span>
<span class=linenos data-linenos="756 "></span>    <span class=c1># if fds is updated, aggregator should be updated too</span>
<span class=linenos data-linenos="757 "></span>    <span class=n>job</span> <span class=o>=</span> <span class=n>TrainingJob</span><span class=p>(</span><span class=n>nodes</span><span class=o>=</span><span class=n>training_nodes</span><span class=p>,</span>
<span class=linenos data-linenos="758 "></span>                      <span class=n>keep_files_dir</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>experimentation_path</span><span class=p>(),</span>
<span class=linenos data-linenos="759 "></span>                      <span class=n>experiment_id</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_experiment_id</span><span class=p>,</span>
<span class=linenos data-linenos="760 "></span>                      <span class=n>round_</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="761 "></span>                      <span class=n>training_plan</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>(),</span>
<span class=linenos data-linenos="762 "></span>                      <span class=n>training_args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>,</span>
<span class=linenos data-linenos="763 "></span>                      <span class=n>model_args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>model_args</span><span class=p>(),</span>
<span class=linenos data-linenos="764 "></span>                      <span class=n>data</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>,</span>
<span class=linenos data-linenos="765 "></span>                      <span class=n>nodes_state_ids</span><span class=o>=</span><span class=n>nodes_state_ids</span><span class=p>,</span>
<span class=linenos data-linenos="766 "></span>                      <span class=n>aggregator_args</span><span class=o>=</span><span class=n>aggregator_args</span><span class=p>,</span>
<span class=linenos data-linenos="767 "></span>                      <span class=n>do_training</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<span class=linenos data-linenos="768 "></span>                      <span class=n>secagg_arguments</span><span class=o>=</span><span class=n>secagg_arguments</span><span class=p>,</span>
<span class=linenos data-linenos="769 "></span>                      <span class=n>optim_aux_var</span><span class=o>=</span><span class=n>optim_aux_var</span>
<span class=linenos data-linenos="770 "></span>                      <span class=p>)</span>
<span class=linenos data-linenos="771 "></span>
<span class=linenos data-linenos="772 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;Sampled nodes in round &#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>job</span><span class=o>.</span><span class=n>nodes</span><span class=p>))</span>
<span class=linenos data-linenos="773 "></span>
<span class=linenos data-linenos="774 "></span>    <span class=n>training_replies</span><span class=p>,</span> <span class=n>aux_vars</span> <span class=o>=</span> <span class=n>job</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
<span class=linenos data-linenos="775 "></span>
<span class=linenos data-linenos="776 "></span>    <span class=c1># update node states with node answers + when used node list has changed during the round</span>
<span class=linenos data-linenos="777 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_update_nodes_states_agent</span><span class=p>(</span><span class=n>before_training</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>training_replies</span><span class=o>=</span><span class=n>training_replies</span><span class=p>)</span>
<span class=linenos data-linenos="778 "></span>
<span class=linenos data-linenos="779 "></span>    <span class=c1># refining/normalizing model weights received from nodes</span>
<span class=linenos data-linenos="780 "></span>    <span class=n>model_params</span><span class=p>,</span> <span class=n>weights</span><span class=p>,</span> <span class=n>total_sample_size</span><span class=p>,</span> <span class=n>encryption_factors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=o>.</span><span class=n>refine</span><span class=p>(</span>
<span class=linenos data-linenos="781 "></span>        <span class=n>training_replies</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>)</span>
<span class=linenos data-linenos="782 "></span>
<span class=linenos data-linenos="783 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>active</span><span class=p>:</span>
<span class=linenos data-linenos="784 "></span>        <span class=n>flatten_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>aggregate</span><span class=p>(</span>
<span class=linenos data-linenos="785 "></span>            <span class=n>round_</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="786 "></span>            <span class=n>encryption_factors</span><span class=o>=</span><span class=n>encryption_factors</span><span class=p>,</span>
<span class=linenos data-linenos="787 "></span>            <span class=n>total_sample_size</span><span class=o>=</span><span class=n>total_sample_size</span><span class=p>,</span>
<span class=linenos data-linenos="788 "></span>            <span class=n>model_params</span><span class=o>=</span><span class=n>model_params</span><span class=p>,</span>
<span class=linenos data-linenos="789 "></span>            <span class=n>num_expected_params</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>get_model_wrapper_class</span><span class=p>()</span><span class=o>.</span><span class=n>flatten</span><span class=p>(</span>
<span class=linenos data-linenos="790 "></span>                <span class=n>exclude_buffers</span> <span class=o>=</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>training_args</span><span class=p>()[</span><span class=s1>&#39;share_persistent_buffers&#39;</span><span class=p>]))</span>
<span class=linenos data-linenos="791 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="792 "></span>        <span class=c1># FIXME: Access TorchModel through non-private getter once it is implemented</span>
<span class=linenos data-linenos="793 "></span>        <span class=n>aggregated_params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]</span> <span class=o>=</span> <span class=p>(</span>
<span class=linenos data-linenos="794 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>get_model_wrapper_class</span><span class=p>()</span><span class=o>.</span><span class=n>unflatten</span><span class=p>(</span>
<span class=linenos data-linenos="795 "></span>                <span class=n>flatten_params</span><span class=p>,</span> <span class=n>exclude_buffers</span> <span class=o>=</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>training_args</span><span class=p>()[</span><span class=s1>&#39;share_persistent_buffers&#39;</span><span class=p>])</span>
<span class=linenos data-linenos="796 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="797 "></span>
<span class=linenos data-linenos="798 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="799 "></span>        <span class=c1># aggregate models from nodes to a global model</span>
<span class=linenos data-linenos="800 "></span>        <span class=n>aggregated_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>aggregate</span><span class=p>(</span><span class=n>model_params</span><span class=p>,</span>
<span class=linenos data-linenos="801 "></span>                                                       <span class=n>weights</span><span class=p>,</span>
<span class=linenos data-linenos="802 "></span>                                                       <span class=n>global_model</span><span class=o>=</span><span class=n>model_params_before_round</span><span class=p>,</span>
<span class=linenos data-linenos="803 "></span>                                                       <span class=n>training_plan</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>(),</span>
<span class=linenos data-linenos="804 "></span>                                                       <span class=n>training_replies</span><span class=o>=</span><span class=n>training_replies</span><span class=p>,</span>
<span class=linenos data-linenos="805 "></span>                                                       <span class=n>node_ids</span><span class=o>=</span><span class=n>job</span><span class=o>.</span><span class=n>nodes</span><span class=p>,</span>
<span class=linenos data-linenos="806 "></span>                                                       <span class=n>n_updates</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;num_updates&#39;</span><span class=p>),</span>
<span class=linenos data-linenos="807 "></span>                                                       <span class=n>n_round</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>)</span>
<span class=linenos data-linenos="808 "></span>
<span class=linenos data-linenos="809 "></span>    <span class=c1># Optionally refine the aggregated updates using an Optimizer.</span>
<span class=linenos data-linenos="810 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_process_optim_aux_var</span><span class=p>(</span><span class=n>aux_vars</span><span class=p>)</span>
<span class=linenos data-linenos="811 "></span>    <span class=n>aggregated_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_run_agg_optimizer</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>(),</span>
<span class=linenos data-linenos="812 "></span>                                                <span class=n>aggregated_params</span><span class=p>)</span>
<span class=linenos data-linenos="813 "></span>
<span class=linenos data-linenos="814 "></span>    <span class=c1># Update the training plan with the aggregated parameters</span>
<span class=linenos data-linenos="815 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>set_model_params</span><span class=p>(</span><span class=n>aggregated_params</span><span class=p>)</span>
<span class=linenos data-linenos="816 "></span>
<span class=linenos data-linenos="817 "></span>    <span class=c1># Update experiment&#39;s in-memory history</span>
<span class=linenos data-linenos="818 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>commit_experiment_history</span><span class=p>(</span><span class=n>training_replies</span><span class=p>,</span> <span class=n>aggregated_params</span><span class=p>)</span>
<span class=linenos data-linenos="819 "></span>
<span class=linenos data-linenos="820 "></span>    <span class=c1># Increase round number (should be incremented before call to `breakpoint`)</span>
<span class=linenos data-linenos="821 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_set_round_current</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<span class=linenos data-linenos="822 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span><span class=p>:</span>
<span class=linenos data-linenos="823 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>breakpoint</span><span class=p>()</span>
<span class=linenos data-linenos="824 "></span>
<span class=linenos data-linenos="825 "></span>    <span class=c1># do final validation after saving breakpoint :</span>
<span class=linenos data-linenos="826 "></span>    <span class=c1># not saved in breakpoint for current round, but more simple</span>
<span class=linenos data-linenos="827 "></span>    <span class=k>if</span> <span class=n>test_after</span><span class=p>:</span>
<span class=linenos data-linenos="828 "></span>        <span class=c1># FIXME: should we sample nodes here too?</span>
<span class=linenos data-linenos="829 "></span>        <span class=n>aggr_args</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>create_aggregator_args</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>after_training_params</span><span class=p>(),</span>
<span class=linenos data-linenos="830 "></span>                                                            <span class=n>training_nodes</span><span class=p>)</span>
<span class=linenos data-linenos="831 "></span>
<span class=linenos data-linenos="832 "></span>        <span class=n>job</span> <span class=o>=</span> <span class=n>TrainingJob</span><span class=p>(</span><span class=n>nodes</span><span class=o>=</span><span class=n>training_nodes</span><span class=p>,</span>
<span class=linenos data-linenos="833 "></span>                          <span class=n>keep_files_dir</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>experimentation_path</span><span class=p>(),</span>
<span class=linenos data-linenos="834 "></span>                          <span class=n>experiment_id</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_experiment_id</span><span class=p>,</span>
<span class=linenos data-linenos="835 "></span>                          <span class=n>round_</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="836 "></span>                          <span class=n>training_plan</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>(),</span>
<span class=linenos data-linenos="837 "></span>                          <span class=n>training_args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>,</span>
<span class=linenos data-linenos="838 "></span>                          <span class=n>model_args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>model_args</span><span class=p>(),</span>
<span class=linenos data-linenos="839 "></span>                          <span class=n>data</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>,</span>
<span class=linenos data-linenos="840 "></span>                          <span class=n>nodes_state_ids</span><span class=o>=</span><span class=n>nodes_state_ids</span><span class=p>,</span>
<span class=linenos data-linenos="841 "></span>                          <span class=n>aggregator_args</span><span class=o>=</span><span class=n>aggr_args</span><span class=p>,</span>
<span class=linenos data-linenos="842 "></span>                          <span class=n>do_training</span><span class=o>=</span><span class=kc>False</span>
<span class=linenos data-linenos="843 "></span>                          <span class=p>)</span>
<span class=linenos data-linenos="844 "></span>        <span class=n>job</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
<span class=linenos data-linenos="845 "></span>
<span class=linenos data-linenos="846 "></span>
<span class=linenos data-linenos="847 "></span>    <span class=k>return</span> <span class=mi>1</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.save_aggregated_params class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">save_aggregated_params</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>save_aggregated_params</span><span class=p>(</span><span class=n>aggregated_params_init</span><span class=p>,</span> <span class=n>breakpoint_path</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Extract and format fields from aggregated_params that need to be saved in breakpoint.</p> <p>Creates link to the params file from the <code>breakpoint_path</code> and use them to reference the params files.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>aggregated_params_init</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>aggregated parameters</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>breakpoint_path</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>path to the directory where breakpoints files and links will be saved</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>]</code> </td> <td> <div class=doc-md-description> <p>Extract from <code>aggregated_params</code></p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad arguments type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1136 "></span><span class=nd>@staticmethod</span>
<span class=linenos data-linenos="1137 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1138 "></span><span class=k>def</span> <span class=nf>save_aggregated_params</span><span class=p>(</span><span class=n>aggregated_params_init</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span> <span class=n>breakpoint_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>dict</span><span class=p>]:</span>
<span class=linenos data-linenos="1139 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Extract and format fields from aggregated_params that need to be saved in breakpoint.</span>
<span class=linenos data-linenos="1140 "></span>
<span class=linenos data-linenos="1141 "></span><span class=sd>    Creates link to the params file from the `breakpoint_path` and use them to reference the params files.</span>
<span class=linenos data-linenos="1142 "></span>
<span class=linenos data-linenos="1143 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1144 "></span><span class=sd>        aggregated_params_init (dict): aggregated parameters</span>
<span class=linenos data-linenos="1145 "></span><span class=sd>        breakpoint_path: path to the directory where breakpoints files and links will be saved</span>
<span class=linenos data-linenos="1146 "></span>
<span class=linenos data-linenos="1147 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1148 "></span><span class=sd>        Extract from `aggregated_params`</span>
<span class=linenos data-linenos="1149 "></span>
<span class=linenos data-linenos="1150 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1151 "></span><span class=sd>        FedbiomedExperimentError: bad arguments type</span>
<span class=linenos data-linenos="1152 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1153 "></span>    <span class=c1># check arguments type, though is should have been done before</span>
<span class=linenos data-linenos="1154 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>aggregated_params_init</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=linenos data-linenos="1155 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39; - save failed. &#39;</span> <span class=o>+</span> \
<span class=linenos data-linenos="1156 "></span>            <span class=sa>f</span><span class=s1>&#39;Bad type for aggregated params, should be `dict` not </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>aggregated_params_init</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1157 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1158 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1159 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="1160 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39; - save failed. &#39;</span> <span class=o>+</span> \
<span class=linenos data-linenos="1161 "></span>            <span class=sa>f</span><span class=s1>&#39;Bad type for breakpoint path, should be `str` not </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1162 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1163 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1164 "></span>
<span class=linenos data-linenos="1165 "></span>    <span class=n>aggregated_params</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="1166 "></span>    <span class=k>for</span> <span class=n>round_</span><span class=p>,</span> <span class=n>params_dict</span> <span class=ow>in</span> <span class=n>aggregated_params_init</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="1167 "></span>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>params_dict</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=linenos data-linenos="1168 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39; - save failed. &#39;</span> <span class=o>+</span> \
<span class=linenos data-linenos="1169 "></span>                <span class=sa>f</span><span class=s1>&#39;Bad type for aggregated params item </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>round_</span><span class=p>)</span><span class=si>}</span><span class=s1>, &#39;</span> <span class=o>+</span> \
<span class=linenos data-linenos="1170 "></span>                <span class=sa>f</span><span class=s1>&#39;should be `dict` not </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>params_dict</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1171 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1172 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1173 "></span>
<span class=linenos data-linenos="1174 "></span>        <span class=n>params_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;aggregated_params_</span><span class=si>{</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span><span class=si>}</span><span class=s2>.mpk&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1175 "></span>        <span class=n>Serializer</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>params_dict</span><span class=p>[</span><span class=s1>&#39;params&#39;</span><span class=p>],</span> <span class=n>params_path</span><span class=p>)</span>
<span class=linenos data-linenos="1176 "></span>        <span class=n>aggregated_params</span><span class=p>[</span><span class=n>round_</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;params_path&#39;</span><span class=p>:</span> <span class=n>params_path</span><span class=p>}</span>
<span class=linenos data-linenos="1177 "></span>
<span class=linenos data-linenos="1178 "></span>    <span class=k>return</span> <span class=n>aggregated_params</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.save_optimizer class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">save_optimizer</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>save_optimizer</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Save the researcher-side Optimizer attached to this Experiment.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>breakpoint_path</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>Path to the breakpoint folder.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>Path to the optimizer's save file, or None if no Optimizer is used.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1213 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1214 "></span><span class=k>def</span> <span class=nf>save_optimizer</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>breakpoint_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=linenos data-linenos="1215 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Save the researcher-side Optimizer attached to this Experiment.</span>
<span class=linenos data-linenos="1216 "></span>
<span class=linenos data-linenos="1217 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1218 "></span><span class=sd>        breakpoint_path: Path to the breakpoint folder.</span>
<span class=linenos data-linenos="1219 "></span>
<span class=linenos data-linenos="1220 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1221 "></span><span class=sd>        Path to the optimizer&#39;s save file, or None if no Optimizer is used.</span>
<span class=linenos data-linenos="1222 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1223 "></span>    <span class=c1># Case when no researcher optimizer is used.</span>
<span class=linenos data-linenos="1224 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_agg_optimizer</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1225 "></span>        <span class=k>return</span> <span class=kc>None</span>
<span class=linenos data-linenos="1226 "></span>    <span class=c1># Case when an Optimizer is used: save its state and return the path.</span>
<span class=linenos data-linenos="1227 "></span>    <span class=n>state</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_agg_optimizer</span><span class=o>.</span><span class=n>get_state</span><span class=p>()</span>
<span class=linenos data-linenos="1228 "></span>    <span class=n>path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;optimizer_</span><span class=si>{</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span><span class=si>}</span><span class=s2>.mpk&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1229 "></span>    <span class=n>Serializer</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>state</span><span class=p>,</span> <span class=n>path</span><span class=p>)</span>
<span class=linenos data-linenos="1230 "></span>    <span class=k>return</span> <span class=n>path</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.save_training_replies class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">save_training_replies</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>save_training_replies</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Extracts a copy of <code>training_replies</code> and prepares it for saving in breakpoint</p> <ul> <li>strip unwanted fields</li> <li>structure as list/dict, so it can be saved with JSON</li> </ul> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]]]</code> </td> <td> <div class=doc-md-description> <p>Extract from <code>training_replies</code> formatted for breakpoint</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1366 "></span><span class=k>def</span> <span class=nf>save_training_replies</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]:</span>
<span class=linenos data-linenos="1367 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Extracts a copy of `training_replies` and prepares it for saving in breakpoint</span>
<span class=linenos data-linenos="1368 "></span>
<span class=linenos data-linenos="1369 "></span><span class=sd>    - strip unwanted fields</span>
<span class=linenos data-linenos="1370 "></span><span class=sd>    - structure as list/dict, so it can be saved with JSON</span>
<span class=linenos data-linenos="1371 "></span>
<span class=linenos data-linenos="1372 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1373 "></span><span class=sd>        Extract from `training_replies` formatted for breakpoint</span>
<span class=linenos data-linenos="1374 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1375 "></span>    <span class=n>converted_training_replies</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>training_replies</span><span class=p>())</span>
<span class=linenos data-linenos="1376 "></span>    <span class=k>for</span> <span class=n>training_reply</span> <span class=ow>in</span> <span class=n>converted_training_replies</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
<span class=linenos data-linenos="1377 "></span>        <span class=c1># we want to strip some fields for the breakpoint</span>
<span class=linenos data-linenos="1378 "></span>        <span class=k>for</span> <span class=n>reply</span> <span class=ow>in</span> <span class=n>training_reply</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
<span class=linenos data-linenos="1379 "></span>            <span class=n>reply</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s1>&#39;params&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
<span class=linenos data-linenos="1380 "></span>    <span class=k>return</span> <span class=n>converted_training_replies</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_agg_optimizer class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_agg_optimizer</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_agg_optimizer</span><span class=p>(</span><span class=n>agg_optimizer</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets the optional researcher optimizer.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>agg_optimizer</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.optimizers.Optimizer" href="../../common/optimizers/#fedbiomed.common.optimizers.Optimizer">Optimizer</a>]</code> </td> <td> <div class=doc-md-description> <p>Optional fedbiomed Optimizer instance to be used so as to refine aggregated updates prior to applying them. If None, equivalent to using vanilla SGD with 1.0 learning rate.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.optimizers.Optimizer" href="../../common/optimizers/#fedbiomed.common.optimizers.Optimizer">Optimizer</a>]</code> </td> <td> <div class=doc-md-description> <p>The optional researcher optimizer attached to this Experiment.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>if <code>optimizer</code> is of unproper type.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="428 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="429 "></span><span class=k>def</span> <span class=nf>set_agg_optimizer</span><span class=p>(</span>
<span class=linenos data-linenos="430 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="431 "></span>    <span class=n>agg_optimizer</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Optimizer</span><span class=p>],</span>
<span class=linenos data-linenos="432 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Optimizer</span><span class=p>]:</span>
<span class=linenos data-linenos="433 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets the optional researcher optimizer.</span>
<span class=linenos data-linenos="434 "></span>
<span class=linenos data-linenos="435 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="436 "></span><span class=sd>        agg_optimizer: Optional fedbiomed Optimizer instance to be</span>
<span class=linenos data-linenos="437 "></span><span class=sd>            used so as to refine aggregated updates prior to applying them.</span>
<span class=linenos data-linenos="438 "></span><span class=sd>            If None, equivalent to using vanilla SGD with 1.0 learning rate.</span>
<span class=linenos data-linenos="439 "></span>
<span class=linenos data-linenos="440 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="441 "></span><span class=sd>        The optional researcher optimizer attached to this Experiment.</span>
<span class=linenos data-linenos="442 "></span>
<span class=linenos data-linenos="443 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="444 "></span><span class=sd>        FedbiomedExperimentError: if `optimizer` is of unproper type.</span>
<span class=linenos data-linenos="445 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="446 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span>
<span class=linenos data-linenos="447 "></span>        <span class=n>agg_optimizer</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span>
<span class=linenos data-linenos="448 "></span>        <span class=nb>isinstance</span><span class=p>(</span><span class=n>agg_optimizer</span><span class=p>,</span> <span class=n>Optimizer</span><span class=p>)</span>
<span class=linenos data-linenos="449 "></span>    <span class=p>):</span>
<span class=linenos data-linenos="450 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span>
<span class=linenos data-linenos="451 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: &#39;agg_optimizer&#39; must be an &quot;</span>
<span class=linenos data-linenos="452 "></span>            <span class=sa>f</span><span class=s2>&quot;Optimizer instance or None, not </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>agg_optimizer</span><span class=p>)</span><span class=si>}</span><span class=s2>.&quot;</span>
<span class=linenos data-linenos="453 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="454 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_agg_optimizer</span> <span class=o>=</span> <span class=n>agg_optimizer</span>
<span class=linenos data-linenos="455 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_agg_optimizer</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_aggregator class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_aggregator</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_aggregator</span><span class=p>(</span><span class=n>aggregator</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets aggregator + verification on arguments type</p> <p>Ensures consistency with the training data.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>aggregator</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a>]</code> </td> <td> <div class=doc-md-description> <p>Object defining the method for aggregating local updates. Default to None (use <code>FedAverage</code> for aggregation)</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a></code> </td> <td> <div class=doc-md-description> <p>aggregator (Aggregator)</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad aggregator type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="362 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="363 "></span><span class=k>def</span> <span class=nf>set_aggregator</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>aggregator</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Aggregator</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Aggregator</span><span class=p>:</span>
<span class=linenos data-linenos="364 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets aggregator + verification on arguments type</span>
<span class=linenos data-linenos="365 "></span>
<span class=linenos data-linenos="366 "></span><span class=sd>    Ensures consistency with the training data.</span>
<span class=linenos data-linenos="367 "></span>
<span class=linenos data-linenos="368 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="369 "></span><span class=sd>        aggregator: Object defining the method for aggregating local updates. Default to None</span>
<span class=linenos data-linenos="370 "></span><span class=sd>            (use `FedAverage` for aggregation)</span>
<span class=linenos data-linenos="371 "></span>
<span class=linenos data-linenos="372 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="373 "></span><span class=sd>        aggregator (Aggregator)</span>
<span class=linenos data-linenos="374 "></span>
<span class=linenos data-linenos="375 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="376 "></span><span class=sd>        FedbiomedExperimentError : bad aggregator type</span>
<span class=linenos data-linenos="377 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="378 "></span>
<span class=linenos data-linenos="379 "></span>    <span class=k>if</span> <span class=n>aggregator</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="380 "></span>        <span class=c1># default aggregator</span>
<span class=linenos data-linenos="381 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=o>=</span> <span class=n>FedAverage</span><span class=p>()</span>
<span class=linenos data-linenos="382 "></span>
<span class=linenos data-linenos="383 "></span>    <span class=k>elif</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>aggregator</span><span class=p>,</span> <span class=n>Aggregator</span><span class=p>):</span>
<span class=linenos data-linenos="384 "></span>
<span class=linenos data-linenos="385 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: aggregator is not an instance of Aggregator.&quot;</span>
<span class=linenos data-linenos="386 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="387 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="388 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="389 "></span>        <span class=c1># at this point, `agregator` is an instance / inheriting of `Aggregator`</span>
<span class=linenos data-linenos="390 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=o>=</span> <span class=n>aggregator</span>
<span class=linenos data-linenos="391 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>aggregator_args</span><span class=p>[</span><span class=s2>&quot;aggregator_name&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>aggregator_name</span>
<span class=linenos data-linenos="392 "></span>    <span class=c1># ensure consistency with federated dataset</span>
<span class=linenos data-linenos="393 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>set_fds</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>)</span>
<span class=linenos data-linenos="394 "></span>
<span class=linenos data-linenos="395 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_retain_full_history class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_retain_full_history</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_retain_full_history</span><span class=p>(</span><span class=n>retain_full_history_</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets the status of whether the full experiment history should be kept in memory.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>retain_full_history_</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>whether to retain in memory the full history of node replies and aggregated params for the experiment. If False, only the last round's replies and aggregated params will be available. Defaults to True.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>The status of whether the full experiment history should be kept in memory.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="661 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="662 "></span><span class=k>def</span> <span class=nf>set_retain_full_history</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>retain_full_history_</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>):</span>
<span class=linenos data-linenos="663 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets the status of whether the full experiment history should be kept in memory.</span>
<span class=linenos data-linenos="664 "></span>
<span class=linenos data-linenos="665 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="666 "></span><span class=sd>        retain_full_history_: whether to retain in memory the full history of node replies and aggregated params</span>
<span class=linenos data-linenos="667 "></span><span class=sd>            for the experiment. If False, only the last round&#39;s replies and aggregated params will be available.</span>
<span class=linenos data-linenos="668 "></span><span class=sd>            Defaults to True.</span>
<span class=linenos data-linenos="669 "></span>
<span class=linenos data-linenos="670 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="671 "></span><span class=sd>        The status of whether the full experiment history should be kept in memory.</span>
<span class=linenos data-linenos="672 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="673 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>retain_full_history_</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="674 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39;: retain_full_history should be a bool, instead got &#39;</span> \
<span class=linenos data-linenos="675 "></span>                                         <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>retain_full_history_</span><span class=p>)</span><span class=si>}</span><span class=s1> &#39;</span>
<span class=linenos data-linenos="676 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="677 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="678 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_retain_full_history</span> <span class=o>=</span> <span class=n>retain_full_history_</span>
<span class=linenos data-linenos="679 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_retain_full_history</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_round_limit class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_round_limit</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_round_limit</span><span class=p>(</span><span class=n>round_limit</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets <code>round_limit</code> + verification on arguments type</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>round_limit</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, None]</code> </td> <td> <div class=doc-md-description> <p>the maximum number of training rounds (nodes &lt;-&gt; central server) that should be executed for the experiment. <code>None</code> means that no limit is defined.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Round limit for experiment of federated learning</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedValueError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedValueError">FedbiomedValueError</a></code> </td> <td> <div class=doc-md-description> <p>bad rounds type or value</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="492 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="493 "></span><span class=k>def</span> <span class=nf>set_round_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>round_limit</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="494 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets `round_limit` + verification on arguments type</span>
<span class=linenos data-linenos="495 "></span>
<span class=linenos data-linenos="496 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="497 "></span><span class=sd>        round_limit: the maximum number of training rounds (nodes &lt;-&gt; central server) that should be executed</span>
<span class=linenos data-linenos="498 "></span><span class=sd>            for the experiment. `None` means that no limit is defined.</span>
<span class=linenos data-linenos="499 "></span>
<span class=linenos data-linenos="500 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="501 "></span><span class=sd>        Round limit for experiment of federated learning</span>
<span class=linenos data-linenos="502 "></span>
<span class=linenos data-linenos="503 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="504 "></span><span class=sd>        FedbiomedValueError : bad rounds type or value</span>
<span class=linenos data-linenos="505 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="506 "></span>    <span class=c1># at this point round_current exists and is an int &gt;= 0</span>
<span class=linenos data-linenos="507 "></span>
<span class=linenos data-linenos="508 "></span>    <span class=k>if</span> <span class=n>round_limit</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="509 "></span>        <span class=c1># no limit for training rounds</span>
<span class=linenos data-linenos="510 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="511 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="512 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_check_round_value_consistency</span><span class=p>(</span><span class=n>round_limit</span><span class=p>,</span> <span class=s2>&quot;round_limit&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="513 "></span>        <span class=k>if</span> <span class=n>round_limit</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>:</span>
<span class=linenos data-linenos="514 "></span>            <span class=c1># self._round_limit can&#39;t be less than current round</span>
<span class=linenos data-linenos="515 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;cannot set `round_limit` to less than the number of already run rounds &#39;</span> \
<span class=linenos data-linenos="516 "></span>                <span class=sa>f</span><span class=s1>&#39;(</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=si>}</span><span class=s1>)&#39;</span>
<span class=linenos data-linenos="517 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="518 "></span>            <span class=k>raise</span> <span class=n>FedbiomedValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="519 "></span>
<span class=linenos data-linenos="520 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="521 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=n>round_limit</span>
<span class=linenos data-linenos="522 "></span>
<span class=linenos data-linenos="523 "></span>    <span class=c1># at this point self._round_limit is a Union[int, None]</span>
<span class=linenos data-linenos="524 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_strategy class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_strategy</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_strategy</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets for <code>node_selection_strategy</code> + verification on arguments type</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>node_selection_strategy</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a>]</code> </td> <td> <div class=doc-md-description> <p>object defining how nodes are sampled at each round for training, and how non-responding nodes are managed. Defaults to None: - use <code>DefaultStrategy</code> if training_data is initialized - else strategy is None (cannot be initialized), experiment cannot be launched yet</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a>, None]</code> </td> <td> <div class=doc-md-description> <p>node selection strategy class</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad strategy type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="457 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="458 "></span><span class=k>def</span> <span class=nf>set_strategy</span><span class=p>(</span>
<span class=linenos data-linenos="459 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="460 "></span>    <span class=n>node_selection_strategy</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Strategy</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="461 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>Strategy</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="462 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets for `node_selection_strategy` + verification on arguments type</span>
<span class=linenos data-linenos="463 "></span>
<span class=linenos data-linenos="464 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="465 "></span><span class=sd>        node_selection_strategy: object defining how nodes are sampled at each round for training, and</span>
<span class=linenos data-linenos="466 "></span><span class=sd>            how non-responding nodes are managed. Defaults to None:</span>
<span class=linenos data-linenos="467 "></span><span class=sd>            - use `DefaultStrategy` if training_data is initialized</span>
<span class=linenos data-linenos="468 "></span><span class=sd>            - else strategy is None (cannot be initialized), experiment cannot</span>
<span class=linenos data-linenos="469 "></span><span class=sd>              be launched yet</span>
<span class=linenos data-linenos="470 "></span>
<span class=linenos data-linenos="471 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="472 "></span><span class=sd>        node selection strategy class</span>
<span class=linenos data-linenos="473 "></span>
<span class=linenos data-linenos="474 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="475 "></span><span class=sd>        FedbiomedExperimentError : bad strategy type</span>
<span class=linenos data-linenos="476 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="477 "></span>    <span class=k>if</span> <span class=n>node_selection_strategy</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="478 "></span>        <span class=c1># default node_selection_strategy</span>
<span class=linenos data-linenos="479 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=o>=</span> <span class=n>DefaultStrategy</span><span class=p>()</span>
<span class=linenos data-linenos="480 "></span>    <span class=k>elif</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=p>,</span> <span class=n>Strategy</span><span class=p>):</span>
<span class=linenos data-linenos="481 "></span>
<span class=linenos data-linenos="482 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: wrong type for &quot;</span> \
<span class=linenos data-linenos="483 "></span>              <span class=s2>&quot;node_selection_strategy {type(node_selection_strategy)} &quot;</span> \
<span class=linenos data-linenos="484 "></span>              <span class=s2>&quot;it should be an instance of Strategy&quot;</span>
<span class=linenos data-linenos="485 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="486 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="487 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="488 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=o>=</span> <span class=n>node_selection_strategy</span>
<span class=linenos data-linenos="489 "></span>    <span class=c1># at this point self._node_selection_strategy is a Union[Strategy, None]</span>
<span class=linenos data-linenos="490 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_tensorboard class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_tensorboard</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_tensorboard</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets the tensorboard flag</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tensorboard</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>If <code>True</code> tensorboard log files will be writen after receiving training feedbacks</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>Status of tensorboard</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="639 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="640 "></span><span class=k>def</span> <span class=nf>set_tensorboard</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tensorboard</span><span class=p>:</span> <span class=nb>bool</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="641 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="642 "></span><span class=sd>    Sets the tensorboard flag</span>
<span class=linenos data-linenos="643 "></span>
<span class=linenos data-linenos="644 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="645 "></span><span class=sd>        tensorboard: If `True` tensorboard log files will be writen after receiving training feedbacks</span>
<span class=linenos data-linenos="646 "></span>
<span class=linenos data-linenos="647 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="648 "></span><span class=sd>        Status of tensorboard</span>
<span class=linenos data-linenos="649 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="650 "></span>
<span class=linenos data-linenos="651 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="652 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_tensorboard</span> <span class=o>=</span> <span class=n>tensorboard</span>
<span class=linenos data-linenos="653 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span><span class=o>.</span><span class=n>set_tensorboard</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>)</span>
<span class=linenos data-linenos="654 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="655 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `tensorboard` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="656 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="657 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="658 "></span>
<span class=linenos data-linenos="659 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tensorboard</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_test_metric class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_test_metric</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_test_metric</span><span class=p>(</span><span class=n>metric</span><span class=p>,</span> <span class=o>**</span><span class=n>metric_args</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets a metric for federated model validation</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>metric</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.metrics.MetricTypes" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes">MetricTypes</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, None]</code> </td> <td> <div class=doc-md-description> <p>A class as an instance of <a class="autorefs autorefs-internal" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes"><code>MetricTypes</code></a>. <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> for referring one of metric which provided as attributes in <a class="autorefs autorefs-internal" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes"><code>MetricTypes</code></a>. None, if it isn't declared yet.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>**metric_args</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>A dictionary that contains arguments for metric function. Arguments should be compatible with corresponding metrics in <a class="autorefs autorefs-external" href="https://scikit-learn.org/stable/api/sklearn.metrics.html#module-sklearn.metrics"><code>sklearn.metrics</code></a>.</p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, None], <a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]]</code> </td> <td> <div class=doc-md-description> <p>Metric and metric args as tuple</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>Invalid type for <code>metric</code> argument</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="579 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="580 "></span><span class=k>def</span> <span class=nf>set_test_metric</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>metric</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>MetricTypes</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span> <span class=o>**</span><span class=n>metric_args</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> \
<span class=linenos data-linenos="581 "></span>        <span class=n>Tuple</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
<span class=linenos data-linenos="582 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Sets a metric for federated model validation</span>
<span class=linenos data-linenos="583 "></span>
<span class=linenos data-linenos="584 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="585 "></span><span class=sd>        metric: A class as an instance of [`MetricTypes`][fedbiomed.common.metrics.MetricTypes]. [`str`][str] for</span>
<span class=linenos data-linenos="586 "></span><span class=sd>            referring one of  metric which provided as attributes in [`MetricTypes`]</span>
<span class=linenos data-linenos="587 "></span><span class=sd>            [fedbiomed.common.metrics.MetricTypes]. None, if it isn&#39;t declared yet.</span>
<span class=linenos data-linenos="588 "></span><span class=sd>        **metric_args: A dictionary that contains arguments for metric function. Arguments</span>
<span class=linenos data-linenos="589 "></span><span class=sd>            should be compatible with corresponding metrics in [`sklearn.metrics`][sklearn.metrics].</span>
<span class=linenos data-linenos="590 "></span>
<span class=linenos data-linenos="591 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="592 "></span><span class=sd>        Metric and  metric args as tuple</span>
<span class=linenos data-linenos="593 "></span>
<span class=linenos data-linenos="594 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="595 "></span><span class=sd>        FedbiomedExperimentError: Invalid type for `metric` argument</span>
<span class=linenos data-linenos="596 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="597 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_metric&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>metric</span>
<span class=linenos data-linenos="598 "></span>
<span class=linenos data-linenos="599 "></span>    <span class=c1># using **metric_args, we know `test_metric_args` is a Dict[str, Any]</span>
<span class=linenos data-linenos="600 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_metric_args&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>metric_args</span>
<span class=linenos data-linenos="601 "></span>    <span class=k>return</span> <span class=n>metric</span><span class=p>,</span> <span class=n>metric_args</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_test_on_global_updates class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_test_on_global_updates</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_test_on_global_updates</span><span class=p>(</span><span class=n>flag</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Setter for test_on_global_updates, that indicates whether to perform a validation on the federated model updates on the node side before training model locally where aggregated model parameters are received.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>flag</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>whether to perform model validation on global updates. Defaults to True.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>Value of the flag <code>test_on_global_updates</code>.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad flag type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="621 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="622 "></span><span class=k>def</span> <span class=nf>set_test_on_global_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>flag</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="623 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="624 "></span><span class=sd>    Setter for test_on_global_updates, that indicates whether to  perform a validation on the federated model</span>
<span class=linenos data-linenos="625 "></span><span class=sd>    updates on the node side before training model locally where aggregated model parameters are received.</span>
<span class=linenos data-linenos="626 "></span>
<span class=linenos data-linenos="627 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="628 "></span><span class=sd>        flag (bool, optional): whether to perform model validation on global updates. Defaults to True.</span>
<span class=linenos data-linenos="629 "></span>
<span class=linenos data-linenos="630 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="631 "></span><span class=sd>        Value of the flag `test_on_global_updates`.</span>
<span class=linenos data-linenos="632 "></span>
<span class=linenos data-linenos="633 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="634 "></span><span class=sd>        FedbiomedExperimentError : bad flag type</span>
<span class=linenos data-linenos="635 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="636 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_global_updates&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span>
<span class=linenos data-linenos="637 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_global_updates&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_test_on_local_updates class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_test_on_local_updates</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_test_on_local_updates</span><span class=p>(</span><span class=n>flag</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Setter for <code>test_on_local_updates</code>, that indicates whether to perform a validation on the federated model on the node side where model parameters are updated locally after training in each node.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>flag</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>whether to perform model validation on local updates. Defaults to True.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>value of the flag <code>test_on_local_updates</code></p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad flag type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="603 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="604 "></span><span class=k>def</span> <span class=nf>set_test_on_local_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>flag</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="605 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="606 "></span><span class=sd>    Setter for `test_on_local_updates`, that indicates whether to perform a validation on the federated model on the</span>
<span class=linenos data-linenos="607 "></span><span class=sd>    node side where model parameters are updated locally after training in each node.</span>
<span class=linenos data-linenos="608 "></span>
<span class=linenos data-linenos="609 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="610 "></span><span class=sd>        flag (bool, optional): whether to perform model validation on local updates. Defaults to True.</span>
<span class=linenos data-linenos="611 "></span>
<span class=linenos data-linenos="612 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="613 "></span><span class=sd>        value of the flag `test_on_local_updates`</span>
<span class=linenos data-linenos="614 "></span>
<span class=linenos data-linenos="615 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="616 "></span><span class=sd>        FedbiomedExperimentError: bad flag type</span>
<span class=linenos data-linenos="617 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="618 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_local_updates&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span>
<span class=linenos data-linenos="619 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_local_updates&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_test_ratio class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_test_ratio</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_test_ratio</span><span class=p>(</span><span class=n>ratio</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets validation ratio for model validation.</p> <p>When setting test_ratio, nodes will allocate (1 - <code>test_ratio</code>) fraction of data for training and the remaining for validating model. This could be useful for validating the model, once every round, as well as controlling overfitting, doing early stopping, ....</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>ratio</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code> </td> <td> <div class=doc-md-description> <p>validation ratio. Must be within interval [0,1].</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code> </td> <td> <div class=doc-md-description> <p>Validation ratio that is set</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad data type</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>ratio is not within interval [0, 1]</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="558 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="559 "></span><span class=k>def</span> <span class=nf>set_test_ratio</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ratio</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=linenos data-linenos="560 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Sets validation ratio for model validation.</span>
<span class=linenos data-linenos="561 "></span>
<span class=linenos data-linenos="562 "></span><span class=sd>    When setting test_ratio, nodes will allocate (1 - `test_ratio`) fraction of data for training and the</span>
<span class=linenos data-linenos="563 "></span><span class=sd>    remaining for validating model. This could be useful for validating the model, once every round, as well as</span>
<span class=linenos data-linenos="564 "></span><span class=sd>    controlling overfitting, doing early stopping, ....</span>
<span class=linenos data-linenos="565 "></span>
<span class=linenos data-linenos="566 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="567 "></span><span class=sd>        ratio: validation ratio. Must be within interval [0,1].</span>
<span class=linenos data-linenos="568 "></span>
<span class=linenos data-linenos="569 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="570 "></span><span class=sd>        Validation ratio that is set</span>
<span class=linenos data-linenos="571 "></span>
<span class=linenos data-linenos="572 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="573 "></span><span class=sd>        FedbiomedExperimentError: bad data type</span>
<span class=linenos data-linenos="574 "></span><span class=sd>        FedbiomedExperimentError: ratio is not within interval [0, 1]</span>
<span class=linenos data-linenos="575 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="576 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ratio</span>
<span class=linenos data-linenos="577 "></span>    <span class=k>return</span> <span class=n>ratio</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.set_training_data class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_training_data</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_training_data</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=n>from_tags</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets training data for federated training + verification on arguments type</p> <p>See <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_training_data"><code>FederatedWorkflow.set_training_data</code></a> for more information.</p> <p>Ensures consistency also with the Experiment's aggregator and node state agent</p> <div class="admonition warning"> <p class=admonition-title>Setting to None forfeits consistency checks</p> <p>Setting training_data to None does not trigger consistency checks, and may therefore leave the class in an inconsistent state.</p> </div> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Dataset metadata</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="397 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="398 "></span><span class=k>def</span> <span class=nf>set_training_data</span><span class=p>(</span>
<span class=linenos data-linenos="399 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="400 "></span>        <span class=n>training_data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span>
<span class=linenos data-linenos="401 "></span>        <span class=n>from_tags</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> \
<span class=linenos data-linenos="402 "></span>        <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="403 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets training data for federated training + verification on arguments type</span>
<span class=linenos data-linenos="404 "></span>
<span class=linenos data-linenos="405 "></span><span class=sd>    See</span>
<span class=linenos data-linenos="406 "></span><span class=sd>    [`FederatedWorkflow.set_training_data`][fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_training_data]</span>
<span class=linenos data-linenos="407 "></span><span class=sd>    for more information.</span>
<span class=linenos data-linenos="408 "></span>
<span class=linenos data-linenos="409 "></span><span class=sd>    Ensures consistency also with the Experiment&#39;s aggregator and node state agent</span>
<span class=linenos data-linenos="410 "></span>
<span class=linenos data-linenos="411 "></span><span class=sd>    !!! warning &quot;Setting to None forfeits consistency checks&quot;</span>
<span class=linenos data-linenos="412 "></span><span class=sd>        Setting training_data to None does not trigger consistency checks, and may therefore leave the class in an</span>
<span class=linenos data-linenos="413 "></span><span class=sd>        inconsistent state.</span>
<span class=linenos data-linenos="414 "></span>
<span class=linenos data-linenos="415 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="416 "></span><span class=sd>        Dataset metadata</span>
<span class=linenos data-linenos="417 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="418 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>set_training_data</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=n>from_tags</span><span class=p>)</span>
<span class=linenos data-linenos="419 "></span>    <span class=c1># Below: Experiment-specific operations for consistency</span>
<span class=linenos data-linenos="420 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="421 "></span>        <span class=c1># update the aggregator&#39;s training data</span>
<span class=linenos data-linenos="422 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>set_fds</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>)</span>
<span class=linenos data-linenos="423 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_state_agent</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="424 "></span>        <span class=c1># update the node state agent (member of FederatedWorkflow)</span>
<span class=linenos data-linenos="425 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_node_state_agent</span><span class=o>.</span><span class=n>update_node_states</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>all_federation_nodes</span><span class=p>())</span>
<span class=linenos data-linenos="426 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.strategy class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">strategy</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>strategy</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the class that represents the node selection strategy.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_strategy"><code>set_strategy</code></a> to set or update node selection strategy.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a>, None]</code> </td> <td> <div class=doc-md-description> <p>A class or object as an instance of <a class="autorefs autorefs-internal" href="../strategies/#fedbiomed.researcher.strategies.Strategy"><code>Strategy</code></a>. <code>None</code> if it is not declared yet. It means that node selection strategy will be <a class="autorefs autorefs-internal" href="../strategies/#fedbiomed.researcher.strategies.DefaultStrategy"><code>DefaultStrategy</code></a>.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="185 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="186 "></span><span class=k>def</span> <span class=nf>strategy</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>Strategy</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="187 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the class that represents the node selection strategy.</span>
<span class=linenos data-linenos="188 "></span>
<span class=linenos data-linenos="189 "></span><span class=sd>    Please see also [`set_strategy`][fedbiomed.researcher.federated_workflows.Experiment.set_strategy]</span>
<span class=linenos data-linenos="190 "></span><span class=sd>    to set or update node selection strategy.</span>
<span class=linenos data-linenos="191 "></span>
<span class=linenos data-linenos="192 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="193 "></span><span class=sd>        A class or object as an instance of [`Strategy`][fedbiomed.researcher.strategies.Strategy]. `None` if</span>
<span class=linenos data-linenos="194 "></span><span class=sd>            it is not declared yet. It means that node selection strategy will be</span>
<span class=linenos data-linenos="195 "></span><span class=sd>            [`DefaultStrategy`][fedbiomed.researcher.strategies.DefaultStrategy].</span>
<span class=linenos data-linenos="196 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="197 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.test_metric class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">test_metric</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>test_metric</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the metric for validation routine.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_test_metric"><code>set_test_metric</code></a> to change/set <code>test_metric</code></p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.metrics.MetricTypes" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes">MetricTypes</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, None]</code> </td> <td> <div class=doc-md-description> <p>A class as an instance of <a class="autorefs autorefs-internal" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes"><code>MetricTypes</code></a>. <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> for referring one of metric which provided as attributes in <a class="autorefs autorefs-internal" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes"><code>MetricTypes</code></a>. None, if it isn't declared yet.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="233 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="234 "></span><span class=k>def</span> <span class=nf>test_metric</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>MetricTypes</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="235 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the metric for validation routine.</span>
<span class=linenos data-linenos="236 "></span>
<span class=linenos data-linenos="237 "></span><span class=sd>    Please see also [`set_test_metric`][fedbiomed.researcher.federated_workflows.Experiment.set_test_metric]</span>
<span class=linenos data-linenos="238 "></span><span class=sd>        to change/set `test_metric`</span>
<span class=linenos data-linenos="239 "></span>
<span class=linenos data-linenos="240 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="241 "></span><span class=sd>        A class as an instance of [`MetricTypes`][fedbiomed.common.metrics.MetricTypes]. [`str`][str] for referring</span>
<span class=linenos data-linenos="242 "></span><span class=sd>            one of  metric which provided as attributes in [`MetricTypes`][fedbiomed.common.metrics.MetricTypes].</span>
<span class=linenos data-linenos="243 "></span><span class=sd>            None, if it isn&#39;t declared yet.</span>
<span class=linenos data-linenos="244 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="245 "></span>
<span class=linenos data-linenos="246 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_metric&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.test_metric_args class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">test_metric_args</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>test_metric_args</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the metric argument for the metric function that is going to be used.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_test_metric"><code>set_test_metric</code></a> to change/set <code>test_metric</code> and get more information on the arguments can be used.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code> </td> <td> <div class=doc-md-description> <p>A dictionary that contains arguments for metric function. See <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_test_metric"><code>set_test_metric</code></a></p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="248 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="249 "></span><span class=k>def</span> <span class=nf>test_metric_args</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<span class=linenos data-linenos="250 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the metric argument for the metric function that is going to be used.</span>
<span class=linenos data-linenos="251 "></span>
<span class=linenos data-linenos="252 "></span><span class=sd>    Please see also [`set_test_metric`][fedbiomed.researcher.federated_workflows.Experiment.set_test_metric]</span>
<span class=linenos data-linenos="253 "></span><span class=sd>    to change/set `test_metric` and get more information on the arguments can be used.</span>
<span class=linenos data-linenos="254 "></span>
<span class=linenos data-linenos="255 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="256 "></span><span class=sd>        A dictionary that contains arguments for metric function. See [`set_test_metric`]</span>
<span class=linenos data-linenos="257 "></span><span class=sd>            [fedbiomed.researcher.federated_workflows.Experiment.set_test_metric]</span>
<span class=linenos data-linenos="258 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="259 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_metric_args&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.test_on_global_updates class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">test_on_global_updates</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>test_on_global_updates</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the status of whether validation will be performed on globally updated (aggregated) parameters by the nodes at the beginning of each round.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_test_on_global_updates"><code>set_test_on_global_updates</code></a>.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>True, if validation is active on globally updated (aggregated) parameters. False for vice versa.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="275 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="276 "></span><span class=k>def</span> <span class=nf>test_on_global_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="277 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Retrieves the status of whether validation will be performed on globally updated (aggregated)</span>
<span class=linenos data-linenos="278 "></span><span class=sd>    parameters by the nodes at the beginning of each round.</span>
<span class=linenos data-linenos="279 "></span>
<span class=linenos data-linenos="280 "></span><span class=sd>    Please see also [`set_test_on_global_updates`]</span>
<span class=linenos data-linenos="281 "></span><span class=sd>    [fedbiomed.researcher.federated_workflows.Experiment.set_test_on_global_updates].</span>
<span class=linenos data-linenos="282 "></span>
<span class=linenos data-linenos="283 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="284 "></span><span class=sd>        True, if validation is active on globally updated (aggregated) parameters. False for vice versa.</span>
<span class=linenos data-linenos="285 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="286 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_global_updates&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.test_on_local_updates class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">test_on_local_updates</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>test_on_local_updates</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the status of whether validation will be performed on locally updated parameters by the nodes at the end of each round.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_test_on_local_updates"><code>set_test_on_local_updates</code></a>.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>True, if validation is active on locally updated parameters. False for vice versa.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="261 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="262 "></span><span class=k>def</span> <span class=nf>test_on_local_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="263 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the status of whether validation will be performed on locally updated parameters by</span>
<span class=linenos data-linenos="264 "></span><span class=sd>    the nodes at the end of each round.</span>
<span class=linenos data-linenos="265 "></span>
<span class=linenos data-linenos="266 "></span><span class=sd>    Please see also</span>
<span class=linenos data-linenos="267 "></span><span class=sd>        [`set_test_on_local_updates`][fedbiomed.researcher.federated_workflows.Experiment.set_test_on_local_updates].</span>
<span class=linenos data-linenos="268 "></span>
<span class=linenos data-linenos="269 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="270 "></span><span class=sd>        True, if validation is active on locally updated parameters. False for vice versa.</span>
<span class=linenos data-linenos="271 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="272 "></span>
<span class=linenos data-linenos="273 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_local_updates&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.test_ratio class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">test_ratio</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>test_ratio</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the ratio for validation partition of entire dataset.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.Experiment.set_test_ratio"><code>set_test_ratio</code></a> to change/set <code>test_ratio</code></p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code> </td> <td> <div class=doc-md-description> <p>The ratio for validation part, <code>1 - test_ratio</code> is ratio for training set.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="220 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="221 "></span><span class=k>def</span> <span class=nf>test_ratio</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=linenos data-linenos="222 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the ratio for validation partition of entire dataset.</span>
<span class=linenos data-linenos="223 "></span>
<span class=linenos data-linenos="224 "></span><span class=sd>    Please see also [`set_test_ratio`][fedbiomed.researcher.federated_workflows.Experiment.set_test_ratio] to</span>
<span class=linenos data-linenos="225 "></span><span class=sd>        change/set `test_ratio`</span>
<span class=linenos data-linenos="226 "></span>
<span class=linenos data-linenos="227 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="228 "></span><span class=sd>        The ratio for validation part, `1 - test_ratio` is ratio for training set.</span>
<span class=linenos data-linenos="229 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="230 "></span>
<span class=linenos data-linenos="231 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_ratio&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.Experiment.training_replies class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">training_replies</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>training_replies</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves training replies of each round of training.</p> <p>Training replies contains timing statistics and the files parth/URLs that has been received after each round.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Dictionary of training replies with format {round (int) : replies (dict)}</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="310 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="311 "></span><span class=k>def</span> <span class=nf>training_replies</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="312 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves training replies of each round of training.</span>
<span class=linenos data-linenos="313 "></span>
<span class=linenos data-linenos="314 "></span><span class=sd>    Training replies contains timing statistics and the files parth/URLs that has been received after each round.</span>
<span class=linenos data-linenos="315 "></span>
<span class=linenos data-linenos="316 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="317 "></span><span class=sd>        Dictionary of training replies with format {round (int) : replies (dict)}</span>
<span class=linenos data-linenos="318 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="319 "></span>
<span class=linenos data-linenos="320 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_replies</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">FederatedWorkflow</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>FederatedWorkflow</span><span class=p>(</span><span class=n>tags</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>nodes</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>training_data</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>experimentation_folder</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>secagg</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>save_breakpoints</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-external" title="abc.ABC" href="https://docs.python.org/3/library/abc.html#abc.ABC">ABC</a></code></p> <p>A FederatedWorkflow is the abstract entry point for the researcher to orchestrate both local and remote operations.</p> <p>The FederatedWorkflow is an abstract base class from which the actual classes used by the researcher must inherit. It manages the life-cycle of:</p> <ul> <li>the training arguments</li> <li>secure aggregation</li> <li>the node state agent</li> </ul> <p>Additionally, it provides the basis for the breakpoint functionality, and manages some backend functionalities such as the temporary directory, the experiment ID, etc...</p> <p>The attributes <code>training_data</code> and <code>tags</code> are co-dependent. Attempting to modify one of those may result in side effects modifying the other, according to the following rules: - modifying tags if training data is not None will reset the training data based on the new tags - modifying the training data using a FederatedDataset object or a dict will set tags to None</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tags</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>list of string with data tags or string with one data tag. Empty list of tags ([]) means any dataset is accepted, it is different from None (tags not set, cannot search for training_data yet).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>nodes</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]]</code> </td> <td> <div class=doc-md-description> <p>list of node_ids to filter the nodes to be involved in the experiment. Defaults to None (no filtering).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>training_data</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>, None]</code> </td> <td> <div class=doc-md-description> <ul> <li>If it is a FederatedDataSet object, use this value as training_data.</li> <li>else if it is a dict, create and use a FederatedDataSet object from the dict and use this value as training_data. The dict should use node ids as keys, values being list of dicts (each dict representing a dataset on a node).</li> <li>else if it is None (no training data provided)</li> <li>if <code>tags</code> is not None, set training_data by searching for datasets with a query to the nodes using <code>tags</code> and <code>nodes</code></li> <li>if <code>tags</code> is None, set training_data to None (no training_data set yet, experiment is not fully initialized and cannot be launched) Defaults to None (query nodes for dataset if <code>tags</code> is not None, set training_data to None else)</li> </ul> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>save_breakpoints</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>whether to save breakpoints or not after each training round. Breakpoints can be used for resuming a crashed experiment.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td><code>experimentation_folder</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, None]</code> </td> <td> <div class=doc-md-description> <p>choose a specific name for the folder where experimentation result files and breakpoints are stored. This should just contain the name for the folder not a path. The name is used as a subdirectory of <code>environ[EXPERIMENTS_DIR])</code>. Defaults to None (auto-choose a folder name) - Caveat : if using a specific name this experimentation will not be automatically detected as the last experimentation by <code>load_breakpoint</code> - Caveat : do not use a <code>experimentation_folder</code> name finishing with numbers ([0-9]+) as this would confuse the last experimentation detection heuristic by <code>load_breakpoint</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>secagg</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-internal" title="fedbiomed.researcher.secagg.SecureAggregation" href="../secagg/#fedbiomed.researcher.secagg.SecureAggregation">SecureAggregation</a>]</code> </td> <td> <div class=doc-md-description> <p>whether to setup a secure aggregation context for this experiment, and use it to send encrypted updates from nodes to researcher. Defaults to <code>False</code></p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="119 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="120 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos="121 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="122 "></span>    <span class=n>tags</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="123 "></span>    <span class=n>nodes</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="124 "></span>    <span class=n>training_data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="125 "></span>    <span class=n>experimentation_folder</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="126 "></span>    <span class=n>secagg</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>SecureAggregation</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=linenos data-linenos="127 "></span>    <span class=n>save_breakpoints</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=linenos data-linenos="128 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="129 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructor of the class.</span>
<span class=linenos data-linenos="130 "></span>
<span class=linenos data-linenos="131 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="132 "></span><span class=sd>        tags: list of string with data tags or string with one data tag. Empty list of</span>
<span class=linenos data-linenos="133 "></span><span class=sd>            tags ([]) means any dataset is accepted, it is different from None</span>
<span class=linenos data-linenos="134 "></span><span class=sd>            (tags not set, cannot search for training_data yet).</span>
<span class=linenos data-linenos="135 "></span>
<span class=linenos data-linenos="136 "></span><span class=sd>        nodes: list of node_ids to filter the nodes to be involved in the experiment.</span>
<span class=linenos data-linenos="137 "></span><span class=sd>            Defaults to None (no filtering).</span>
<span class=linenos data-linenos="138 "></span>
<span class=linenos data-linenos="139 "></span><span class=sd>        training_data:</span>
<span class=linenos data-linenos="140 "></span><span class=sd>            * If it is a FederatedDataSet object, use this value as training_data.</span>
<span class=linenos data-linenos="141 "></span><span class=sd>            * else if it is a dict, create and use a FederatedDataSet object</span>
<span class=linenos data-linenos="142 "></span><span class=sd>                from the dict and use this value as training_data. The dict should use</span>
<span class=linenos data-linenos="143 "></span><span class=sd>                node ids as keys, values being list of dicts (each dict representing a</span>
<span class=linenos data-linenos="144 "></span><span class=sd>                dataset on a node).</span>
<span class=linenos data-linenos="145 "></span><span class=sd>            * else if it is None (no training data provided)</span>
<span class=linenos data-linenos="146 "></span><span class=sd>              - if `tags` is not None, set training_data by</span>
<span class=linenos data-linenos="147 "></span><span class=sd>                searching for datasets with a query to the nodes using `tags` and `nodes`</span>
<span class=linenos data-linenos="148 "></span><span class=sd>              - if `tags` is None, set training_data to None (no training_data set yet,</span>
<span class=linenos data-linenos="149 "></span><span class=sd>                experiment is not fully initialized and cannot be launched)</span>
<span class=linenos data-linenos="150 "></span><span class=sd>            Defaults to None (query nodes for dataset if `tags` is not None, set training_data</span>
<span class=linenos data-linenos="151 "></span><span class=sd>            to None else)</span>
<span class=linenos data-linenos="152 "></span><span class=sd>        save_breakpoints: whether to save breakpoints or not after each training</span>
<span class=linenos data-linenos="153 "></span><span class=sd>            round. Breakpoints can be used for resuming a crashed experiment.</span>
<span class=linenos data-linenos="154 "></span>
<span class=linenos data-linenos="155 "></span><span class=sd>        experimentation_folder: choose a specific name for the folder</span>
<span class=linenos data-linenos="156 "></span><span class=sd>            where experimentation result files and breakpoints are stored. This</span>
<span class=linenos data-linenos="157 "></span><span class=sd>            should just contain the name for the folder not a path. The name is used</span>
<span class=linenos data-linenos="158 "></span><span class=sd>            as a subdirectory of `environ[EXPERIMENTS_DIR])`. Defaults to None</span>
<span class=linenos data-linenos="159 "></span><span class=sd>            (auto-choose a folder name)</span>
<span class=linenos data-linenos="160 "></span><span class=sd>            - Caveat : if using a specific name this experimentation will not be</span>
<span class=linenos data-linenos="161 "></span><span class=sd>                automatically detected as the last experimentation by `load_breakpoint`</span>
<span class=linenos data-linenos="162 "></span><span class=sd>            - Caveat : do not use a `experimentation_folder` name finishing</span>
<span class=linenos data-linenos="163 "></span><span class=sd>                with numbers ([0-9]+) as this would confuse the last experimentation</span>
<span class=linenos data-linenos="164 "></span><span class=sd>                detection heuristic by `load_breakpoint`.</span>
<span class=linenos data-linenos="165 "></span><span class=sd>        secagg: whether to setup a secure aggregation context for this experiment, and</span>
<span class=linenos data-linenos="166 "></span><span class=sd>            use it to send encrypted updates from nodes to researcher.</span>
<span class=linenos data-linenos="167 "></span><span class=sd>            Defaults to `False`</span>
<span class=linenos data-linenos="168 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="169 "></span>    <span class=c1># predefine all class variables, so no need to write try/except</span>
<span class=linenos data-linenos="170 "></span>    <span class=c1># block each time we use it</span>
<span class=linenos data-linenos="171 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># dataset metadata from the full federation</span>
<span class=linenos data-linenos="172 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span><span class=p>:</span> <span class=n>Requests</span> <span class=o>=</span> <span class=n>Requests</span><span class=p>()</span>
<span class=linenos data-linenos="173 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># researcher-defined nodes filter</span>
<span class=linenos data-linenos="174 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="175 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="176 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>SecureAggregation</span><span class=p>,</span> <span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span>
<span class=linenos data-linenos="177 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="178 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_node_state_agent</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>NodeStateAgent</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="179 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_researcher_id</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>environ</span><span class=p>[</span><span class=s1>&#39;RESEARCHER_ID&#39;</span><span class=p>]</span>
<span class=linenos data-linenos="180 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_experiment_id</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>EXPERIMENT_PREFIX</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>  <span class=c1># creating a unique experiment id</span>
<span class=linenos data-linenos="181 "></span>
<span class=linenos data-linenos="182 "></span>    <span class=c1># set internal members from constructor arguments</span>
<span class=linenos data-linenos="183 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_secagg</span><span class=p>(</span><span class=n>secagg</span><span class=p>)</span>
<span class=linenos data-linenos="184 "></span>
<span class=linenos data-linenos="185 "></span>    <span class=c1># TODO: Manage tags within the FederatedDataset to avoid conflicts</span>
<span class=linenos data-linenos="186 "></span>    <span class=k>if</span> <span class=n>training_data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>tags</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="187 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Can not set `training_data` and `tags` at the &quot;</span> \
<span class=linenos data-linenos="188 "></span>            <span class=s2>&quot;same time. Please provide only `training_data`, or tags to search for &quot;</span> \
<span class=linenos data-linenos="189 "></span>            <span class=s2>&quot;training data.&quot;</span>
<span class=linenos data-linenos="190 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="191 "></span>        <span class=k>raise</span> <span class=n>FedbiomedValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="192 "></span>
<span class=linenos data-linenos="193 "></span>    <span class=c1># Set tags if it tags is not None</span>
<span class=linenos data-linenos="194 "></span>    <span class=k>if</span> <span class=n>tags</span><span class=p>:</span>
<span class=linenos data-linenos="195 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>set_tags</span><span class=p>(</span><span class=n>tags</span><span class=p>)</span>
<span class=linenos data-linenos="196 "></span>
<span class=linenos data-linenos="197 "></span>    <span class=k>if</span> <span class=n>training_data</span><span class=p>:</span>
<span class=linenos data-linenos="198 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>set_training_data</span><span class=p>(</span><span class=n>training_data</span><span class=p>)</span>
<span class=linenos data-linenos="199 "></span>
<span class=linenos data-linenos="200 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_nodes</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>
<span class=linenos data-linenos="201 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_save_breakpoints</span><span class=p>(</span><span class=n>save_breakpoints</span><span class=p>)</span>
<span class=linenos data-linenos="202 "></span>
<span class=linenos data-linenos="203 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_experimentation_folder</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>)</span>
<span class=linenos data-linenos="204 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_node_state_agent</span> <span class=o>=</span> <span class=n>NodeStateAgent</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=o>.</span><span class=n>data</span><span class=p>()</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
<span class=linenos data-linenos="205 "></span>                                            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=o>.</span><span class=n>data</span><span class=p>()</span> <span class=k>else</span> <span class=p>[])</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow-attributes>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.id class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">id</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nb>id</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the unique experiment identifier.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.secagg class="doc doc-heading"> <span class="doc doc-object-name doc-attribute-name">secagg</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=n>secagg</span>
</code></pre></div> <div class="doc doc-contents "> <p>Gets secagg object <code>SecureAggregation</code></p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.researcher.secagg.SecureAggregation" href="../secagg/#fedbiomed.researcher.secagg.SecureAggregation">SecureAggregation</a></code> </td> <td> <div class=doc-md-description> <p>Secure aggregation object.</p> </div> </td> </tr> </tbody> </table> </div> </div> <h4 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.all_federation_nodes class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">all_federation_nodes</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>all_federation_nodes</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Returns all the node ids in the federation</p> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="249 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="250 "></span><span class=k>def</span> <span class=nf>all_federation_nodes</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=linenos data-linenos="251 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns all the node ids in the federation&quot;&quot;&quot;</span>
<span class=linenos data-linenos="252 "></span>    <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=o>.</span><span class=n>data</span><span class=p>()</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=p>[]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.breakpoint class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">breakpoint</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nb>breakpoint</span><span class=p>(</span><span class=nf>state</span><span class=p>,</span> <span class=n>bkpt_number</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Saves breakpoint with the state of the workflow.</p> <p>The following attributes will be saved:</p> <ul> <li>tags</li> <li>experimentation_folder</li> <li>training_data</li> <li>training_args</li> <li>secagg</li> <li>node_state</li> </ul> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>experiment not fully defined, experiment did not run any round yet, or error when saving breakpoint</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="694 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="695 "></span><span class=k>def</span> <span class=nf>breakpoint</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="696 "></span>               <span class=n>state</span><span class=p>:</span> <span class=n>Dict</span><span class=p>,</span>
<span class=linenos data-linenos="697 "></span>               <span class=n>bkpt_number</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="698 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="699 "></span><span class=sd>    Saves breakpoint with the state of the workflow.</span>
<span class=linenos data-linenos="700 "></span>
<span class=linenos data-linenos="701 "></span><span class=sd>    The following attributes will be saved:</span>
<span class=linenos data-linenos="702 "></span>
<span class=linenos data-linenos="703 "></span><span class=sd>      - tags</span>
<span class=linenos data-linenos="704 "></span><span class=sd>      - experimentation_folder</span>
<span class=linenos data-linenos="705 "></span><span class=sd>      - training_data</span>
<span class=linenos data-linenos="706 "></span><span class=sd>      - training_args</span>
<span class=linenos data-linenos="707 "></span><span class=sd>      - secagg</span>
<span class=linenos data-linenos="708 "></span><span class=sd>      - node_state</span>
<span class=linenos data-linenos="709 "></span>
<span class=linenos data-linenos="710 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="711 "></span><span class=sd>        FedbiomedExperimentError: experiment not fully defined, experiment did not run any round</span>
<span class=linenos data-linenos="712 "></span><span class=sd>            yet, or error when saving breakpoint</span>
<span class=linenos data-linenos="713 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="714 "></span>    <span class=n>state</span><span class=o>.</span><span class=n>update</span><span class=p>({</span>
<span class=linenos data-linenos="715 "></span>        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experiment_id</span><span class=p>,</span>
<span class=linenos data-linenos="716 "></span>        <span class=s1>&#39;breakpoint_version&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>__breakpoints_version__</span><span class=p>),</span>
<span class=linenos data-linenos="717 "></span>        <span class=s1>&#39;training_data&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=o>.</span><span class=n>data</span><span class=p>(),</span>
<span class=linenos data-linenos="718 "></span>        <span class=s1>&#39;experimentation_folder&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>,</span>
<span class=linenos data-linenos="719 "></span>        <span class=s1>&#39;tags&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span><span class=p>,</span>
<span class=linenos data-linenos="720 "></span>        <span class=s1>&#39;nodes&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span><span class=p>,</span>
<span class=linenos data-linenos="721 "></span>        <span class=s1>&#39;secagg&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>save_state_breakpoint</span><span class=p>(),</span>
<span class=linenos data-linenos="722 "></span>        <span class=s1>&#39;node_state&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_state_agent</span><span class=o>.</span><span class=n>save_state_breakpoint</span><span class=p>()</span>
<span class=linenos data-linenos="723 "></span>    <span class=p>})</span>
<span class=linenos data-linenos="724 "></span>
<span class=linenos data-linenos="725 "></span>    <span class=c1># save state into a json file</span>
<span class=linenos data-linenos="726 "></span>    <span class=n>breakpoint_path</span><span class=p>,</span> <span class=n>breakpoint_file_name</span> <span class=o>=</span> \
<span class=linenos data-linenos="727 "></span>        <span class=n>choose_bkpt_file</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>,</span> <span class=n>bkpt_number</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
<span class=linenos data-linenos="728 "></span>    <span class=n>breakpoint_file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>,</span> <span class=n>breakpoint_file_name</span><span class=p>)</span>
<span class=linenos data-linenos="729 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="730 "></span>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>breakpoint_file_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&quot;UTF-8&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>bkpt</span><span class=p>:</span>
<span class=linenos data-linenos="731 "></span>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>state</span><span class=p>,</span> <span class=n>bkpt</span><span class=p>)</span>
<span class=linenos data-linenos="732 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;breakpoint number </span><span class=si>{</span><span class=n>bkpt_number</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2> saved at &quot;</span> <span class=o>+</span>
<span class=linenos data-linenos="733 "></span>                    <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>breakpoint_file_path</span><span class=p>))</span>
<span class=linenos data-linenos="734 "></span>    <span class=k>except</span> <span class=p>(</span><span class=ne>OSError</span><span class=p>,</span> <span class=ne>PermissionError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>,</span> <span class=ne>RecursionError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos="735 "></span>        <span class=c1># - OSError: heuristic for catching open() and write() errors</span>
<span class=linenos data-linenos="736 "></span>        <span class=c1># - see json.dump() documentation for documented errors for this call</span>
<span class=linenos data-linenos="737 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; - save failed with message </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="738 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="739 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span> <span class=kn>from</span> <span class=nn>e</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.experimentation_folder class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">experimentation_folder</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>experimentation_folder</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the folder name where experiment data/result are saved.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_experimentation_folder"><code>set_experimentation_folder</code></a></p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>File name where experiment related files are saved</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="277 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="278 "></span><span class=k>def</span> <span class=nf>experimentation_folder</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=linenos data-linenos="279 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the folder name where experiment data/result are saved.</span>
<span class=linenos data-linenos="280 "></span>
<span class=linenos data-linenos="281 "></span><span class=sd>    Please see also [`set_experimentation_folder`]</span>
<span class=linenos data-linenos="282 "></span><span class=sd>    [fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_experimentation_folder]</span>
<span class=linenos data-linenos="283 "></span>
<span class=linenos data-linenos="284 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="285 "></span><span class=sd>        File name where experiment related files are saved</span>
<span class=linenos data-linenos="286 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="287 "></span>
<span class=linenos data-linenos="288 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.experimentation_path class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">experimentation_path</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>experimentation_path</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the file path where experimentation folder is located and experiment related files are saved.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>Experiment directory where all experiment related files are saved</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="290 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="291 "></span><span class=k>def</span> <span class=nf>experimentation_path</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=linenos data-linenos="292 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the file path where experimentation folder is located and experiment related files are saved.</span>
<span class=linenos data-linenos="293 "></span>
<span class=linenos data-linenos="294 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="295 "></span><span class=sd>        Experiment directory where all experiment related files are saved</span>
<span class=linenos data-linenos="296 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="297 "></span>
<span class=linenos data-linenos="298 "></span>    <span class=k>return</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;EXPERIMENTS_DIR&#39;</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.filtered_federation_nodes class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">filtered_federation_nodes</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>filtered_federation_nodes</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Returns the node ids in the federation after filtering with the nodes filter</p> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="254 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="255 "></span><span class=k>def</span> <span class=nf>filtered_federation_nodes</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=linenos data-linenos="256 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns the node ids in the federation after filtering with the nodes filter&quot;&quot;&quot;</span>
<span class=linenos data-linenos="257 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="258 "></span>        <span class=k>return</span> <span class=p>[</span><span class=n>node</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>all_federation_nodes</span><span class=p>()</span> <span class=k>if</span> <span class=n>node</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span><span class=p>]</span>
<span class=linenos data-linenos="259 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="260 "></span>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>all_federation_nodes</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.info class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">info</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>info</span><span class=p>(</span><span class=n>info</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>missing</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Prints out the information about the current status of the experiment.</p> <p>Lists all the parameters/arguments of the experiment and informs whether the experiment can be run.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>info</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]]</code> </td> <td> <div class=doc-md-description> <p>Dictionary of sub-classes relevant attributes status that will be completed with some additional attributes status defined in this class. Defaults to None (no entries of sub-classes available or of importance).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>missing_object_to_check</code></td> <td> </td> <td> <div class=doc-md-description> <p>dictionary mapping sub-classes attributes to attribute names, that may be needed to fully run the object. Defaults to None (no check will be performed).</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]]</code> </td> <td> <div class=doc-md-description> <p>dictionary containing all pieces of information, with 2 entries: <code>Arguments</code> mapping a list</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>of all argument, and <code>Values</code> mapping a list containing all the values.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="330 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="331 "></span><span class=k>def</span> <span class=nf>info</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="332 "></span>         <span class=n>info</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="333 "></span>         <span class=n>missing</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]],</span> <span class=nb>str</span><span class=p>]:</span>
<span class=linenos data-linenos="334 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Prints out the information about the current status of the experiment.</span>
<span class=linenos data-linenos="335 "></span>
<span class=linenos data-linenos="336 "></span><span class=sd>    Lists  all the parameters/arguments of the experiment and informs whether the experiment can be run.</span>
<span class=linenos data-linenos="337 "></span>
<span class=linenos data-linenos="338 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="339 "></span><span class=sd>        info: Dictionary of sub-classes relevant attributes status that will be completed with some additional</span>
<span class=linenos data-linenos="340 "></span><span class=sd>            attributes status defined in this class. Defaults to None (no entries of sub-classes available or</span>
<span class=linenos data-linenos="341 "></span><span class=sd>            of importance).</span>
<span class=linenos data-linenos="342 "></span><span class=sd>        missing_object_to_check: dictionary mapping sub-classes attributes to attribute names, that may be</span>
<span class=linenos data-linenos="343 "></span><span class=sd>            needed to fully run the object. Defaults to None (no check will be performed).</span>
<span class=linenos data-linenos="344 "></span>
<span class=linenos data-linenos="345 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="346 "></span><span class=sd>        dictionary containing all pieces of information, with 2 entries: `Arguments` mapping a list</span>
<span class=linenos data-linenos="347 "></span><span class=sd>        of all argument, and `Values` mapping a list containing all the values.</span>
<span class=linenos data-linenos="348 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="349 "></span>    <span class=k>if</span> <span class=n>info</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="350 "></span>        <span class=n>info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_default_info_structure</span><span class=p>()</span>
<span class=linenos data-linenos="351 "></span>    <span class=n>info</span><span class=p>[</span><span class=s1>&#39;Arguments&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
<span class=linenos data-linenos="352 "></span>        <span class=s1>&#39;Tags&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="353 "></span>        <span class=s1>&#39;Nodes filter&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="354 "></span>        <span class=s1>&#39;Training Data&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="355 "></span>        <span class=s1>&#39;Experiment folder&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="356 "></span>        <span class=s1>&#39;Experiment Path&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="357 "></span>        <span class=s1>&#39;Secure Aggregation&#39;</span>
<span class=linenos data-linenos="358 "></span>    <span class=p>])</span>
<span class=linenos data-linenos="359 "></span>
<span class=linenos data-linenos="360 "></span>    <span class=n>info</span><span class=p>[</span><span class=s1>&#39;Values&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;.{1,60}&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)))</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=p>[</span>
<span class=linenos data-linenos="361 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span><span class=p>,</span>
<span class=linenos data-linenos="362 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span><span class=p>,</span>
<span class=linenos data-linenos="363 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>,</span>
<span class=linenos data-linenos="364 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>,</span>
<span class=linenos data-linenos="365 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>experimentation_path</span><span class=p>(),</span>
<span class=linenos data-linenos="366 "></span>        <span class=sa>f</span><span class=s1>&#39;- Using: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=si>}</span><span class=se>\n</span><span class=s1>- Active: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>active</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="367 "></span>    <span class=p>]])</span>
<span class=linenos data-linenos="368 "></span>
<span class=linenos data-linenos="369 "></span>    <span class=c1># printing list of items set / not set yet</span>
<span class=linenos data-linenos="370 "></span>    <span class=nb>print</span><span class=p>(</span><span class=n>tabulate</span><span class=o>.</span><span class=n>tabulate</span><span class=p>(</span><span class=n>info</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=s1>&#39;keys&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="371 "></span>
<span class=linenos data-linenos="372 "></span>    <span class=k>if</span> <span class=n>missing</span><span class=p>:</span>
<span class=linenos data-linenos="373 "></span>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Warning: Object not fully defined, missing&quot;</span>
<span class=linenos data-linenos="374 "></span>              <span class=sa>f</span><span class=s2>&quot;: </span><span class=se>\n</span><span class=si>{</span><span class=n>missing</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="375 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="376 "></span>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2> can be run now (fully defined)&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="377 "></span>    <span class=k>return</span> <span class=n>info</span><span class=p>,</span> <span class=n>missing</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.load_breakpoint class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">load_breakpoint</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>load_breakpoint</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Loads breakpoint (provided a breakpoint has been saved) so the workflow can be resumed.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>breakpoint_folder_path</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>path of the breakpoint folder. Path can be absolute or relative eg: "var/experiments/Experiment_xxxx/breakpoints_xxxx". If None, loads the latest breakpoint of the latest workflow. Defaults to None.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="fedbiomed.researcher.federated_workflows._federated_workflow.TFederatedWorkflow">TFederatedWorkflow</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>]</code> </td> <td> <div class=doc-md-description> <p>Tuple contaning reinitialized workflow object and the saved state as a dictionary</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type, error when reading breakpoint or bad loaded breakpoint content (corrupted)</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="741 "></span><span class=nd>@classmethod</span>
<span class=linenos data-linenos="742 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="743 "></span><span class=k>def</span> <span class=nf>load_breakpoint</span><span class=p>(</span>
<span class=linenos data-linenos="744 "></span>    <span class=bp>cls</span><span class=p>,</span>
<span class=linenos data-linenos="745 "></span>    <span class=n>breakpoint_folder_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="746 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>TFederatedWorkflow</span><span class=p>,</span> <span class=nb>dict</span><span class=p>]:</span>
<span class=linenos data-linenos="747 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="748 "></span><span class=sd>    Loads breakpoint (provided a breakpoint has been saved)</span>
<span class=linenos data-linenos="749 "></span><span class=sd>    so the workflow can be resumed.</span>
<span class=linenos data-linenos="750 "></span>
<span class=linenos data-linenos="751 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="752 "></span><span class=sd>      breakpoint_folder_path: path of the breakpoint folder. Path can be absolute</span>
<span class=linenos data-linenos="753 "></span><span class=sd>        or relative eg: &quot;var/experiments/Experiment_xxxx/breakpoints_xxxx&quot;.</span>
<span class=linenos data-linenos="754 "></span><span class=sd>        If None, loads the latest breakpoint of the latest workflow. Defaults to None.</span>
<span class=linenos data-linenos="755 "></span>
<span class=linenos data-linenos="756 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="757 "></span><span class=sd>        Tuple contaning reinitialized workflow object and the saved state as a dictionary</span>
<span class=linenos data-linenos="758 "></span>
<span class=linenos data-linenos="759 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="760 "></span><span class=sd>        FedbiomedExperimentError: bad argument type, error when reading breakpoint or</span>
<span class=linenos data-linenos="761 "></span><span class=sd>            bad loaded breakpoint content (corrupted)</span>
<span class=linenos data-linenos="762 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="763 "></span>    <span class=c1># check parameters type</span>
<span class=linenos data-linenos="764 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=ow>and</span> <span class=n>breakpoint_folder_path</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="765 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
<span class=linenos data-linenos="766 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: load failed, `breakpoint_folder_path`&quot;</span>
<span class=linenos data-linenos="767 "></span>            <span class=sa>f</span><span class=s2>&quot; has bad type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="768 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="769 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="770 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="771 "></span>
<span class=linenos data-linenos="772 "></span>    <span class=c1># get breakpoint folder path (if it is None) and state file</span>
<span class=linenos data-linenos="773 "></span>    <span class=n>breakpoint_folder_path</span><span class=p>,</span> <span class=n>state_file</span> <span class=o>=</span> <span class=n>find_breakpoint_path</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>)</span>
<span class=linenos data-linenos="774 "></span>    <span class=n>breakpoint_folder_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>)</span>
<span class=linenos data-linenos="775 "></span>
<span class=linenos data-linenos="776 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="777 "></span>        <span class=n>path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>,</span> <span class=n>state_file</span><span class=p>)</span>
<span class=linenos data-linenos="778 "></span>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&quot;utf-8&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
<span class=linenos data-linenos="779 "></span>            <span class=n>saved_state</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
<span class=linenos data-linenos="780 "></span>    <span class=k>except</span> <span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>,</span> <span class=ne>OSError</span><span class=p>)</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
<span class=linenos data-linenos="781 "></span>        <span class=c1># OSError: heuristic for catching file access issues</span>
<span class=linenos data-linenos="782 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
<span class=linenos data-linenos="783 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: load failed,&quot;</span>
<span class=linenos data-linenos="784 "></span>            <span class=sa>f</span><span class=s2>&quot; reading breakpoint file failed with message </span><span class=si>{</span><span class=n>exc</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="785 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="786 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="787 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span> <span class=kn>from</span> <span class=nn>exc</span>
<span class=linenos data-linenos="788 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>saved_state</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=linenos data-linenos="789 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
<span class=linenos data-linenos="790 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: load failed, breakpoint file seems&quot;</span>
<span class=linenos data-linenos="791 "></span>            <span class=sa>f</span><span class=s2>&quot; corrupted. Type should be `dict` not </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>saved_state</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="792 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="793 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="794 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="795 "></span>
<span class=linenos data-linenos="796 "></span>    <span class=c1># First, check version of breakpoints</span>
<span class=linenos data-linenos="797 "></span>    <span class=n>bkpt_version</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;breakpoint_version&#39;</span><span class=p>,</span> <span class=n>__default_version__</span><span class=p>)</span>
<span class=linenos data-linenos="798 "></span>    <span class=n>raise_for_version_compatibility</span><span class=p>(</span><span class=n>bkpt_version</span><span class=p>,</span> <span class=n>__breakpoints_version__</span><span class=p>,</span>
<span class=linenos data-linenos="799 "></span>                                    <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Breakpoint &quot;</span>
<span class=linenos data-linenos="800 "></span>                                    <span class=s2>&quot;file was generated with version </span><span class=si>%s</span><span class=s2> &quot;</span>
<span class=linenos data-linenos="801 "></span>                                    <span class=sa>f</span><span class=s2>&quot;which is incompatible with the current version %s.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="802 "></span>
<span class=linenos data-linenos="803 "></span>    <span class=c1># retrieve breakpoint training data</span>
<span class=linenos data-linenos="804 "></span>    <span class=n>bkpt_fds</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;training_data&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="805 "></span>    <span class=n>bkpt_fds</span> <span class=o>=</span> <span class=n>FederatedDataSet</span><span class=p>(</span><span class=n>bkpt_fds</span><span class=p>)</span>
<span class=linenos data-linenos="806 "></span>
<span class=linenos data-linenos="807 "></span>    <span class=c1># initializing experiment</span>
<span class=linenos data-linenos="808 "></span>    <span class=n>loaded_exp</span> <span class=o>=</span> <span class=bp>cls</span><span class=p>()</span>
<span class=linenos data-linenos="809 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_experiment_id</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="810 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_training_data</span><span class=p>(</span><span class=n>bkpt_fds</span><span class=p>)</span>
<span class=linenos data-linenos="811 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_tags</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;tags&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="812 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_nodes</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;nodes&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="813 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_experimentation_folder</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;experimentation_folder&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="814 "></span>
<span class=linenos data-linenos="815 "></span>    <span class=n>secagg</span> <span class=o>=</span> <span class=n>SecureAggregation</span><span class=o>.</span><span class=n>load_state_breakpoint</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;secagg&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="816 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_secagg</span><span class=p>(</span><span class=n>secagg</span><span class=p>)</span>
<span class=linenos data-linenos="817 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_node_state_agent</span><span class=o>.</span><span class=n>load_state_breakpoint</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;node_state&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="818 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_save_breakpoints</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
<span class=linenos data-linenos="819 "></span>
<span class=linenos data-linenos="820 "></span>    <span class=k>return</span> <span class=n>loaded_exp</span><span class=p>,</span> <span class=n>saved_state</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.nodes class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">nodes</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>nodes</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the nodes filter for the execution of the workflow.</p> <p>If nodes is None, then no filtering is applied, and all the nodes in the federation participate in the execution of the workflow. If nodes is not None, then the semantics of the nodes filter are as follows:</p> <table> <thead> <tr> <th>node_id in nodes filter</th> <th>node_id in training data</th> <th>outcome</th> </tr> </thead> <tbody> <tr> <td>yes</td> <td>yes</td> <td>this node is part of the federation, and will take part in the execution the workflow</td> </tr> <tr> <td>yes</td> <td>no</td> <td>ignored</td> </tr> <tr> <td>no</td> <td>yes</td> <td>this node is part of the federation but will not be considered for executing the workflow</td> </tr> <tr> <td>no</td> <td>no</td> <td>ignored</td> </tr> </tbody> </table> <p>Please see <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_nodes"><code>set_nodes</code></a> to set <code>nodes</code>.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], None]</code> </td> <td> <div class=doc-md-description> <p>The list of nodes to keep for workflow execution, or None if no filtering is applied</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="227 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="228 "></span><span class=k>def</span> <span class=nf>nodes</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="229 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the nodes filter for the execution of the workflow.</span>
<span class=linenos data-linenos="230 "></span>
<span class=linenos data-linenos="231 "></span><span class=sd>    If nodes is None, then no filtering is applied, and all the nodes in the federation participate in the</span>
<span class=linenos data-linenos="232 "></span><span class=sd>    execution of the workflow.</span>
<span class=linenos data-linenos="233 "></span><span class=sd>    If nodes is not None, then the semantics of the nodes filter are as follows:</span>
<span class=linenos data-linenos="234 "></span>
<span class=linenos data-linenos="235 "></span><span class=sd>    | node_id in nodes filter | node_id in training data | outcome |</span>
<span class=linenos data-linenos="236 "></span><span class=sd>    | --- | --- | --- |</span>
<span class=linenos data-linenos="237 "></span><span class=sd>    | yes | yes | this node is part of the federation, and will take part in the execution the workflow |</span>
<span class=linenos data-linenos="238 "></span><span class=sd>    | yes | no | ignored |</span>
<span class=linenos data-linenos="239 "></span><span class=sd>    | no | yes | this node is part of the federation but will not be considered for executing the workflow |</span>
<span class=linenos data-linenos="240 "></span><span class=sd>    | no | no | ignored |</span>
<span class=linenos data-linenos="241 "></span>
<span class=linenos data-linenos="242 "></span><span class=sd>    Please see [`set_nodes`][fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_nodes] to set `nodes`.</span>
<span class=linenos data-linenos="243 "></span>
<span class=linenos data-linenos="244 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="245 "></span><span class=sd>        The list of nodes to keep for workflow execution, or None if no filtering is applied</span>
<span class=linenos data-linenos="246 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="247 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.run class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">run</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>run</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Run the experiment</p> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="822 "></span><span class=nd>@abstractmethod</span>
<span class=linenos data-linenos="823 "></span><span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=linenos data-linenos="824 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run the experiment&quot;&quot;&quot;</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.save_breakpoints class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">save_breakpoints</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>save_breakpoints</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the status of saving breakpoint after each round of training.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p><code>True</code>, If saving breakpoint is active. <code>False</code>, vice versa.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="305 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="306 "></span><span class=k>def</span> <span class=nf>save_breakpoints</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="307 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the status of saving breakpoint after each round of training.</span>
<span class=linenos data-linenos="308 "></span>
<span class=linenos data-linenos="309 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="310 "></span><span class=sd>        `True`, If saving breakpoint is active. `False`, vice versa.</span>
<span class=linenos data-linenos="311 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="312 "></span>
<span class=linenos data-linenos="313 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.secagg_setup class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">secagg_setup</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>secagg_setup</span><span class=p>(</span><span class=n>sampled_nodes</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the secagg arguments for setup.</p> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="679 "></span><span class=k>def</span> <span class=nf>secagg_setup</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>sampled_nodes</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
<span class=linenos data-linenos="680 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the secagg arguments for setup.&quot;&quot;&quot;</span>
<span class=linenos data-linenos="681 "></span>    <span class=n>secagg_arguments</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="682 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>active</span><span class=p>:</span>
<span class=linenos data-linenos="683 "></span>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span>
<span class=linenos data-linenos="684 "></span>            <span class=n>parties</span><span class=o>=</span><span class=n>sampled_nodes</span><span class=p>,</span>
<span class=linenos data-linenos="685 "></span>            <span class=n>experiment_id</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_experiment_id</span><span class=p>,</span>
<span class=linenos data-linenos="686 "></span>        <span class=p>):</span>
<span class=linenos data-linenos="687 "></span>            <span class=k>raise</span> <span class=n>FedbiomedSecureAggregationError</span><span class=p>(</span>
<span class=linenos data-linenos="688 "></span>                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB417</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Could not setup secure aggregation crypto &quot;</span>
<span class=linenos data-linenos="689 "></span>                <span class=s2>&quot;context.&quot;</span>
<span class=linenos data-linenos="690 "></span>            <span class=p>)</span>
<span class=linenos data-linenos="691 "></span>        <span class=n>secagg_arguments</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>train_arguments</span><span class=p>()</span>
<span class=linenos data-linenos="692 "></span>    <span class=k>return</span> <span class=n>secagg_arguments</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_experimentation_folder class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_experimentation_folder</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_experimentation_folder</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets <code>experimentation_folder</code>, the folder name where experiment data/result are saved.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>experimentation_folder</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>File name where experiment related files are saved</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>The path to experimentation folder.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad <code>experimentation_folder</code> type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="581 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="582 "></span><span class=k>def</span> <span class=nf>set_experimentation_folder</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>experimentation_folder</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=linenos data-linenos="583 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets `experimentation_folder`, the folder name where experiment data/result are saved.</span>
<span class=linenos data-linenos="584 "></span>
<span class=linenos data-linenos="585 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="586 "></span><span class=sd>        experimentation_folder: File name where experiment related files are saved</span>
<span class=linenos data-linenos="587 "></span>
<span class=linenos data-linenos="588 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="589 "></span><span class=sd>        The path to experimentation folder.</span>
<span class=linenos data-linenos="590 "></span>
<span class=linenos data-linenos="591 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="592 "></span><span class=sd>        FedbiomedExperimentError : bad `experimentation_folder` type</span>
<span class=linenos data-linenos="593 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="594 "></span>    <span class=k>if</span> <span class=n>experimentation_folder</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="595 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span> <span class=o>=</span> <span class=n>create_exp_folder</span><span class=p>()</span>
<span class=linenos data-linenos="596 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="597 "></span>        <span class=n>sanitized_folder</span> <span class=o>=</span> <span class=n>sanitize_filename</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>,</span> <span class=n>platform</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="598 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span> <span class=o>=</span> <span class=n>create_exp_folder</span><span class=p>(</span><span class=n>sanitized_folder</span><span class=p>)</span>
<span class=linenos data-linenos="599 "></span>        <span class=k>if</span> <span class=n>sanitized_folder</span> <span class=o>!=</span> <span class=n>experimentation_folder</span><span class=p>:</span>
<span class=linenos data-linenos="600 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;`experimentation_folder` was sanitized from &#39;</span>
<span class=linenos data-linenos="601 "></span>                           <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>experimentation_folder</span><span class=si>}</span><span class=s1> to </span><span class=si>{</span><span class=n>sanitized_folder</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="602 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="603 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="604 "></span>            <span class=sa>f</span><span class=s1>&#39; `experimentation_folder` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="605 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="606 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="607 "></span>
<span class=linenos data-linenos="608 "></span>        <span class=c1># at this point self._experimentation_folder is a str valid for a foldername</span>
<span class=linenos data-linenos="609 "></span>
<span class=linenos data-linenos="610 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_nodes class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_nodes</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_nodes</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets the nodes filter + verifications on argument type</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>nodes</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], None]</code> </td> <td> <div class=doc-md-description> <p>List of node_ids to filter the nodes to be involved in the experiment.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], None]</code> </td> <td> <div class=doc-md-description> <p>List of nodes that are set. None, if the argument <code>nodes</code> is None.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedTypeError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedTypeError">FedbiomedTypeError</a></code> </td> <td> <div class=doc-md-description> <p>Bad nodes type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="464 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="465 "></span><span class=k>def</span> <span class=nf>set_nodes</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>nodes</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="466 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets the nodes filter + verifications on argument type</span>
<span class=linenos data-linenos="467 "></span>
<span class=linenos data-linenos="468 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="469 "></span><span class=sd>        nodes: List of node_ids to filter the nodes to be involved in the experiment.</span>
<span class=linenos data-linenos="470 "></span>
<span class=linenos data-linenos="471 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="472 "></span><span class=sd>        List of nodes that are set. None, if the argument `nodes` is None.</span>
<span class=linenos data-linenos="473 "></span>
<span class=linenos data-linenos="474 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="475 "></span><span class=sd>        FedbiomedTypeError : Bad nodes type</span>
<span class=linenos data-linenos="476 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="477 "></span>    <span class=c1># immediately exit if setting nodes to None</span>
<span class=linenos data-linenos="478 "></span>    <span class=k>if</span> <span class=n>nodes</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="479 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="480 "></span>    <span class=c1># set nodes</span>
<span class=linenos data-linenos="481 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
<span class=linenos data-linenos="482 "></span>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>node</span><span class=p>:</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=nb>str</span><span class=p>),</span> <span class=n>nodes</span><span class=p>)):</span>
<span class=linenos data-linenos="483 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39; `nodes` argument must be a list of strings or None.&#39;</span>
<span class=linenos data-linenos="484 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="485 "></span>            <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="486 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span> <span class=o>=</span> <span class=n>nodes</span>
<span class=linenos data-linenos="487 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="488 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39; `nodes` argument must be a list of strings or None.&#39;</span>
<span class=linenos data-linenos="489 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="490 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="491 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_save_breakpoints class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_save_breakpoints</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_save_breakpoints</span><span class=p>(</span><span class=n>save_breakpoints</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Setter for save_breakpoints + verification on arguments type</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>save_breakpoints</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>whether to save breakpoints or not after each training round. Breakpoints can be used for resuming a crashed experiment.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>Status of saving breakpoints</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad save_breakpoints type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="654 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="655 "></span><span class=k>def</span> <span class=nf>set_save_breakpoints</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>save_breakpoints</span><span class=p>:</span> <span class=nb>bool</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="656 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Setter for save_breakpoints + verification on arguments type</span>
<span class=linenos data-linenos="657 "></span>
<span class=linenos data-linenos="658 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="659 "></span><span class=sd>        save_breakpoints (bool): whether to save breakpoints or</span>
<span class=linenos data-linenos="660 "></span><span class=sd>            not after each training round. Breakpoints can be used for resuming</span>
<span class=linenos data-linenos="661 "></span><span class=sd>            a crashed experiment.</span>
<span class=linenos data-linenos="662 "></span>
<span class=linenos data-linenos="663 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="664 "></span><span class=sd>        Status of saving breakpoints</span>
<span class=linenos data-linenos="665 "></span>
<span class=linenos data-linenos="666 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="667 "></span><span class=sd>        FedbiomedExperimentError: bad save_breakpoints type</span>
<span class=linenos data-linenos="668 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="669 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>save_breakpoints</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="670 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span> <span class=o>=</span> <span class=n>save_breakpoints</span>
<span class=linenos data-linenos="671 "></span>        <span class=c1># no warning if done during experiment, we may change breakpoint policy at any time</span>
<span class=linenos data-linenos="672 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="673 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `save_breakpoints` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>save_breakpoints</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="674 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="675 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="676 "></span>
<span class=linenos data-linenos="677 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_secagg class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_secagg</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_secagg</span><span class=p>(</span><span class=n>secagg</span><span class=p>,</span> <span class=n>scheme</span><span class=o>=</span><span class=n>SecureAggregationSchemes</span><span class=o>.</span><span class=n>LOM</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets secure aggregation status and scheme</p> <p>Build secure aggregation controller/instance or sets given secure aggregation class</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>secagg</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-internal" title="fedbiomed.researcher.secagg.SecureAggregation" href="../secagg/#fedbiomed.researcher.secagg.SecureAggregation">SecureAggregation</a>]</code> </td> <td> <div class=doc-md-description> <p>If True activates training request with secure aggregation by building <a class="autorefs autorefs-internal" href="../secagg/#fedbiomed.researcher.secagg.SecureAggregation"><code>SecureAggregation</code></a> class with default arguments. Or if argument is an instance of <code>SecureAggregation</code> it does only assignment. Secure aggregation activation and configuration depends on the instance provided.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>scheme</code></td> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.constants.SecureAggregationSchemes" href="../../common/constants/#fedbiomed.common.constants.SecureAggregationSchemes">SecureAggregationSchemes</a></code> </td> <td> <div class=doc-md-description> <p>Secure aggregation scheme to use. Ig a <code>SecureAggregation</code> object is provided, the argument is not used, as the scheme comes from the object. Defaults is SecureAggregationSchemes.LOM.</p> </div> </td> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.constants.SecureAggregationSchemes.LOM" href="../../common/constants/#fedbiomed.common.constants.SecureAggregationSchemes.LOM">LOM</a></code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Secure aggregation controller instance.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type or value</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="612 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="613 "></span><span class=k>def</span> <span class=nf>set_secagg</span><span class=p>(</span>
<span class=linenos data-linenos="614 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="615 "></span>        <span class=n>secagg</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>SecureAggregation</span><span class=p>],</span>
<span class=linenos data-linenos="616 "></span>        <span class=n>scheme</span><span class=p>:</span> <span class=n>SecureAggregationSchemes</span> <span class=o>=</span> <span class=n>SecureAggregationSchemes</span><span class=o>.</span><span class=n>LOM</span><span class=p>):</span>
<span class=linenos data-linenos="617 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets secure aggregation status and scheme</span>
<span class=linenos data-linenos="618 "></span>
<span class=linenos data-linenos="619 "></span><span class=sd>    Build secure aggregation controller/instance or sets given</span>
<span class=linenos data-linenos="620 "></span><span class=sd>    secure aggregation class</span>
<span class=linenos data-linenos="621 "></span>
<span class=linenos data-linenos="622 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="623 "></span><span class=sd>        secagg: If True activates training request with secure aggregation by building</span>
<span class=linenos data-linenos="624 "></span><span class=sd>            [`SecureAggregation`][fedbiomed.researcher.secagg.SecureAggregation] class</span>
<span class=linenos data-linenos="625 "></span><span class=sd>            with default arguments. Or if argument is an instance of `SecureAggregation`</span>
<span class=linenos data-linenos="626 "></span><span class=sd>            it does only assignment. Secure aggregation activation and configuration</span>
<span class=linenos data-linenos="627 "></span><span class=sd>            depends on the instance provided.</span>
<span class=linenos data-linenos="628 "></span><span class=sd>        scheme: Secure aggregation scheme to use. Ig a `SecureAggregation` object is provided,</span>
<span class=linenos data-linenos="629 "></span><span class=sd>            the argument is not used, as the scheme comes from the object. Defaults is</span>
<span class=linenos data-linenos="630 "></span><span class=sd>            SecureAggregationSchemes.LOM.</span>
<span class=linenos data-linenos="631 "></span>
<span class=linenos data-linenos="632 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="633 "></span><span class=sd>        Secure aggregation controller instance.</span>
<span class=linenos data-linenos="634 "></span>
<span class=linenos data-linenos="635 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="636 "></span><span class=sd>        FedbiomedExperimentError: bad argument type or value</span>
<span class=linenos data-linenos="637 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="638 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>scheme</span><span class=p>,</span> <span class=n>SecureAggregationSchemes</span><span class=p>):</span>
<span class=linenos data-linenos="639 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span>
<span class=linenos data-linenos="640 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Expected `scheme` argument &quot;</span>
<span class=linenos data-linenos="641 "></span>            <span class=s2>&quot;`SecureAggregationSchemes`, but got {type(scheme)}&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="642 "></span>
<span class=linenos data-linenos="643 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>secagg</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="644 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span> <span class=o>=</span> <span class=n>SecureAggregation</span><span class=p>(</span><span class=n>scheme</span><span class=o>=</span><span class=n>scheme</span><span class=p>,</span> <span class=n>active</span><span class=o>=</span><span class=n>secagg</span><span class=p>)</span>
<span class=linenos data-linenos="645 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>secagg</span><span class=p>,</span> <span class=n>SecureAggregation</span><span class=p>):</span>
<span class=linenos data-linenos="646 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span> <span class=o>=</span> <span class=n>secagg</span>
<span class=linenos data-linenos="647 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="648 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span>
<span class=linenos data-linenos="649 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Expected `secagg` argument bool or &quot;</span>
<span class=linenos data-linenos="650 "></span>            <span class=sa>f</span><span class=s2>&quot;`SecureAggregation` but got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>secagg</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="651 "></span>
<span class=linenos data-linenos="652 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_tags class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_tags</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_tags</span><span class=p>(</span><span class=n>tags</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets tags and verification on argument type</p> <p>Setting tags updates also training data by executing [<code>set_training_data</code>].[fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_training_data] method.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>tags</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>List of string with data tags or string with one data tag. Empty list of tags ([]) means any dataset is accepted, it is different from None (tags not set, cannot search for training_data yet).</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p>Returns: List of tags that are set.</p> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedTypeError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedTypeError">FedbiomedTypeError</a></code> </td> <td> <div class=doc-md-description> <p>Bad tags type</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedValueError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedValueError">FedbiomedValueError</a></code> </td> <td> <div class=doc-md-description> <p>Some issue prevented resetting the training data after an inconsistency was detected</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="405 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="406 "></span><span class=k>def</span> <span class=nf>set_tags</span><span class=p>(</span>
<span class=linenos data-linenos="407 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="408 "></span>    <span class=n>tags</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=nb>str</span><span class=p>],</span>
<span class=linenos data-linenos="409 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=linenos data-linenos="410 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets tags and verification on argument type</span>
<span class=linenos data-linenos="411 "></span>
<span class=linenos data-linenos="412 "></span><span class=sd>    Setting tags updates also training data by executing</span>
<span class=linenos data-linenos="413 "></span><span class=sd>    [`set_training_data`].[fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_training_data]</span>
<span class=linenos data-linenos="414 "></span><span class=sd>    method.</span>
<span class=linenos data-linenos="415 "></span>
<span class=linenos data-linenos="416 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="417 "></span><span class=sd>        tags: List of string with data tags or string with one data tag. Empty list</span>
<span class=linenos data-linenos="418 "></span><span class=sd>            of tags ([]) means any dataset is accepted, it is different from None</span>
<span class=linenos data-linenos="419 "></span><span class=sd>            (tags not set, cannot search for training_data yet).</span>
<span class=linenos data-linenos="420 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="421 "></span><span class=sd>        List of tags that are set.</span>
<span class=linenos data-linenos="422 "></span>
<span class=linenos data-linenos="423 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="424 "></span><span class=sd>        FedbiomedTypeError: Bad tags type</span>
<span class=linenos data-linenos="425 "></span><span class=sd>        FedbiomedValueError: Some issue prevented resetting the training</span>
<span class=linenos data-linenos="426 "></span><span class=sd>            data after an inconsistency was detected</span>
<span class=linenos data-linenos="427 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="428 "></span>    <span class=c1># preprocess the tags argument to correct typing</span>
<span class=linenos data-linenos="429 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=n>tags</span><span class=p>:</span>
<span class=linenos data-linenos="430 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Invalid value for tags argument </span><span class=si>{</span><span class=n>tags</span><span class=si>}</span><span class=s2>, tags &quot;</span> \
<span class=linenos data-linenos="431 "></span>            <span class=s2>&quot;should be non-empty list of str or non-empty str.&quot;</span>
<span class=linenos data-linenos="432 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="433 "></span>        <span class=k>raise</span> <span class=n>FedbiomedValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="434 "></span>
<span class=linenos data-linenos="435 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tags</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
<span class=linenos data-linenos="436 "></span>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>tag</span><span class=p>:</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span> <span class=nb>str</span><span class=p>),</span> <span class=n>tags</span><span class=p>)):</span>
<span class=linenos data-linenos="437 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: `tags` must be a non-empty str or &quot;</span> \
<span class=linenos data-linenos="438 "></span>                <span class=s2>&quot;a non-empty list of str.&quot;</span>
<span class=linenos data-linenos="439 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="440 "></span>            <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="441 "></span>
<span class=linenos data-linenos="442 "></span>        <span class=c1># If it is empty list</span>
<span class=linenos data-linenos="443 "></span>        <span class=n>tags_to_set</span> <span class=o>=</span> <span class=n>tags</span>
<span class=linenos data-linenos="444 "></span>
<span class=linenos data-linenos="445 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tags</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="446 "></span>        <span class=n>tags_to_set</span> <span class=o>=</span> <span class=p>[</span><span class=n>tags</span><span class=p>]</span>
<span class=linenos data-linenos="447 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="448 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2> `tags` must be a non-empty str, &quot;</span> \
<span class=linenos data-linenos="449 "></span>            <span class=s2>&quot;a non-empty list of str&quot;</span>
<span class=linenos data-linenos="450 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="451 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="452 "></span>
<span class=linenos data-linenos="453 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span> <span class=o>=</span> <span class=n>tags_to_set</span>
<span class=linenos data-linenos="454 "></span>
<span class=linenos data-linenos="455 "></span>    <span class=c1># Set training data</span>
<span class=linenos data-linenos="456 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
<span class=linenos data-linenos="457 "></span>        <span class=s2>&quot;Updating training data. This action will update FederatedDataset, &quot;</span>
<span class=linenos data-linenos="458 "></span>        <span class=s2>&quot;and the nodes that will participate to the experiment.&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="459 "></span>
<span class=linenos data-linenos="460 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_training_data</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>from_tags</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=linenos data-linenos="461 "></span>
<span class=linenos data-linenos="462 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_training_data class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_training_data</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_training_data</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=n>from_tags</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets training data for federated training + verification on arguments type</p> <p>The full expected behaviour when changing training data is given in the table below:</p> <table> <thead> <tr> <th>New value of <code>training_data</code></th> <th><code>from_tags</code></th> <th>Outcome</th> </tr> </thead> <tbody> <tr> <td>dict or FederatedDataset</td> <td>True</td> <td>fail because user is attempting to set from tags but also providing a training_data argument</td> </tr> <tr> <td>dict or FederatedDataset</td> <td>False</td> <td>set fds attribute, set tags to None</td> </tr> <tr> <td>None</td> <td>True</td> <td>fail if tags are not set, else set fds attribute based tags</td> </tr> <tr> <td>None</td> <td>False</td> <td>set tags to None and keep same value and tags</td> </tr> </tbody> </table> <div class="admonition warning"> <p class=admonition-title>Setting to None forfeits consistency checks</p> <p>Setting training_data to None does not trigger consistency checks, and may therefore leave the class in an inconsistent state.</p> </div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>training_data</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>, None]</code> </td> <td> <div class=doc-md-description> <ul> <li>If it is a FederatedDataSet object, use this value as training_data.</li> <li>else if it is a dict, create and use a FederatedDataSet object from the dict and use this value as training_data. The dict should use node ids as keys, values being list of dicts (each dict representing a dataset on a node).</li> <li>else if it is None (no training data provided)</li> <li>if <code>from_tags</code> is True and <code>tags</code> is not None, set training_data by searching for datasets with a query to the nodes using <code>tags</code> and <code>nodes</code></li> <li>if <code>from_tags</code> is False or <code>tags</code> is None, set training_data to None (no training_data set yet, experiment is not fully initialized and cannot be launched)</li> </ul> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>from_tags</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>If True, query nodes for datasets when no <code>training_data</code> is provided. Not used when <code>training_data</code> is provided.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a>, None]</code> </td> <td> <div class=doc-md-description> <p>FederatedDataSet metadata</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedTypeError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedTypeError">FedbiomedTypeError</a></code> </td> <td> <div class=doc-md-description> <p>bad training_data or from_tags type.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedValueError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedValueError">FedbiomedValueError</a></code> </td> <td> <div class=doc-md-description> <p>Invalid value for the arguments <code>training_data</code> or <code>from_tags</code>.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="493 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="494 "></span><span class=k>def</span> <span class=nf>set_training_data</span><span class=p>(</span>
<span class=linenos data-linenos="495 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="496 "></span>        <span class=n>training_data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span>
<span class=linenos data-linenos="497 "></span>        <span class=n>from_tags</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> \
<span class=linenos data-linenos="498 "></span>        <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="499 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets training data for federated training + verification on arguments type</span>
<span class=linenos data-linenos="500 "></span>
<span class=linenos data-linenos="501 "></span>
<span class=linenos data-linenos="502 "></span><span class=sd>    The full expected behaviour when changing training data is given in the table below:</span>
<span class=linenos data-linenos="503 "></span>
<span class=linenos data-linenos="504 "></span><span class=sd>    | New value of `training_data` | `from_tags` | Outcome |</span>
<span class=linenos data-linenos="505 "></span><span class=sd>    | --- | --- | --- |</span>
<span class=linenos data-linenos="506 "></span><span class=sd>    | dict or FederatedDataset | True  | fail because user is attempting to set from tags but also providing a training_data argument|</span>
<span class=linenos data-linenos="507 "></span><span class=sd>    | dict or FederatedDataset | False | set fds attribute, set tags to None |</span>
<span class=linenos data-linenos="508 "></span><span class=sd>    | None | True | fail if tags are not set, else set fds attribute based tags |</span>
<span class=linenos data-linenos="509 "></span><span class=sd>    | None | False | set tags to None and keep same value and tags |</span>
<span class=linenos data-linenos="510 "></span>
<span class=linenos data-linenos="511 "></span><span class=sd>    !!! warning &quot;Setting to None forfeits consistency checks&quot;</span>
<span class=linenos data-linenos="512 "></span><span class=sd>        Setting training_data to None does not trigger consistency checks, and may therefore leave the class in an</span>
<span class=linenos data-linenos="513 "></span><span class=sd>        inconsistent state.</span>
<span class=linenos data-linenos="514 "></span>
<span class=linenos data-linenos="515 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="516 "></span><span class=sd>        training_data:</span>
<span class=linenos data-linenos="517 "></span><span class=sd>            * If it is a FederatedDataSet object, use this value as training_data.</span>
<span class=linenos data-linenos="518 "></span><span class=sd>            * else if it is a dict, create and use a FederatedDataSet object from the dict</span>
<span class=linenos data-linenos="519 "></span><span class=sd>              and use this value as training_data. The dict should use node ids as keys,</span>
<span class=linenos data-linenos="520 "></span><span class=sd>              values being list of dicts (each dict representing a dataset on a node).</span>
<span class=linenos data-linenos="521 "></span><span class=sd>            * else if it is None (no training data provided)</span>
<span class=linenos data-linenos="522 "></span><span class=sd>              - if `from_tags` is True and `tags` is not None, set training_data by</span>
<span class=linenos data-linenos="523 "></span><span class=sd>                searching for datasets with a query to the nodes using `tags` and `nodes`</span>
<span class=linenos data-linenos="524 "></span><span class=sd>              - if `from_tags` is False or `tags` is None, set training_data to None (no training_data set yet,</span>
<span class=linenos data-linenos="525 "></span><span class=sd>                experiment is not fully initialized and cannot be launched)</span>
<span class=linenos data-linenos="526 "></span><span class=sd>        from_tags: If True, query nodes for datasets when no `training_data` is provided.</span>
<span class=linenos data-linenos="527 "></span><span class=sd>            Not used when `training_data` is provided.</span>
<span class=linenos data-linenos="528 "></span>
<span class=linenos data-linenos="529 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="530 "></span><span class=sd>        FederatedDataSet metadata</span>
<span class=linenos data-linenos="531 "></span>
<span class=linenos data-linenos="532 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="533 "></span><span class=sd>        FedbiomedTypeError: bad training_data or from_tags type.</span>
<span class=linenos data-linenos="534 "></span><span class=sd>        FedbiomedValueError: Invalid value for the arguments  `training_data` or `from_tags`.</span>
<span class=linenos data-linenos="535 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="536 "></span>
<span class=linenos data-linenos="537 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>from_tags</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="538 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="539 "></span>            <span class=sa>f</span><span class=s1>&#39; `from_tags` : got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>from_tags</span><span class=p>)</span><span class=si>}</span><span class=s1> but expected a boolean&#39;</span>
<span class=linenos data-linenos="540 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="541 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="542 "></span>    <span class=k>if</span> <span class=n>from_tags</span> <span class=ow>and</span> <span class=n>training_data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="543 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="544 "></span>            <span class=s1>&#39; set_training_data: cannot specify a training_data argument if &#39;</span> \
<span class=linenos data-linenos="545 "></span>            <span class=s1>&#39;from_tags is True&#39;</span>
<span class=linenos data-linenos="546 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="547 "></span>        <span class=k>raise</span> <span class=n>FedbiomedValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="548 "></span>
<span class=linenos data-linenos="549 "></span>    <span class=c1># case where no training data are passed</span>
<span class=linenos data-linenos="550 "></span>    <span class=k>if</span> <span class=n>training_data</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="551 "></span>        <span class=k>if</span> <span class=n>from_tags</span> <span class=ow>is</span> <span class=kc>True</span><span class=p>:</span>
<span class=linenos data-linenos="552 "></span>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span><span class=p>:</span>
<span class=linenos data-linenos="553 "></span>                <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: attempting to &quot;</span> \
<span class=linenos data-linenos="554 "></span>                    <span class=s2>&quot;set training data from undefined tags. Please consider set tags before &quot;</span> \
<span class=linenos data-linenos="555 "></span>                    <span class=s2>&quot;using set_tags method of the experiment.&quot;</span>
<span class=linenos data-linenos="556 "></span>                <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="557 "></span>                <span class=k>raise</span> <span class=n>FedbiomedValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="558 "></span>            <span class=n>training_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_tags</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes_filter</span><span class=p>)</span>
<span class=linenos data-linenos="559 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="560 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Can not set training data to `None`. &quot;</span> \
<span class=linenos data-linenos="561 "></span>                <span class=s2>&quot;Please set from_tags=True or provide a valid training data&quot;</span>
<span class=linenos data-linenos="562 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="563 "></span>            <span class=k>raise</span> <span class=n>FedbiomedValueError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="564 "></span>
<span class=linenos data-linenos="565 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=n>FederatedDataSet</span><span class=p>):</span>
<span class=linenos data-linenos="566 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=o>=</span> <span class=n>training_data</span>
<span class=linenos data-linenos="567 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=linenos data-linenos="568 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=o>=</span> <span class=n>FederatedDataSet</span><span class=p>(</span><span class=n>training_data</span><span class=p>)</span>
<span class=linenos data-linenos="569 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="570 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="571 "></span>            <span class=sa>f</span><span class=s1>&#39; `training_data` has incorrect type: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>training_data</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="572 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="573 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="574 "></span>
<span class=linenos data-linenos="575 "></span>    <span class=c1># check and ensure consistency</span>
<span class=linenos data-linenos="576 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span> <span class=k>if</span> <span class=n>from_tags</span> <span class=k>else</span> <span class=kc>None</span>
<span class=linenos data-linenos="577 "></span>
<span class=linenos data-linenos="578 "></span>    <span class=c1># return the new value</span>
<span class=linenos data-linenos="579 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.tags class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">tags</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>tags</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the tags from the experiment object.</p> <p>Please see <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_tags"><code>set_tags</code></a> to set tags.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>], None]</code> </td> <td> <div class=doc-md-description> <p>List of tags that has been set. <code>None</code> if it isn't declare yet.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="216 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="217 "></span><span class=k>def</span> <span class=nf>tags</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="218 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the tags from the experiment object.</span>
<span class=linenos data-linenos="219 "></span>
<span class=linenos data-linenos="220 "></span><span class=sd>    Please see [`set_tags`][fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_tags] to set tags.</span>
<span class=linenos data-linenos="221 "></span>
<span class=linenos data-linenos="222 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="223 "></span><span class=sd>        List of tags that has been set. `None` if it isn&#39;t declare yet.</span>
<span class=linenos data-linenos="224 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="225 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.FederatedWorkflow.training_data class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">training_data</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>training_data</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the training data which is an instance of <a class="autorefs autorefs-internal" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet"><code>FederatedDataset</code></a></p> <p>This represents the dataset metadata available for the full federation.</p> <p>Please see <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_training_data"><code>set_training_data</code></a> to set or update training data.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Object that contains metadata for the datasets of each node. <code>None</code> if it isn't set yet.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_federated_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="262 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="263 "></span><span class=k>def</span> <span class=nf>training_data</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="264 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the training data which is an instance of</span>
<span class=linenos data-linenos="265 "></span><span class=sd>    [`FederatedDataset`][fedbiomed.researcher.datasets.FederatedDataSet]</span>
<span class=linenos data-linenos="266 "></span>
<span class=linenos data-linenos="267 "></span><span class=sd>    This represents the dataset metadata available for the full federation.</span>
<span class=linenos data-linenos="268 "></span>
<span class=linenos data-linenos="269 "></span><span class=sd>    Please see [`set_training_data`][fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_training_data]</span>
<span class=linenos data-linenos="270 "></span><span class=sd>    to set or update training data.</span>
<span class=linenos data-linenos="271 "></span>
<span class=linenos data-linenos="272 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="273 "></span><span class=sd>        Object that contains metadata for the datasets of each node. `None` if it isn&#39;t set yet.</span>
<span class=linenos data-linenos="274 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="275 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow class="doc doc-heading"> <span class="doc doc-object-name doc-class-name">TrainingPlanWorkflow</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>TrainingPlanWorkflow</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>training_plan_class</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>training_args</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>model_args</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="fedbiomed.researcher.federated_workflows._federated_workflow.FederatedWorkflow" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow">FederatedWorkflow</a></code>, <code><a class="autorefs autorefs-external" title="abc.ABC" href="https://docs.python.org/3/library/abc.html#abc.ABC">ABC</a></code></p> <p>A <code>TrainingPlanWorkflow</code> is an abstract entry point to orchestrate an experiment which uses a training plan.</p> <p>In addition to the functionalities provided by <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow"><code>FederatedWorkflow</code></a>, the <code>TrainingPlanWorkflow</code> also manages the life-cycle of the training plan.</p> <div class="admonition warning"> <p class=admonition-title>Use <code>set_training_plan_class</code> to manage the training plan</p> <p>Please only ever use the <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_training_plan_class"><code>set_training_plan_class</code></a> function to manage the training plan. Do not set the training plan or training plan class directly!</p> </div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>training_plan_class</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<span title="fedbiomed.researcher.federated_workflows._training_plan_workflow.TrainingPlanT">TrainingPlanT</span>]</code> </td> <td> <div class=doc-md-description> <p>training plan class to be used for training. For experiment to be properly and fully defined <code>training_plan_class</code> needs to be a <code>TrainingPlanT</code> Defaults to None (no training plan class defined yet.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>model_args</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>]</code> </td> <td> <div class=doc-md-description> <p>contains model arguments passed to the constructor of the training plan when instantiating it : output and input feature dimension, etc.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>training_args</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-internal" title="fedbiomed.common.training_args.TrainingArgs" href="../../common/training_args/#fedbiomed.common.training_args.TrainingArgs">TrainingArgs</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>]]</code> </td> <td> <div class=doc-md-description> <p>contains training arguments passed to the <code>training_routine</code> of the training plan when launching it: lr, epochs, batch_size...</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>*args</code></td> <td> </td> <td> <div class=doc-md-description> <p>Extra positional arguments from parent class <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow"><code>FederatedWorkflow</code></a></p> </div> </td> <td> <code>()</code> </td> </tr> <tr class=doc-section-item> <td><code>**kwargs</code></td> <td> </td> <td> <div class=doc-md-description> <p>Arguments of parent class <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.FederatedWorkflow"><code>FederatedWorkflow</code></a></p> </div> </td> <td> <code>{}</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 56 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos=" 57 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
<span class=linenos data-linenos=" 58 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos=" 59 "></span>    <span class=o>*</span><span class=n>args</span><span class=p>,</span>
<span class=linenos data-linenos=" 60 "></span>    <span class=n>training_plan_class</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>TrainingPlanT</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 61 "></span>    <span class=n>training_args</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>TrainingArgs</span><span class=p>,</span> <span class=nb>dict</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 62 "></span>    <span class=n>model_args</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos=" 63 "></span>    <span class=o>**</span><span class=n>kwargs</span><span class=p>,</span>
<span class=linenos data-linenos=" 64 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos=" 65 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructor of the class.</span>
<span class=linenos data-linenos=" 66 "></span>
<span class=linenos data-linenos=" 67 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos=" 68 "></span><span class=sd>        training_plan_class: training plan class to be used for training.</span>
<span class=linenos data-linenos=" 69 "></span><span class=sd>            For experiment to be properly and fully defined `training_plan_class`</span>
<span class=linenos data-linenos=" 70 "></span><span class=sd>            needs to be a `TrainingPlanT` Defaults to None (no training plan class</span>
<span class=linenos data-linenos=" 71 "></span><span class=sd>            defined yet.</span>
<span class=linenos data-linenos=" 72 "></span><span class=sd>        model_args: contains model arguments passed to the constructor</span>
<span class=linenos data-linenos=" 73 "></span><span class=sd>            of the training plan when instantiating it :</span>
<span class=linenos data-linenos=" 74 "></span><span class=sd>            output and input feature dimension, etc.</span>
<span class=linenos data-linenos=" 75 "></span><span class=sd>        training_args: contains training arguments passed to the `training_routine`</span>
<span class=linenos data-linenos=" 76 "></span><span class=sd>            of the training plan when launching it: lr, epochs, batch_size...</span>
<span class=linenos data-linenos=" 77 "></span><span class=sd>        *args: Extra positional arguments from parent class</span>
<span class=linenos data-linenos=" 78 "></span><span class=sd>            [`FederatedWorkflow`][fedbiomed.researcher.federated_workflows.FederatedWorkflow]</span>
<span class=linenos data-linenos=" 79 "></span><span class=sd>        **kwargs: Arguments of parent class</span>
<span class=linenos data-linenos=" 80 "></span><span class=sd>            [`FederatedWorkflow`][fedbiomed.researcher.federated_workflows.FederatedWorkflow]</span>
<span class=linenos data-linenos=" 81 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos=" 82 "></span>    <span class=c1># Check arguments</span>
<span class=linenos data-linenos=" 83 "></span>    <span class=k>if</span> <span class=n>training_plan_class</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>inspect</span><span class=o>.</span><span class=n>isclass</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>):</span>
<span class=linenos data-linenos=" 84 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span>
<span class=linenos data-linenos=" 85 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: bad type for argument &quot;</span>
<span class=linenos data-linenos=" 86 "></span>            <span class=sa>f</span><span class=s2>&quot;`training_plan_class` </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=linenos data-linenos=" 87 "></span>
<span class=linenos data-linenos=" 88 "></span>    <span class=k>if</span> <span class=n>training_plan_class</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> \
<span class=linenos data-linenos=" 89 "></span>            <span class=ow>not</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>,</span> <span class=n>TRAINING_PLAN_TYPES</span><span class=p>):</span>
<span class=linenos data-linenos=" 90 "></span>
<span class=linenos data-linenos=" 91 "></span>        <span class=k>raise</span> <span class=n>FedbiomedTypeError</span><span class=p>(</span>
<span class=linenos data-linenos=" 92 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: bad type for argument `training_plan_class`.&quot;</span>
<span class=linenos data-linenos=" 93 "></span>            <span class=sa>f</span><span class=s2>&quot; It is not subclass of supported training plans </span><span class=si>{</span><span class=n>TRAINING_PLAN_TYPES</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=linenos data-linenos=" 94 "></span>
<span class=linenos data-linenos=" 95 "></span>    <span class=c1># _training_plan_class determines the life-cycle of the training plan:</span>
<span class=linenos data-linenos=" 96 "></span>    <span class=c1># if training_plass_class changes, then the training plan must be reinitialized</span>
<span class=linenos data-linenos=" 97 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos=" 98 "></span>    <span class=c1># model args is also tied to the life-cycle of training plan:</span>
<span class=linenos data-linenos=" 99 "></span>    <span class=c1># if model_args changes, the training plan must be reinitialized</span>
<span class=linenos data-linenos="100 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="101 "></span>    <span class=c1># The _training_plan attribute represents the *actual instance*</span>
<span class=linenos data-linenos="102 "></span>    <span class=c1># of a _training_plan_class that is currently</span>
<span class=linenos data-linenos="103 "></span>    <span class=c1># being used in the workflow. The training plan cannot be modified by the user.</span>
<span class=linenos data-linenos="104 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="105 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>TrainingArgs</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># FIXME: is it ok to have this here?</span>
<span class=linenos data-linenos="106 "></span>    <span class=c1># The _training_plan_file attribute represents the path of the file where the training plan is saved.</span>
<span class=linenos data-linenos="107 "></span>    <span class=c1># It cannot be modified by the user</span>
<span class=linenos data-linenos="108 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_file</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="109 "></span>
<span class=linenos data-linenos="110 "></span>    <span class=c1># initialize object</span>
<span class=linenos data-linenos="111 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
<span class=linenos data-linenos="112 "></span>
<span class=linenos data-linenos="113 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_training_args</span><span class=p>(</span><span class=n>training_args</span><span class=p>)</span>
<span class=linenos data-linenos="114 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_model_args</span><span class=p>(</span><span class=n>model_args</span><span class=p>)</span>
<span class=linenos data-linenos="115 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_training_plan_class</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow-functions>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.breakpoint class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">breakpoint</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nb>breakpoint</span><span class=p>(</span><span class=nf>state</span><span class=p>,</span> <span class=n>bkpt_number</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Saves breakpoint with the state of the workflow.</p> <p>The following attributes will be saved:</p> <ul> <li>training_args</li> <li>training_plan_class</li> <li>model_args</li> </ul> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="486 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="487 "></span><span class=k>def</span> <span class=nf>breakpoint</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="488 "></span>               <span class=n>state</span><span class=p>,</span>
<span class=linenos data-linenos="489 "></span>               <span class=n>bkpt_number</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="490 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="491 "></span><span class=sd>    Saves breakpoint with the state of the workflow.</span>
<span class=linenos data-linenos="492 "></span>
<span class=linenos data-linenos="493 "></span><span class=sd>    The following attributes will be saved:</span>
<span class=linenos data-linenos="494 "></span>
<span class=linenos data-linenos="495 "></span><span class=sd>      - training_args</span>
<span class=linenos data-linenos="496 "></span><span class=sd>      - training_plan_class</span>
<span class=linenos data-linenos="497 "></span><span class=sd>      - model_args</span>
<span class=linenos data-linenos="498 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="499 "></span>    <span class=c1># save training plan to file</span>
<span class=linenos data-linenos="500 "></span>    <span class=n>training_plan_module</span> <span class=o>=</span> <span class=s1>&#39;model_&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
<span class=linenos data-linenos="501 "></span>    <span class=n>training_plan_file</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>experimentation_path</span><span class=p>(),</span> <span class=n>training_plan_module</span> <span class=o>+</span> <span class=s1>&#39;.py&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="502 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>save_code</span><span class=p>(</span><span class=n>training_plan_file</span><span class=p>)</span>
<span class=linenos data-linenos="503 "></span>
<span class=linenos data-linenos="504 "></span>    <span class=n>state</span><span class=o>.</span><span class=n>update</span><span class=p>({</span>
<span class=linenos data-linenos="505 "></span>        <span class=s1>&#39;model_args&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span><span class=p>,</span>
<span class=linenos data-linenos="506 "></span>        <span class=s1>&#39;training_plan_class_name&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=o>.</span><span class=vm>__name__</span><span class=p>,</span>
<span class=linenos data-linenos="507 "></span>        <span class=s1>&#39;training_args&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>get_state_breakpoint</span><span class=p>(),</span>
<span class=linenos data-linenos="508 "></span>    <span class=p>})</span>
<span class=linenos data-linenos="509 "></span>
<span class=linenos data-linenos="510 "></span>    <span class=n>breakpoint_path</span><span class=p>,</span> <span class=n>breakpoint_file_name</span> <span class=o>=</span> \
<span class=linenos data-linenos="511 "></span>        <span class=n>choose_bkpt_file</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>,</span> <span class=n>bkpt_number</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
<span class=linenos data-linenos="512 "></span>
<span class=linenos data-linenos="513 "></span>    <span class=c1># rewrite paths in breakpoint : use the links in breakpoint directory</span>
<span class=linenos data-linenos="514 "></span>    <span class=n>state</span><span class=p>[</span><span class=s1>&#39;training_plan_path&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>create_unique_link</span><span class=p>(</span>
<span class=linenos data-linenos="515 "></span>        <span class=n>breakpoint_path</span><span class=p>,</span>
<span class=linenos data-linenos="516 "></span>        <span class=c1># - Need a file with a restricted characters set in name to be able to import as module</span>
<span class=linenos data-linenos="517 "></span>        <span class=s1>&#39;model_&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{:04d}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>bkpt_number</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)),</span> <span class=s1>&#39;.py&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="518 "></span>        <span class=c1># - Prefer relative path, eg for using experiment result after</span>
<span class=linenos data-linenos="519 "></span>        <span class=c1># experiment in a different tree</span>
<span class=linenos data-linenos="520 "></span>        <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39;..&#39;</span><span class=p>,</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>training_plan_file</span><span class=p>))</span>
<span class=linenos data-linenos="521 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="522 "></span>    <span class=n>params_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;model_params_</span><span class=si>{</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span><span class=si>}</span><span class=s2>.mpk&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="523 "></span>    <span class=n>Serializer</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>get_model_wrapper_class</span><span class=p>()</span><span class=o>.</span><span class=n>get_weights</span><span class=p>(</span>
<span class=linenos data-linenos="524 "></span>        <span class=n>only_trainable</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>exclude_buffers</span> <span class=o>=</span> <span class=kc>False</span><span class=p>),</span> <span class=n>params_path</span><span class=p>)</span>
<span class=linenos data-linenos="525 "></span>    <span class=n>state</span><span class=p>[</span><span class=s1>&#39;model_weights_path&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>params_path</span>
<span class=linenos data-linenos="526 "></span>
<span class=linenos data-linenos="527 "></span>    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>breakpoint</span><span class=p>(</span><span class=n>state</span><span class=p>,</span> <span class=n>bkpt_number</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.check_training_plan_status class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">check_training_plan_status</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>check_training_plan_status</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Method for checking training plan status, ie whether it is approved or not by the nodes</p> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>if the training data is not defined.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a></code> </td> <td> <div class=doc-md-description> <p>Training plan status for answering nodes</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="432 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="433 "></span><span class=k>def</span> <span class=nf>check_training_plan_status</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
<span class=linenos data-linenos="434 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Method for checking training plan status, ie whether it is approved or not by the nodes</span>
<span class=linenos data-linenos="435 "></span>
<span class=linenos data-linenos="436 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="437 "></span><span class=sd>        FedbiomedExperimentError: if the training data is not defined.</span>
<span class=linenos data-linenos="438 "></span>
<span class=linenos data-linenos="439 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="440 "></span><span class=sd>        Training plan status for answering nodes</span>
<span class=linenos data-linenos="441 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="442 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>training_data</span><span class=p>()</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="443 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>. Cannot check training plan status: training data is not defined.&quot;</span> \
<span class=linenos data-linenos="444 "></span>              <span class=sa>f</span><span class=s2>&quot;Please either use the `set_tags` or `set_training_data` method to fix this.&quot;</span>
<span class=linenos data-linenos="445 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="446 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="447 "></span>
<span class=linenos data-linenos="448 "></span>    <span class=n>job</span> <span class=o>=</span> <span class=n>TrainingPlanCheckJob</span><span class=p>(</span>
<span class=linenos data-linenos="449 "></span>        <span class=n>nodes</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_data</span><span class=p>()</span><span class=o>.</span><span class=n>node_ids</span><span class=p>(),</span>
<span class=linenos data-linenos="450 "></span>        <span class=n>keep_files_dir</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>experimentation_path</span><span class=p>(),</span>
<span class=linenos data-linenos="451 "></span>        <span class=n>experiment_id</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_experiment_id</span><span class=p>,</span>
<span class=linenos data-linenos="452 "></span>        <span class=n>training_plan</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span>
<span class=linenos data-linenos="453 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="454 "></span>    <span class=n>responses</span> <span class=o>=</span> <span class=n>job</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
<span class=linenos data-linenos="455 "></span>    <span class=k>return</span> <span class=n>responses</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.info class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">info</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>info</span><span class=p>(</span><span class=n>info</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>missing</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Prints out the information about the current status of the experiment.</p> <p>Lists all the parameters/arguments of the experiment and informs whether the experiment can be run.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>info</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>]</code> </td> <td> <div class=doc-md-description> <p>Dictionary of sub-classes relevant attributes status that will be completed with some additional attributes status defined in this class. Defaults to None (no entries of sub-classes available or of importance).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td><code>missing_object_to_check</code></td> <td> </td> <td> <div class=doc-md-description> <p>dictionary mapping sub-classes attributes to attribute names, that may be needed to fully run the object. Defaults to None (no check will be performed).</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>dictionary containing all pieces of information, with 2 entries: <code>Arguments</code> mapping a list of all argument, and <code>Values</code> mapping a list copntaining all the values.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#KeyError">KeyError</a></code> </td> <td> <div class=doc-md-description> <p>if <code>Arguments</code> or <code>Values</code> entry is missing in passing argument <code>info</code></p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="265 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="266 "></span><span class=k>def</span> <span class=nf>info</span><span class=p>(</span>
<span class=linenos data-linenos="267 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="268 "></span>    <span class=n>info</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="269 "></span>    <span class=n>missing</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
<span class=linenos data-linenos="270 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]],</span> <span class=nb>str</span><span class=p>]:</span>
<span class=linenos data-linenos="271 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Prints out the information about the current status of the experiment.</span>
<span class=linenos data-linenos="272 "></span>
<span class=linenos data-linenos="273 "></span><span class=sd>    Lists  all the parameters/arguments of the experiment and informs whether</span>
<span class=linenos data-linenos="274 "></span><span class=sd>    the experiment can be run.</span>
<span class=linenos data-linenos="275 "></span>
<span class=linenos data-linenos="276 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="277 "></span><span class=sd>        info: Dictionary of sub-classes relevant attributes status that will be</span>
<span class=linenos data-linenos="278 "></span><span class=sd>            completed with some additional attributes status defined in this class.</span>
<span class=linenos data-linenos="279 "></span><span class=sd>            Defaults to None (no entries of sub-classes available or of importance).</span>
<span class=linenos data-linenos="280 "></span><span class=sd>        missing_object_to_check: dictionary mapping sub-classes attributes to</span>
<span class=linenos data-linenos="281 "></span><span class=sd>            attribute names, that may be needed to fully run the object. Defaults</span>
<span class=linenos data-linenos="282 "></span><span class=sd>            to None (no check will be performed).</span>
<span class=linenos data-linenos="283 "></span>
<span class=linenos data-linenos="284 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="285 "></span><span class=sd>        dictionary containing all pieces of information, with 2 entries:</span>
<span class=linenos data-linenos="286 "></span><span class=sd>            `Arguments` mapping a list of all argument, and `Values` mapping</span>
<span class=linenos data-linenos="287 "></span><span class=sd>            a list copntaining all the values.</span>
<span class=linenos data-linenos="288 "></span>
<span class=linenos data-linenos="289 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="290 "></span><span class=sd>        KeyError: if `Arguments` or `Values` entry is missing in passing argument `info`</span>
<span class=linenos data-linenos="291 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="292 "></span>    <span class=c1># at this point all attributes are initialized (in constructor)</span>
<span class=linenos data-linenos="293 "></span>    <span class=k>if</span> <span class=n>info</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="294 "></span>        <span class=n>info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_default_info_structure</span><span class=p>()</span>
<span class=linenos data-linenos="295 "></span>    <span class=n>info</span><span class=p>[</span><span class=s1>&#39;Arguments&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
<span class=linenos data-linenos="296 "></span>        <span class=s1>&#39;Training Plan Class&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="297 "></span>        <span class=s1>&#39;Model Arguments&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="298 "></span>        <span class=s1>&#39;Training Arguments&#39;</span>
<span class=linenos data-linenos="299 "></span>    <span class=p>])</span>
<span class=linenos data-linenos="300 "></span>    <span class=n>info</span><span class=p>[</span><span class=s1>&#39;Values&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;.{1,60}&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="301 "></span>                                     <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)))</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=p>[</span>
<span class=linenos data-linenos="302 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=p>,</span>
<span class=linenos data-linenos="303 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span><span class=p>,</span>
<span class=linenos data-linenos="304 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span>
<span class=linenos data-linenos="305 "></span>    <span class=p>]])</span>
<span class=linenos data-linenos="306 "></span>
<span class=linenos data-linenos="307 "></span>    <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>info</span><span class=p>,</span> <span class=n>missing</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.load_breakpoint class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">load_breakpoint</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>load_breakpoint</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Loads breakpoint (provided a breakpoint has been saved) so the workflow can be resumed.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>breakpoint_folder_path</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code> </td> <td> <div class=doc-md-description> <p>path of the breakpoint folder. Path can be absolute or relative eg: "var/experiments/Experiment_xxxx/breakpoints_xxxx". If None, loads the latest breakpoint of the latest workflow. Defaults to None.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="fedbiomed.researcher.federated_workflows._training_plan_workflow.TrainingPlanWorkflowT">TrainingPlanWorkflowT</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>]</code> </td> <td> <div class=doc-md-description> <p>Reinitialized workflow object.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type, error when reading breakpoint or bad loaded breakpoint content (corrupted)</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="530 "></span><span class=nd>@classmethod</span>
<span class=linenos data-linenos="531 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="532 "></span><span class=k>def</span> <span class=nf>load_breakpoint</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span>
<span class=linenos data-linenos="533 "></span>                    <span class=n>breakpoint_folder_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>TrainingPlanWorkflowT</span><span class=p>,</span> <span class=nb>dict</span><span class=p>]:</span>
<span class=linenos data-linenos="534 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="535 "></span><span class=sd>    Loads breakpoint (provided a breakpoint has been saved)</span>
<span class=linenos data-linenos="536 "></span><span class=sd>    so the workflow can be resumed.</span>
<span class=linenos data-linenos="537 "></span>
<span class=linenos data-linenos="538 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="539 "></span><span class=sd>      breakpoint_folder_path: path of the breakpoint folder. Path can be absolute or relative eg:</span>
<span class=linenos data-linenos="540 "></span><span class=sd>        &quot;var/experiments/Experiment_xxxx/breakpoints_xxxx&quot;. If None, loads the latest breakpoint of the latest</span>
<span class=linenos data-linenos="541 "></span><span class=sd>        workflow. Defaults to None.</span>
<span class=linenos data-linenos="542 "></span>
<span class=linenos data-linenos="543 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="544 "></span><span class=sd>        Reinitialized workflow object.</span>
<span class=linenos data-linenos="545 "></span>
<span class=linenos data-linenos="546 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="547 "></span><span class=sd>        FedbiomedExperimentError: bad argument type, error when reading breakpoint or bad loaded breakpoint</span>
<span class=linenos data-linenos="548 "></span><span class=sd>            content (corrupted)</span>
<span class=linenos data-linenos="549 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="550 "></span>    <span class=n>loaded_exp</span><span class=p>,</span> <span class=n>saved_state</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>load_breakpoint</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>)</span>
<span class=linenos data-linenos="551 "></span>
<span class=linenos data-linenos="552 "></span>    <span class=c1># Define type for pylint</span>
<span class=linenos data-linenos="553 "></span>    <span class=n>loaded_exp</span><span class=p>:</span> <span class=n>TrainingPlanWorkflow</span>
<span class=linenos data-linenos="554 "></span>
<span class=linenos data-linenos="555 "></span>    <span class=c1># Import TP class</span>
<span class=linenos data-linenos="556 "></span>    <span class=n>_</span><span class=p>,</span> <span class=n>tp_class</span> <span class=o>=</span> <span class=n>import_class_from_file</span><span class=p>(</span>
<span class=linenos data-linenos="557 "></span>        <span class=n>module_path</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;training_plan_path&quot;</span><span class=p>),</span>
<span class=linenos data-linenos="558 "></span>        <span class=n>class_name</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;training_plan_class_name&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="559 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="560 "></span>
<span class=linenos data-linenos="561 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_model_args</span><span class=p>(</span><span class=n>saved_state</span><span class=p>[</span><span class=s2>&quot;model_args&quot;</span><span class=p>])</span>
<span class=linenos data-linenos="562 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_training_plan_class</span><span class=p>(</span><span class=n>tp_class</span><span class=p>)</span>
<span class=linenos data-linenos="563 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_training_args</span><span class=p>(</span>
<span class=linenos data-linenos="564 "></span>        <span class=n>TrainingArgs</span><span class=o>.</span><span class=n>load_state_breakpoint</span><span class=p>(</span>
<span class=linenos data-linenos="565 "></span>            <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;training_args&#39;</span><span class=p>)))</span>
<span class=linenos data-linenos="566 "></span>    <span class=n>training_plan</span> <span class=o>=</span> <span class=n>loaded_exp</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span>
<span class=linenos data-linenos="567 "></span>    <span class=k>if</span> <span class=n>training_plan</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="568 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39; - load failed, &#39;</span> <span class=o>+</span> \
<span class=linenos data-linenos="569 "></span>            <span class=s1>&#39;breakpoint file seems corrupted, `training_plan` is None&#39;</span>
<span class=linenos data-linenos="570 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="571 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="572 "></span>    <span class=n>param_path</span> <span class=o>=</span> <span class=n>saved_state</span><span class=p>[</span><span class=s1>&#39;model_weights_path&#39;</span><span class=p>]</span>
<span class=linenos data-linenos="573 "></span>    <span class=n>params</span> <span class=o>=</span> <span class=n>Serializer</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>param_path</span><span class=p>)</span>
<span class=linenos data-linenos="574 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span><span class=o>.</span><span class=n>get_model_wrapper_class</span><span class=p>()</span><span class=o>.</span><span class=n>set_weights</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
<span class=linenos data-linenos="575 "></span>
<span class=linenos data-linenos="576 "></span>    <span class=k>return</span> <span class=n>loaded_exp</span><span class=p>,</span> <span class=n>saved_state</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.model_args class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">model_args</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>model_args</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves model arguments.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_model_args"><code>set_model_args</code></a></p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>The arguments that are going to be passed to the <code>init_model</code> function of the training plan during</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>initialization of the model instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="253 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="254 "></span><span class=k>def</span> <span class=nf>model_args</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="255 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves model arguments.</span>
<span class=linenos data-linenos="256 "></span>
<span class=linenos data-linenos="257 "></span><span class=sd>    Please see also [`set_model_args`][fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_model_args]</span>
<span class=linenos data-linenos="258 "></span>
<span class=linenos data-linenos="259 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="260 "></span><span class=sd>        The arguments that are going to be passed to the `init_model` function of the training plan during</span>
<span class=linenos data-linenos="261 "></span><span class=sd>        initialization of the model instance</span>
<span class=linenos data-linenos="262 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="263 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_model_args class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_model_args</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_model_args</span><span class=p>(</span><span class=n>model_args</span><span class=p>,</span> <span class=n>keep_weights</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets <code>model_args</code> + verification on arguments type</p> <div class="admonition warning"> <p class=admonition-title>Resets the training plan</p> <p>This function has an important (and intended!) side-effect: it resets the <code>training_plan</code> attribute. By default, it tries to keep the same weights as the current training plan, if available.</p> </div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>model_args</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>contains model arguments passed to the constructor of the training plan when instantiating it : output and input feature dimension, etc.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>keep_weights</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>try to keep the same weights as the current training plan</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>Model arguments that have been set.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad model_args type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="397 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="398 "></span><span class=k>def</span> <span class=nf>set_model_args</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="399 "></span>                   <span class=n>model_args</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span>
<span class=linenos data-linenos="400 "></span>                   <span class=n>keep_weights</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="401 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets `model_args` + verification on arguments type</span>
<span class=linenos data-linenos="402 "></span>
<span class=linenos data-linenos="403 "></span><span class=sd>    !!! warning &quot;Resets the training plan&quot;</span>
<span class=linenos data-linenos="404 "></span><span class=sd>        This function has an important (and intended!) side-effect: it resets the `training_plan` attribute.</span>
<span class=linenos data-linenos="405 "></span><span class=sd>        By default, it tries to keep the same weights as the current training plan, if available.</span>
<span class=linenos data-linenos="406 "></span>
<span class=linenos data-linenos="407 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="408 "></span><span class=sd>        model_args (dict): contains model arguments passed to the constructor</span>
<span class=linenos data-linenos="409 "></span><span class=sd>            of the training plan when instantiating it : output and input feature</span>
<span class=linenos data-linenos="410 "></span><span class=sd>            dimension, etc.</span>
<span class=linenos data-linenos="411 "></span><span class=sd>        keep_weights: try to keep the same weights as the current training plan</span>
<span class=linenos data-linenos="412 "></span>
<span class=linenos data-linenos="413 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="414 "></span><span class=sd>        Model arguments that have been set.</span>
<span class=linenos data-linenos="415 "></span>
<span class=linenos data-linenos="416 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="417 "></span><span class=sd>        FedbiomedExperimentError : bad model_args type</span>
<span class=linenos data-linenos="418 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="419 "></span>    <span class=k>if</span> <span class=n>model_args</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>model_args</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=linenos data-linenos="420 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span> <span class=o>=</span> <span class=n>model_args</span>
<span class=linenos data-linenos="421 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="422 "></span>        <span class=c1># bad type</span>
<span class=linenos data-linenos="423 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `model_args` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>model_args</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="424 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="425 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="426 "></span>    <span class=c1># self._model_args always exist at this point</span>
<span class=linenos data-linenos="427 "></span>
<span class=linenos data-linenos="428 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_update_training_plan</span><span class=p>(</span><span class=n>keep_weights</span><span class=p>)</span>  <span class=c1># resets the training plan attribute</span>
<span class=linenos data-linenos="429 "></span>
<span class=linenos data-linenos="430 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_training_args class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_training_args</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_training_args</span><span class=p>(</span><span class=n>training_args</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets <code>training_args</code> + verification on arguments type</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>training_args</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>, <a class="autorefs autorefs-internal" title="fedbiomed.common.training_args.TrainingArgs" href="../../common/training_args/#fedbiomed.common.training_args.TrainingArgs">TrainingArgs</a>, None]</code> </td> <td> <div class=doc-md-description> <p>contains training arguments passed to the training plan's <code>training_routine</code> such as lr, epochs, batch_size...</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>, None]</code> </td> <td> <div class=doc-md-description> <p>Training arguments</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad training_args type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="319 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="320 "></span><span class=k>def</span> <span class=nf>set_training_args</span><span class=p>(</span>
<span class=linenos data-linenos="321 "></span>    <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="322 "></span>    <span class=n>training_args</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>dict</span><span class=p>,</span> <span class=n>TrainingArgs</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>
<span class=linenos data-linenos="323 "></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="324 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Sets `training_args` + verification on arguments type</span>
<span class=linenos data-linenos="325 "></span>
<span class=linenos data-linenos="326 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="327 "></span><span class=sd>        training_args: contains training arguments passed to the</span>
<span class=linenos data-linenos="328 "></span><span class=sd>            training plan&#39;s `training_routine` such as lr, epochs, batch_size...</span>
<span class=linenos data-linenos="329 "></span>
<span class=linenos data-linenos="330 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="331 "></span><span class=sd>        Training arguments</span>
<span class=linenos data-linenos="332 "></span>
<span class=linenos data-linenos="333 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="334 "></span><span class=sd>        FedbiomedExperimentError : bad training_args type</span>
<span class=linenos data-linenos="335 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="336 "></span>
<span class=linenos data-linenos="337 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_args</span><span class=p>,</span> <span class=n>TrainingArgs</span><span class=p>):</span>
<span class=linenos data-linenos="338 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span> <span class=o>=</span> <span class=n>deepcopy</span><span class=p>(</span><span class=n>training_args</span><span class=p>)</span>
<span class=linenos data-linenos="339 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_args</span><span class=p>,</span> <span class=nb>dict</span><span class=p>)</span> <span class=ow>or</span> <span class=n>training_args</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="340 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span> <span class=o>=</span> <span class=n>TrainingArgs</span><span class=p>(</span><span class=n>training_args</span><span class=p>,</span> <span class=n>only_required</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=linenos data-linenos="341 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="342 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2> in function `set_training_args`. &quot;</span> \
<span class=linenos data-linenos="343 "></span>              <span class=s2>&quot;Expected type TrainingArgs, dict, or &quot;</span> \
<span class=linenos data-linenos="344 "></span>              <span class=sa>f</span><span class=s2>&quot;None, got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>training_args</span><span class=p>)</span><span class=si>}</span><span class=s2> instead.&quot;</span>
<span class=linenos data-linenos="345 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="346 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="347 "></span>
<span class=linenos data-linenos="348 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_training_plan_class class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">set_training_plan_class</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>set_training_plan_class</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>,</span> <span class=n>keep_weights</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Sets the training plan type + verification on arguments type</p> <div class="admonition warning"> <p class=admonition-title>Resets the training plan</p> <p>This function has an important (and intended!) side-effect: it resets the <code>training_plan</code> attribute. By default, it tries to keep the same weights as the current training plan, if available.</p> </div> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>training_plan_class</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<span title="fedbiomed.researcher.federated_workflows._training_plan_workflow.TrainingPlanT">TrainingPlanT</span>, None]</code> </td> <td> <div class=doc-md-description> <p>training plan class to be used for training. For experiment to be properly and fully defined <code>training_plan_class</code> needs to be a <code>TrainingPlanT</code> Defaults to None (no training plan class defined yet)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td><code>keep_weights</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>try to keep the same weights as the current training plan</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<span title="fedbiomed.researcher.federated_workflows._training_plan_workflow.TrainingPlanT">TrainingPlanT</span>, None]</code> </td> <td> <div class=doc-md-description> <p><code>training_plan_class</code> that is set for experiment</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad training_plan_class type</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="352 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="353 "></span><span class=k>def</span> <span class=nf>set_training_plan_class</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="354 "></span>                            <span class=n>training_plan_class</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>TrainingPlanT</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span>
<span class=linenos data-linenos="355 "></span>                            <span class=n>keep_weights</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
<span class=linenos data-linenos="356 "></span>                            <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>TrainingPlanT</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="357 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets  the training plan type + verification on arguments type</span>
<span class=linenos data-linenos="358 "></span>
<span class=linenos data-linenos="359 "></span><span class=sd>    !!! warning &quot;Resets the training plan&quot;</span>
<span class=linenos data-linenos="360 "></span><span class=sd>        This function has an important (and intended!) side-effect: it resets the `training_plan` attribute.</span>
<span class=linenos data-linenos="361 "></span><span class=sd>        By default, it tries to keep the same weights as the current training plan, if available.</span>
<span class=linenos data-linenos="362 "></span>
<span class=linenos data-linenos="363 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="364 "></span><span class=sd>        training_plan_class: training plan class to be used for training.</span>
<span class=linenos data-linenos="365 "></span><span class=sd>            For experiment to be properly and fully defined `training_plan_class` needs to be a `TrainingPlanT`</span>
<span class=linenos data-linenos="366 "></span><span class=sd>            Defaults to None (no training plan class defined yet)</span>
<span class=linenos data-linenos="367 "></span><span class=sd>        keep_weights: try to keep the same weights as the current training plan</span>
<span class=linenos data-linenos="368 "></span>
<span class=linenos data-linenos="369 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="370 "></span><span class=sd>        `training_plan_class` that is set for experiment</span>
<span class=linenos data-linenos="371 "></span>
<span class=linenos data-linenos="372 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="373 "></span><span class=sd>        FedbiomedExperimentError : bad training_plan_class type</span>
<span class=linenos data-linenos="374 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="375 "></span>    <span class=k>if</span> <span class=n>training_plan_class</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="376 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="377 "></span>    <span class=k>elif</span> <span class=n>inspect</span><span class=o>.</span><span class=n>isclass</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>):</span>
<span class=linenos data-linenos="378 "></span>        <span class=c1># training_plan_class must be a subclass of a valid training plan</span>
<span class=linenos data-linenos="379 "></span>        <span class=k>if</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>,</span> <span class=n>TRAINING_PLAN_TYPES</span><span class=p>):</span>
<span class=linenos data-linenos="380 "></span>            <span class=c1># valid class</span>
<span class=linenos data-linenos="381 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span> <span class=o>=</span> <span class=n>training_plan_class</span>
<span class=linenos data-linenos="382 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="383 "></span>            <span class=c1># bad class</span>
<span class=linenos data-linenos="384 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `training_plan_class` : </span><span class=si>{</span><span class=n>training_plan_class</span><span class=si>}</span><span class=s1> class&#39;</span>
<span class=linenos data-linenos="385 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="386 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="387 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="388 "></span>        <span class=c1># bad type</span>
<span class=linenos data-linenos="389 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `training_plan_class` of type: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="390 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="391 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="392 "></span>
<span class=linenos data-linenos="393 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_update_training_plan</span><span class=p>(</span><span class=n>keep_weights</span><span class=p>)</span>  <span class=c1># resets the training plan attribute</span>
<span class=linenos data-linenos="394 "></span>
<span class=linenos data-linenos="395 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_args class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">training_args</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>training_args</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves training arguments.</p> <p>Please see also [<code>set_training_args</code>][fedbiomed.researcher.        federated_workflows.FederatedWorkflow.set_training_args]</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>The arguments that are going to be passed to the training plan's <code>training_routine</code> to perfom training on the node side. An example training routine: <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans.TorchTrainingPlan.training_routine"><code>TorchTrainingPlan.training_routine</code></a></p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="226 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="227 "></span><span class=k>def</span> <span class=nf>training_args</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="228 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves training arguments.</span>
<span class=linenos data-linenos="229 "></span>
<span class=linenos data-linenos="230 "></span><span class=sd>    Please see also [`set_training_args`][fedbiomed.researcher.\</span>
<span class=linenos data-linenos="231 "></span><span class=sd>    federated_workflows.FederatedWorkflow.set_training_args]</span>
<span class=linenos data-linenos="232 "></span>
<span class=linenos data-linenos="233 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="234 "></span><span class=sd>        The arguments that are going to be passed to the training plan&#39;s</span>
<span class=linenos data-linenos="235 "></span><span class=sd>            `training_routine` to perfom training on the node side. An example</span>
<span class=linenos data-linenos="236 "></span><span class=sd>            training routine: [`TorchTrainingPlan.training_routine`]</span>
<span class=linenos data-linenos="237 "></span><span class=sd>            [fedbiomed.common.training_plans.TorchTrainingPlan.training_routine]</span>
<span class=linenos data-linenos="238 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="239 "></span>
<span class=linenos data-linenos="240 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">training_plan</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>training_plan</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the training plan instance currently being used in the federated workflow.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<span title="fedbiomed.researcher.federated_workflows._training_plan_workflow.TrainingPlan">TrainingPlan</span>]</code> </td> <td> <div class=doc-md-description> <p>training plan: the training plan instance</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="244 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="245 "></span><span class=k>def</span> <span class=nf>training_plan</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>TrainingPlan</span><span class=p>]:</span>
<span class=linenos data-linenos="246 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the training plan instance currently being used in the federated workflow.</span>
<span class=linenos data-linenos="247 "></span>
<span class=linenos data-linenos="248 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="249 "></span><span class=sd>        training plan: the training plan instance</span>
<span class=linenos data-linenos="250 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="251 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan_approve class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">training_plan_approve</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>training_plan_approve</span><span class=p>(</span><span class=n>description</span><span class=o>=</span><span class=s1>&#39;no description provided&#39;</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Send a training plan and a ApprovalRequest message to node(s).</p> <p>This is a simple redirect to the Requests.training_plan_approve() method.</p> <p>If a list of node id(s) is provided, the message will be individually sent to all nodes of the list. If the node id(s) list is None (default), the message is broadcast to all nodes.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>description</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>Description for training plan approve request</p> </div> </td> <td> <code>&#39;no description provided&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>a dictionary of pairs (node_id: status), where status indicates to the researcher</p> </div> </td> </tr> <tr class=doc-section-item> <td></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>that the training plan has been correctly downloaded on the node side.</p> </div> </td> </tr> <tr class=doc-section-item> <td><code>Warning</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>status does not mean that the training plan is approved, only that it has been added</p> </div> </td> </tr> <tr class=doc-section-item> <td></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td> <div class=doc-md-description> <p>to the "approval queue" on the node side.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="457 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="458 "></span><span class=k>def</span> <span class=nf>training_plan_approve</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="459 "></span>                          <span class=n>description</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;no description provided&quot;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="460 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Send a training plan and a ApprovalRequest message to node(s).</span>
<span class=linenos data-linenos="461 "></span>
<span class=linenos data-linenos="462 "></span><span class=sd>    This is a simple redirect to the Requests.training_plan_approve() method.</span>
<span class=linenos data-linenos="463 "></span>
<span class=linenos data-linenos="464 "></span><span class=sd>    If a list of node id(s) is provided, the message will be individually sent</span>
<span class=linenos data-linenos="465 "></span><span class=sd>    to all nodes of the list.</span>
<span class=linenos data-linenos="466 "></span><span class=sd>    If the node id(s) list is None (default), the message is broadcast to all nodes.</span>
<span class=linenos data-linenos="467 "></span>
<span class=linenos data-linenos="468 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="469 "></span><span class=sd>        description: Description for training plan approve request</span>
<span class=linenos data-linenos="470 "></span>
<span class=linenos data-linenos="471 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="472 "></span><span class=sd>        a dictionary of pairs (node_id: status), where status indicates to the researcher</span>
<span class=linenos data-linenos="473 "></span><span class=sd>        that the training plan has been correctly downloaded on the node side.</span>
<span class=linenos data-linenos="474 "></span><span class=sd>        Warning: status does not mean that the training plan is approved, only that it has been added</span>
<span class=linenos data-linenos="475 "></span><span class=sd>        to the &quot;approval queue&quot; on the node side.</span>
<span class=linenos data-linenos="476 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="477 "></span>    <span class=n>job</span> <span class=o>=</span> <span class=n>TrainingPlanApproveJob</span><span class=p>(</span>
<span class=linenos data-linenos="478 "></span>        <span class=n>nodes</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_data</span><span class=p>()</span><span class=o>.</span><span class=n>node_ids</span><span class=p>(),</span>
<span class=linenos data-linenos="479 "></span>        <span class=n>keep_files_dir</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>experimentation_path</span><span class=p>(),</span>
<span class=linenos data-linenos="480 "></span>        <span class=n>training_plan</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>training_plan</span><span class=p>(),</span>
<span class=linenos data-linenos="481 "></span>        <span class=n>description</span><span class=o>=</span><span class=n>description</span><span class=p>,</span>
<span class=linenos data-linenos="482 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="483 "></span>    <span class=n>responses</span> <span class=o>=</span> <span class=n>job</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
<span class=linenos data-linenos="484 "></span>    <span class=k>return</span> <span class=n>responses</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan_class class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">training_plan_class</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>training_plan_class</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the type of the training plan that is created for training.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_training_plan_class"><code>set_training_plan_class</code></a>.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>training_plan_class</code></td> <td> <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<span title="fedbiomed.researcher.federated_workflows._training_plan_workflow.TrainingPlanT">TrainingPlanT</span>]</code> </td> <td> <div class=doc-md-description> <p>the class type of the training plan.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="176 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="177 "></span><span class=k>def</span> <span class=nf>training_plan_class</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>TrainingPlanT</span><span class=p>]:</span>
<span class=linenos data-linenos="178 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the type of the training plan that is created for training.</span>
<span class=linenos data-linenos="179 "></span>
<span class=linenos data-linenos="180 "></span><span class=sd>    Please see also</span>
<span class=linenos data-linenos="181 "></span><span class=sd>    [`set_training_plan_class`][fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_training_plan_class].</span>
<span class=linenos data-linenos="182 "></span>
<span class=linenos data-linenos="183 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="184 "></span><span class=sd>        training_plan_class: the class type of the training plan.</span>
<span class=linenos data-linenos="185 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="186 "></span>
<span class=linenos data-linenos="187 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan_file class="doc doc-heading"> <span class="doc doc-object-name doc-function-name">training_plan_file</span> </h5> <div class="doc-signature highlight"><pre><span></span><code><span class=nf>training_plan_file</span><span class=p>(</span><span class=n>display</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Retrieves the path of the file where the training plan is saved, and optionally displays it.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>display</code></td> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td> <div class=doc-md-description> <p>If <code>True</code>, prints the content of the training plan file. Default is <code>True</code></p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td> <div class=doc-md-description> <p>Path to the training plan file</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td> <div class=doc-md-description> <p>bad argument type, or cannot read training plan file content</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/federated_workflows/_training_plan_workflow.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="190 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="191 "></span><span class=k>def</span> <span class=nf>training_plan_file</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>display</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=linenos data-linenos="192 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the path of the file where the training plan is saved, and optionally displays it.</span>
<span class=linenos data-linenos="193 "></span>
<span class=linenos data-linenos="194 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="195 "></span><span class=sd>        display: If `True`, prints the content of the training plan file. Default is `True`</span>
<span class=linenos data-linenos="196 "></span>
<span class=linenos data-linenos="197 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="198 "></span><span class=sd>        Path to the training plan file</span>
<span class=linenos data-linenos="199 "></span>
<span class=linenos data-linenos="200 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="201 "></span><span class=sd>        FedbiomedExperimentError: bad argument type, or cannot read training plan file content</span>
<span class=linenos data-linenos="202 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="203 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>display</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="204 "></span>        <span class=c1># bad type</span>
<span class=linenos data-linenos="205 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="206 "></span>            <span class=sa>f</span><span class=s1>&#39;, in method `training_plan_file` param `display` : type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>display</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="207 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="208 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="209 "></span>
<span class=linenos data-linenos="210 "></span>    <span class=k>if</span> <span class=n>display</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_file</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="211 "></span>        <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="212 "></span>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_file</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
<span class=linenos data-linenos="213 "></span>                <span class=n>content</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<span class=linenos data-linenos="214 "></span>                <span class=n>file</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
<span class=linenos data-linenos="215 "></span>                <span class=nb>print</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
<span class=linenos data-linenos="216 "></span>        <span class=k>except</span> <span class=ne>OSError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos="217 "></span>            <span class=c1># cannot read training plan file content</span>
<span class=linenos data-linenos="218 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB412</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="219 "></span>                <span class=sa>f</span><span class=s1>&#39;, in method `training_plan_file` : error when reading training plan file - </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="220 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="221 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="222 "></span>
<span class=linenos data-linenos="223 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_file</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> </div> </article> </main> </div> <div class=right-col> <div id=right-sidebar class=sidebar-right> <nav class=toc> <!-- Render item list --> <label class=toc-title for=__toc> <span class=toc-icon></span> </label> <ul class=toc-list data-md-component=toc data-md-scrollfix> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows-classes class=md-nav__link> Classes </a> <nav class=toc-nav aria-label=Classes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment class=md-nav__link> Experiment </a> <nav class=toc-nav aria-label=Experiment> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.aggregator_args class=md-nav__link> aggregator_args </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.agg_optimizer class=md-nav__link> agg_optimizer </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.aggregated_params class=md-nav__link> aggregated_params </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.aggregator class=md-nav__link> aggregator </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.breakpoint class=md-nav__link> breakpoint </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.commit_experiment_history class=md-nav__link> commit_experiment_history </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.info class=md-nav__link> info </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.load_breakpoint class=md-nav__link> load_breakpoint </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.load_training_replies class=md-nav__link> load_training_replies </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.monitor class=md-nav__link> monitor </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.retain_full_history class=md-nav__link> retain_full_history </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.round_current class=md-nav__link> round_current </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.round_limit class=md-nav__link> round_limit </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.run class=md-nav__link> run </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.run_once class=md-nav__link> run_once </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.save_aggregated_params class=md-nav__link> save_aggregated_params </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.save_optimizer class=md-nav__link> save_optimizer </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.save_training_replies class=md-nav__link> save_training_replies </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_agg_optimizer class=md-nav__link> set_agg_optimizer </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_aggregator class=md-nav__link> set_aggregator </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_retain_full_history class=md-nav__link> set_retain_full_history </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_round_limit class=md-nav__link> set_round_limit </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_strategy class=md-nav__link> set_strategy </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_tensorboard class=md-nav__link> set_tensorboard </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_test_metric class=md-nav__link> set_test_metric </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_test_on_global_updates class=md-nav__link> set_test_on_global_updates </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_test_on_local_updates class=md-nav__link> set_test_on_local_updates </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_test_ratio class=md-nav__link> set_test_ratio </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.set_training_data class=md-nav__link> set_training_data </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.strategy class=md-nav__link> strategy </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.test_metric class=md-nav__link> test_metric </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.test_metric_args class=md-nav__link> test_metric_args </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.test_on_global_updates class=md-nav__link> test_on_global_updates </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.test_on_local_updates class=md-nav__link> test_on_local_updates </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.test_ratio class=md-nav__link> test_ratio </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.Experiment.training_replies class=md-nav__link> training_replies </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow class=md-nav__link> FederatedWorkflow </a> <nav class=toc-nav aria-label=FederatedWorkflow> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.id class=md-nav__link> id </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.secagg class=md-nav__link> secagg </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.all_federation_nodes class=md-nav__link> all_federation_nodes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.breakpoint class=md-nav__link> breakpoint </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.experimentation_folder class=md-nav__link> experimentation_folder </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.experimentation_path class=md-nav__link> experimentation_path </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.filtered_federation_nodes class=md-nav__link> filtered_federation_nodes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.info class=md-nav__link> info </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.load_breakpoint class=md-nav__link> load_breakpoint </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.nodes class=md-nav__link> nodes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.run class=md-nav__link> run </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.save_breakpoints class=md-nav__link> save_breakpoints </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.secagg_setup class=md-nav__link> secagg_setup </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_experimentation_folder class=md-nav__link> set_experimentation_folder </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_nodes class=md-nav__link> set_nodes </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_save_breakpoints class=md-nav__link> set_save_breakpoints </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_secagg class=md-nav__link> set_secagg </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_tags class=md-nav__link> set_tags </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.set_training_data class=md-nav__link> set_training_data </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.tags class=md-nav__link> tags </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.FederatedWorkflow.training_data class=md-nav__link> training_data </a> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow class=md-nav__link> TrainingPlanWorkflow </a> <nav class=toc-nav aria-label=TrainingPlanWorkflow> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.breakpoint class=md-nav__link> breakpoint </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.check_training_plan_status class=md-nav__link> check_training_plan_status </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.info class=md-nav__link> info </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.load_breakpoint class=md-nav__link> load_breakpoint </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.model_args class=md-nav__link> model_args </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_model_args class=md-nav__link> set_model_args </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_training_args class=md-nav__link> set_training_args </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.set_training_plan_class class=md-nav__link> set_training_plan_class </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_args class=md-nav__link> training_args </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan class=md-nav__link> training_plan </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan_approve class=md-nav__link> training_plan_approve </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan_class class=md-nav__link> training_plan_class </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.federated_workflows.TrainingPlanWorkflow.training_plan_file class=md-nav__link> training_plan_file </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> </div> <!-- News Main Page--> </div> <footer> <div class=container-fluid> <div class=footer-first-inner> <div class=container> <div class=row> <div class=col-md-6> <div class=footer-contact> <strong>Address:</strong> <p>2004 Rte des Lucioles, 06902 Sophia Antipolis</p> <strong>E-mail:</strong> <p>fedbiomed _at_ inria _dot_ fr</p> </div> </div> <div class=col-md-6> <div class=footer-contact> <p>Fed-BioMed  2022</p> </div> </div> </div> </div> </div> </div> </footer> <!-- JQuery --> <script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script> <!-- Latest compiled and minified JavaScript --> <script src=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../../assets/javascript/lunr.js></script> <script src=../../../../assets/javascript/theme.js></script> </body> </html>