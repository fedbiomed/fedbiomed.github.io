<!DOCTYPE html><html> <head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1"><!--  --><script>
      const versions_json = "../../../../../versions.json";
      const search_worker_js = "../../../../assets/javascript/search-worker.js";
      const search_index_json = "../../../../search/search_index.json";
      const base_url = '../../../..';
    </script><!-- Site title --><title>Experiment - Fed-BioMed</title><link rel=icon type=image/x-icon href=../../../../favicon.ico><!-- Page description --><meta name=description content="Open, Transparent and Trusted Federated Learning for Real-world Healthcare Applications"><!-- Page keywords --><!-- Page author --><!-- Latest compiled and minified CSS --><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><!-- Bootstrap Icons --><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link href=../../../../assets/_mkdocstrings.css rel=stylesheet><link href=../../../../assets/css/style.css rel=stylesheet></head> <body> <div class="container-fluid top-bar"> <div class=brand> <a href=/ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <nav class=top> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class="container-fluid top-bar-mobile"> <div class=mobile-bar> <div class=brand> <a href=../../../../ > <img src=../../../../assets/img/fedbiomed-logo-small.png> </a> </div> <div class=hum-menu> <img class=open src=../../../../assets/img/menu.svg> <img class=close style=display:none src=../../../../assets/img/cancel.svg> </div> </div> <nav class=top-mobile> <ul> <li class> <a href=../../../..>Home</a> </li> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ >User Documentation</a> </li> <li class> <a href=../../../../pages/about-us/ >About</a> </li> <li id=clicker class=has-sub> More <i class="bi bi-chevron-down"></i> <ul class=sub-nav-menu> <li class> <a href=../../../../#funding>Funding</a> </li> <li class> <a href=../../../../news/ >News</a> </li> <li class> <a href=../../../../#contributors>Contributors</a> </li> <li class> <a href=../../../../#users>Users</a> </li> <li class> <a href=../../../../pages/roadmap/ >Roadmap</a> </li> <li class> <a href=../../../../#contact-us>Contact Us</a> </li> </ul> </li> </ul> </nav> </div> <div class=main> <!-- Home page --> <div class=container-fluid> <div class=doc-row> <div class=left-col> <div class=sidebar-doc> <div class=sidebar-inner> <ul class="sidebar-menu-left sub"> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Getting Started <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../getting-started/what-is-fedbiomed/ class>What's Fed-BioMed</a> </li> <li class> <a href=../../../../getting-started/getting-started/ class>Basic Example</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-architecture/ class>Fedbiomed Architecture</a> </li> <li class> <a href=../../../../getting-started/fedbiomed-workflow/ class>Fedbiomed Workflow</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Tutorials <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Installation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/installation/0-basic-software-installation/ class>Software Installation</a> </li> <li class> <a href=../../../../tutorials/installation/1-setting-up-environment/ class>Setting Up Environment</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> PyTorch <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/pytorch/01_PyTorch_MNIST_Single_Node_Tutorial/ class>PyTorch MNIST Basic Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/02_Create_Your_Custom_Training_Plan/ class>How to Create Your Custom PyTorch Training Plan</a> </li> <li class> <a href=../../../../tutorials/pytorch/03_PyTorch_MNIST_local_vs_Federated/ class>MNIST classification with PyTorch, comparing federated model vs model trained locally</a> </li> <li class> <a href=../../../../tutorials/pytorch/04_PyTorch_Used_Cars_Dataset_Example/ class>PyTorch Used Cars Dataset Example</a> </li> <li class> <a href=../../../../tutorials/pytorch/05-Aggregation_in_Fed-BioMed/ class>PyTorch aggregation methods in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> MONAI <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/monai/01_monai-2d-image-classification/ class>Federated 2d image classification with MONAI</a> </li> <li class> <a href=../../../../tutorials/monai/02_monai-2d-image-registration/ class>Federated 2d XRay registration with MONAI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Scikit-Learn <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/scikit-learn/01_sklearn_MNIST_classification_tutorial/ class>MNIST classification with Scikit-Learn Classifier (Perceptron)</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/02_sklearn_sgd_regressor_tutorial/ class>Fed-BioMed to train a federated SGD regressor model</a> </li> <li class> <a href=../../../../tutorials/scikit-learn/03-other-scikit-learn-models/ class>Implementing other Scikit Learn models for Federated Learning</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> FLamby <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/flamby/flamby/ class>General Concepts</a> </li> <li class> <a href=../../../../tutorials/flamby/flamby-integration-into-fedbiomed/ class>FLamby integration in Fed-BioMed</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Advanced <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/advanced/in-depth-experiment-configuration/ class>In Depth Experiment Configuration</a> </li> <li class> <a href=../../../../tutorials/advanced/training-with-gpu/ class>PyTorch model training using a GPU</a> </li> <li class> <a href=../../../../tutorials/advanced/breakpoints/ class>Breakpoints</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Security <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/security/differential-privacy-with-opacus-on-fedbiomed/ class>Using Differential Privacy with OPACUS on Fed-BioMed</a> </li> <li class> <a href=../../../../tutorials/security/non-private-local-central-dp-monai-2d-image-registration/ class>Local and Central DP with Fed-BioMed: MONAI 2d image registration</a> </li> <li class> <a href=../../../../tutorials/security/training-with-approved-training-plans/ class>Training Process with Training Plan Management</a> </li> <li class> <a href=../../../../tutorials/security/secure-aggregation/ class>Training with Secure Aggregation</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Biomedical data <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../tutorials/medical/medical-image-segmentation-unet-library/ class>Brain Segmentation</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> User Guide <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/glossary/ class>Glossary</a> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Deployment <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/deployment/deployment/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/deployment/deployment-vpn/ class>VPN Deployment</a> </li> <li class> <a href=../../../../user-guide/deployment/matrix/ class>Network matrix</a> </li> <li class> <a href=../../../../user-guide/deployment/security-model/ class>Security model</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/nodes/configuring-nodes/ class>Configuring Nodes</a> </li> <li class> <a href=../../../../user-guide/nodes/deploying-datasets/ class>Deploying Datasets</a> </li> <li class> <a href=../../../../user-guide/nodes/training-plan-security-manager/ class>Training Plan Management</a> </li> <li class> <a href=../../../../user-guide/nodes/using-gpu/ class>Using GPU</a> </li> <li class> <a href=../../../../user-guide/nodes/node-gui/ class>Node GUI</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/researcher/training-plan/ class>Training Plan</a> </li> <li class> <a href=../../../../user-guide/researcher/training-data/ class>Training Data</a> </li> <li class> <a href=../../../../user-guide/researcher/experiment/ class>Experiment</a> </li> <li class> <a href=../../../../user-guide/researcher/aggregation/ class>Aggregation</a> </li> <li class> <a href=../../../../user-guide/researcher/listing-datasets-and-selecting-nodes/ class>Listing Datasets and Selecting Nodes</a> </li> <li class> <a href=../../../../user-guide/researcher/model-testing-during-federated-training/ class>Model Validation on the Node Side</a> </li> <li class> <a href=../../../../user-guide/researcher/tensorboard/ class>Tensorboard</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Secure Aggregation <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../../../user-guide/secagg/introduction/ class>Introduction</a> </li> <li class> <a href=../../../../user-guide/secagg/configuration/ class>Configuration</a> </li> <li class> <a href=../../../../user-guide/secagg/certificate-registration/ class>Certificate Registration</a> </li> <li class> <a href=../../../../user-guide/secagg/researcher-interface/ class>Managing Secure Aggregation in Researcher</a> </li> </ul> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Developer <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> API Reference <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Common <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../common/constants/ class>Constants</a> </li> <li class> <a href=../../common/data/ class>Data</a> </li> <li class> <a href=../../common/environ/ class>Environ</a> </li> <li class> <a href=../../common/exceptions/ class>Exceptions</a> </li> <li class> <a href=../../common/json/ class>Json</a> </li> <li class> <a href=../../common/logger/ class>Logger</a> </li> <li class> <a href=../../common/message/ class>Message</a> </li> <li class> <a href=../../common/messaging/ class>Messaging</a> </li> <li class> <a href=../../common/models/ class>Model</a> </li> <li class> <a href=../../common/optimizer/ class>Optimizer</a> </li> <li class> <a href=../../common/repository/ class>Repository</a> </li> <li class> <a href=../../common/tasks_queue/ class>TasksQueue</a> </li> <li class> <a href=../../common/training_plans/ class>TrainingPlans</a> </li> <li class> <a href=../../common/training_args/ class>TrainingArgs</a> </li> <li class> <a href=../../common/utils/ class>Utils</a> </li> <li class> <a href=../../common/validator/ class>Validator</a> </li> </ul> </li> <li data-adress=sub-1 class=has-sub-side> <div href class="parent-list "> Node <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub "> <li class> <a href=../../node/cli/ class>CLI</a> </li> <li class> <a href=../../node/dataset_manager/ class>DatasetManager</a> </li> <li class> <a href=../../node/node/ class>Node</a> </li> <li class> <a href=../../node/training_plan_security_manager/ class>TrainingPlanSecurityManager</a> </li> <li class> <a href=../../node/history_monitor/ class>HistoryMonitor</a> </li> <li class> <a href=../../node/round/ class>Round</a> </li> </ul> </li> <li data-adress=sub-1 class="current has-sub-side"> <div href class="parent-list current "> Researcher <i class="bi bi-chevron-down"></i> </div> <ul class="sub-sidebar-menu sub active "> <li class> <a href=../aggregators/ class>Aggregators</a> </li> <li class> <a href=../datasets/ class>Datasets</a> </li> <li class=current> <a href=./ class="link current">Experiment</a> </li> <li class> <a href=../filetools/ class>Filetools</a> </li> <li class> <a href=../job/ class>Job</a> </li> <li class> <a href=../monitor/ class>Monitor</a> </li> <li class> <a href=../responses/ class>Responses</a> </li> <li class> <a href=../requests/ class>Requests</a> </li> <li class> <a href=../strategies/ class>Strategies</a> </li> <li class> <a href=../secagg/ class>Secagg</a> </li> </ul> </li> </ul> </li> <li class> <a href=../../../usage_and_tools/ class>Usage and Tools</a> </li> <li class> <a href=../../../ci/ class>Continuous Integration</a> </li> </ul> </li> </ul> </div> </div> </div> <div class=main-col> <div class=main-docs> <div class="doc doc-object doc-module"> <h1 id=fedbiomed.researcher.experiment class="doc doc-heading module"> fedbiomed.researcher.experiment </h1> <span>Module: <code>fedbiomed.researcher.experiment</code></span> <div class="doc doc-contents first"> <p>Code of the researcher. Implements the experiment orchestration</p> <div class="doc doc-children"> <h2 id=fedbiomed.researcher.experiment-attributes class=api-section-header>Attributes</h2> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.researcher.experiment.TExperiment class="doc doc-heading attribute"> TExperiment <span class="doc doc-properties"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>TExperiment</span> <span class=o>=</span> <span class=n>TypeVar</span><span class=p>(</span><span class=s1>&#39;TExperiment&#39;</span><span class=p>,</span> <span class=n>bound</span><span class=o>=</span><span class=s1>&#39;Experiment&#39;</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.researcher.experiment.TrainingPlan class="doc doc-heading attribute"> TrainingPlan <span class="doc doc-properties"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>TrainingPlan</span> <span class=o>=</span> <span class=n>TypeVar</span><span class=p>(</span><span class=s1>&#39;TrainingPlan&#39;</span><span class=p>,</span> <span class=n>TorchTrainingPlan</span><span class=p>,</span> <span class=n>SKLearnTrainingPlan</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.researcher.experiment.Type_TrainingPlan class="doc doc-heading attribute"> Type_TrainingPlan <span class="doc doc-properties"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>Type_TrainingPlan</span> <span class=o>=</span> <span class=n>TypeVar</span><span class=p>(</span><span class=s1>&#39;Type_TrainingPlan&#39;</span><span class=p>,</span> <span class=n>Type</span><span class=p>[</span><span class=n>TorchTrainingPlan</span><span class=p>],</span> <span class=n>Type</span><span class=p>[</span><span class=n>SKLearnTrainingPlan</span><span class=p>])</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=fedbiomed.researcher.experiment.training_plans class="doc doc-heading attribute"> training_plans <span class="doc doc-properties"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> </h3> <div class=highlight><pre><span></span><code><span class=n>training_plans</span> <span class=o>=</span> <span class=p>(</span><span class=n>TorchTrainingPlan</span><span class=p>,</span> <span class=n>SKLearnTrainingPlan</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <h2 id=fedbiomed.researcher.experiment-classes class=api-section-header>Classes</h2> <div class="doc doc-object doc-class"> <h3 id=fedbiomed.researcher.experiment.Experiment class="doc doc-heading"> Experiment<!--        --> <!--          <code>Experiment</code>--> <!--        --> </h3> <div class=main-class-init> <span>CLASS </span> <div class=highlight><pre><span></span><code><span class=n>Experiment</span><span class=p>(</span><span class=n>tags</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>nodes</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>training_data</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>aggregator</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>node_selection_strategy</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>round_limit</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>training_plan_class</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>training_plan_path</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>model_args</span><span class=o>=</span><span class=p>{},</span> <span class=n>training_args</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>save_breakpoints</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>tensorboard</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>experimentation_folder</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>secagg</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> </div> <div class="doc doc-contents "> <p>This class represents the orchestrator managing the federated training</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>tags</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->, <!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>list of string with data tags or string with one data tag. Empty list of tags ([]) means any dataset is accepted, it is different from None (tags not set, cannot search for training_data yet).</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>nodes</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>list of node_ids to filter the nodes to be involved in the experiment. Defaults to None (no filtering).</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>training_data</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--FederatedDataSet, dict, None--><!--fedbiomed.researcher.datasets.FederatedDataSet--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a><!---->, <!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a><!---->, <!---->None<!---->]</code> </td> <td><ul> <li>If it is a FederatedDataSet object, use this value as training_data.</li> <li>else if it is a dict, create and use a FederatedDataSet object from the dict and use this value as training_data. The dict should use node ids as keys, values being list of dicts (each dict representing a dataset on a node).</li> <li>else if it is None (no training data provided)</li> <li>if <code>tags</code> is not None, set training_data by searching for datasets with a query to the nodes using <code>tags</code> and <code>nodes</code></li> <li>if <code>tags</code> is None, set training_data to None (no training_data set yet, experiment is not fully initialized and cannot be launched) Defaults to None (query nodes for dataset if <code>tags</code> is not None, set training_data to None else)</li> </ul></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>aggregator</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--fedbiomed.researcher.aggregators.Aggregator--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a><!---->, <!--Type[Aggregator]--><!--typing.Type--><a class="autorefs autorefs-external" title="typing.Type" href="https://docs.python.org/3/library/typing.html#typing.Type">Type</a><!---->[<!--fedbiomed.researcher.aggregators.Aggregator--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>object or class defining the method for aggregating local updates. Default to None (use <a class="autorefs autorefs-internal" href="../aggregators/#fedbiomed.researcher.aggregators.FedAverage"><code>FedAverage</code></a> for aggregation)</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>node_selection_strategy</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--fedbiomed.researcher.strategies.strategy.Strategy--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a><!---->, <!--Type[Strategy]--><!--typing.Type--><a class="autorefs autorefs-external" title="typing.Type" href="https://docs.python.org/3/library/typing.html#typing.Type">Type</a><!---->[<!--fedbiomed.researcher.strategies.strategy.Strategy--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>object or class defining how nodes are sampled at each round for training, and how non-responding nodes are managed. Defaults to None: - use <a class="autorefs autorefs-internal" href="../strategies/#fedbiomed.researcher.strategies.DefaultStrategy"><code>DefaultStrategy</code></a> if training_data is initialized - else strategy is None (cannot be initialized), experiment cannot be launched yet</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>round_limit</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--int, None--><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a><!---->, <!---->None<!---->]</code> </td> <td><p>the maximum number of training rounds (nodes &lt;-&gt; central server) that should be executed for the experiment. <code>None</code> means that no limit is defined. Defaults to None.</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>training_plan_class</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--Type_TrainingPlan, str, None--><!--fedbiomed.researcher.experiment.Type_TrainingPlan--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.experiment.Type_TrainingPlan" href="#fedbiomed.researcher.experiment.Type_TrainingPlan">Type_TrainingPlan</a><!---->, <!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>name of the training plan class <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> or training plan class (<code>Type_TrainingPlan</code>) to use for training. For experiment to be properly and fully defined <code>training_plan_class</code> needs to be: - a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> when <code>training_plan_class_path</code> is not None (training plan class comes from a file). - a <code>Type_TrainingPlan</code> when <code>training_plan_class_path</code> is None (training plan class passed as argument). Defaults to None (no training plan class defined yet)</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>training_plan_path</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--str, None--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>path to a file containing training plan code <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> or None (no file containing training plan code, <code>training_plan</code> needs to be a class matching <code>Type_TrainingPlan</code>) Defaults to None.</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>model_args</code></td> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>contains model arguments passed to the constructor of the training plan when instantiating it : output and input feature dimension, etc.</p></td> <td> <code><!---->{}</code> </td> </tr> <tr> <td><code>training_args</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!----><!--typing.TypeVar--><a class="autorefs autorefs-external" title="typing.TypeVar" href="https://docs.python.org/3/library/typing.html#typing.TypeVar">TypeVar</a><!---->(<!--TrainingArgs--><!--fedbiomed.common.training_args.TrainingArgs--><a class="autorefs autorefs-internal" title="fedbiomed.common.training_args.TrainingArgs" href="../../common/training_args/#fedbiomed.common.training_args.TrainingArgs">TrainingArgs</a><!---->)<!---->, <!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a><!---->, <!---->None<!---->]</code> </td> <td><p>contains training arguments passed to the <code>training_routine</code> of the training plan when launching it: lr, epochs, batch_size...</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>save_breakpoints</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>whether to save breakpoints or not after each training round. Breakpoints can be used for resuming a crashed experiment.</p></td> <td> <code><!---->False</code> </td> </tr> <tr> <td><code>tensorboard</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>whether to save scalar values for displaying in Tensorboard during training for each node. Currently, it is only used for loss values. - If it is true, monitor instantiates a <code>Monitor</code> object that write scalar logs into <code>./runs</code> directory. - If it is False, it stops monitoring if it was active.</p></td> <td> <code><!---->False</code> </td> </tr> <tr> <td><code>experimentation_folder</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--str, None--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>choose a specific name for the folder where experimentation result files and breakpoints are stored. This should just contain the name for the folder not a path. The name is used as a subdirectory of <code>environ[EXPERIMENTS_DIR])</code>. Defaults to None (auto-choose a folder name) - Caveat : if using a specific name this experimentation will not be automatically detected as the last experimentation by <code>load_breakpoint</code> - Caveat : do not use a <code>experimentation_folder</code> name finishing with numbers ([0-9]+) as this would confuse the last experimentation detection heuristic by <code>load_breakpoint</code>.</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>secagg</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--bool, SecureAggregation--><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a><!---->, <!--fedbiomed.researcher.secagg.SecureAggregation--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.secagg.SecureAggregation" href="../secagg/#fedbiomed.researcher.secagg.SecureAggregation">SecureAggregation</a><!---->]</code> </td> <td><p>whether to setup a secure aggregation context for this experiment, and use it to send encrypted updates from nodes to researcher. Defaults to <code>False</code></p></td> <td> <code><!---->False</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="123 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="124 "></span><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="125 "></span>             <span class=n>tags</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="126 "></span>             <span class=n>nodes</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="127 "></span>             <span class=n>training_data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="128 "></span>             <span class=n>aggregator</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Aggregator</span><span class=p>,</span> <span class=n>Type</span><span class=p>[</span><span class=n>Aggregator</span><span class=p>],</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="129 "></span>             <span class=n>node_selection_strategy</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Strategy</span><span class=p>,</span> <span class=n>Type</span><span class=p>[</span><span class=n>Strategy</span><span class=p>],</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="130 "></span>             <span class=n>round_limit</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="131 "></span>             <span class=n>training_plan_class</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Type_TrainingPlan</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="132 "></span>             <span class=n>training_plan_path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="133 "></span>             <span class=n>model_args</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=p>{},</span>
<span class=linenos data-linenos="134 "></span>             <span class=n>training_args</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>TypeVar</span><span class=p>(</span><span class=s2>&quot;TrainingArgs&quot;</span><span class=p>),</span> <span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="135 "></span>             <span class=n>save_breakpoints</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=linenos data-linenos="136 "></span>             <span class=n>tensorboard</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=linenos data-linenos="137 "></span>             <span class=n>experimentation_folder</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="138 "></span>             <span class=n>secagg</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>SecureAggregation</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=linenos data-linenos="139 "></span>             <span class=p>):</span>
<span class=linenos data-linenos="140 "></span>
<span class=linenos data-linenos="141 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Constructor of the class.</span>
<span class=linenos data-linenos="142 "></span>
<span class=linenos data-linenos="143 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="144 "></span><span class=sd>        tags: list of string with data tags or string with one data tag. Empty list of tags ([]) means any dataset</span>
<span class=linenos data-linenos="145 "></span><span class=sd>            is accepted, it is different from None (tags not set, cannot search for training_data yet).</span>
<span class=linenos data-linenos="146 "></span><span class=sd>        nodes: list of node_ids to filter the nodes to be involved in the experiment. Defaults to None (no</span>
<span class=linenos data-linenos="147 "></span><span class=sd>            filtering).</span>
<span class=linenos data-linenos="148 "></span><span class=sd>        training_data:</span>
<span class=linenos data-linenos="149 "></span><span class=sd>            * If it is a FederatedDataSet object, use this value as training_data.</span>
<span class=linenos data-linenos="150 "></span><span class=sd>            * else if it is a dict, create and use a FederatedDataSet object from the dict and use this value as</span>
<span class=linenos data-linenos="151 "></span><span class=sd>                training_data. The dict should use node ids as keys, values being list of dicts (each dict</span>
<span class=linenos data-linenos="152 "></span><span class=sd>                representing a dataset on a node).</span>
<span class=linenos data-linenos="153 "></span><span class=sd>            * else if it is None (no training data provided)</span>
<span class=linenos data-linenos="154 "></span><span class=sd>              - if `tags` is not None, set training_data by</span>
<span class=linenos data-linenos="155 "></span><span class=sd>                searching for datasets with a query to the nodes using `tags` and `nodes`</span>
<span class=linenos data-linenos="156 "></span><span class=sd>              - if `tags` is None, set training_data to None (no training_data set yet,</span>
<span class=linenos data-linenos="157 "></span><span class=sd>                experiment is not fully initialized and cannot be launched)</span>
<span class=linenos data-linenos="158 "></span><span class=sd>            Defaults to None (query nodes for dataset if `tags` is not None, set training_data</span>
<span class=linenos data-linenos="159 "></span><span class=sd>            to None else)</span>
<span class=linenos data-linenos="160 "></span><span class=sd>        aggregator: object or class defining the method for aggregating local updates. Default to None (use</span>
<span class=linenos data-linenos="161 "></span><span class=sd>            [`FedAverage`][fedbiomed.researcher.aggregators.FedAverage] for aggregation)</span>
<span class=linenos data-linenos="162 "></span><span class=sd>        node_selection_strategy:object or class defining how nodes are sampled at each round for training, and how</span>
<span class=linenos data-linenos="163 "></span><span class=sd>            non-responding nodes are managed.  Defaults to None:</span>
<span class=linenos data-linenos="164 "></span><span class=sd>            - use [`DefaultStrategy`][fedbiomed.researcher.strategies.DefaultStrategy] if training_data is</span>
<span class=linenos data-linenos="165 "></span><span class=sd>                initialized</span>
<span class=linenos data-linenos="166 "></span><span class=sd>            - else strategy is None (cannot be initialized), experiment cannot be launched yet</span>
<span class=linenos data-linenos="167 "></span><span class=sd>        round_limit: the maximum number of training rounds (nodes &lt;-&gt; central server) that should be executed for</span>
<span class=linenos data-linenos="168 "></span><span class=sd>            the experiment. `None` means that no limit is defined. Defaults to None.</span>
<span class=linenos data-linenos="169 "></span><span class=sd>        training_plan_class: name of the training plan class [`str`][str] or training plan class</span>
<span class=linenos data-linenos="170 "></span><span class=sd>            (`Type_TrainingPlan`) to use for training.</span>
<span class=linenos data-linenos="171 "></span><span class=sd>            For experiment to be properly and fully defined `training_plan_class` needs to be:</span>
<span class=linenos data-linenos="172 "></span><span class=sd>            - a [`str`][str] when `training_plan_class_path` is not None (training plan class comes from a file).</span>
<span class=linenos data-linenos="173 "></span><span class=sd>            - a `Type_TrainingPlan` when `training_plan_class_path` is None (training plan class passed</span>
<span class=linenos data-linenos="174 "></span><span class=sd>                as argument).</span>
<span class=linenos data-linenos="175 "></span><span class=sd>            Defaults to None (no training plan class defined yet)</span>
<span class=linenos data-linenos="176 "></span>
<span class=linenos data-linenos="177 "></span><span class=sd>        training_plan_path: path to a file containing training plan code [`str`][str] or None (no file containing</span>
<span class=linenos data-linenos="178 "></span><span class=sd>            training plan code, `training_plan` needs to be a class matching `Type_TrainingPlan`) Defaults to None.</span>
<span class=linenos data-linenos="179 "></span><span class=sd>        model_args: contains model arguments passed to the constructor of the training plan when instantiating it :</span>
<span class=linenos data-linenos="180 "></span><span class=sd>            output and input feature dimension, etc.</span>
<span class=linenos data-linenos="181 "></span><span class=sd>        training_args: contains training arguments passed to the `training_routine` of the training plan when</span>
<span class=linenos data-linenos="182 "></span><span class=sd>            launching it: lr, epochs, batch_size...</span>
<span class=linenos data-linenos="183 "></span><span class=sd>        save_breakpoints: whether to save breakpoints or not after each training round. Breakpoints can be used for</span>
<span class=linenos data-linenos="184 "></span><span class=sd>            resuming a crashed experiment.</span>
<span class=linenos data-linenos="185 "></span><span class=sd>        tensorboard: whether to save scalar values  for displaying in Tensorboard during training for each node.</span>
<span class=linenos data-linenos="186 "></span><span class=sd>            Currently, it is only used for loss values.</span>
<span class=linenos data-linenos="187 "></span><span class=sd>            - If it is true, monitor instantiates a `Monitor` object that write scalar logs into `./runs` directory.</span>
<span class=linenos data-linenos="188 "></span><span class=sd>            - If it is False, it stops monitoring if it was active.</span>
<span class=linenos data-linenos="189 "></span><span class=sd>        experimentation_folder: choose a specific name for the folder where experimentation result files and</span>
<span class=linenos data-linenos="190 "></span><span class=sd>            breakpoints are stored. This should just contain the name for the folder not a path. The name is used</span>
<span class=linenos data-linenos="191 "></span><span class=sd>            as a subdirectory of `environ[EXPERIMENTS_DIR])`. Defaults to None (auto-choose a folder name)</span>
<span class=linenos data-linenos="192 "></span><span class=sd>            - Caveat : if using a specific name this experimentation will not be automatically detected as the last</span>
<span class=linenos data-linenos="193 "></span><span class=sd>            experimentation by `load_breakpoint`</span>
<span class=linenos data-linenos="194 "></span><span class=sd>            - Caveat : do not use a `experimentation_folder` name finishing with numbers ([0-9]+) as this would</span>
<span class=linenos data-linenos="195 "></span><span class=sd>            confuse the last experimentation detection heuristic by `load_breakpoint`.</span>
<span class=linenos data-linenos="196 "></span><span class=sd>        secagg: whether to setup a secure aggregation context for this experiment, and use it</span>
<span class=linenos data-linenos="197 "></span><span class=sd>            to send encrypted updates from nodes to researcher. Defaults to `False`</span>
<span class=linenos data-linenos="198 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="199 "></span>
<span class=linenos data-linenos="200 "></span>    <span class=c1># predefine all class variables, so no need to write try/except</span>
<span class=linenos data-linenos="201 "></span>    <span class=c1># block each time we use it</span>
<span class=linenos data-linenos="202 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="203 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="204 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="205 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="206 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="207 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="208 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="209 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="210 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="211 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="212 "></span>
<span class=linenos data-linenos="213 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="214 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>aggregator_args</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="215 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="216 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_global_model</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="217 "></span>
<span class=linenos data-linenos="218 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_client_correction_states_dict</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="219 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_client_states_dict</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="220 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_server_state</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="221 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="222 "></span>
<span class=linenos data-linenos="223 "></span>    <span class=c1># set self._secagg</span>
<span class=linenos data-linenos="224 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_secagg</span><span class=p>(</span><span class=n>secagg</span><span class=p>)</span>
<span class=linenos data-linenos="225 "></span>
<span class=linenos data-linenos="226 "></span>    <span class=c1># set self._tags and self._nodes</span>
<span class=linenos data-linenos="227 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_tags</span><span class=p>(</span><span class=n>tags</span><span class=p>)</span>
<span class=linenos data-linenos="228 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_nodes</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>
<span class=linenos data-linenos="229 "></span>
<span class=linenos data-linenos="230 "></span>    <span class=c1># set self._model_args and self._training_args to dict</span>
<span class=linenos data-linenos="231 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_model_args</span><span class=p>(</span><span class=n>model_args</span><span class=p>)</span>
<span class=linenos data-linenos="232 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_training_args</span><span class=p>(</span><span class=n>training_args</span><span class=p>)</span>
<span class=linenos data-linenos="233 "></span>
<span class=linenos data-linenos="234 "></span>    <span class=c1># Useless to add a param and setter/getter for Requests() as it is a singleton ?</span>
<span class=linenos data-linenos="235 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span> <span class=o>=</span> <span class=n>Requests</span><span class=p>()</span>
<span class=linenos data-linenos="236 "></span>
<span class=linenos data-linenos="237 "></span>    <span class=c1># set self._fds: type Union[FederatedDataSet, None]</span>
<span class=linenos data-linenos="238 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_training_data</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span>
<span class=linenos data-linenos="239 "></span>
<span class=linenos data-linenos="240 "></span>    <span class=c1># set self._aggregator : type Aggregator</span>
<span class=linenos data-linenos="241 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_aggregator</span><span class=p>(</span><span class=n>aggregator</span><span class=p>)</span>
<span class=linenos data-linenos="242 "></span>
<span class=linenos data-linenos="243 "></span>    <span class=c1># set self._node_selection_strategy: type Union[Strategy, None]</span>
<span class=linenos data-linenos="244 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_strategy</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=p>)</span>
<span class=linenos data-linenos="245 "></span>
<span class=linenos data-linenos="246 "></span>    <span class=c1># &quot;current&quot; means number of rounds already trained</span>
<span class=linenos data-linenos="247 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_set_round_current</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=linenos data-linenos="248 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_round_limit</span><span class=p>(</span><span class=n>round_limit</span><span class=p>)</span>
<span class=linenos data-linenos="249 "></span>
<span class=linenos data-linenos="250 "></span>    <span class=c1># set self._experimentation_folder: type str</span>
<span class=linenos data-linenos="251 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_experimentation_folder</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>)</span>
<span class=linenos data-linenos="252 "></span>    <span class=c1># Note: currently keep this parameter as it cannot be updated in Job()</span>
<span class=linenos data-linenos="253 "></span>    <span class=c1># without refactoring Job() first</span>
<span class=linenos data-linenos="254 "></span>
<span class=linenos data-linenos="255 "></span>    <span class=c1># sets self._training_plan_is_defined: bool == is the training plan properly defined ?</span>
<span class=linenos data-linenos="256 "></span>    <span class=c1># with current version of jobs, a correctly defined model requires:</span>
<span class=linenos data-linenos="257 "></span>    <span class=c1># - either training_plan_path to None + training_plan_class is the class a training plan</span>
<span class=linenos data-linenos="258 "></span>    <span class=c1># - or training_plan_path not None + training_plan_class is a name (str) of a training plan</span>
<span class=linenos data-linenos="259 "></span>    <span class=c1>#</span>
<span class=linenos data-linenos="260 "></span>    <span class=c1># note: no need to set self._training_plan_is_defined before calling `set_training_plan_class`</span>
<span class=linenos data-linenos="261 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_training_plan_class</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>)</span>
<span class=linenos data-linenos="262 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_training_plan_path</span><span class=p>(</span><span class=n>training_plan_path</span><span class=p>)</span>
<span class=linenos data-linenos="263 "></span>
<span class=linenos data-linenos="264 "></span>    <span class=c1># set self._job to Union[Job, None]</span>
<span class=linenos data-linenos="265 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_job</span><span class=p>()</span>
<span class=linenos data-linenos="266 "></span>
<span class=linenos data-linenos="267 "></span>    <span class=c1># TODO: rewrite after experiment results refactoring</span>
<span class=linenos data-linenos="268 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span> <span class=o>=</span> <span class=p>{}</span>
<span class=linenos data-linenos="269 "></span>
<span class=linenos data-linenos="270 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_save_breakpoints</span><span class=p>(</span><span class=n>save_breakpoints</span><span class=p>)</span>
<span class=linenos data-linenos="271 "></span>
<span class=linenos data-linenos="272 "></span>    <span class=c1># always create a monitoring process</span>
<span class=linenos data-linenos="273 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span> <span class=o>=</span> <span class=n>Monitor</span><span class=p>()</span>
<span class=linenos data-linenos="274 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span><span class=o>.</span><span class=n>add_monitor_callback</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span><span class=o>.</span><span class=n>on_message_handler</span><span class=p>)</span>
<span class=linenos data-linenos="275 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>set_tensorboard</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>)</span>
</code></pre></div> </details> <div class="doc doc-children"> <h4 id=fedbiomed.researcher.experiment.Experiment-attributes class=api-section-header>Attributes</h4> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.researcher.experiment.Experiment.aggregator_args class="doc doc-heading attribute"> aggregator_args <span class="doc doc-properties"> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>aggregator_args</span> <span class=o>=</span> <span class=p>{}</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h5 id=fedbiomed.researcher.experiment.Experiment.secagg class="doc doc-heading attribute"> secagg <span class="doc doc-properties"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h5> <div class=highlight><pre><span></span><code><span class=n>secagg</span><span class=p>:</span> <span class=n>SecureAggregation</span>
</code></pre></div> <div class="doc doc-contents "> <p>Gets secagg object <code>SecureAggregation</code></p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.researcher.secagg.SecureAggregation--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.secagg.SecureAggregation" href="../secagg/#fedbiomed.researcher.secagg.SecureAggregation">SecureAggregation</a></code> </td> <td><p>Secure aggregation object.</p></td> </tr> </tbody> </table> </div> </div> <h4 id=fedbiomed.researcher.experiment.Experiment-functions class=api-section-header>Functions</h4> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.aggregated_params class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>aggregated_params</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves all aggregated parameters of each round of training</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>Dictionary of aggregated parameters keys stand for each round of training</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="564 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="565 "></span><span class=k>def</span> <span class=nf>aggregated_params</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="566 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves all aggregated parameters of each round of training</span>
<span class=linenos data-linenos="567 "></span>
<span class=linenos data-linenos="568 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="569 "></span><span class=sd>        Dictionary of aggregated parameters keys stand for each round of training</span>
<span class=linenos data-linenos="570 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="571 "></span>
<span class=linenos data-linenos="572 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.aggregator class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>aggregator</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves aggregator class that will be used for aggregating model parameters.</p> <p>To set or update aggregator: <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_aggregator"><code>set_aggregator</code></a>.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.researcher.aggregators.Aggregator--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a></code> </td> <td><p>A class or an object that is an instance of <a class="autorefs autorefs-internal" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a></p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="335 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="336 "></span><span class=k>def</span> <span class=nf>aggregator</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Aggregator</span><span class=p>:</span>
<span class=linenos data-linenos="337 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Retrieves aggregator class that will be used for aggregating model parameters.</span>
<span class=linenos data-linenos="338 "></span>
<span class=linenos data-linenos="339 "></span><span class=sd>    To set or update aggregator: [`set_aggregator`][fedbiomed.researcher.experiment.Experiment.set_aggregator].</span>
<span class=linenos data-linenos="340 "></span>
<span class=linenos data-linenos="341 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="342 "></span><span class=sd>        A class or an object that is an instance of [Aggregator][fedbiomed.researcher.aggregators.Aggregator]</span>
<span class=linenos data-linenos="343 "></span>
<span class=linenos data-linenos="344 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="345 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.breakpoint class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=nb>breakpoint</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Saves breakpoint with the state of the training at a current round. The following Experiment attributes will</p> <details class=be-saved> <summary>be saved</summary> <ul> <li>round_current</li> <li>round_limit</li> <li>tags</li> <li>experimentation_folder</li> <li>aggregator</li> <li>node_selection_strategy</li> <li>training_data</li> <li>training_args</li> <li>model_args</li> <li>training_plan_path</li> <li>training_plan_class</li> <li>aggregated_params</li> <li>job (attributes returned by the Job, aka job state)</li> <li>secagg</li> </ul> </details> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>experiment not fully defined, experiment did not run any round yet, or error when saving breakpoint</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1786 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1787 "></span><span class=k>def</span> <span class=nf>breakpoint</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1788 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="1789 "></span><span class=sd>    Saves breakpoint with the state of the training at a current round. The following Experiment attributes will</span>
<span class=linenos data-linenos="1790 "></span><span class=sd>    be saved:</span>
<span class=linenos data-linenos="1791 "></span><span class=sd>      - round_current</span>
<span class=linenos data-linenos="1792 "></span><span class=sd>      - round_limit</span>
<span class=linenos data-linenos="1793 "></span><span class=sd>      - tags</span>
<span class=linenos data-linenos="1794 "></span><span class=sd>      - experimentation_folder</span>
<span class=linenos data-linenos="1795 "></span><span class=sd>      - aggregator</span>
<span class=linenos data-linenos="1796 "></span><span class=sd>      - node_selection_strategy</span>
<span class=linenos data-linenos="1797 "></span><span class=sd>      - training_data</span>
<span class=linenos data-linenos="1798 "></span><span class=sd>      - training_args</span>
<span class=linenos data-linenos="1799 "></span><span class=sd>      - model_args</span>
<span class=linenos data-linenos="1800 "></span><span class=sd>      - training_plan_path</span>
<span class=linenos data-linenos="1801 "></span><span class=sd>      - training_plan_class</span>
<span class=linenos data-linenos="1802 "></span><span class=sd>      - aggregated_params</span>
<span class=linenos data-linenos="1803 "></span><span class=sd>      - job (attributes returned by the Job, aka job state)</span>
<span class=linenos data-linenos="1804 "></span><span class=sd>      - secagg</span>
<span class=linenos data-linenos="1805 "></span>
<span class=linenos data-linenos="1806 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1807 "></span><span class=sd>        FedbiomedExperimentError: experiment not fully defined, experiment did not run any round yet, or error when</span>
<span class=linenos data-linenos="1808 "></span><span class=sd>            saving breakpoint</span>
<span class=linenos data-linenos="1809 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1810 "></span>    <span class=c1># at this point, we run the constructor so all object variables are defined</span>
<span class=linenos data-linenos="1811 "></span>
<span class=linenos data-linenos="1812 "></span>    <span class=c1># check pre-requisistes for saving a breakpoint</span>
<span class=linenos data-linenos="1813 "></span>    <span class=c1>#</span>
<span class=linenos data-linenos="1814 "></span>    <span class=c1># need to have run at least 1 round to save a breakpoint</span>
<span class=linenos data-linenos="1815 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
<span class=linenos data-linenos="1816 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1817 "></span>            <span class=s1>&#39; - need to run at least 1 before saving a breakpoint&#39;</span>
<span class=linenos data-linenos="1818 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1819 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1820 "></span>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1821 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1822 "></span>            <span class=s1>&#39; - need to define `training_data` for saving a breakpoint&#39;</span>
<span class=linenos data-linenos="1823 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1824 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1825 "></span>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1826 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1827 "></span>            <span class=s1>&#39; - need to define `strategy` for saving a breakpoint&#39;</span>
<span class=linenos data-linenos="1828 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1829 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1830 "></span>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1831 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1832 "></span>            <span class=s1>&#39; - need to define `job` for saving a breakpoint&#39;</span>
<span class=linenos data-linenos="1833 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1834 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1835 "></span>
<span class=linenos data-linenos="1836 "></span>        <span class=c1># conditions are met, save breakpoint</span>
<span class=linenos data-linenos="1837 "></span>    <span class=n>breakpoint_path</span><span class=p>,</span> <span class=n>breakpoint_file_name</span> <span class=o>=</span> \
<span class=linenos data-linenos="1838 "></span>        <span class=n>choose_bkpt_file</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
<span class=linenos data-linenos="1839 "></span>
<span class=linenos data-linenos="1840 "></span>    <span class=n>state</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="1841 "></span>        <span class=s1>&#39;training_data&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=o>.</span><span class=n>data</span><span class=p>(),</span>
<span class=linenos data-linenos="1842 "></span>        <span class=s1>&#39;training_args&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>dict</span><span class=p>(),</span>
<span class=linenos data-linenos="1843 "></span>        <span class=s1>&#39;model_args&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span><span class=p>,</span>
<span class=linenos data-linenos="1844 "></span>        <span class=s1>&#39;training_plan_path&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan_file</span><span class=p>,</span>  <span class=c1># only in Job we always model saved to a file</span>
<span class=linenos data-linenos="1845 "></span>        <span class=c1># with current version</span>
<span class=linenos data-linenos="1846 "></span>        <span class=s1>&#39;training_plan_class&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan_name</span><span class=p>,</span>  <span class=c1># not always available properly</span>
<span class=linenos data-linenos="1847 "></span>        <span class=c1># formatted in Experiment with current version</span>
<span class=linenos data-linenos="1848 "></span>        <span class=s1>&#39;round_current&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="1849 "></span>        <span class=s1>&#39;round_limit&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span>
<span class=linenos data-linenos="1850 "></span>        <span class=s1>&#39;experimentation_folder&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>,</span>
<span class=linenos data-linenos="1851 "></span>        <span class=s1>&#39;aggregator&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>save_state</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>,</span> <span class=n>global_model</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_global_model</span><span class=p>),</span>  <span class=c1># aggregator state</span>
<span class=linenos data-linenos="1852 "></span>        <span class=s1>&#39;node_selection_strategy&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=o>.</span><span class=n>save_state</span><span class=p>(),</span>
<span class=linenos data-linenos="1853 "></span>        <span class=c1># strategy state</span>
<span class=linenos data-linenos="1854 "></span>        <span class=s1>&#39;tags&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span><span class=p>,</span>
<span class=linenos data-linenos="1855 "></span>        <span class=s1>&#39;aggregated_params&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_save_aggregated_params</span><span class=p>(</span>
<span class=linenos data-linenos="1856 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span><span class=p>,</span> <span class=n>breakpoint_path</span><span class=p>),</span>
<span class=linenos data-linenos="1857 "></span>        <span class=s1>&#39;job&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>save_state</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>),</span>  <span class=c1># job state</span>
<span class=linenos data-linenos="1858 "></span>        <span class=s1>&#39;secagg&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>save_state</span><span class=p>()</span>
<span class=linenos data-linenos="1859 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="1860 "></span>
<span class=linenos data-linenos="1861 "></span>    <span class=c1># rewrite paths in breakpoint : use the links in breakpoint directory</span>
<span class=linenos data-linenos="1862 "></span>    <span class=n>state</span><span class=p>[</span><span class=s1>&#39;training_plan_path&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>create_unique_link</span><span class=p>(</span>
<span class=linenos data-linenos="1863 "></span>        <span class=n>breakpoint_path</span><span class=p>,</span>
<span class=linenos data-linenos="1864 "></span>        <span class=c1># - Need a file with a restricted characters set in name to be able to import as module</span>
<span class=linenos data-linenos="1865 "></span>        <span class=s1>&#39;model_&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{:04d}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)),</span> <span class=s1>&#39;.py&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="1866 "></span>        <span class=c1># - Prefer relative path, eg for using experiment result after</span>
<span class=linenos data-linenos="1867 "></span>        <span class=c1># experiment in a different tree</span>
<span class=linenos data-linenos="1868 "></span>        <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39;..&#39;</span><span class=p>,</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=s2>&quot;training_plan_path&quot;</span><span class=p>]))</span>
<span class=linenos data-linenos="1869 "></span>    <span class=p>)</span>
<span class=linenos data-linenos="1870 "></span>
<span class=linenos data-linenos="1871 "></span>    <span class=c1># save state into a json file.</span>
<span class=linenos data-linenos="1872 "></span>
<span class=linenos data-linenos="1873 "></span>    <span class=n>breakpoint_file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>breakpoint_path</span><span class=p>,</span> <span class=n>breakpoint_file_name</span><span class=p>)</span>
<span class=linenos data-linenos="1874 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="1875 "></span>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>breakpoint_file_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>bkpt</span><span class=p>:</span>
<span class=linenos data-linenos="1876 "></span>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>state</span><span class=p>,</span> <span class=n>bkpt</span><span class=p>)</span>
<span class=linenos data-linenos="1877 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;breakpoint for round </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2> saved at &quot;</span> <span class=o>+</span>
<span class=linenos data-linenos="1878 "></span>                    <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>breakpoint_file_path</span><span class=p>))</span>
<span class=linenos data-linenos="1879 "></span>    <span class=k>except</span> <span class=p>(</span><span class=ne>OSError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>,</span> <span class=ne>RecursionError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos="1880 "></span>        <span class=c1># - OSError: heuristic for catching open() and write() errors</span>
<span class=linenos data-linenos="1881 "></span>        <span class=c1># - see json.dump() documentation for documented errors for this call</span>
<span class=linenos data-linenos="1882 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; - save failed with message </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1883 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1884 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.check_training_plan_status class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>check_training_plan_status</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Method for checking training plan status, ie whether it is approved or not by the nodes</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.researcher.responses.Responses--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.responses.Responses" href="../responses/#fedbiomed.researcher.responses.Responses">Responses</a></code> </td> <td><p>Training plan status for answering nodes</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad argument type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1761 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1762 "></span><span class=k>def</span> <span class=nf>check_training_plan_status</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Responses</span><span class=p>:</span>
<span class=linenos data-linenos="1763 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Method for checking training plan status, ie whether it is approved or not by the nodes</span>
<span class=linenos data-linenos="1764 "></span>
<span class=linenos data-linenos="1765 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1766 "></span><span class=sd>        Training plan status for answering nodes</span>
<span class=linenos data-linenos="1767 "></span>
<span class=linenos data-linenos="1768 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1769 "></span><span class=sd>        FedbiomedExperimentError: bad argument type</span>
<span class=linenos data-linenos="1770 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1771 "></span>    <span class=c1># at this point, self._job exists (initialized in constructor)</span>
<span class=linenos data-linenos="1772 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1773 "></span>        <span class=c1># cannot check training plan status if job not defined</span>
<span class=linenos data-linenos="1774 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB412</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1775 "></span>              <span class=s1>&#39;, in method `check_training_plan_status` : no `job` defined for experiment&#39;</span>
<span class=linenos data-linenos="1776 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1777 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1778 "></span>
<span class=linenos data-linenos="1779 "></span>    <span class=c1># always returns a `Responses()` object</span>
<span class=linenos data-linenos="1780 "></span>    <span class=n>responses</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>check_training_plan_is_approved_by_nodes</span><span class=p>()</span>
<span class=linenos data-linenos="1781 "></span>
<span class=linenos data-linenos="1782 "></span>    <span class=k>return</span> <span class=n>responses</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.experimentation_folder class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>experimentation_folder</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the folder name where experiment data/result are saved.</p> <p>Please see also<a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_experimentation_folder"><code>set_experimentation_folder</code></a></p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>File name where experiment related files are saved</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="382 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="383 "></span><span class=k>def</span> <span class=nf>experimentation_folder</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=linenos data-linenos="384 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the folder name where experiment data/result are saved.</span>
<span class=linenos data-linenos="385 "></span>
<span class=linenos data-linenos="386 "></span><span class=sd>    Please see also[`set_experimentation_folder`]</span>
<span class=linenos data-linenos="387 "></span><span class=sd>    [fedbiomed.researcher.experiment.Experiment.set_experimentation_folder]</span>
<span class=linenos data-linenos="388 "></span>
<span class=linenos data-linenos="389 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="390 "></span><span class=sd>        File name where experiment related files are saved</span>
<span class=linenos data-linenos="391 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="392 "></span>
<span class=linenos data-linenos="393 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.experimentation_path class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>experimentation_path</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the file path where experimentation folder is located and experiment related files are saved.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>Experiment directory where all experiment related files are saved</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="396 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="397 "></span><span class=k>def</span> <span class=nf>experimentation_path</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=linenos data-linenos="398 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the file path where experimentation folder is located and experiment related files are saved.</span>
<span class=linenos data-linenos="399 "></span>
<span class=linenos data-linenos="400 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="401 "></span><span class=sd>        Experiment directory where all experiment related files are saved</span>
<span class=linenos data-linenos="402 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="403 "></span>
<span class=linenos data-linenos="404 "></span>    <span class=k>return</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;EXPERIMENTS_DIR&#39;</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.info class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>info</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Prints out the information about the current status of the experiment.</p> <p>Lists all the parameters/arguments of the experiment and informs whether the experiment can be run.</p> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>Inconsistent experiment due to missing variables</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="619 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="620 "></span><span class=k>def</span> <span class=nf>info</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="621 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Prints out the information about the current status of the experiment.</span>
<span class=linenos data-linenos="622 "></span>
<span class=linenos data-linenos="623 "></span><span class=sd>    Lists  all the parameters/arguments of the experiment and informs whether the experiment can be run.</span>
<span class=linenos data-linenos="624 "></span>
<span class=linenos data-linenos="625 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="626 "></span><span class=sd>        FedbiomedExperimentError: Inconsistent experiment due to missing variables</span>
<span class=linenos data-linenos="627 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="628 "></span>
<span class=linenos data-linenos="629 "></span>    <span class=c1># at this point all attributes are initialized (in constructor)</span>
<span class=linenos data-linenos="630 "></span>    <span class=n>info</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="631 "></span>        <span class=s1>&#39;Arguments&#39;</span><span class=p>:</span> <span class=p>[</span>
<span class=linenos data-linenos="632 "></span>            <span class=s1>&#39;Tags&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="633 "></span>            <span class=s1>&#39;Nodes filter&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="634 "></span>            <span class=s1>&#39;Training Data&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="635 "></span>            <span class=s1>&#39;Aggregator&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="636 "></span>            <span class=s1>&#39;Strategy&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="637 "></span>            <span class=s1>&#39;Job&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="638 "></span>            <span class=s1>&#39;Training Plan Path&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="639 "></span>            <span class=s1>&#39;Training Plan Class&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="640 "></span>            <span class=s1>&#39;Model Arguments&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="641 "></span>            <span class=s1>&#39;Training Arguments&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="642 "></span>            <span class=s1>&#39;Rounds already run&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="643 "></span>            <span class=s1>&#39;Rounds total&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="644 "></span>            <span class=s1>&#39;Experiment folder&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="645 "></span>            <span class=s1>&#39;Experiment Path&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="646 "></span>            <span class=s1>&#39;Breakpoint State&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="647 "></span>            <span class=s1>&#39;Secure Aggregation&#39;</span>
<span class=linenos data-linenos="648 "></span>        <span class=p>],</span>
<span class=linenos data-linenos="649 "></span>        <span class=c1># max 60 characters per column for values - can we do that with tabulate() ?</span>
<span class=linenos data-linenos="650 "></span>        <span class=s1>&#39;Values&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;.{1,60}&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="651 "></span>                                     <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)))</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=p>[</span>
<span class=linenos data-linenos="652 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span><span class=p>,</span>
<span class=linenos data-linenos="653 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span><span class=p>,</span>
<span class=linenos data-linenos="654 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>,</span>
<span class=linenos data-linenos="655 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>aggregator_name</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
<span class=linenos data-linenos="656 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=p>,</span>
<span class=linenos data-linenos="657 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=p>,</span>
<span class=linenos data-linenos="658 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span><span class=p>,</span>
<span class=linenos data-linenos="659 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=p>,</span>
<span class=linenos data-linenos="660 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span><span class=p>,</span>
<span class=linenos data-linenos="661 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>,</span>
<span class=linenos data-linenos="662 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="663 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span>
<span class=linenos data-linenos="664 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span><span class=p>,</span>
<span class=linenos data-linenos="665 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>experimentation_path</span><span class=p>(),</span>
<span class=linenos data-linenos="666 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span><span class=p>,</span>
<span class=linenos data-linenos="667 "></span>            <span class=sa>f</span><span class=s1>&#39;- Using: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=si>}</span><span class=se>\n</span><span class=s1>- Active: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>active</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="668 "></span>        <span class=p>]</span>
<span class=linenos data-linenos="669 "></span>        <span class=p>]</span>
<span class=linenos data-linenos="670 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="671 "></span>    <span class=nb>print</span><span class=p>(</span><span class=n>tabulate</span><span class=p>(</span><span class=n>info</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=s1>&#39;keys&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="672 "></span>
<span class=linenos data-linenos="673 "></span>    <span class=c1># definitions that may be missing for running the experiment</span>
<span class=linenos data-linenos="674 "></span>    <span class=c1># (value None == not defined yet for _fds et _job,</span>
<span class=linenos data-linenos="675 "></span>    <span class=c1># False == no valid model for _training_plan_is_defined )</span>
<span class=linenos data-linenos="676 "></span>    <span class=n>may_be_missing</span> <span class=o>=</span> <span class=p>{</span>
<span class=linenos data-linenos="677 "></span>        <span class=s1>&#39;_fds&#39;</span><span class=p>:</span> <span class=s1>&#39;Training Data&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="678 "></span>        <span class=s1>&#39;_node_selection_strategy&#39;</span><span class=p>:</span> <span class=s1>&#39;Strategy&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="679 "></span>        <span class=s1>&#39;_training_plan_is_defined&#39;</span><span class=p>:</span> <span class=s1>&#39;Training Plan&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="680 "></span>        <span class=s1>&#39;_job&#39;</span><span class=p>:</span> <span class=s1>&#39;Job&#39;</span>
<span class=linenos data-linenos="681 "></span>    <span class=p>}</span>
<span class=linenos data-linenos="682 "></span>    <span class=c1># definitions found missing</span>
<span class=linenos data-linenos="683 "></span>    <span class=n>missing</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
<span class=linenos data-linenos="684 "></span>
<span class=linenos data-linenos="685 "></span>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>may_be_missing</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<span class=linenos data-linenos="686 "></span>        <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="687 "></span>            <span class=k>if</span> <span class=nb>eval</span><span class=p>(</span><span class=s1>&#39;self.&#39;</span> <span class=o>+</span> <span class=n>key</span><span class=p>)</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=nb>eval</span><span class=p>(</span><span class=s1>&#39;self.&#39;</span> <span class=o>+</span> <span class=n>key</span><span class=p>)</span> <span class=ow>is</span> <span class=kc>False</span><span class=p>:</span>
<span class=linenos data-linenos="688 "></span>                <span class=n>missing</span> <span class=o>+=</span> <span class=sa>f</span><span class=s1>&#39;- </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=se>\n</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="689 "></span>        <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
<span class=linenos data-linenos="690 "></span>            <span class=c1># should not happen, all eval variables should be defined</span>
<span class=linenos data-linenos="691 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB400</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="692 "></span>                <span class=sa>f</span><span class=s1>&#39;, in method `info` : self.</span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s1> not defined for experiment&#39;</span>
<span class=linenos data-linenos="693 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="694 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="695 "></span>    <span class=k>if</span> <span class=n>missing</span><span class=p>:</span>
<span class=linenos data-linenos="696 "></span>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Experiment cannot be run (not fully defined), missing :</span><span class=se>\n</span><span class=si>{</span><span class=n>missing</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="697 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="698 "></span>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Experiment can be run now (fully defined)&#39;</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.job class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>job</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the <a class="autorefs autorefs-internal" href="../job/#fedbiomed.researcher.job"><code>Job</code></a> that manages training rounds.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--Job, None--><!--fedbiomed.researcher.job.Job--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.job.Job" href="../job/#fedbiomed.researcher.job.Job">Job</a><!---->, <!---->None<!---->]</code> </td> <td><p>Initialized <code>Job</code> object. None, if it isn't declared yet or not information to set to job. Please see <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_job"><code>set_job</code></a>.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="529 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="530 "></span><span class=k>def</span> <span class=nf>job</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>Job</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="531 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the [`Job`][fedbiomed.researcher.job] that manages training rounds.</span>
<span class=linenos data-linenos="532 "></span>
<span class=linenos data-linenos="533 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="534 "></span><span class=sd>        Initialized `Job` object. None, if it isn&#39;t declared yet or not information to set to job. Please see</span>
<span class=linenos data-linenos="535 "></span><span class=sd>            [`set_job`][fedbiomed.researcher.experiment.Experiment.set_job].</span>
<span class=linenos data-linenos="536 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="537 "></span>
<span class=linenos data-linenos="538 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.load_breakpoint class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>load_breakpoint</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</code></pre></div> <span class="doc doc-properties"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> </h5> <div class="doc doc-contents "> <p>Loads breakpoint (provided a breakpoint has been saved) so experience can be resumed. Useful if training has crashed researcher side or if user wants to resume experiment.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>cls</code></td> <td> <code><!--Type[TExperiment]--><!--typing.Type--><a class="autorefs autorefs-external" title="typing.Type" href="https://docs.python.org/3/library/typing.html#typing.Type">Type</a><!---->[<!--fedbiomed.researcher.experiment.TExperiment--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.experiment.TExperiment" href="#fedbiomed.researcher.experiment.TExperiment">TExperiment</a><!---->]</code> </td> <td><p>Experiment class</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>breakpoint_folder_path</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--str, None--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>path of the breakpoint folder. Path can be absolute or relative eg: "var/experiments/Experiment_xxxx/breakpoints_xxxx". If None, loads latest breakpoint of the latest experiment. Defaults to None.</p></td> <td> <code><!---->None</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.researcher.experiment.TExperiment--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.experiment.TExperiment" href="#fedbiomed.researcher.experiment.TExperiment">TExperiment</a></code> </td> <td><p>Reinitialized experiment object. With given object-0.2119, 0.0796, -0.0759, user can then use <code>.run()</code> method to pursue model training.</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad argument type, error when reading breakpoint or bad loaded breakpoint content (corrupted)</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1886 "></span><span class=nd>@classmethod</span>
<span class=linenos data-linenos="1887 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1888 "></span><span class=k>def</span> <span class=nf>load_breakpoint</span><span class=p>(</span><span class=bp>cls</span><span class=p>:</span> <span class=n>Type</span><span class=p>[</span><span class=n>TExperiment</span><span class=p>],</span>
<span class=linenos data-linenos="1889 "></span>                    <span class=n>breakpoint_folder_path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>TExperiment</span><span class=p>:</span>
<span class=linenos data-linenos="1890 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="1891 "></span><span class=sd>    Loads breakpoint (provided a breakpoint has been saved)</span>
<span class=linenos data-linenos="1892 "></span><span class=sd>    so experience can be resumed. Useful if training has crashed</span>
<span class=linenos data-linenos="1893 "></span><span class=sd>    researcher side or if user wants to resume experiment.</span>
<span class=linenos data-linenos="1894 "></span>
<span class=linenos data-linenos="1895 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1896 "></span><span class=sd>      cls: Experiment class</span>
<span class=linenos data-linenos="1897 "></span><span class=sd>      breakpoint_folder_path: path of the breakpoint folder. Path can be absolute or relative eg:</span>
<span class=linenos data-linenos="1898 "></span><span class=sd>        &quot;var/experiments/Experiment_xxxx/breakpoints_xxxx&quot;. If None, loads latest breakpoint of the latest</span>
<span class=linenos data-linenos="1899 "></span><span class=sd>        experiment. Defaults to None.</span>
<span class=linenos data-linenos="1900 "></span>
<span class=linenos data-linenos="1901 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1902 "></span><span class=sd>        Reinitialized experiment object. With given object-0.2119,  0.0796, -0.0759, user can then use `.run()`</span>
<span class=linenos data-linenos="1903 "></span><span class=sd>            method to pursue model training.</span>
<span class=linenos data-linenos="1904 "></span>
<span class=linenos data-linenos="1905 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1906 "></span><span class=sd>        FedbiomedExperimentError: bad argument type, error when reading breakpoint or bad loaded breakpoint</span>
<span class=linenos data-linenos="1907 "></span><span class=sd>            content (corrupted)</span>
<span class=linenos data-linenos="1908 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1909 "></span>    <span class=c1># check parameters type</span>
<span class=linenos data-linenos="1910 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=ow>and</span> <span class=n>breakpoint_folder_path</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1911 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
<span class=linenos data-linenos="1912 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: load failed, `breakpoint_folder_path`&quot;</span>
<span class=linenos data-linenos="1913 "></span>            <span class=sa>f</span><span class=s2>&quot; has bad type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="1914 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="1915 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1916 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1917 "></span>
<span class=linenos data-linenos="1918 "></span>    <span class=c1># get breakpoint folder path (if it is None) and state file</span>
<span class=linenos data-linenos="1919 "></span>    <span class=n>breakpoint_folder_path</span><span class=p>,</span> <span class=n>state_file</span> <span class=o>=</span> <span class=n>find_breakpoint_path</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>)</span>
<span class=linenos data-linenos="1920 "></span>    <span class=n>breakpoint_folder_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>)</span>
<span class=linenos data-linenos="1921 "></span>
<span class=linenos data-linenos="1922 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="1923 "></span>        <span class=n>path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>breakpoint_folder_path</span><span class=p>,</span> <span class=n>state_file</span><span class=p>)</span>
<span class=linenos data-linenos="1924 "></span>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&quot;utf-8&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
<span class=linenos data-linenos="1925 "></span>            <span class=n>saved_state</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
<span class=linenos data-linenos="1926 "></span>    <span class=k>except</span> <span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>,</span> <span class=ne>OSError</span><span class=p>)</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
<span class=linenos data-linenos="1927 "></span>        <span class=c1># OSError: heuristic for catching file access issues</span>
<span class=linenos data-linenos="1928 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
<span class=linenos data-linenos="1929 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: load failed,&quot;</span>
<span class=linenos data-linenos="1930 "></span>            <span class=sa>f</span><span class=s2>&quot; reading breakpoint file failed with message </span><span class=si>{</span><span class=n>exc</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="1931 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="1932 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1933 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span> <span class=kn>from</span> <span class=nn>exc</span>
<span class=linenos data-linenos="1934 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>saved_state</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=linenos data-linenos="1935 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
<span class=linenos data-linenos="1936 "></span>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: load failed, breakpoint file seems&quot;</span>
<span class=linenos data-linenos="1937 "></span>            <span class=sa>f</span><span class=s2>&quot; corrupted. Type should be `dict` not </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>saved_state</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="1938 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="1939 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1940 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1941 "></span>
<span class=linenos data-linenos="1942 "></span>    <span class=c1># retrieve breakpoint training data</span>
<span class=linenos data-linenos="1943 "></span>    <span class=n>bkpt_fds</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;training_data&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1944 "></span>    <span class=n>bkpt_fds</span> <span class=o>=</span> <span class=n>FederatedDataSet</span><span class=p>(</span><span class=n>bkpt_fds</span><span class=p>)</span>
<span class=linenos data-linenos="1945 "></span>    <span class=c1># retrieve breakpoint sampling strategy</span>
<span class=linenos data-linenos="1946 "></span>    <span class=n>bkpt_sampling_strategy_args</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;node_selection_strategy&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1947 "></span>
<span class=linenos data-linenos="1948 "></span>    <span class=n>bkpt_sampling_strategy</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_create_object</span><span class=p>(</span><span class=n>bkpt_sampling_strategy_args</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>bkpt_fds</span><span class=p>)</span>
<span class=linenos data-linenos="1949 "></span>
<span class=linenos data-linenos="1950 "></span>    <span class=c1># initializing experiment</span>
<span class=linenos data-linenos="1951 "></span>    <span class=n>loaded_exp</span> <span class=o>=</span> <span class=bp>cls</span><span class=p>(</span><span class=n>tags</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;tags&#39;</span><span class=p>),</span>
<span class=linenos data-linenos="1952 "></span>                     <span class=n>nodes</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>  <span class=c1># list of previous nodes is contained in training_data</span>
<span class=linenos data-linenos="1953 "></span>                     <span class=n>training_data</span><span class=o>=</span><span class=n>bkpt_fds</span><span class=p>,</span>
<span class=linenos data-linenos="1954 "></span>                     <span class=n>node_selection_strategy</span><span class=o>=</span><span class=n>bkpt_sampling_strategy</span><span class=p>,</span>
<span class=linenos data-linenos="1955 "></span>                     <span class=n>round_limit</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;round_limit&quot;</span><span class=p>),</span>
<span class=linenos data-linenos="1956 "></span>                     <span class=n>training_plan_class</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;training_plan_class&quot;</span><span class=p>),</span>
<span class=linenos data-linenos="1957 "></span>                     <span class=n>training_plan_path</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;training_plan_path&quot;</span><span class=p>),</span>
<span class=linenos data-linenos="1958 "></span>                     <span class=n>model_args</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;model_args&quot;</span><span class=p>),</span>
<span class=linenos data-linenos="1959 "></span>                     <span class=n>training_args</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;training_args&quot;</span><span class=p>),</span>
<span class=linenos data-linenos="1960 "></span>                     <span class=n>save_breakpoints</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<span class=linenos data-linenos="1961 "></span>                     <span class=n>experimentation_folder</span><span class=o>=</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;experimentation_folder&#39;</span><span class=p>),</span>
<span class=linenos data-linenos="1962 "></span>                     <span class=n>secagg</span><span class=o>=</span><span class=n>SecureAggregation</span><span class=o>.</span><span class=n>load_state</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;secagg&#39;</span><span class=p>)))</span>
<span class=linenos data-linenos="1963 "></span>
<span class=linenos data-linenos="1964 "></span>    <span class=c1># nota: we are initializing experiment with no aggregator: hence, by default,</span>
<span class=linenos data-linenos="1965 "></span>    <span class=c1># `loaded_exp` will be loaded with FedAverage.</span>
<span class=linenos data-linenos="1966 "></span>
<span class=linenos data-linenos="1967 "></span>    <span class=c1># changing `Experiment` attributes</span>
<span class=linenos data-linenos="1968 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_set_round_current</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;round_current&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="1969 "></span>
<span class=linenos data-linenos="1970 "></span>    <span class=c1># TODO: checks when loading parameters</span>
<span class=linenos data-linenos="1971 "></span>    <span class=n>training_plan</span> <span class=o>=</span> <span class=n>loaded_exp</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span>
<span class=linenos data-linenos="1972 "></span>    <span class=k>if</span> <span class=n>training_plan</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1973 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB413</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39; - load failed, &#39;</span> <span class=o>+</span> \
<span class=linenos data-linenos="1974 "></span>            <span class=s1>&#39;breakpoint file seems corrupted, `training_plan` is None&#39;</span>
<span class=linenos data-linenos="1975 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1976 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1977 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1978 "></span>        <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_aggregated_params</span> <span class=o>=</span> <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_load_aggregated_params</span><span class=p>(</span>
<span class=linenos data-linenos="1979 "></span>            <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;aggregated_params&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1980 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="1981 "></span>
<span class=linenos data-linenos="1982 "></span>    <span class=c1># retrieve and change federator</span>
<span class=linenos data-linenos="1983 "></span>    <span class=n>bkpt_aggregator_args</span> <span class=o>=</span> <span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;aggregator&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1984 "></span>
<span class=linenos data-linenos="1985 "></span>    <span class=n>bkpt_aggregator</span> <span class=o>=</span> <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_create_object</span><span class=p>(</span><span class=n>bkpt_aggregator_args</span><span class=p>,</span> <span class=n>training_plan</span><span class=o>=</span><span class=n>training_plan</span><span class=p>)</span>
<span class=linenos data-linenos="1986 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>set_aggregator</span><span class=p>(</span><span class=n>bkpt_aggregator</span><span class=p>)</span>
<span class=linenos data-linenos="1987 "></span>
<span class=linenos data-linenos="1988 "></span>    <span class=c1># changing `Job` attributes</span>
<span class=linenos data-linenos="1989 "></span>    <span class=n>loaded_exp</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>load_state</span><span class=p>(</span><span class=n>saved_state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;job&#39;</span><span class=p>))</span>
<span class=linenos data-linenos="1990 "></span>
<span class=linenos data-linenos="1991 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Experimentation reload from </span><span class=si>{</span><span class=n>breakpoint_folder_path</span><span class=si>}</span><span class=s2> successful!&quot;</span><span class=p>)</span>
<span class=linenos data-linenos="1992 "></span>    <span class=k>return</span> <span class=n>loaded_exp</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.model_args class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>model_args</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves model arguments.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_model_args"><code>set_model_args</code></a></p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>The arguments that are going to be passed to <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans"><code>training_plans</code></a> classes in built time on the node side.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="434 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="435 "></span><span class=k>def</span> <span class=nf>model_args</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="436 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves model arguments.</span>
<span class=linenos data-linenos="437 "></span>
<span class=linenos data-linenos="438 "></span><span class=sd>    Please see also [`set_model_args`][fedbiomed.researcher.experiment.Experiment.set_model_args]</span>
<span class=linenos data-linenos="439 "></span>
<span class=linenos data-linenos="440 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="441 "></span><span class=sd>        The arguments that are going to be passed to [`training_plans`][fedbiomed.common.training_plans]</span>
<span class=linenos data-linenos="442 "></span><span class=sd>            classes in built time on the node side.</span>
<span class=linenos data-linenos="443 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="444 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.monitor class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>monitor</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the monitor object</p> <p>Monitor is responsible for receiving and parsing real-time training and validation feed-back from each node participate to federated training. See <a class="autorefs autorefs-internal" href="../monitor/#fedbiomed.researcher.monitor.Monitor"><code>Monitor</code></a></p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.researcher.monitor.Monitor--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.monitor.Monitor" href="../monitor/#fedbiomed.researcher.monitor.Monitor">Monitor</a></code> </td> <td><p>Monitor object that will always exist with experiment to retrieve feed-back from the nodes.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="550 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="551 "></span><span class=k>def</span> <span class=nf>monitor</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Monitor</span><span class=p>:</span>
<span class=linenos data-linenos="552 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the monitor object</span>
<span class=linenos data-linenos="553 "></span>
<span class=linenos data-linenos="554 "></span><span class=sd>    Monitor is responsible for receiving and parsing real-time training and validation feed-back from each node</span>
<span class=linenos data-linenos="555 "></span><span class=sd>    participate to federated training. See [`Monitor`][fedbiomed.researcher.monitor.Monitor]</span>
<span class=linenos data-linenos="556 "></span>
<span class=linenos data-linenos="557 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="558 "></span><span class=sd>        Monitor object that will always exist with experiment to retrieve feed-back from the nodes.</span>
<span class=linenos data-linenos="559 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="560 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.nodes class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>nodes</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the <code>nodes</code> that are chosen for federated training.</p> <p>Please see <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_nodes"><code>set_nodes</code></a> to set <code>nodes</code>.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>Object that contains meta-data for the datasets of each node. <code>None</code> if nodes are not set.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="311 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="312 "></span><span class=k>def</span> <span class=nf>nodes</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="313 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the `nodes` that are chosen for federated training.</span>
<span class=linenos data-linenos="314 "></span>
<span class=linenos data-linenos="315 "></span><span class=sd>    Please see [`set_nodes`][fedbiomed.researcher.experiment.Experiment.set_nodes] to set `nodes`.</span>
<span class=linenos data-linenos="316 "></span>
<span class=linenos data-linenos="317 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="318 "></span><span class=sd>        Object that contains meta-data for the datasets of each node. `None` if nodes are not set.</span>
<span class=linenos data-linenos="319 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="320 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.round_current class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>round_current</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the round where the experiment is at.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td><p>Indicates the round number that the experiment will perform next.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="373 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="374 "></span><span class=k>def</span> <span class=nf>round_current</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=linenos data-linenos="375 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the round where the experiment is at.</span>
<span class=linenos data-linenos="376 "></span>
<span class=linenos data-linenos="377 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="378 "></span><span class=sd>        Indicates the round number that the experiment will perform next.</span>
<span class=linenos data-linenos="379 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="380 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.round_limit class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>round_limit</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the round limit from the experiment object.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_training_data"><code>set_round_limit</code></a> to change or set round limit.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--int, None--><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a><!---->, <!---->None<!---->]</code> </td> <td><p>Round limit that shows maximum number of rounds that can be performed. <code>None</code> if it isn't declared yet.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="361 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="362 "></span><span class=k>def</span> <span class=nf>round_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="363 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the round limit from the experiment object.</span>
<span class=linenos data-linenos="364 "></span>
<span class=linenos data-linenos="365 "></span><span class=sd>    Please see  also [`set_round_limit`][fedbiomed.researcher.experiment.Experiment.set_training_data] to change</span>
<span class=linenos data-linenos="366 "></span><span class=sd>    or set round limit.</span>
<span class=linenos data-linenos="367 "></span>
<span class=linenos data-linenos="368 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="369 "></span><span class=sd>        Round limit that shows maximum number of rounds that can be performed. `None` if it isn&#39;t declared yet.</span>
<span class=linenos data-linenos="370 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="371 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.run class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>run</span><span class=p>(</span><span class=n>rounds</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>increase</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Run one or more rounds of an experiment, continuing from the point the experiment had reached.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>rounds</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--int, None--><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a><!---->, <!---->None<!---->]</code> </td> <td><p>Number of experiment rounds to run in this call. * <code>None</code> means "run all the rounds remaining in the experiment" computed as maximum rounds (<code>round_limit</code> for this experiment) minus the number of rounds already run rounds (<code>round_current</code> for this experiment). It does nothing and issues a warning if <code>round_limit</code> is <code>None</code> (no round limit defined for the experiment) * <code>int</code> &gt;= 1 means "run at most <code>rounds</code> rounds". If <code>round_limit</code> is <code>None</code> for the experiment, run exactly <code>rounds</code> rounds. If a <code>round_limit</code> is set for the experiment and the number or rounds would increase beyond the <code>round_limit</code> of the experiment: - if <code>increase</code> is True, increase the <code>round_limit</code> to (<code>round_current</code> + <code>rounds</code>) and run <code>rounds</code> rounds - if <code>increase</code> is False, run (<code>round_limit</code> - <code>round_current</code>) rounds, don't modify the maximum <code>round_limit</code> of the experiment and issue a warning.</p></td> <td> <code><!---->None</code> </td> </tr> <tr> <td><code>increase</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>automatically increase the <code>round_limit</code> of the experiment for executing the specified number of <code>rounds</code>. Does nothing if <code>round_limit</code> is <code>None</code> or <code>rounds</code> is None. Defaults to False</p></td> <td> <code><!---->False</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td><p>Number of rounds have been run</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad argument type or value</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1592 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1593 "></span><span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>rounds</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>increase</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=linenos data-linenos="1594 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run one or more rounds of an experiment, continuing from the point the</span>
<span class=linenos data-linenos="1595 "></span><span class=sd>    experiment had reached.</span>
<span class=linenos data-linenos="1596 "></span>
<span class=linenos data-linenos="1597 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1598 "></span><span class=sd>        rounds: Number of experiment rounds to run in this call.</span>
<span class=linenos data-linenos="1599 "></span><span class=sd>            * `None` means &quot;run all the rounds remaining in the experiment&quot; computed as</span>
<span class=linenos data-linenos="1600 "></span><span class=sd>                maximum rounds (`round_limit` for this experiment) minus the number of</span>
<span class=linenos data-linenos="1601 "></span><span class=sd>                rounds already run rounds (`round_current` for this experiment).</span>
<span class=linenos data-linenos="1602 "></span><span class=sd>                It does nothing and issues a warning if `round_limit` is `None` (no</span>
<span class=linenos data-linenos="1603 "></span><span class=sd>                round limit defined for the experiment)</span>
<span class=linenos data-linenos="1604 "></span><span class=sd>            * `int` &gt;= 1 means &quot;run at most `rounds` rounds&quot;.</span>
<span class=linenos data-linenos="1605 "></span><span class=sd>                If `round_limit` is `None` for the experiment, run exactly `rounds` rounds.</span>
<span class=linenos data-linenos="1606 "></span><span class=sd>                If a `round_limit` is set for the experiment and the number or rounds would</span>
<span class=linenos data-linenos="1607 "></span><span class=sd>            increase beyond the `round_limit` of the experiment:</span>
<span class=linenos data-linenos="1608 "></span><span class=sd>            - if `increase` is True, increase the `round_limit` to</span>
<span class=linenos data-linenos="1609 "></span><span class=sd>              (`round_current` + `rounds`) and run `rounds` rounds</span>
<span class=linenos data-linenos="1610 "></span><span class=sd>            - if `increase` is False, run (`round_limit` - `round_current`)</span>
<span class=linenos data-linenos="1611 "></span><span class=sd>              rounds, don&#39;t modify the maximum `round_limit` of the experiment</span>
<span class=linenos data-linenos="1612 "></span><span class=sd>              and issue a warning.</span>
<span class=linenos data-linenos="1613 "></span><span class=sd>        increase: automatically increase the `round_limit`</span>
<span class=linenos data-linenos="1614 "></span><span class=sd>            of the experiment for executing the specified number of `rounds`.</span>
<span class=linenos data-linenos="1615 "></span><span class=sd>            Does nothing if `round_limit` is `None` or `rounds` is None.</span>
<span class=linenos data-linenos="1616 "></span><span class=sd>            Defaults to False</span>
<span class=linenos data-linenos="1617 "></span>
<span class=linenos data-linenos="1618 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1619 "></span><span class=sd>        Number of rounds have been run</span>
<span class=linenos data-linenos="1620 "></span>
<span class=linenos data-linenos="1621 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1622 "></span><span class=sd>        FedbiomedExperimentError: bad argument type or value</span>
<span class=linenos data-linenos="1623 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1624 "></span>    <span class=c1># check rounds is a &gt;=1 integer or None</span>
<span class=linenos data-linenos="1625 "></span>    <span class=k>if</span> <span class=n>rounds</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1626 "></span>        <span class=k>pass</span>
<span class=linenos data-linenos="1627 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>rounds</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos="1628 "></span>        <span class=k>if</span> <span class=n>rounds</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
<span class=linenos data-linenos="1629 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1630 "></span>                <span class=sa>f</span><span class=s1>&#39;, in method `run` param `rounds` : value </span><span class=si>{</span><span class=n>rounds</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1631 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1632 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1633 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1634 "></span>        <span class=c1># bad type</span>
<span class=linenos data-linenos="1635 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1636 "></span>            <span class=sa>f</span><span class=s1>&#39;, in method `run` param `rounds` : type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>rounds</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1637 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1638 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1639 "></span>        <span class=c1># check increase is a boolean</span>
<span class=linenos data-linenos="1640 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>increase</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="1641 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1642 "></span>            <span class=sa>f</span><span class=s1>&#39;, in method `run` param `increase` : type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>increase</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1643 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1644 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1645 "></span>
<span class=linenos data-linenos="1646 "></span>    <span class=c1># compute number of rounds to run + updated rounds limit</span>
<span class=linenos data-linenos="1647 "></span>    <span class=k>if</span> <span class=n>rounds</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1648 "></span>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos="1649 "></span>            <span class=c1># run all remaining rounds in the experiment</span>
<span class=linenos data-linenos="1650 "></span>            <span class=n>rounds</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span>
<span class=linenos data-linenos="1651 "></span>            <span class=k>if</span> <span class=n>rounds</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<span class=linenos data-linenos="1652 "></span>                <span class=c1># limit already reached</span>
<span class=linenos data-linenos="1653 "></span>                <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Round limit of </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> already reached &#39;</span>
<span class=linenos data-linenos="1654 "></span>                               <span class=s1>&#39;for this experiment, do nothing.&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1655 "></span>                <span class=k>return</span> <span class=mi>0</span>
<span class=linenos data-linenos="1656 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1657 "></span>            <span class=c1># cannot run if no number of rounds given and no round limit exists</span>
<span class=linenos data-linenos="1658 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s1>&#39;Cannot run, please specify a number of `rounds` to run or &#39;</span>
<span class=linenos data-linenos="1659 "></span>                           <span class=s1>&#39;set a `round_limit` to the experiment&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1660 "></span>            <span class=k>return</span> <span class=mi>0</span>
<span class=linenos data-linenos="1661 "></span>
<span class=linenos data-linenos="1662 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1663 "></span>        <span class=c1># at this point, rounds is an int &gt;= 1</span>
<span class=linenos data-linenos="1664 "></span>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos="1665 "></span>            <span class=k>if</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+</span> <span class=n>rounds</span><span class=p>)</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>:</span>
<span class=linenos data-linenos="1666 "></span>                <span class=k>if</span> <span class=n>increase</span><span class=p>:</span>
<span class=linenos data-linenos="1667 "></span>                    <span class=c1># dont change rounds, but extend self._round_limit as necessary</span>
<span class=linenos data-linenos="1668 "></span>                    <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Auto increasing total rounds for experiment from </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> &#39;</span>
<span class=linenos data-linenos="1669 "></span>                                 <span class=sa>f</span><span class=s1>&#39;to </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>rounds</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1670 "></span>                    <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+</span> <span class=n>rounds</span>
<span class=linenos data-linenos="1671 "></span>                <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1672 "></span>                    <span class=n>new_rounds</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span>
<span class=linenos data-linenos="1673 "></span>                    <span class=k>if</span> <span class=n>new_rounds</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<span class=linenos data-linenos="1674 "></span>                        <span class=c1># limit already reached</span>
<span class=linenos data-linenos="1675 "></span>                        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Round limit of </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> already reached &#39;</span>
<span class=linenos data-linenos="1676 "></span>                                       <span class=s1>&#39;for this experiment, do nothing.&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1677 "></span>                        <span class=k>return</span> <span class=mi>0</span>
<span class=linenos data-linenos="1678 "></span>                    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1679 "></span>                        <span class=c1># reduce the number of rounds to run in the experiment</span>
<span class=linenos data-linenos="1680 "></span>                        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Limit of </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> rounds for the experiment &#39;</span>
<span class=linenos data-linenos="1681 "></span>                                       <span class=sa>f</span><span class=s1>&#39;will be reached, reducing the number of rounds for this &#39;</span>
<span class=linenos data-linenos="1682 "></span>                                       <span class=sa>f</span><span class=s1>&#39;run from </span><span class=si>{</span><span class=n>rounds</span><span class=si>}</span><span class=s1> to </span><span class=si>{</span><span class=n>new_rounds</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1683 "></span>                        <span class=n>rounds</span> <span class=o>=</span> <span class=n>new_rounds</span>
<span class=linenos data-linenos="1684 "></span>
<span class=linenos data-linenos="1685 "></span>    <span class=c1># At this point `rounds` is an int &gt; 0 (not None)</span>
<span class=linenos data-linenos="1686 "></span>
<span class=linenos data-linenos="1687 "></span>    <span class=c1># run the rounds</span>
<span class=linenos data-linenos="1688 "></span>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>rounds</span><span class=p>):</span>
<span class=linenos data-linenos="1689 "></span>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>==</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> \
<span class=linenos data-linenos="1690 "></span>                <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_global_updates&#39;</span><span class=p>]</span> <span class=ow>is</span> <span class=kc>True</span><span class=p>:</span>
<span class=linenos data-linenos="1691 "></span>            <span class=c1># Do &quot;validation after a round&quot; only if this a round limit is defined and we reached it</span>
<span class=linenos data-linenos="1692 "></span>            <span class=c1># and validation is active on global params</span>
<span class=linenos data-linenos="1693 "></span>            <span class=c1># When this condition is met, it also means we are running the last of</span>
<span class=linenos data-linenos="1694 "></span>            <span class=c1># the `rounds` rounds in this function</span>
<span class=linenos data-linenos="1695 "></span>            <span class=n>test_after</span> <span class=o>=</span> <span class=kc>True</span>
<span class=linenos data-linenos="1696 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1697 "></span>            <span class=n>test_after</span> <span class=o>=</span> <span class=kc>False</span>
<span class=linenos data-linenos="1698 "></span>
<span class=linenos data-linenos="1699 "></span>        <span class=n>increment</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>run_once</span><span class=p>(</span><span class=n>increase</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>test_after</span><span class=o>=</span><span class=n>test_after</span><span class=p>)</span>
<span class=linenos data-linenos="1700 "></span>
<span class=linenos data-linenos="1701 "></span>        <span class=k>if</span> <span class=n>increment</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<span class=linenos data-linenos="1702 "></span>            <span class=c1># should not happen</span>
<span class=linenos data-linenos="1703 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB400</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1704 "></span>                <span class=sa>f</span><span class=s1>&#39;, in method `run` method `run_once` returns </span><span class=si>{</span><span class=n>increment</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1705 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1706 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1707 "></span>
<span class=linenos data-linenos="1708 "></span>    <span class=k>return</span> <span class=n>rounds</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.run_once class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>run_once</span><span class=p>(</span><span class=n>increase</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>test_after</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Run at most one round of an experiment, continuing from the point the experiment had reached.</p> <p>If <code>round_limit</code> is <code>None</code> for the experiment (no round limit defined), run one round. If <code>round_limit</code> is not <code>None</code> and the <code>round_limit</code> of the experiment is already reached: * if <code>increase</code> is False, do nothing and issue a warning * if <code>increase</code> is True, increment total number of round <code>round_limit</code> and run one round</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>increase</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>automatically increase the <code>round_limit</code> of the experiment if needed. Does nothing if <code>round_limit</code> is <code>None</code>. Defaults to False</p></td> <td> <code><!---->False</code> </td> </tr> <tr> <td><code>test_after</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>if True, do a second request to the nodes after the round, only for validation on aggregated params. Intended to be used after the last training round of an experiment. Defaults to False.</p></td> <td> <code><!---->False</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td><p>Number of rounds really run</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad argument type or value</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1446 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1447 "></span><span class=k>def</span> <span class=nf>run_once</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>increase</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>test_after</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=linenos data-linenos="1448 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run at most one round of an experiment, continuing from the point the</span>
<span class=linenos data-linenos="1449 "></span><span class=sd>    experiment had reached.</span>
<span class=linenos data-linenos="1450 "></span>
<span class=linenos data-linenos="1451 "></span><span class=sd>    If `round_limit` is `None` for the experiment (no round limit defined), run one round.</span>
<span class=linenos data-linenos="1452 "></span><span class=sd>    If `round_limit` is not `None` and the `round_limit` of the experiment is already reached:</span>
<span class=linenos data-linenos="1453 "></span><span class=sd>    * if `increase` is False, do nothing and issue a warning</span>
<span class=linenos data-linenos="1454 "></span><span class=sd>    * if `increase` is True, increment total number of round `round_limit` and run one round</span>
<span class=linenos data-linenos="1455 "></span>
<span class=linenos data-linenos="1456 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1457 "></span><span class=sd>        increase: automatically increase the `round_limit` of the experiment if needed. Does nothing if</span>
<span class=linenos data-linenos="1458 "></span><span class=sd>            `round_limit` is `None`. Defaults to False</span>
<span class=linenos data-linenos="1459 "></span><span class=sd>        test_after: if True, do a second request to the nodes after the round, only for validation on aggregated</span>
<span class=linenos data-linenos="1460 "></span><span class=sd>            params. Intended to be used after the last training round of an experiment. Defaults to False.</span>
<span class=linenos data-linenos="1461 "></span>
<span class=linenos data-linenos="1462 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1463 "></span><span class=sd>        Number of rounds really run</span>
<span class=linenos data-linenos="1464 "></span>
<span class=linenos data-linenos="1465 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1466 "></span><span class=sd>        FedbiomedExperimentError: bad argument type or value</span>
<span class=linenos data-linenos="1467 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1468 "></span>    <span class=c1># check increase is a boolean</span>
<span class=linenos data-linenos="1469 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>increase</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="1470 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1471 "></span>              <span class=sa>f</span><span class=s1>&#39;, in method `run_once` param `increase` : type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>increase</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1472 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1473 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1474 "></span>
<span class=linenos data-linenos="1475 "></span>    <span class=c1># nota:  we should never have self._round_current &gt; self._round_limit, only ==</span>
<span class=linenos data-linenos="1476 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=p>:</span>
<span class=linenos data-linenos="1477 "></span>        <span class=k>if</span> <span class=n>increase</span> <span class=ow>is</span> <span class=kc>True</span><span class=p>:</span>
<span class=linenos data-linenos="1478 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Auto increasing total rounds for experiment from </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> &#39;</span>
<span class=linenos data-linenos="1479 "></span>                         <span class=sa>f</span><span class=s1>&#39;to </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1480 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+</span> <span class=mi>1</span>
<span class=linenos data-linenos="1481 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1482 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Round limit of </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span><span class=si>}</span><span class=s1> was reached, do nothing&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1483 "></span>            <span class=k>return</span> <span class=mi>0</span>
<span class=linenos data-linenos="1484 "></span>
<span class=linenos data-linenos="1485 "></span>    <span class=c1># at this point, self._aggregator always exists and is not None</span>
<span class=linenos data-linenos="1486 "></span>    <span class=c1># self.{_node_selection_strategy,_job} exist but may be None</span>
<span class=linenos data-linenos="1487 "></span>
<span class=linenos data-linenos="1488 "></span>    <span class=c1># check pre-requisites are met for running a round</span>
<span class=linenos data-linenos="1489 "></span>    <span class=c1># for component in (self._node_selection_strategy, self._job):</span>
<span class=linenos data-linenos="1490 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1491 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB411</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39;, missing `node_selection_strategy`&#39;</span>
<span class=linenos data-linenos="1492 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1493 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1494 "></span>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1495 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB411</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39;, missing `job`&#39;</span>
<span class=linenos data-linenos="1496 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1497 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1498 "></span>
<span class=linenos data-linenos="1499 "></span>    <span class=c1># Ready to execute a training round using the job, strategy and aggregator</span>
<span class=linenos data-linenos="1500 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_global_model</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1501 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_global_model</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan</span><span class=o>.</span><span class=n>get_model_params</span><span class=p>()</span>
<span class=linenos data-linenos="1502 "></span>        <span class=c1># initial server state, before optimization/aggregation</span>
<span class=linenos data-linenos="1503 "></span>
<span class=linenos data-linenos="1504 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>set_training_plan_type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan</span><span class=o>.</span><span class=n>type</span><span class=p>())</span>
<span class=linenos data-linenos="1505 "></span>    <span class=c1># Sample nodes using strategy (if given)</span>
<span class=linenos data-linenos="1506 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>nodes</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=o>.</span><span class=n>sample_nodes</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>)</span>
<span class=linenos data-linenos="1507 "></span>
<span class=linenos data-linenos="1508 "></span>    <span class=c1># If secure aggregation is activated ---------------------------------------------------------------------</span>
<span class=linenos data-linenos="1509 "></span>    <span class=n>secagg_arguments</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1510 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>active</span><span class=p>:</span>
<span class=linenos data-linenos="1511 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>parties</span><span class=o>=</span><span class=p>[</span><span class=n>environ</span><span class=p>[</span><span class=s2>&quot;ID&quot;</span><span class=p>]]</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>nodes</span><span class=p>,</span>
<span class=linenos data-linenos="1512 "></span>                           <span class=n>job_id</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
<span class=linenos data-linenos="1513 "></span>        <span class=n>secagg_arguments</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>train_arguments</span><span class=p>()</span>
<span class=linenos data-linenos="1514 "></span>    <span class=c1># --------------------------------------------------------------------------------------------------------</span>
<span class=linenos data-linenos="1515 "></span>
<span class=linenos data-linenos="1516 "></span>    <span class=c1># Check aggregator parameter(s) before starting a round</span>
<span class=linenos data-linenos="1517 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>check_values</span><span class=p>(</span><span class=n>n_updates</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;num_updates&#39;</span><span class=p>),</span>
<span class=linenos data-linenos="1518 "></span>                                  <span class=n>training_plan</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan</span><span class=p>)</span>
<span class=linenos data-linenos="1519 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;Sampled nodes in round &#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>nodes</span><span class=p>))</span>
<span class=linenos data-linenos="1520 "></span>
<span class=linenos data-linenos="1521 "></span>    <span class=n>aggr_args_thr_msg</span><span class=p>,</span> <span class=n>aggr_args_thr_file</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>create_aggregator_args</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_global_model</span><span class=p>,</span>
<span class=linenos data-linenos="1522 "></span>                                                                                    <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>nodes</span><span class=p>)</span>
<span class=linenos data-linenos="1523 "></span>
<span class=linenos data-linenos="1524 "></span>    <span class=c1># Trigger training round on sampled nodes</span>
<span class=linenos data-linenos="1525 "></span>    <span class=n>_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>start_nodes_training_round</span><span class=p>(</span><span class=n>round_</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="1526 "></span>                                             <span class=n>aggregator_args_thr_msg</span><span class=o>=</span><span class=n>aggr_args_thr_msg</span><span class=p>,</span>
<span class=linenos data-linenos="1527 "></span>                                             <span class=n>aggregator_args_thr_files</span><span class=o>=</span><span class=n>aggr_args_thr_file</span><span class=p>,</span>
<span class=linenos data-linenos="1528 "></span>                                             <span class=n>do_training</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<span class=linenos data-linenos="1529 "></span>                                             <span class=n>secagg_arguments</span><span class=o>=</span><span class=n>secagg_arguments</span><span class=p>)</span>
<span class=linenos data-linenos="1530 "></span>
<span class=linenos data-linenos="1531 "></span>    <span class=c1># refining/normalizing model weights received from nodes</span>
<span class=linenos data-linenos="1532 "></span>    <span class=n>model_params</span><span class=p>,</span> <span class=n>weights</span><span class=p>,</span> <span class=n>total_sample_size</span><span class=p>,</span> <span class=n>encryption_factors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span><span class=o>.</span><span class=n>refine</span><span class=p>(</span>
<span class=linenos data-linenos="1533 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_replies</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>)</span>
<span class=linenos data-linenos="1534 "></span>
<span class=linenos data-linenos="1535 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>set_fds</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>)</span>
<span class=linenos data-linenos="1536 "></span>
<span class=linenos data-linenos="1537 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>active</span><span class=p>:</span>
<span class=linenos data-linenos="1538 "></span>        <span class=n>flatten_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span><span class=o>.</span><span class=n>aggregate</span><span class=p>(</span>
<span class=linenos data-linenos="1539 "></span>            <span class=n>round_</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="1540 "></span>            <span class=n>encryption_factors</span><span class=o>=</span><span class=n>encryption_factors</span><span class=p>,</span>
<span class=linenos data-linenos="1541 "></span>            <span class=n>total_sample_size</span><span class=o>=</span><span class=n>total_sample_size</span><span class=p>,</span>
<span class=linenos data-linenos="1542 "></span>            <span class=n>model_params</span><span class=o>=</span><span class=n>model_params</span>
<span class=linenos data-linenos="1543 "></span>        <span class=p>)</span>
<span class=linenos data-linenos="1544 "></span>        <span class=c1># FIXME: Access TorchModel through non-private getter once it is implemented</span>
<span class=linenos data-linenos="1545 "></span>        <span class=n>aggregated_params</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=s1>&#39;torch.tensor&#39;</span><span class=p>,</span> <span class=s1>&#39;nd.ndarray&#39;</span><span class=p>]]</span> <span class=o>=</span> \
<span class=linenos data-linenos="1546 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan</span><span class=o>.</span><span class=n>_model</span><span class=o>.</span><span class=n>unflatten</span><span class=p>(</span><span class=n>flatten_params</span><span class=p>)</span>
<span class=linenos data-linenos="1547 "></span>
<span class=linenos data-linenos="1548 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1549 "></span>        <span class=c1># aggregate models from nodes to a global model</span>
<span class=linenos data-linenos="1550 "></span>        <span class=n>aggregated_params</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>aggregate</span><span class=p>(</span><span class=n>model_params</span><span class=p>,</span>
<span class=linenos data-linenos="1551 "></span>                                                       <span class=n>weights</span><span class=p>,</span>
<span class=linenos data-linenos="1552 "></span>                                                       <span class=n>global_model</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_global_model</span><span class=p>,</span>
<span class=linenos data-linenos="1553 "></span>                                                       <span class=n>training_plan</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan</span><span class=p>,</span>
<span class=linenos data-linenos="1554 "></span>                                                       <span class=n>training_replies</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_replies</span><span class=p>,</span>
<span class=linenos data-linenos="1555 "></span>                                                       <span class=n>node_ids</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>nodes</span><span class=p>,</span>
<span class=linenos data-linenos="1556 "></span>                                                       <span class=n>n_updates</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;num_updates&#39;</span><span class=p>),</span>
<span class=linenos data-linenos="1557 "></span>                                                       <span class=n>n_round</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>)</span>
<span class=linenos data-linenos="1558 "></span>
<span class=linenos data-linenos="1559 "></span>    <span class=c1># write results of the aggregated model in a temp file</span>
<span class=linenos data-linenos="1560 "></span>
<span class=linenos data-linenos="1561 "></span>    <span class=c1># Export aggregated parameters to a local file and upload it.</span>
<span class=linenos data-linenos="1562 "></span>    <span class=c1># Also assign the new values to the job&#39;s training plan&#39;s model.</span>
<span class=linenos data-linenos="1563 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_global_model</span> <span class=o>=</span> <span class=n>aggregated_params</span>  <span class=c1># update global model</span>
<span class=linenos data-linenos="1564 "></span>    <span class=n>aggregated_params_path</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>update_parameters</span><span class=p>(</span><span class=n>aggregated_params</span><span class=p>)</span>
<span class=linenos data-linenos="1565 "></span>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Saved aggregated params for round </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=si>}</span><span class=s1> &#39;</span>
<span class=linenos data-linenos="1566 "></span>                <span class=sa>f</span><span class=s1>&#39;in </span><span class=si>{</span><span class=n>aggregated_params_path</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1567 "></span>
<span class=linenos data-linenos="1568 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_aggregated_params</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;params&#39;</span><span class=p>:</span> <span class=n>aggregated_params</span><span class=p>,</span>
<span class=linenos data-linenos="1569 "></span>                                                    <span class=s1>&#39;params_path&#39;</span><span class=p>:</span> <span class=n>aggregated_params_path</span><span class=p>}</span>
<span class=linenos data-linenos="1570 "></span>
<span class=linenos data-linenos="1571 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+=</span> <span class=mi>1</span>
<span class=linenos data-linenos="1572 "></span>
<span class=linenos data-linenos="1573 "></span>    <span class=c1># Update round in monitor for the next round</span>
<span class=linenos data-linenos="1574 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span><span class=o>.</span><span class=n>set_round</span><span class=p>(</span><span class=n>round_</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<span class=linenos data-linenos="1575 "></span>
<span class=linenos data-linenos="1576 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span><span class=p>:</span>
<span class=linenos data-linenos="1577 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>breakpoint</span><span class=p>()</span>
<span class=linenos data-linenos="1578 "></span>
<span class=linenos data-linenos="1579 "></span>    <span class=c1># do final validation after saving breakpoint :</span>
<span class=linenos data-linenos="1580 "></span>    <span class=c1># not saved in breakpoint for current round, but more simple</span>
<span class=linenos data-linenos="1581 "></span>    <span class=k>if</span> <span class=n>test_after</span><span class=p>:</span>
<span class=linenos data-linenos="1582 "></span>        <span class=c1># FIXME: should we sample nodes here too?</span>
<span class=linenos data-linenos="1583 "></span>        <span class=n>aggr_args_thr_msg</span><span class=p>,</span> <span class=n>aggr_args_thr_file</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>create_aggregator_args</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_global_model</span><span class=p>,</span>
<span class=linenos data-linenos="1584 "></span>                                                                                        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>nodes</span><span class=p>)</span>
<span class=linenos data-linenos="1585 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>start_nodes_training_round</span><span class=p>(</span><span class=n>round_</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>,</span>
<span class=linenos data-linenos="1586 "></span>                                             <span class=n>aggregator_args_thr_msg</span><span class=o>=</span><span class=n>aggr_args_thr_msg</span><span class=p>,</span>
<span class=linenos data-linenos="1587 "></span>                                             <span class=n>aggregator_args_thr_files</span><span class=o>=</span><span class=n>aggr_args_thr_file</span><span class=p>,</span>
<span class=linenos data-linenos="1588 "></span>                                             <span class=n>do_training</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=linenos data-linenos="1589 "></span>
<span class=linenos data-linenos="1590 "></span>    <span class=k>return</span> <span class=mi>1</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.save_breakpoints class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>save_breakpoints</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the status of saving breakpoint after each round of training.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p><code>True</code>, If saving breakpoint is active. <code>False</code>, vice versa.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="540 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="541 "></span><span class=k>def</span> <span class=nf>save_breakpoints</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="542 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the status of saving breakpoint after each round of training.</span>
<span class=linenos data-linenos="543 "></span>
<span class=linenos data-linenos="544 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="545 "></span><span class=sd>        `True`, If saving breakpoint is active. `False`, vice versa.</span>
<span class=linenos data-linenos="546 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="547 "></span>
<span class=linenos data-linenos="548 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_aggregator class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_aggregator</span><span class=p>(</span><span class=n>aggregator</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets aggregator + verification on arguments type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>aggregator</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--fedbiomed.researcher.aggregators.Aggregator--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a><!---->, <!--Type[Aggregator]--><!--typing.Type--><a class="autorefs autorefs-external" title="typing.Type" href="https://docs.python.org/3/library/typing.html#typing.Type">Type</a><!---->[<!--fedbiomed.researcher.aggregators.Aggregator--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>Object or class defining the method for aggregating local updates. Default to None (use <code>FedAverage</code> for aggregation)</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.researcher.aggregators.Aggregator--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.aggregators.Aggregator" href="../aggregators/#fedbiomed.researcher.aggregators.Aggregator">Aggregator</a></code> </td> <td><p>aggregator (Aggregator)</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad aggregator type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="839 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="840 "></span><span class=k>def</span> <span class=nf>set_aggregator</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>aggregator</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Aggregator</span><span class=p>,</span> <span class=n>Type</span><span class=p>[</span><span class=n>Aggregator</span><span class=p>],</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> \
<span class=linenos data-linenos="841 "></span>        <span class=n>Aggregator</span><span class=p>:</span>
<span class=linenos data-linenos="842 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets aggregator + verification on arguments type</span>
<span class=linenos data-linenos="843 "></span>
<span class=linenos data-linenos="844 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="845 "></span><span class=sd>        aggregator: Object or class defining the method for aggregating local updates. Default to None</span>
<span class=linenos data-linenos="846 "></span><span class=sd>            (use `FedAverage` for aggregation)</span>
<span class=linenos data-linenos="847 "></span>
<span class=linenos data-linenos="848 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="849 "></span><span class=sd>        aggregator (Aggregator)</span>
<span class=linenos data-linenos="850 "></span>
<span class=linenos data-linenos="851 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="852 "></span><span class=sd>        FedbiomedExperimentError : bad aggregator type</span>
<span class=linenos data-linenos="853 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="854 "></span>
<span class=linenos data-linenos="855 "></span>    <span class=k>if</span> <span class=n>aggregator</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="856 "></span>        <span class=c1># default aggregator</span>
<span class=linenos data-linenos="857 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=o>=</span> <span class=n>FedAverage</span><span class=p>()</span>
<span class=linenos data-linenos="858 "></span>    <span class=k>elif</span> <span class=n>inspect</span><span class=o>.</span><span class=n>isclass</span><span class=p>(</span><span class=n>aggregator</span><span class=p>):</span>
<span class=linenos data-linenos="859 "></span>        <span class=c1># a class is provided, need to instantiate an object</span>
<span class=linenos data-linenos="860 "></span>        <span class=k>if</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>aggregator</span><span class=p>,</span> <span class=n>Aggregator</span><span class=p>):</span>
<span class=linenos data-linenos="861 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=o>=</span> <span class=n>aggregator</span><span class=p>()</span>
<span class=linenos data-linenos="862 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="863 "></span>            <span class=c1># bad argument</span>
<span class=linenos data-linenos="864 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `aggregator` : </span><span class=si>{</span><span class=n>aggregator</span><span class=si>}</span><span class=s1> class&#39;</span>
<span class=linenos data-linenos="865 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="866 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="867 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>aggregator</span><span class=p>,</span> <span class=n>Aggregator</span><span class=p>):</span>
<span class=linenos data-linenos="868 "></span>        <span class=c1># an object of a proper class is provided, nothing to do</span>
<span class=linenos data-linenos="869 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=o>=</span> <span class=n>aggregator</span>
<span class=linenos data-linenos="870 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="871 "></span>        <span class=c1># other bad type or object</span>
<span class=linenos data-linenos="872 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `aggregator` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>aggregator</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="873 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="874 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="875 "></span>    <span class=c1># at this point self._aggregator is (non-None) aggregator object</span>
<span class=linenos data-linenos="876 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>aggregator_args</span><span class=p>[</span><span class=s2>&quot;aggregator_name&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>aggregator_name</span>
<span class=linenos data-linenos="877 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="878 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span><span class=o>.</span><span class=n>set_fds</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>)</span>
<span class=linenos data-linenos="879 "></span>
<span class=linenos data-linenos="880 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_experimentation_folder class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_experimentation_folder</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets <code>experimentation_folder</code>, the folder name where experiment data/result are saved.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>experimentation_folder</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--str, None--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>File name where experiment related files are saved</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>experimentation_folder (str)</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad <code>experimentation_folder</code> type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1019 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1020 "></span><span class=k>def</span> <span class=nf>set_experimentation_folder</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>experimentation_folder</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=linenos data-linenos="1021 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets `experimentation_folder`, the folder name where experiment data/result are saved.</span>
<span class=linenos data-linenos="1022 "></span>
<span class=linenos data-linenos="1023 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1024 "></span><span class=sd>        experimentation_folder: File name where experiment related files are saved</span>
<span class=linenos data-linenos="1025 "></span>
<span class=linenos data-linenos="1026 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1027 "></span><span class=sd>        experimentation_folder (str)</span>
<span class=linenos data-linenos="1028 "></span>
<span class=linenos data-linenos="1029 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1030 "></span><span class=sd>        FedbiomedExperimentError : bad `experimentation_folder` type</span>
<span class=linenos data-linenos="1031 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1032 "></span>    <span class=k>if</span> <span class=n>experimentation_folder</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1033 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span> <span class=o>=</span> <span class=n>create_exp_folder</span><span class=p>()</span>
<span class=linenos data-linenos="1034 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="1035 "></span>        <span class=n>sanitized_folder</span> <span class=o>=</span> <span class=n>sanitize_filename</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>,</span> <span class=n>platform</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1036 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span> <span class=o>=</span> <span class=n>create_exp_folder</span><span class=p>(</span><span class=n>sanitized_folder</span><span class=p>)</span>
<span class=linenos data-linenos="1037 "></span>        <span class=k>if</span> <span class=p>(</span><span class=n>sanitized_folder</span> <span class=o>!=</span> <span class=n>experimentation_folder</span><span class=p>):</span>
<span class=linenos data-linenos="1038 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;`experimentation_folder` was sanitized from &#39;</span>
<span class=linenos data-linenos="1039 "></span>                           <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>experimentation_folder</span><span class=si>}</span><span class=s1> to </span><span class=si>{</span><span class=n>sanitized_folder</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1040 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1041 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1042 "></span>            <span class=sa>f</span><span class=s1>&#39; `experimentation_folder` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>experimentation_folder</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1043 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1044 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1045 "></span>
<span class=linenos data-linenos="1046 "></span>        <span class=c1># at this point self._experimentation_folder is a str valid for a foldername</span>
<span class=linenos data-linenos="1047 "></span>
<span class=linenos data-linenos="1048 "></span>    <span class=c1># _job doesn&#39;t always exist at this point</span>
<span class=linenos data-linenos="1049 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1050 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation folder changed, you may need to update `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1051 "></span>
<span class=linenos data-linenos="1052 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_experimentation_folder</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_job class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_job</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Setter for job, it verifies pre-requisites are met for creating a job attached to this experiment. If yes, instantiate a job ; if no, return None.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--Job, None--><!--fedbiomed.researcher.job.Job--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.job.Job" href="../job/#fedbiomed.researcher.job.Job">Job</a><!---->, <!---->None<!---->]</code> </td> <td><p>The object that is initialized for creating round jobs.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1339 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1340 "></span><span class=k>def</span> <span class=nf>set_job</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>Job</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="1341 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Setter for job, it verifies pre-requisites are met for creating a job</span>
<span class=linenos data-linenos="1342 "></span><span class=sd>    attached to this experiment. If yes, instantiate a job ; if no, return None.</span>
<span class=linenos data-linenos="1343 "></span>
<span class=linenos data-linenos="1344 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1345 "></span><span class=sd>        The object that is initialized for creating round jobs.</span>
<span class=linenos data-linenos="1346 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1347 "></span>    <span class=c1># at this point all are defined among:</span>
<span class=linenos data-linenos="1348 "></span>    <span class=c1># self.{_reqs,_fds,_training_plan_is_defined,_training_plan,_training_plan_path,_model_args,_training_args}</span>
<span class=linenos data-linenos="1349 "></span>    <span class=c1># self._experimentation_folder =&gt; self.experimentation_path()</span>
<span class=linenos data-linenos="1350 "></span>    <span class=c1># self._round_current</span>
<span class=linenos data-linenos="1351 "></span>
<span class=linenos data-linenos="1352 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1353 "></span>        <span class=c1># a job is already defined, and it may also have run some rounds</span>
<span class=linenos data-linenos="1354 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation `job` changed after running &#39;</span>
<span class=linenos data-linenos="1355 "></span>                     <span class=s1>&#39;</span><span class=si>{self._round_current}</span><span class=s1> rounds, may give inconsistent results&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1356 "></span>
<span class=linenos data-linenos="1357 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_is_defined</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>True</span><span class=p>:</span>
<span class=linenos data-linenos="1358 "></span>        <span class=c1># training plan not properly defined yet</span>
<span class=linenos data-linenos="1359 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1360 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experiment not fully configured yet: no job. Missing proper training plan &#39;</span>
<span class=linenos data-linenos="1361 "></span>                     <span class=sa>f</span><span class=s1>&#39;definition (training_plan=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=si>}</span><span class=s1> &#39;</span>
<span class=linenos data-linenos="1362 "></span>                     <span class=sa>f</span><span class=s1>&#39;training_plan_path=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1363 "></span>    <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1364 "></span>        <span class=c1># not training data yet</span>
<span class=linenos data-linenos="1365 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1366 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experiment not fully configured yet: no job. Missing training data&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1367 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1368 "></span>        <span class=c1># meeting requisites for instantiating a job</span>
<span class=linenos data-linenos="1369 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=o>=</span> <span class=n>Job</span><span class=p>(</span><span class=n>reqs</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span><span class=p>,</span>
<span class=linenos data-linenos="1370 "></span>                        <span class=n>training_plan_class</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=p>,</span>
<span class=linenos data-linenos="1371 "></span>                        <span class=n>training_plan_path</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span><span class=p>,</span>
<span class=linenos data-linenos="1372 "></span>                        <span class=n>model_args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span><span class=p>,</span>
<span class=linenos data-linenos="1373 "></span>                        <span class=n>training_args</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>,</span>
<span class=linenos data-linenos="1374 "></span>                        <span class=n>data</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>,</span>
<span class=linenos data-linenos="1375 "></span>                        <span class=n>keep_files_dir</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>experimentation_path</span><span class=p>())</span>
<span class=linenos data-linenos="1376 "></span>
<span class=linenos data-linenos="1377 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_model_args class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_model_args</span><span class=p>(</span><span class=n>model_args</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets <code>model_args</code> + verification on arguments type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model_args</code></td> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>contains model arguments passed to the constructor of the training plan when instantiating it : output and input feature dimension, etc.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>Model arguments that have been set.</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad model_args type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1174 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1175 "></span><span class=k>def</span> <span class=nf>set_model_args</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model_args</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="1176 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets `model_args` + verification on arguments type</span>
<span class=linenos data-linenos="1177 "></span>
<span class=linenos data-linenos="1178 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1179 "></span><span class=sd>        model_args (dict): contains model arguments passed to the constructor</span>
<span class=linenos data-linenos="1180 "></span><span class=sd>            of the training plan when instantiating it : output and input feature</span>
<span class=linenos data-linenos="1181 "></span><span class=sd>            dimension, etc.</span>
<span class=linenos data-linenos="1182 "></span>
<span class=linenos data-linenos="1183 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1184 "></span><span class=sd>        Model arguments that have been set.</span>
<span class=linenos data-linenos="1185 "></span>
<span class=linenos data-linenos="1186 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1187 "></span><span class=sd>        FedbiomedExperimentError : bad model_args type</span>
<span class=linenos data-linenos="1188 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1189 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>model_args</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=linenos data-linenos="1190 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span> <span class=o>=</span> <span class=n>model_args</span>
<span class=linenos data-linenos="1191 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1192 "></span>        <span class=c1># bad type</span>
<span class=linenos data-linenos="1193 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `model_args` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>model_args</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1194 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1195 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1196 "></span>    <span class=c1># self._model_args always exist at this point</span>
<span class=linenos data-linenos="1197 "></span>
<span class=linenos data-linenos="1198 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1199 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation model_args changed, you may need to update `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1200 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_model_args</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_nodes class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_nodes</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets for nodes + verifications on argument type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>nodes</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>List of node_ids to filter the nodes to be involved in the experiment.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>List of tags that are set. None, if the argument <code>nodes</code> is None.</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>Bad nodes type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="740 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="741 "></span><span class=k>def</span> <span class=nf>set_nodes</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>nodes</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="742 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets for nodes + verifications on argument type</span>
<span class=linenos data-linenos="743 "></span>
<span class=linenos data-linenos="744 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="745 "></span><span class=sd>        nodes: List of node_ids to filter the nodes to be involved in the experiment.</span>
<span class=linenos data-linenos="746 "></span>
<span class=linenos data-linenos="747 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="748 "></span><span class=sd>        List of tags that are set. None, if the argument `nodes` is None.</span>
<span class=linenos data-linenos="749 "></span>
<span class=linenos data-linenos="750 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="751 "></span><span class=sd>        FedbiomedExperimentError : Bad nodes type</span>
<span class=linenos data-linenos="752 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="753 "></span>
<span class=linenos data-linenos="754 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
<span class=linenos data-linenos="755 "></span>        <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
<span class=linenos data-linenos="756 "></span>            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="757 "></span>                <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `nodes` : list of </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>node</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="758 "></span>                <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="759 "></span>                <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="760 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span> <span class=o>=</span> <span class=n>nodes</span>
<span class=linenos data-linenos="761 "></span>    <span class=k>elif</span> <span class=n>nodes</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="762 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span> <span class=o>=</span> <span class=n>nodes</span>
<span class=linenos data-linenos="763 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="764 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `nodes` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="765 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="766 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="767 "></span>    <span class=c1># self._nodes always exist at this point</span>
<span class=linenos data-linenos="768 "></span>
<span class=linenos data-linenos="769 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="770 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation nodes filter changed, you may need to update `training_data`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="771 "></span>
<span class=linenos data-linenos="772 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_round_limit class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_round_limit</span><span class=p>(</span><span class=n>round_limit</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets <code>round_limit</code> + verification on arguments type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>round_limit</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--int, None--><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a><!---->, <!---->None<!---->]</code> </td> <td><p>the maximum number of training rounds (nodes &lt;-&gt; central server) that should be executed for the experiment. <code>None</code> means that no limit is defined.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--int, None--><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a><!---->, <!---->None<!---->]</code> </td> <td><p>Round limit for experiment of federated learning</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad rounds type or value</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="931 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="932 "></span><span class=k>def</span> <span class=nf>set_round_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>round_limit</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="933 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets `round_limit` + verification on arguments type</span>
<span class=linenos data-linenos="934 "></span>
<span class=linenos data-linenos="935 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="936 "></span><span class=sd>        round_limit: the maximum number of training rounds (nodes &lt;-&gt; central server) that should be executed</span>
<span class=linenos data-linenos="937 "></span><span class=sd>            for the experiment. `None` means that no limit is defined.</span>
<span class=linenos data-linenos="938 "></span>
<span class=linenos data-linenos="939 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="940 "></span><span class=sd>        Round limit for experiment of federated learning</span>
<span class=linenos data-linenos="941 "></span>
<span class=linenos data-linenos="942 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="943 "></span><span class=sd>        FedbiomedExperimentError : bad rounds type or value</span>
<span class=linenos data-linenos="944 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="945 "></span>    <span class=c1># at this point round_current exists and is an int &gt;= 0</span>
<span class=linenos data-linenos="946 "></span>
<span class=linenos data-linenos="947 "></span>    <span class=k>if</span> <span class=n>round_limit</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="948 "></span>        <span class=c1># no limit for training rounds</span>
<span class=linenos data-linenos="949 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="950 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>round_limit</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<span class=linenos data-linenos="951 "></span>        <span class=c1># at this point round_limit is an int</span>
<span class=linenos data-linenos="952 "></span>        <span class=k>if</span> <span class=n>round_limit</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
<span class=linenos data-linenos="953 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `round_limit` can not be negative: </span><span class=si>{</span><span class=n>round_limit</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="954 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="955 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="956 "></span>        <span class=k>elif</span> <span class=n>round_limit</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=p>:</span>
<span class=linenos data-linenos="957 "></span>            <span class=c1># self._round_limit can&#39;t be less than current round</span>
<span class=linenos data-linenos="958 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;cannot set `round_limit` to less than the number of already run rounds &#39;</span>
<span class=linenos data-linenos="959 "></span>                         <span class=sa>f</span><span class=s1>&#39;(</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_round_current</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="960 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="961 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span> <span class=o>=</span> <span class=n>round_limit</span>
<span class=linenos data-linenos="962 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="963 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `round_limit` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>round_limit</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="964 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="965 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="966 "></span>
<span class=linenos data-linenos="967 "></span>    <span class=c1># at this point self._round_limit is a Union[int, None]</span>
<span class=linenos data-linenos="968 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_round_limit</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_save_breakpoints class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_save_breakpoints</span><span class=p>(</span><span class=n>save_breakpoints</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Setter for save_breakpoints + verification on arguments type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>save_breakpoints</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>whether to save breakpoints or not after each training round. Breakpoints can be used for resuming a crashed experiment.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>Status of saving breakpoints</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad save_breakpoints type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1384 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1385 "></span><span class=k>def</span> <span class=nf>set_save_breakpoints</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>save_breakpoints</span><span class=p>:</span> <span class=nb>bool</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="1386 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Setter for save_breakpoints + verification on arguments type</span>
<span class=linenos data-linenos="1387 "></span>
<span class=linenos data-linenos="1388 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1389 "></span><span class=sd>        save_breakpoints (bool): whether to save breakpoints or</span>
<span class=linenos data-linenos="1390 "></span><span class=sd>            not after each training round. Breakpoints can be used for resuming</span>
<span class=linenos data-linenos="1391 "></span><span class=sd>            a crashed experiment.</span>
<span class=linenos data-linenos="1392 "></span>
<span class=linenos data-linenos="1393 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1394 "></span><span class=sd>        Status of saving breakpoints</span>
<span class=linenos data-linenos="1395 "></span>
<span class=linenos data-linenos="1396 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1397 "></span><span class=sd>        FedbiomedExperimentError: bad save_breakpoints type</span>
<span class=linenos data-linenos="1398 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1399 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>save_breakpoints</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="1400 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span> <span class=o>=</span> <span class=n>save_breakpoints</span>
<span class=linenos data-linenos="1401 "></span>        <span class=c1># no warning if done during experiment, we may change breakpoint policy at any time</span>
<span class=linenos data-linenos="1402 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1403 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `save_breakpoints` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>save_breakpoints</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1404 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1405 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1406 "></span>
<span class=linenos data-linenos="1407 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_save_breakpoints</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_secagg class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_secagg</span><span class=p>(</span><span class=n>secagg</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1431 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1432 "></span><span class=k>def</span> <span class=nf>set_secagg</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>secagg</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=n>SecureAggregation</span><span class=p>]):</span>
<span class=linenos data-linenos="1433 "></span>
<span class=linenos data-linenos="1434 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>secagg</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="1435 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span> <span class=o>=</span> <span class=n>SecureAggregation</span><span class=p>(</span><span class=n>active</span><span class=o>=</span><span class=n>secagg</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<span class=linenos data-linenos="1436 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>secagg</span><span class=p>,</span> <span class=n>SecureAggregation</span><span class=p>):</span>
<span class=linenos data-linenos="1437 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span> <span class=o>=</span> <span class=n>secagg</span>
<span class=linenos data-linenos="1438 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1439 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>: Expected `secagg` argument bool or `SecureAggregation`, &quot;</span> \
<span class=linenos data-linenos="1440 "></span>              <span class=sa>f</span><span class=s2>&quot;but got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>secagg</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=linenos data-linenos="1441 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1442 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1443 "></span>
<span class=linenos data-linenos="1444 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_secagg</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_strategy class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_strategy</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets for <code>node_selection_strategy</code> + verification on arguments type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>node_selection_strategy</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--fedbiomed.researcher.strategies.strategy.Strategy--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a><!---->, <!--Type[Strategy]--><!--typing.Type--><a class="autorefs autorefs-external" title="typing.Type" href="https://docs.python.org/3/library/typing.html#typing.Type">Type</a><!---->[<!--fedbiomed.researcher.strategies.strategy.Strategy--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>object or class defining how nodes are sampled at each round for training, and how non-responding nodes are managed. Defaults to None: - use <code>DefaultStrategy</code> if training_data is initialized - else strategy is None (cannot be initialized), experiment cannot be launched yet</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--Strategy, None--><!--fedbiomed.researcher.strategies.strategy.Strategy--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a><!---->, <!---->None<!---->]</code> </td> <td><p>node selection strategy class</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad strategy type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="882 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="883 "></span><span class=k>def</span> <span class=nf>set_strategy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>node_selection_strategy</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Strategy</span><span class=p>,</span> <span class=n>Type</span><span class=p>[</span><span class=n>Strategy</span><span class=p>],</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> \
<span class=linenos data-linenos="884 "></span>        <span class=n>Union</span><span class=p>[</span><span class=n>Strategy</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="885 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets for `node_selection_strategy` + verification on arguments type</span>
<span class=linenos data-linenos="886 "></span>
<span class=linenos data-linenos="887 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="888 "></span><span class=sd>        node_selection_strategy: object or class defining how nodes are sampled at each round for training, and</span>
<span class=linenos data-linenos="889 "></span><span class=sd>            how non-responding nodes are managed. Defaults to None:</span>
<span class=linenos data-linenos="890 "></span><span class=sd>            - use `DefaultStrategy` if training_data is initialized</span>
<span class=linenos data-linenos="891 "></span><span class=sd>            - else strategy is None (cannot be initialized), experiment cannot</span>
<span class=linenos data-linenos="892 "></span><span class=sd>              be launched yet</span>
<span class=linenos data-linenos="893 "></span>
<span class=linenos data-linenos="894 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="895 "></span><span class=sd>        node selection strategy class</span>
<span class=linenos data-linenos="896 "></span>
<span class=linenos data-linenos="897 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="898 "></span><span class=sd>        FedbiomedExperimentError : bad strategy type</span>
<span class=linenos data-linenos="899 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="900 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="901 "></span>        <span class=k>if</span> <span class=n>node_selection_strategy</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="902 "></span>            <span class=c1># default node_selection_strategy</span>
<span class=linenos data-linenos="903 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=o>=</span> <span class=n>DefaultStrategy</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>)</span>
<span class=linenos data-linenos="904 "></span>        <span class=k>elif</span> <span class=n>inspect</span><span class=o>.</span><span class=n>isclass</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=p>):</span>
<span class=linenos data-linenos="905 "></span>            <span class=c1># a class is provided, need to instantiate an object</span>
<span class=linenos data-linenos="906 "></span>            <span class=k>if</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=p>,</span> <span class=n>Strategy</span><span class=p>):</span>
<span class=linenos data-linenos="907 "></span>                <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=o>=</span> <span class=n>node_selection_strategy</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_fds</span><span class=p>)</span>
<span class=linenos data-linenos="908 "></span>            <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="909 "></span>                <span class=c1># bad argument</span>
<span class=linenos data-linenos="910 "></span>                <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="911 "></span>                    <span class=sa>f</span><span class=s1>&#39; `node_selection_strategy` : </span><span class=si>{</span><span class=n>node_selection_strategy</span><span class=si>}</span><span class=s1> class&#39;</span>
<span class=linenos data-linenos="912 "></span>                <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="913 "></span>                <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="914 "></span>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=p>,</span> <span class=n>Strategy</span><span class=p>):</span>
<span class=linenos data-linenos="915 "></span>            <span class=c1># an object of a proper class is provided, nothing to do</span>
<span class=linenos data-linenos="916 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=o>=</span> <span class=n>node_selection_strategy</span>
<span class=linenos data-linenos="917 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="918 "></span>            <span class=c1># other bad type or object</span>
<span class=linenos data-linenos="919 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="920 "></span>                <span class=sa>f</span><span class=s1>&#39; `node_selection_strategy` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>node_selection_strategy</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="921 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="922 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="923 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="924 "></span>        <span class=c1># cannot initialize strategy if not FederatedDataSet yet</span>
<span class=linenos data-linenos="925 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="926 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experiment not fully configured yet: no node selection strategy&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="927 "></span>
<span class=linenos data-linenos="928 "></span>    <span class=c1># at this point self._node_selection_strategy is a Union[Strategy, None]</span>
<span class=linenos data-linenos="929 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_tags class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_tags</span><span class=p>(</span><span class=n>tags</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets tags + verifications on argument type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>tags</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->, <!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>List of string with data tags or string with one data tag. Empty list of tags ([]) means any dataset is accepted, it is different from None (tags not set, cannot search for training_data yet).</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>List of tags that are set. None, if the argument <code>tags</code> is None.</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>Bad tags type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="702 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="703 "></span><span class=k>def</span> <span class=nf>set_tags</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tags</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="704 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets tags + verifications on argument type</span>
<span class=linenos data-linenos="705 "></span>
<span class=linenos data-linenos="706 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="707 "></span><span class=sd>        tags: List of string with data tags or string with one data tag. Empty list</span>
<span class=linenos data-linenos="708 "></span><span class=sd>            of tags ([]) means any dataset is accepted, it is different from None (tags not set, cannot search</span>
<span class=linenos data-linenos="709 "></span><span class=sd>            for training_data yet).</span>
<span class=linenos data-linenos="710 "></span>
<span class=linenos data-linenos="711 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="712 "></span><span class=sd>        List of tags that are set. None, if the argument `tags` is None.</span>
<span class=linenos data-linenos="713 "></span>
<span class=linenos data-linenos="714 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="715 "></span><span class=sd>        FedbiomedExperimentError : Bad tags type</span>
<span class=linenos data-linenos="716 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="717 "></span>
<span class=linenos data-linenos="718 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tags</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
<span class=linenos data-linenos="719 "></span>        <span class=k>for</span> <span class=n>tag</span> <span class=ow>in</span> <span class=n>tags</span><span class=p>:</span>
<span class=linenos data-linenos="720 "></span>            <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tag</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="721 "></span>                <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `tags` : list of </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>tag</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="722 "></span>                <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="723 "></span>                <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="724 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span> <span class=o>=</span> <span class=n>tags</span>
<span class=linenos data-linenos="725 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tags</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="726 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span> <span class=o>=</span> <span class=p>[</span><span class=n>tags</span><span class=p>]</span>
<span class=linenos data-linenos="727 "></span>    <span class=k>elif</span> <span class=n>tags</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="728 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span> <span class=o>=</span> <span class=n>tags</span>
<span class=linenos data-linenos="729 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="730 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `tags` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>tags</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="731 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="732 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="733 "></span>    <span class=c1># self._tags always exist at this point</span>
<span class=linenos data-linenos="734 "></span>
<span class=linenos data-linenos="735 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="736 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation tags changed, you may need to update `training_data`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="737 "></span>
<span class=linenos data-linenos="738 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_tensorboard class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_tensorboard</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets the tensorboard flag</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>tensorboard</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>If <code>True</code> tensorboard log files will be writen after receiving training feedbacks</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>Status of tensorboard</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1409 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1410 "></span><span class=k>def</span> <span class=nf>set_tensorboard</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tensorboard</span><span class=p>:</span> <span class=nb>bool</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="1411 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="1412 "></span><span class=sd>    Sets the tensorboard flag</span>
<span class=linenos data-linenos="1413 "></span>
<span class=linenos data-linenos="1414 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1415 "></span><span class=sd>        tensorboard: If `True` tensorboard log files will be writen after receiving training feedbacks</span>
<span class=linenos data-linenos="1416 "></span>
<span class=linenos data-linenos="1417 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1418 "></span><span class=sd>        Status of tensorboard</span>
<span class=linenos data-linenos="1419 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1420 "></span>
<span class=linenos data-linenos="1421 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="1422 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_tensorboard</span> <span class=o>=</span> <span class=n>tensorboard</span>
<span class=linenos data-linenos="1423 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_monitor</span><span class=o>.</span><span class=n>set_tensorboard</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>)</span>
<span class=linenos data-linenos="1424 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1425 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `tensorboard` : </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>tensorboard</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1426 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1427 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1428 "></span>
<span class=linenos data-linenos="1429 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tensorboard</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_test_metric class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_test_metric</span><span class=p>(</span><span class=n>metric</span><span class=p>,</span> <span class=n>metric_args</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets a metric for federated model validation</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>metric</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--MetricTypes, str, None--><!--fedbiomed.common.metrics.MetricTypes--><a class="autorefs autorefs-internal" title="fedbiomed.common.metrics.MetricTypes" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes">MetricTypes</a><!---->, <!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>A class as an instance of <a class="autorefs autorefs-internal" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes"><code>MetricTypes</code></a>. <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> for referring one of metric which provided as attributes in <a class="autorefs autorefs-internal" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes"><code>MetricTypes</code></a>. None, if it isn't declared yet.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>**metric_args</code></td> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>A dictionary that contains arguments for metric function. Arguments should be compatible with corresponding metrics in <a class="autorefs autorefs-external" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics"><code>sklearn.metrics</code></a>.</p></td> <td> <code><!---->{}</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Tuple--><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a><!---->[<!----><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--str, None--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]<!---->, <!----><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, Any--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a><!---->]<!---->]</code> </td> <td><p>Metric and metric args as tuple</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>Invalid type for <code>metric</code> argument</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1259 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1260 "></span><span class=k>def</span> <span class=nf>set_test_metric</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>metric</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>MetricTypes</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span> <span class=o>**</span><span class=n>metric_args</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> \
<span class=linenos data-linenos="1261 "></span>        <span class=n>Tuple</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
<span class=linenos data-linenos="1262 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Sets a metric for federated model validation</span>
<span class=linenos data-linenos="1263 "></span>
<span class=linenos data-linenos="1264 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1265 "></span><span class=sd>        metric: A class as an instance of [`MetricTypes`][fedbiomed.common.metrics.MetricTypes]. [`str`][str] for</span>
<span class=linenos data-linenos="1266 "></span><span class=sd>            referring one of  metric which provided as attributes in [`MetricTypes`]</span>
<span class=linenos data-linenos="1267 "></span><span class=sd>            [fedbiomed.common.metrics.MetricTypes]. None, if it isn&#39;t declared yet.</span>
<span class=linenos data-linenos="1268 "></span><span class=sd>        **metric_args: A dictionary that contains arguments for metric function. Arguments</span>
<span class=linenos data-linenos="1269 "></span><span class=sd>            should be compatible with corresponding metrics in [`sklearn.metrics`][sklearn.metrics].</span>
<span class=linenos data-linenos="1270 "></span>
<span class=linenos data-linenos="1271 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1272 "></span><span class=sd>        Metric and  metric args as tuple</span>
<span class=linenos data-linenos="1273 "></span>
<span class=linenos data-linenos="1274 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1275 "></span><span class=sd>        FedbiomedExperimentError: Invalid type for `metric` argument</span>
<span class=linenos data-linenos="1276 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1277 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_metric&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>metric</span>
<span class=linenos data-linenos="1278 "></span>
<span class=linenos data-linenos="1279 "></span>    <span class=c1># using **metric_args, we know `test_metric_args` is a Dict[str, Any]</span>
<span class=linenos data-linenos="1280 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_metric_args&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>metric_args</span>
<span class=linenos data-linenos="1281 "></span>
<span class=linenos data-linenos="1282 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1283 "></span>        <span class=c1># job setter function exists, use it</span>
<span class=linenos data-linenos="1284 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_args</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span>
<span class=linenos data-linenos="1285 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation training_args updated for `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1286 "></span>
<span class=linenos data-linenos="1287 "></span>    <span class=k>return</span> <span class=n>metric</span><span class=p>,</span> <span class=n>metric_args</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_test_on_global_updates class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_test_on_global_updates</span><span class=p>(</span><span class=n>flag</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Setter for test_on_global_updates, that indicates whether to perform a validation on the federated model updates on the node side before training model locally where aggregated model parameters are received.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>flag</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>whether to perform model validation on global updates. Defaults to True.</p></td> <td> <code><!---->True</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>Value of the flag <code>test_on_global_updates</code>.</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad flag type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1313 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1314 "></span><span class=k>def</span> <span class=nf>set_test_on_global_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>flag</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="1315 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="1316 "></span><span class=sd>    Setter for test_on_global_updates, that indicates whether to  perform a validation on the federated model</span>
<span class=linenos data-linenos="1317 "></span><span class=sd>    updates on the node side before training model locally where aggregated model parameters are received.</span>
<span class=linenos data-linenos="1318 "></span>
<span class=linenos data-linenos="1319 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1320 "></span><span class=sd>        flag (bool, optional): whether to perform model validation on global updates. Defaults to True.</span>
<span class=linenos data-linenos="1321 "></span>
<span class=linenos data-linenos="1322 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1323 "></span><span class=sd>        Value of the flag `test_on_global_updates`.</span>
<span class=linenos data-linenos="1324 "></span>
<span class=linenos data-linenos="1325 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1326 "></span><span class=sd>        FedbiomedExperimentError : bad flag type</span>
<span class=linenos data-linenos="1327 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1328 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_global_updates&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span>
<span class=linenos data-linenos="1329 "></span>
<span class=linenos data-linenos="1330 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1331 "></span>        <span class=c1># job setter function exists, use it</span>
<span class=linenos data-linenos="1332 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_args</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span>
<span class=linenos data-linenos="1333 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation training_args updated for `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1334 "></span>
<span class=linenos data-linenos="1335 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_global_updates&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_test_on_local_updates class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_test_on_local_updates</span><span class=p>(</span><span class=n>flag</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Setter for <code>test_on_local_updates</code>, that indicates whether to perform a validation on the federated model on the node side where model parameters are updated locally after training in each node.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>flag</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>whether to perform model validation on local updates. Defaults to True.</p></td> <td> <code><!---->True</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>value of the flag <code>test_on_local_updates</code></p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad flag type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1289 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1290 "></span><span class=k>def</span> <span class=nf>set_test_on_local_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>flag</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="1291 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos="1292 "></span><span class=sd>    Setter for `test_on_local_updates`, that indicates whether to perform a validation on the federated model on the</span>
<span class=linenos data-linenos="1293 "></span><span class=sd>    node side where model parameters are updated locally after training in each node.</span>
<span class=linenos data-linenos="1294 "></span>
<span class=linenos data-linenos="1295 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1296 "></span><span class=sd>        flag (bool, optional): whether to perform model validation on local updates. Defaults to True.</span>
<span class=linenos data-linenos="1297 "></span>
<span class=linenos data-linenos="1298 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1299 "></span><span class=sd>        value of the flag `test_on_local_updates`</span>
<span class=linenos data-linenos="1300 "></span>
<span class=linenos data-linenos="1301 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1302 "></span><span class=sd>        FedbiomedExperimentError: bad flag type</span>
<span class=linenos data-linenos="1303 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1304 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_local_updates&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>flag</span>
<span class=linenos data-linenos="1305 "></span>
<span class=linenos data-linenos="1306 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1307 "></span>        <span class=c1># job setter function exists, use it</span>
<span class=linenos data-linenos="1308 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_args</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span>
<span class=linenos data-linenos="1309 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation training_args updated for `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1310 "></span>
<span class=linenos data-linenos="1311 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_local_updates&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_test_ratio class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_test_ratio</span><span class=p>(</span><span class=n>ratio</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets validation ratio for model validation.</p> <p>When setting test_ratio, nodes will allocate (1 - <code>test_ratio</code>) fraction of data for training and the remaining for validating model. This could be useful for validating the model, once every round, as well as controlling overfitting, doing early stopping, ....</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>ratio</code></td> <td> <code><!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code> </td> <td><p>validation ratio. Must be within interval [0,1].</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code> </td> <td><p>Validation ratio that is set</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad data type</p></td> </tr> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>ratio is not within interval [0, 1]</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1232 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1233 "></span><span class=k>def</span> <span class=nf>set_test_ratio</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ratio</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=linenos data-linenos="1234 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Sets validation ratio for model validation.</span>
<span class=linenos data-linenos="1235 "></span>
<span class=linenos data-linenos="1236 "></span><span class=sd>    When setting test_ratio, nodes will allocate (1 - `test_ratio`) fraction of data for training and the</span>
<span class=linenos data-linenos="1237 "></span><span class=sd>    remaining for validating model. This could be useful for validating the model, once every round, as well as</span>
<span class=linenos data-linenos="1238 "></span><span class=sd>    controlling overfitting, doing early stopping, ....</span>
<span class=linenos data-linenos="1239 "></span>
<span class=linenos data-linenos="1240 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1241 "></span><span class=sd>        ratio: validation ratio. Must be within interval [0,1].</span>
<span class=linenos data-linenos="1242 "></span>
<span class=linenos data-linenos="1243 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1244 "></span><span class=sd>        Validation ratio that is set</span>
<span class=linenos data-linenos="1245 "></span>
<span class=linenos data-linenos="1246 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1247 "></span><span class=sd>        FedbiomedExperimentError: bad data type</span>
<span class=linenos data-linenos="1248 "></span><span class=sd>        FedbiomedExperimentError: ratio is not within interval [0, 1]</span>
<span class=linenos data-linenos="1249 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1250 "></span>    <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ratio</span>
<span class=linenos data-linenos="1251 "></span>
<span class=linenos data-linenos="1252 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1253 "></span>        <span class=c1># job setter function exists, use it</span>
<span class=linenos data-linenos="1254 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_args</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span>
<span class=linenos data-linenos="1255 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation training_args updated for `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1256 "></span>
<span class=linenos data-linenos="1257 "></span>    <span class=k>return</span> <span class=n>ratio</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_training_args class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_training_args</span><span class=p>(</span><span class=n>training_args</span><span class=p>,</span> <span class=n>reset</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets <code>training_args</code> + verification on arguments type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>training_args</code></td> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>contains training arguments passed to the <code>training_routine</code> of the <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans"><code>fedbiomed.common.training_plans</code></a> when launching it: lr, epochs, batch_size...</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>reset</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>whether to reset the training_args (if previous training_args has already been set), or to update them with training_args. Defaults to True.</p></td> <td> <code><!---->True</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>Training arguments</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad training_args type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1204 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1205 "></span><span class=k>def</span> <span class=nf>set_training_args</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>training_args</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span> <span class=n>reset</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="1206 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Sets `training_args` + verification on arguments type</span>
<span class=linenos data-linenos="1207 "></span>
<span class=linenos data-linenos="1208 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1209 "></span><span class=sd>        training_args (dict): contains training arguments passed to the `training_routine` of the</span>
<span class=linenos data-linenos="1210 "></span><span class=sd>            [`fedbiomed.common.training_plans`][fedbiomed.common.training_plans] when launching it:</span>
<span class=linenos data-linenos="1211 "></span><span class=sd>            lr, epochs, batch_size...</span>
<span class=linenos data-linenos="1212 "></span><span class=sd>        reset (bool, optional): whether to reset the training_args (if previous training_args has already been</span>
<span class=linenos data-linenos="1213 "></span><span class=sd>            set), or to update them with training_args. Defaults to True.</span>
<span class=linenos data-linenos="1214 "></span>
<span class=linenos data-linenos="1215 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1216 "></span><span class=sd>        Training arguments</span>
<span class=linenos data-linenos="1217 "></span>
<span class=linenos data-linenos="1218 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1219 "></span><span class=sd>        FedbiomedExperimentError : bad training_args type</span>
<span class=linenos data-linenos="1220 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1221 "></span>
<span class=linenos data-linenos="1222 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_args</span><span class=p>,</span> <span class=n>TrainingArgs</span><span class=p>):</span>
<span class=linenos data-linenos="1223 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span> <span class=o>=</span> <span class=n>deepcopy</span><span class=p>(</span><span class=n>training_args</span><span class=p>)</span>
<span class=linenos data-linenos="1224 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1225 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span> <span class=o>=</span> <span class=n>TrainingArgs</span><span class=p>(</span><span class=n>training_args</span><span class=p>,</span> <span class=n>only_required</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=linenos data-linenos="1226 "></span>    <span class=c1># Propagate training arguments to job</span>
<span class=linenos data-linenos="1227 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1228 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_args</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span>
<span class=linenos data-linenos="1229 "></span>
<span class=linenos data-linenos="1230 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_training_data class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_training_data</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=n>from_tags</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets training data for federated training + verification on arguments type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>training_data</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--FederatedDataSet, dict, None--><!--fedbiomed.researcher.datasets.FederatedDataSet--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a><!---->, <!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a><!---->, <!---->None<!---->]</code> </td> <td><ul> <li>If it is a FederatedDataSet object, use this value as training_data.</li> <li>else if it is a dict, create and use a FederatedDataSet object from the dict and use this value as training_data. The dict should use node ids as keys, values being list of dicts (each dict representing a dataset on a node).</li> <li>else if it is None (no training data provided)</li> <li>if <code>from_tags</code> is True and <code>tags</code> is not None, set training_data by searching for datasets with a query to the nodes using <code>tags</code> and <code>nodes</code></li> <li>if <code>from_tags</code> is False or <code>tags</code> is None, set training_data to None (no training_data set yet, experiment is not fully initialized and cannot be launched)</li> </ul></td> <td> <em>required</em> </td> </tr> <tr> <td><code>from_tags</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>If True, query nodes for datasets when no <code>training_data</code> is provided. Not used when <code>training_data</code> is provided.</p></td> <td> <code><!---->False</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--FederatedDataSet, None--><!--fedbiomed.researcher.datasets.FederatedDataSet--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a><!---->, <!---->None<!---->]</code> </td> <td><p>Nodes and dataset with meta-data</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad training_data type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="774 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="775 "></span><span class=k>def</span> <span class=nf>set_training_data</span><span class=p>(</span>
<span class=linenos data-linenos="776 "></span>        <span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="777 "></span>        <span class=n>training_data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span>
<span class=linenos data-linenos="778 "></span>        <span class=n>from_tags</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> \
<span class=linenos data-linenos="779 "></span>        <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="780 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets training data for federated training + verification on arguments type</span>
<span class=linenos data-linenos="781 "></span>
<span class=linenos data-linenos="782 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="783 "></span><span class=sd>        training_data:</span>
<span class=linenos data-linenos="784 "></span><span class=sd>            * If it is a FederatedDataSet object, use this value as training_data.</span>
<span class=linenos data-linenos="785 "></span><span class=sd>            * else if it is a dict, create and use a FederatedDataSet object from the dict</span>
<span class=linenos data-linenos="786 "></span><span class=sd>              and use this value as training_data. The dict should use node ids as keys,</span>
<span class=linenos data-linenos="787 "></span><span class=sd>              values being list of dicts (each dict representing a dataset on a node).</span>
<span class=linenos data-linenos="788 "></span><span class=sd>            * else if it is None (no training data provided)</span>
<span class=linenos data-linenos="789 "></span><span class=sd>              - if `from_tags` is True and `tags` is not None, set training_data by</span>
<span class=linenos data-linenos="790 "></span><span class=sd>                searching for datasets with a query to the nodes using `tags` and `nodes`</span>
<span class=linenos data-linenos="791 "></span><span class=sd>              - if `from_tags` is False or `tags` is None, set training_data to None (no training_data set yet,</span>
<span class=linenos data-linenos="792 "></span><span class=sd>                experiment is not fully initialized and cannot be launched)</span>
<span class=linenos data-linenos="793 "></span><span class=sd>        from_tags: If True, query nodes for datasets when no `training_data` is provided.</span>
<span class=linenos data-linenos="794 "></span><span class=sd>            Not used when `training_data` is provided.</span>
<span class=linenos data-linenos="795 "></span>
<span class=linenos data-linenos="796 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="797 "></span><span class=sd>        Nodes and dataset with meta-data</span>
<span class=linenos data-linenos="798 "></span>
<span class=linenos data-linenos="799 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="800 "></span><span class=sd>        FedbiomedExperimentError : bad training_data type</span>
<span class=linenos data-linenos="801 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="802 "></span>    <span class=c1># we can trust _reqs _tags _nodes are existing and properly typed/formatted</span>
<span class=linenos data-linenos="803 "></span>
<span class=linenos data-linenos="804 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>from_tags</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="805 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `from_tags` : got </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>from_tags</span><span class=p>)</span><span class=si>}</span><span class=s1> but expected a boolean&#39;</span>
<span class=linenos data-linenos="806 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="807 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="808 "></span>
<span class=linenos data-linenos="809 "></span>    <span class=c1># case where no training data are passed</span>
<span class=linenos data-linenos="810 "></span>    <span class=k>if</span> <span class=n>training_data</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>from_tags</span> <span class=ow>is</span> <span class=kc>True</span><span class=p>:</span>
<span class=linenos data-linenos="811 "></span>        <span class=c1># cannot search for training_data if tags not initialized;</span>
<span class=linenos data-linenos="812 "></span>        <span class=c1># nodes can be None (no filtering on nodes by default)</span>
<span class=linenos data-linenos="813 "></span>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="814 "></span>            <span class=n>training_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_tags</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span><span class=p>)</span>
<span class=linenos data-linenos="815 "></span>
<span class=linenos data-linenos="816 "></span>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=n>FederatedDataSet</span><span class=p>):</span>
<span class=linenos data-linenos="817 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=o>=</span> <span class=n>training_data</span>
<span class=linenos data-linenos="818 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_data</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<span class=linenos data-linenos="819 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=o>=</span> <span class=n>FederatedDataSet</span><span class=p>(</span><span class=n>training_data</span><span class=p>)</span>
<span class=linenos data-linenos="820 "></span>    <span class=k>elif</span> <span class=n>training_data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="821 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `training_data` has incorrect type: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>training_data</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="822 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="823 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="824 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="825 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="826 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experiment not fully configured yet: no training data&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="827 "></span>    <span class=c1># at this point, self._fds is either None or a FederatedDataSet object</span>
<span class=linenos data-linenos="828 "></span>
<span class=linenos data-linenos="829 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="830 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Training data changed, &#39;</span>
<span class=linenos data-linenos="831 "></span>                     <span class=s1>&#39;you may need to update `node_selection_strategy`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="832 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="833 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Training data changed, you may need to update `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="834 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_aggregator</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="835 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Training data changed, you may need to update `aggregator`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="836 "></span>
<span class=linenos data-linenos="837 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_training_plan_class class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_training_plan_class</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets <code>training_plan</code> + verification on arguments type</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>training_plan_class</code></td> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--Type_TrainingPlan, str, None--><!--fedbiomed.researcher.experiment.Type_TrainingPlan--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.experiment.Type_TrainingPlan" href="#fedbiomed.researcher.experiment.Type_TrainingPlan">Type_TrainingPlan</a><!---->, <!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>name of the training plan class (<code>str</code>) or training plan class as one of <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans"><code>TrainingPlans</code></a> to use for training. For experiment to be properly and fully defined <code>training_plan_class</code> needs to be: - a <code>str</code> when <code>training_plan_path</code> is not None (training plan class comes from a file). - a <code>Type_TrainingPlan</code> when <code>training_plan_path</code> is None (training plan class passed as argument).</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--Type_TrainingPlan, str, None--><!--fedbiomed.researcher.experiment.Type_TrainingPlan--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.experiment.Type_TrainingPlan" href="#fedbiomed.researcher.experiment.Type_TrainingPlan">Type_TrainingPlan</a><!---->, <!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p><code>training_plan_class</code> that is set for experiment</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad training_plan_class type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1054 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1055 "></span><span class=k>def</span> <span class=nf>set_training_plan_class</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>training_plan_class</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>Type_TrainingPlan</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> \
<span class=linenos data-linenos="1056 "></span>        <span class=n>Union</span><span class=p>[</span><span class=n>Type_TrainingPlan</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="1057 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets  `training_plan` + verification on arguments type</span>
<span class=linenos data-linenos="1058 "></span>
<span class=linenos data-linenos="1059 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1060 "></span><span class=sd>        training_plan_class: name of the training plan class (`str`) or training plan class as one</span>
<span class=linenos data-linenos="1061 "></span><span class=sd>            of [`TrainingPlans`] [fedbiomed.common.training_plans] to use for training.</span>
<span class=linenos data-linenos="1062 "></span><span class=sd>            For experiment to be properly and fully defined `training_plan_class` needs to be:</span>
<span class=linenos data-linenos="1063 "></span><span class=sd>                - a `str` when `training_plan_path` is not None (training plan class comes from a file).</span>
<span class=linenos data-linenos="1064 "></span><span class=sd>                - a `Type_TrainingPlan` when `training_plan_path` is None (training plan class passed</span>
<span class=linenos data-linenos="1065 "></span><span class=sd>                as argument).</span>
<span class=linenos data-linenos="1066 "></span>
<span class=linenos data-linenos="1067 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1068 "></span><span class=sd>        `training_plan_class` that is set for experiment</span>
<span class=linenos data-linenos="1069 "></span>
<span class=linenos data-linenos="1070 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1071 "></span><span class=sd>        FedbiomedExperimentError : bad training_plan_class type</span>
<span class=linenos data-linenos="1072 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1073 "></span>    <span class=k>if</span> <span class=n>training_plan_class</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1074 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1075 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_is_defined</span> <span class=o>=</span> <span class=kc>False</span>
<span class=linenos data-linenos="1076 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="1077 "></span>        <span class=k>if</span> <span class=nb>str</span><span class=o>.</span><span class=n>isidentifier</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>):</span>
<span class=linenos data-linenos="1078 "></span>            <span class=c1># correct python identifier</span>
<span class=linenos data-linenos="1079 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span> <span class=o>=</span> <span class=n>training_plan_class</span>
<span class=linenos data-linenos="1080 "></span>            <span class=c1># training_plan_class_path may not be defined at this point</span>
<span class=linenos data-linenos="1081 "></span>
<span class=linenos data-linenos="1082 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_is_defined</span> <span class=o>=</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span>
<span class=linenos data-linenos="1083 "></span>
<span class=linenos data-linenos="1084 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1085 "></span>            <span class=c1># bad identifier</span>
<span class=linenos data-linenos="1086 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `training_plan_class` : </span><span class=si>{</span><span class=n>training_plan_class</span><span class=si>}</span><span class=s1> bad identifier&#39;</span>
<span class=linenos data-linenos="1087 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1088 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1089 "></span>    <span class=k>elif</span> <span class=n>inspect</span><span class=o>.</span><span class=n>isclass</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>):</span>
<span class=linenos data-linenos="1090 "></span>        <span class=c1># training_plan_class must be a subclass of a valid training plan</span>
<span class=linenos data-linenos="1091 "></span>        <span class=k>if</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>,</span> <span class=n>training_plans</span><span class=p>):</span>
<span class=linenos data-linenos="1092 "></span>            <span class=c1># valid class</span>
<span class=linenos data-linenos="1093 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span> <span class=o>=</span> <span class=n>training_plan_class</span>
<span class=linenos data-linenos="1094 "></span>            <span class=c1># training_plan_class_path may not be defined at this point</span>
<span class=linenos data-linenos="1095 "></span>
<span class=linenos data-linenos="1096 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_is_defined</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span> <span class=ow>is</span> <span class=kc>None</span>
<span class=linenos data-linenos="1097 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1098 "></span>            <span class=c1># bad class</span>
<span class=linenos data-linenos="1099 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `training_plan_class` : </span><span class=si>{</span><span class=n>training_plan_class</span><span class=si>}</span><span class=s1> class&#39;</span>
<span class=linenos data-linenos="1100 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1101 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1102 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1103 "></span>        <span class=c1># bad type</span>
<span class=linenos data-linenos="1104 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=sa>f</span><span class=s1>&#39; `training_plan_class` of type: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>training_plan_class</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1105 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1106 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1107 "></span>
<span class=linenos data-linenos="1108 "></span>        <span class=c1># self._training_plan_is_defined and self._training_plan_class always exist at this point</span>
<span class=linenos data-linenos="1109 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_is_defined</span><span class=p>:</span>
<span class=linenos data-linenos="1110 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Experiment not fully configured yet: no valid training plan, &#39;</span>
<span class=linenos data-linenos="1111 "></span>                     <span class=sa>f</span><span class=s1>&#39;training_plan_class=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=si>}</span><span class=s1> &#39;</span>
<span class=linenos data-linenos="1112 "></span>                     <span class=sa>f</span><span class=s1>&#39;training_plan_class_path=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1113 "></span>
<span class=linenos data-linenos="1114 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1115 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation training_plan changed, you may need to update `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1116 "></span>
<span class=linenos data-linenos="1117 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.set_training_plan_path class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>set_training_plan_path</span><span class=p>(</span><span class=n>training_plan_path</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Sets <code>training_plan_path</code> + verification on arguments type.</p> <p>Training plan path is the path where training plan class is saved as python script/module externally.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>training_plan_path</code></td> <td> <code><!---->Union[str, None]) </code> </td> <td><p>path to a file containing training plan code (<code>str</code>) or None (no file containing training plan code, <code>training_plan</code> needs to be a class matching one of <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans"><code>training_plans</code></a></p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--str, None--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>The path that is set for retrieving module where training plan class is defined</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad training_plan_path type</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1119 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1120 "></span><span class=k>def</span> <span class=nf>set_training_plan_path</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>training_plan_path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="1121 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Sets `training_plan_path` + verification on arguments type.</span>
<span class=linenos data-linenos="1122 "></span>
<span class=linenos data-linenos="1123 "></span><span class=sd>    Training plan path is the path where training plan class is saved as python script/module externally.</span>
<span class=linenos data-linenos="1124 "></span>
<span class=linenos data-linenos="1125 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1126 "></span><span class=sd>        training_plan_path (Union[str, None]) : path to a file containing  training plan code (`str`) or None</span>
<span class=linenos data-linenos="1127 "></span><span class=sd>            (no file containing training plan code, `training_plan` needs to be a class matching one</span>
<span class=linenos data-linenos="1128 "></span><span class=sd>            of [`training_plans`][fedbiomed.common.training_plans]</span>
<span class=linenos data-linenos="1129 "></span>
<span class=linenos data-linenos="1130 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1131 "></span><span class=sd>        The path that is set for retrieving module where training plan class is defined</span>
<span class=linenos data-linenos="1132 "></span>
<span class=linenos data-linenos="1133 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1134 "></span><span class=sd>        FedbiomedExperimentError : bad training_plan_path type</span>
<span class=linenos data-linenos="1135 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1136 "></span>    <span class=c1># self._training_plan and self._training_plan_is_defined already exist when entering this function</span>
<span class=linenos data-linenos="1137 "></span>
<span class=linenos data-linenos="1138 "></span>    <span class=k>if</span> <span class=n>training_plan_path</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1139 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span> <span class=o>=</span> <span class=kc>None</span>
<span class=linenos data-linenos="1140 "></span>        <span class=c1># .. so training plan is defined if it is a class (+ then, it has been tested as valid)</span>
<span class=linenos data-linenos="1141 "></span>        <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_is_defined</span> <span class=o>=</span> <span class=n>inspect</span><span class=o>.</span><span class=n>isclass</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=p>)</span>
<span class=linenos data-linenos="1142 "></span>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>training_plan_path</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<span class=linenos data-linenos="1143 "></span>        <span class=k>if</span> <span class=n>sanitize_filepath</span><span class=p>(</span><span class=n>training_plan_path</span><span class=p>,</span> <span class=n>platform</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>)</span> <span class=o>==</span> <span class=n>training_plan_path</span> \
<span class=linenos data-linenos="1144 "></span>                <span class=ow>and</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isfile</span><span class=p>(</span><span class=n>training_plan_path</span><span class=p>):</span>
<span class=linenos data-linenos="1145 "></span>            <span class=c1># provided training plan path is a sane path to an existing file</span>
<span class=linenos data-linenos="1146 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span> <span class=o>=</span> <span class=n>training_plan_path</span>
<span class=linenos data-linenos="1147 "></span>            <span class=c1># if providing a training plan path, we expect a training plan class name (not a class)</span>
<span class=linenos data-linenos="1148 "></span>            <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_is_defined</span> <span class=o>=</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span>
<span class=linenos data-linenos="1149 "></span>        <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1150 "></span>            <span class=c1># bad filepath</span>
<span class=linenos data-linenos="1151 "></span>            <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1152 "></span>                <span class=sa>f</span><span class=s1>&#39; `training_plan_path` : </span><span class=si>{</span><span class=n>training_plan_path</span><span class=si>}</span><span class=s1> is not a same path to an existing file&#39;</span>
<span class=linenos data-linenos="1153 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1154 "></span>            <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1155 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="1156 "></span>        <span class=c1># bad type</span>
<span class=linenos data-linenos="1157 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> <span class=s1>&#39; `training_plan_path` must be string, &#39;</span> \
<span class=linenos data-linenos="1158 "></span>                                         <span class=sa>f</span><span class=s1>&#39;but got type: </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>training_plan_path</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1159 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1160 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1161 "></span>
<span class=linenos data-linenos="1162 "></span>    <span class=c1># self._training_plan_path is also defined at this point</span>
<span class=linenos data-linenos="1163 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_is_defined</span><span class=p>:</span>
<span class=linenos data-linenos="1164 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Experiment not fully configured yet: no valid training plan, &#39;</span>
<span class=linenos data-linenos="1165 "></span>                     <span class=sa>f</span><span class=s1>&#39;training_plan=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span><span class=si>}</span><span class=s1> training_plan_path=</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1166 "></span>
<span class=linenos data-linenos="1167 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1168 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;Experimentation training_plan_path changed, you may need to update `job`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="1169 "></span>
<span class=linenos data-linenos="1170 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.strategy class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>strategy</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the class that represents the node selection strategy.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_strategy"><code>set_strategy</code></a> to set or update node selection strategy.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--Strategy, None--><!--fedbiomed.researcher.strategies.strategy.Strategy--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.strategies.strategy.Strategy" href="../strategies/#fedbiomed.researcher.strategies.Strategy">Strategy</a><!---->, <!---->None<!---->]</code> </td> <td><p>A class or object as an instance of <a class="autorefs autorefs-internal" href="../strategies/#fedbiomed.researcher.strategies.Strategy"><code>Strategy</code></a>. <code>None</code> if it is not declared yet. It means that node selection strategy will be <a class="autorefs autorefs-internal" href="../strategies/#fedbiomed.researcher.strategies.DefaultStrategy"><code>DefaultStrategy</code></a>.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="347 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="348 "></span><span class=k>def</span> <span class=nf>strategy</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>Strategy</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="349 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the class that represents the node selection strategy.</span>
<span class=linenos data-linenos="350 "></span>
<span class=linenos data-linenos="351 "></span><span class=sd>    Please see also [`set_strategy`][fedbiomed.researcher.experiment.Experiment.set_strategy] to set or update</span>
<span class=linenos data-linenos="352 "></span><span class=sd>    node selection strategy.</span>
<span class=linenos data-linenos="353 "></span>
<span class=linenos data-linenos="354 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="355 "></span><span class=sd>        A class or object as an instance of [`Strategy`][fedbiomed.researcher.strategies.Strategy]. `None` if</span>
<span class=linenos data-linenos="356 "></span><span class=sd>            it is not declared yet. It means that node selection strategy will be</span>
<span class=linenos data-linenos="357 "></span><span class=sd>            [`DefaultStrategy`][fedbiomed.researcher.strategies.DefaultStrategy].</span>
<span class=linenos data-linenos="358 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="359 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_node_selection_strategy</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.tags class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>tags</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the tags from the experiment object.</p> <p>Please see <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_tags"><code>set_tags</code></a> to set tags.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!----><!--List[str]--><!--typing.List--><a class="autorefs autorefs-external" title="typing.List" href="https://docs.python.org/3/library/typing.html#typing.List">List</a><!---->[<!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->]<!---->, <!---->None<!---->]</code> </td> <td><p>List of tags that has been set. <code>None</code> if it isn't declare yet.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="300 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="301 "></span><span class=k>def</span> <span class=nf>tags</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="302 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the tags from the experiment object.</span>
<span class=linenos data-linenos="303 "></span>
<span class=linenos data-linenos="304 "></span><span class=sd>    Please see [`set_tags`][fedbiomed.researcher.experiment.Experiment.set_tags] to set tags.</span>
<span class=linenos data-linenos="305 "></span>
<span class=linenos data-linenos="306 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="307 "></span><span class=sd>        List of tags that has been set. `None` if it isn&#39;t declare yet.</span>
<span class=linenos data-linenos="308 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="309 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tags</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.test_metric class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>test_metric</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the metric for validation routine.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_test_metric"><code>set_test_metric</code></a> to change/set <code>test_metric</code></p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--MetricTypes, str, None--><!--fedbiomed.common.metrics.MetricTypes--><a class="autorefs autorefs-internal" title="fedbiomed.common.metrics.MetricTypes" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes">MetricTypes</a><!---->, <!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>A class as an instance of <a class="autorefs autorefs-internal" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes"><code>MetricTypes</code></a>. <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> for referring one of metric which provided as attributes in <a class="autorefs autorefs-internal" href="../../common/metrics/#fedbiomed.common.metrics.MetricTypes"><code>MetricTypes</code></a>. None, if it isn't declared yet.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="474 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="475 "></span><span class=k>def</span> <span class=nf>test_metric</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>MetricTypes</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="476 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the metric for validation routine.</span>
<span class=linenos data-linenos="477 "></span>
<span class=linenos data-linenos="478 "></span><span class=sd>    Please see also [`set_test_metric`][fedbiomed.researcher.experiment.Experiment.set_test_metric]</span>
<span class=linenos data-linenos="479 "></span><span class=sd>        to change/set `test_metric`</span>
<span class=linenos data-linenos="480 "></span>
<span class=linenos data-linenos="481 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="482 "></span><span class=sd>        A class as an instance of [`MetricTypes`][fedbiomed.common.metrics.MetricTypes]. [`str`][str] for referring</span>
<span class=linenos data-linenos="483 "></span><span class=sd>            one of  metric which provided as attributes in [`MetricTypes`][fedbiomed.common.metrics.MetricTypes].</span>
<span class=linenos data-linenos="484 "></span><span class=sd>            None, if it isn&#39;t declared yet.</span>
<span class=linenos data-linenos="485 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="486 "></span>
<span class=linenos data-linenos="487 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_metric&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.test_metric_args class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>test_metric_args</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the metric argument for the metric function that is going to be used.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_test_metric"><code>set_test_metric</code></a> to change/set <code>test_metric</code> and get more information on the arguments can be used.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Dict--><a class="autorefs autorefs-external" title="typing.Dict" href="https://docs.python.org/3/library/typing.html#typing.Dict">Dict</a><!---->[<!--str, Any--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!--typing.Any--><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a><!---->]</code> </td> <td><p>A dictionary that contains arguments for metric function. See <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_test_metric"><code>set_test_metric</code></a></p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="489 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="490 "></span><span class=k>def</span> <span class=nf>test_metric_args</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
<span class=linenos data-linenos="491 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the metric argument for the metric function that is going to be used.</span>
<span class=linenos data-linenos="492 "></span>
<span class=linenos data-linenos="493 "></span><span class=sd>    Please see also [`set_test_metric`][fedbiomed.researcher.experiment.Experiment.set_test_metric] to change/set</span>
<span class=linenos data-linenos="494 "></span><span class=sd>    `test_metric` and get more information on the arguments can be used.</span>
<span class=linenos data-linenos="495 "></span>
<span class=linenos data-linenos="496 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="497 "></span><span class=sd>        A dictionary that contains arguments for metric function. See [`set_test_metric`]</span>
<span class=linenos data-linenos="498 "></span><span class=sd>            [fedbiomed.researcher.experiment.Experiment.set_test_metric]</span>
<span class=linenos data-linenos="499 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="500 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_metric_args&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.test_on_global_updates class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>test_on_global_updates</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the status of whether validation will be performed on globally updated (aggregated) parameters by the nodes at the beginning of each round.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_test_on_global_updates"><code>set_test_on_global_updates</code></a>.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>True, if validation is active on globally updated (aggregated) parameters. False for vice versa.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="516 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="517 "></span><span class=k>def</span> <span class=nf>test_on_global_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="518 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Retrieves the status of whether validation will be performed on globally updated (aggregated)</span>
<span class=linenos data-linenos="519 "></span><span class=sd>    parameters by the nodes at the beginning of each round.</span>
<span class=linenos data-linenos="520 "></span>
<span class=linenos data-linenos="521 "></span><span class=sd>    Please see also [`set_test_on_global_updates`]</span>
<span class=linenos data-linenos="522 "></span><span class=sd>    [fedbiomed.researcher.experiment.Experiment.set_test_on_global_updates].</span>
<span class=linenos data-linenos="523 "></span>
<span class=linenos data-linenos="524 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="525 "></span><span class=sd>        True, if validation is active on globally updated (aggregated) parameters. False for vice versa.</span>
<span class=linenos data-linenos="526 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="527 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_global_updates&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.test_on_local_updates class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>test_on_local_updates</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the status of whether validation will be performed on locally updated parameters by the nodes at the end of each round.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_test_on_local_updates"><code>set_test_on_local_updates</code></a>.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>True, if validation is active on locally updated parameters. False for vice versa.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="502 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="503 "></span><span class=k>def</span> <span class=nf>test_on_local_updates</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=linenos data-linenos="504 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the status of whether validation will be performed on locally updated parameters by</span>
<span class=linenos data-linenos="505 "></span><span class=sd>    the nodes at the end of each round.</span>
<span class=linenos data-linenos="506 "></span>
<span class=linenos data-linenos="507 "></span><span class=sd>    Please see also</span>
<span class=linenos data-linenos="508 "></span><span class=sd>        [`set_test_on_local_updates`][fedbiomed.researcher.experiment.Experiment.set_test_on_local_updates].</span>
<span class=linenos data-linenos="509 "></span>
<span class=linenos data-linenos="510 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="511 "></span><span class=sd>        True, if validation is active on locally updated parameters. False for vice versa.</span>
<span class=linenos data-linenos="512 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="513 "></span>
<span class=linenos data-linenos="514 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_on_local_updates&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.test_ratio class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>test_ratio</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the ratio for validation partition of entire dataset.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_test_ratio"><code>set_test_ratio</code></a> to change/set <code>test_ratio</code></p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--float--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code> </td> <td><p>The ratio for validation part, <code>1 - test_ratio</code> is ratio for training set.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="461 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="462 "></span><span class=k>def</span> <span class=nf>test_ratio</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
<span class=linenos data-linenos="463 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the ratio for validation partition of entire dataset.</span>
<span class=linenos data-linenos="464 "></span>
<span class=linenos data-linenos="465 "></span><span class=sd>    Please see also [`set_test_ratio`][fedbiomed.researcher.experiment.Experiment.set_test_ratio] to</span>
<span class=linenos data-linenos="466 "></span><span class=sd>        change/set `test_ratio`</span>
<span class=linenos data-linenos="467 "></span>
<span class=linenos data-linenos="468 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="469 "></span><span class=sd>        The ratio for validation part, `1 - test_ratio` is ratio for training set.</span>
<span class=linenos data-linenos="470 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="471 "></span>
<span class=linenos data-linenos="472 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=p>[</span><span class=s1>&#39;test_ratio&#39;</span><span class=p>]</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.training_args class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>training_args</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves training arguments.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_training_args"><code>set_training_args</code></a></p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>The arguments that are going to be passed to <code>training_routine</code> of <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans"><code>training_plans</code></a> classes to perfom training on the node side. An example training routine: <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans._torchnn.TorchTrainingPlan.training_routine"><code>TorchTrainingPlan.training_routine</code></a></p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="446 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="447 "></span><span class=k>def</span> <span class=nf>training_args</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="448 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves training arguments.</span>
<span class=linenos data-linenos="449 "></span>
<span class=linenos data-linenos="450 "></span><span class=sd>    Please see also [`set_training_args`][fedbiomed.researcher.experiment.Experiment.set_training_args]</span>
<span class=linenos data-linenos="451 "></span>
<span class=linenos data-linenos="452 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="453 "></span><span class=sd>        The arguments that are going to be passed to `training_routine` of [`training_plans`]</span>
<span class=linenos data-linenos="454 "></span><span class=sd>            [fedbiomed.common.training_plans] classes to perfom training on the node side.</span>
<span class=linenos data-linenos="455 "></span><span class=sd>            An example training routine: [`TorchTrainingPlan.training_routine`]</span>
<span class=linenos data-linenos="456 "></span><span class=sd>            [fedbiomed.common.training_plans.TorchTrainingPlan.training_routine]</span>
<span class=linenos data-linenos="457 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="458 "></span>
<span class=linenos data-linenos="459 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_args</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.training_data class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>training_data</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the training data which is an instance of <a class="autorefs autorefs-internal" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet"><code>FederatedDataset</code></a></p> <p>Please see <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_training_data"><code>set_training_data</code></a> to set or update training data.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--FederatedDataSet, None--><!--fedbiomed.researcher.datasets.FederatedDataSet--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.datasets.FederatedDataSet" href="../datasets/#fedbiomed.researcher.datasets.FederatedDataSet">FederatedDataSet</a><!---->, <!---->None<!---->]</code> </td> <td><p>Object that contains meta-data for the datasets of each node. <code>None</code> if it isn't set yet.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="322 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="323 "></span><span class=k>def</span> <span class=nf>training_data</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>FederatedDataSet</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="324 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the training data which is an instance of [`FederatedDataset`]</span>
<span class=linenos data-linenos="325 "></span><span class=sd>    [fedbiomed.researcher.datasets.FederatedDataSet]</span>
<span class=linenos data-linenos="326 "></span>
<span class=linenos data-linenos="327 "></span><span class=sd>    Please see [`set_training_data`][fedbiomed.researcher.experiment.Experiment.set_training_data] to set or</span>
<span class=linenos data-linenos="328 "></span><span class=sd>    update training data.</span>
<span class=linenos data-linenos="329 "></span>
<span class=linenos data-linenos="330 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="331 "></span><span class=sd>        Object that contains meta-data for the datasets of each node. `None` if it isn&#39;t set yet.</span>
<span class=linenos data-linenos="332 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="333 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fds</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.training_plan class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>training_plan</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves training plan instance that has been built and send the nodes through HTTP restfull service for each round of training.</p> <div class="admonition info"> <p class=admonition-title>Loading aggregated parameters</p> <p>After retrieving the training plan instance aggregated parameters should be loaded. Example: <div class=highlight><pre><span></span><code><span class=n>training_plan</span> <span class=o>=</span> <span class=n>exp</span><span class=o>.</span><span class=n>training_plan</span><span class=p>()</span>
<span class=n>training_plan</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>load_state_dict</span><span class=p>(</span><span class=n>exp</span><span class=o>.</span><span class=n>aggregated_params</span><span class=p>()[</span><span class=n>rounds</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=s1>&#39;params&#39;</span><span class=p>])</span>
</code></pre></div></p> </div> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--TrainingPlan, None--><!--fedbiomed.researcher.experiment.TrainingPlan--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.experiment.TrainingPlan" href="#fedbiomed.researcher.experiment.TrainingPlan">TrainingPlan</a><!---->, <!---->None<!---->]</code> </td> <td><p>Training plan object which is an instance one of <a class="autorefs autorefs-internal" href="../../common/training_plans/#fedbiomed.common.training_plans">training_plans</a>.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="594 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="595 "></span><span class=k>def</span> <span class=nf>training_plan</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>TrainingPlan</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="596 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; Retrieves training plan instance that has been built and send the nodes through HTTP restfull service</span>
<span class=linenos data-linenos="597 "></span><span class=sd>    for each round of training.</span>
<span class=linenos data-linenos="598 "></span>
<span class=linenos data-linenos="599 "></span><span class=sd>    !!! info &quot;Loading aggregated parameters&quot;</span>
<span class=linenos data-linenos="600 "></span><span class=sd>        After retrieving the training plan instance aggregated parameters should be loaded.</span>
<span class=linenos data-linenos="601 "></span><span class=sd>        Example:</span>
<span class=linenos data-linenos="602 "></span><span class=sd>        ```python</span>
<span class=linenos data-linenos="603 "></span><span class=sd>        training_plan = exp.training_plan()</span>
<span class=linenos data-linenos="604 "></span><span class=sd>        training_plan.model.load_state_dict(exp.aggregated_params()[rounds - 1][&#39;params&#39;])</span>
<span class=linenos data-linenos="605 "></span><span class=sd>        ```</span>
<span class=linenos data-linenos="606 "></span>
<span class=linenos data-linenos="607 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="608 "></span><span class=sd>        Training plan object which is an instance one of [training_plans][fedbiomed.common.training_plans].</span>
<span class=linenos data-linenos="609 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="610 "></span>    <span class=c1># at this point `job` is defined but may be None</span>
<span class=linenos data-linenos="611 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="612 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s1>&#39;No `job` defined for experiment, cannot get `training_plan`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="613 "></span>        <span class=k>return</span> <span class=kc>None</span>
<span class=linenos data-linenos="614 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="615 "></span>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.training_plan_approve class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>training_plan_approve</span><span class=p>(</span><span class=n>training_plan</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s1>&#39;no description provided&#39;</span><span class=p>,</span> <span class=n>nodes</span><span class=o>=</span><span class=p>[],</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Send a training plan and a ApprovalRequest message to node(s).</p> <p>This is a simple redirect to the Requests.training_plan_approve() method.</p> <p>If a list of node id(s) is provided, the message will be individually sent to all nodes of the list. If the node id(s) list is None (default), the message is broadcast to all nodes.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>training_plan</code></td> <td> <code><!--fedbiomed.common.training_plans.BaseTrainingPlan--><a class="autorefs autorefs-internal" title="fedbiomed.common.training_plans.BaseTrainingPlan" href="../../common/training_plans/#fedbiomed.common.training_plans.BaseTrainingPlan">BaseTrainingPlan</a></code> </td> <td><p>the training plan to upload and send to the nodes for approval. It can be: - a path_name (str) - a training_plan (class) - an instance of a training plan</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>nodes</code></td> <td> <code><!--list--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code> </td> <td><p>list of nodes (specified by their UUID)</p></td> <td> <code><!---->[]</code> </td> </tr> <tr> <td><code>description</code></td> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>Description for training plan approve request</p></td> <td> <code><!---->&#39;no description provided&#39;</code> </td> </tr> <tr> <td><code>timeout</code></td> <td> <code><!--int--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </td> <td><p>maximum waiting time for the answers</p></td> <td> <code><!---->5</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td></td> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>a dictionary of pairs (node_id: status), where status indicates to the researcher</p></td> </tr> <tr> <td></td> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>that the training plan has been correctly downloaded on the node side.</p></td> </tr> <tr> <td><code>Warning</code></td> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>status does not mean that the training plan is approved, only that it has been added</p></td> </tr> <tr> <td></td> <td> <code><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code> </td> <td><p>to the "approval queue" on the node side.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="2160 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="2161 "></span><span class=k>def</span> <span class=nf>training_plan_approve</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
<span class=linenos data-linenos="2162 "></span>                          <span class=n>training_plan</span><span class=p>:</span> <span class=s1>&#39;BaseTrainingPlan&#39;</span><span class=p>,</span>
<span class=linenos data-linenos="2163 "></span>                          <span class=n>description</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;no description provided&quot;</span><span class=p>,</span>
<span class=linenos data-linenos="2164 "></span>                          <span class=n>nodes</span><span class=p>:</span> <span class=nb>list</span> <span class=o>=</span> <span class=p>[],</span>
<span class=linenos data-linenos="2165 "></span>                          <span class=n>timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>5</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<span class=linenos data-linenos="2166 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Send a training plan and a ApprovalRequest message to node(s).</span>
<span class=linenos data-linenos="2167 "></span>
<span class=linenos data-linenos="2168 "></span><span class=sd>    This is a simple redirect to the Requests.training_plan_approve() method.</span>
<span class=linenos data-linenos="2169 "></span>
<span class=linenos data-linenos="2170 "></span><span class=sd>    If a list of node id(s) is provided, the message will be individually sent</span>
<span class=linenos data-linenos="2171 "></span><span class=sd>    to all nodes of the list.</span>
<span class=linenos data-linenos="2172 "></span><span class=sd>    If the node id(s) list is None (default), the message is broadcast to all nodes.</span>
<span class=linenos data-linenos="2173 "></span>
<span class=linenos data-linenos="2174 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="2175 "></span><span class=sd>        training_plan: the training plan to upload and send to the nodes for approval.</span>
<span class=linenos data-linenos="2176 "></span><span class=sd>               It can be:</span>
<span class=linenos data-linenos="2177 "></span><span class=sd>               - a path_name (str)</span>
<span class=linenos data-linenos="2178 "></span><span class=sd>               - a training_plan (class)</span>
<span class=linenos data-linenos="2179 "></span><span class=sd>               - an instance of a training plan</span>
<span class=linenos data-linenos="2180 "></span><span class=sd>        nodes: list of nodes (specified by their UUID)</span>
<span class=linenos data-linenos="2181 "></span><span class=sd>        description: Description for training plan approve request</span>
<span class=linenos data-linenos="2182 "></span><span class=sd>        timeout: maximum waiting time for the answers</span>
<span class=linenos data-linenos="2183 "></span>
<span class=linenos data-linenos="2184 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="2185 "></span><span class=sd>        a dictionary of pairs (node_id: status), where status indicates to the researcher</span>
<span class=linenos data-linenos="2186 "></span><span class=sd>        that the training plan has been correctly downloaded on the node side.</span>
<span class=linenos data-linenos="2187 "></span><span class=sd>        Warning: status does not mean that the training plan is approved, only that it has been added</span>
<span class=linenos data-linenos="2188 "></span><span class=sd>        to the &quot;approval queue&quot; on the node side.</span>
<span class=linenos data-linenos="2189 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="2190 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_reqs</span><span class=o>.</span><span class=n>training_plan_approve</span><span class=p>(</span><span class=n>training_plan</span><span class=p>,</span>
<span class=linenos data-linenos="2191 "></span>                                            <span class=n>description</span><span class=p>,</span>
<span class=linenos data-linenos="2192 "></span>                                            <span class=n>nodes</span><span class=p>,</span>
<span class=linenos data-linenos="2193 "></span>                                            <span class=n>timeout</span><span class=p>)</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.training_plan_class class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>training_plan_class</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves the training plan (training plan class) that is created for training.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_training_plan_class"><code>set_training_plan_class</code></a>.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--Type_TrainingPlan, str, None--><!--fedbiomed.researcher.experiment.Type_TrainingPlan--><a class="autorefs autorefs-internal" title="fedbiomed.researcher.experiment.Type_TrainingPlan" href="#fedbiomed.researcher.experiment.Type_TrainingPlan">Type_TrainingPlan</a><!---->, <!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>Training plan class as one of <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Type_TrainingPlan"><code>Type_TrainingPlan</code></a>. None if it isn't declared yet. <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str"><code>str</code></a> if <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.training_plan_path"><code>training_plan_path</code></a>that represents training plan class created externally is provided.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="406 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="407 "></span><span class=k>def</span> <span class=nf>training_plan_class</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>Type_TrainingPlan</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="408 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves the training plan (training plan class) that is created for training.</span>
<span class=linenos data-linenos="409 "></span>
<span class=linenos data-linenos="410 "></span><span class=sd>    Please see also [`set_training_plan_class`][fedbiomed.researcher.experiment.Experiment.set_training_plan_class].</span>
<span class=linenos data-linenos="411 "></span>
<span class=linenos data-linenos="412 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="413 "></span><span class=sd>        Training plan class as one of [`Type_TrainingPlan`][fedbiomed.researcher.experiment.Type_TrainingPlan]. None</span>
<span class=linenos data-linenos="414 "></span><span class=sd>            if it isn&#39;t declared yet. [`str`][str] if [`training_plan_path`]</span>
<span class=linenos data-linenos="415 "></span><span class=sd>            [fedbiomed.researcher.experiment.Experiment.training_plan_path]that represents training plan class</span>
<span class=linenos data-linenos="416 "></span><span class=sd>            created externally is provided.</span>
<span class=linenos data-linenos="417 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="418 "></span>
<span class=linenos data-linenos="419 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_class</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.training_plan_file class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>training_plan_file</span><span class=p>(</span><span class=n>display</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>This method displays saved final training plan for the experiment that will be sent to the nodes for training.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>display</code></td> <td> <code><!--bool--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </td> <td><p>If <code>True</code>, prints content of the training plan file. Default is <code>True</code></p></td> <td> <code><!---->True</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </td> <td><p>Path to training plan file</p></td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!--fedbiomed.common.exceptions.FedbiomedExperimentError--><a class="autorefs autorefs-internal" title="fedbiomed.common.exceptions.FedbiomedExperimentError" href="../../common/exceptions/#fedbiomed.common.exceptions.FedbiomedExperimentError">FedbiomedExperimentError</a></code> </td> <td><p>bad argument type, or cannot read training plan file content</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="1712 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="1713 "></span><span class=k>def</span> <span class=nf>training_plan_file</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>display</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=linenos data-linenos="1714 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot; This method displays saved final training plan for the experiment</span>
<span class=linenos data-linenos="1715 "></span><span class=sd>        that will be sent to the nodes for training.</span>
<span class=linenos data-linenos="1716 "></span>
<span class=linenos data-linenos="1717 "></span><span class=sd>    Args:</span>
<span class=linenos data-linenos="1718 "></span><span class=sd>        display: If `True`, prints content of the training plan file. Default is `True`</span>
<span class=linenos data-linenos="1719 "></span>
<span class=linenos data-linenos="1720 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="1721 "></span><span class=sd>        Path to training plan file</span>
<span class=linenos data-linenos="1722 "></span>
<span class=linenos data-linenos="1723 "></span><span class=sd>    Raises:</span>
<span class=linenos data-linenos="1724 "></span><span class=sd>        FedbiomedExperimentError: bad argument type, or cannot read training plan file content</span>
<span class=linenos data-linenos="1725 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="1726 "></span>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>display</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
<span class=linenos data-linenos="1727 "></span>        <span class=c1># bad type</span>
<span class=linenos data-linenos="1728 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB410</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1729 "></span>            <span class=sa>f</span><span class=s1>&#39;, in method `training_plan_file` param `display` : type </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>display</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1730 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1731 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1732 "></span>
<span class=linenos data-linenos="1733 "></span>    <span class=c1># at this point, self._job exists (initialized in constructor)</span>
<span class=linenos data-linenos="1734 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="1735 "></span>        <span class=c1># cannot check training plan file if job not defined</span>
<span class=linenos data-linenos="1736 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB412</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1737 "></span>            <span class=s1>&#39;, in method `training_plan_file` : no `job` defined for experiment&#39;</span>
<span class=linenos data-linenos="1738 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1739 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1740 "></span>
<span class=linenos data-linenos="1741 "></span>    <span class=n>training_plan_file</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan_file</span>
<span class=linenos data-linenos="1742 "></span>
<span class=linenos data-linenos="1743 "></span>    <span class=c1># Display content so researcher can copy</span>
<span class=linenos data-linenos="1744 "></span>    <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos="1745 "></span>        <span class=k>if</span> <span class=n>display</span><span class=p>:</span>
<span class=linenos data-linenos="1746 "></span>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>training_plan_file</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
<span class=linenos data-linenos="1747 "></span>                <span class=n>content</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<span class=linenos data-linenos="1748 "></span>                <span class=n>file</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
<span class=linenos data-linenos="1749 "></span>                <span class=nb>print</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
<span class=linenos data-linenos="1750 "></span>    <span class=k>except</span> <span class=ne>OSError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos="1751 "></span>        <span class=c1># cannot read training plan file content</span>
<span class=linenos data-linenos="1752 "></span>        <span class=n>msg</span> <span class=o>=</span> <span class=n>ErrorNumbers</span><span class=o>.</span><span class=n>FB412</span><span class=o>.</span><span class=n>value</span> <span class=o>+</span> \
<span class=linenos data-linenos="1753 "></span>            <span class=sa>f</span><span class=s1>&#39;, in method `training_plan_file` : error when reading training plan file - </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span>
<span class=linenos data-linenos="1754 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1755 "></span>        <span class=k>raise</span> <span class=n>FedbiomedExperimentError</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
<span class=linenos data-linenos="1756 "></span>
<span class=linenos data-linenos="1757 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_plan_file</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.training_plan_path class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>training_plan_path</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves training plan path where training plan class is saved as python script externally.</p> <p>Please see also <a class="autorefs autorefs-internal" href="#fedbiomed.researcher.experiment.Experiment.set_training_plan_path"><code>set_training_plan_path</code></a>.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--str, None--><!--str--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a><!---->, <!---->None<!---->]</code> </td> <td><p>Path to python script (<code>.py</code>) where training plan class (training plan) is created. None if it isn't declared yet.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="421 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="422 "></span><span class=k>def</span> <span class=nf>training_plan_path</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="423 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves training plan path where training plan class is saved as python script externally.</span>
<span class=linenos data-linenos="424 "></span>
<span class=linenos data-linenos="425 "></span><span class=sd>    Please see also [`set_training_plan_path`][fedbiomed.researcher.experiment.Experiment.set_training_plan_path].</span>
<span class=linenos data-linenos="426 "></span>
<span class=linenos data-linenos="427 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="428 "></span><span class=sd>        Path to python script (`.py`) where training plan class (training plan) is created. None if it isn&#39;t</span>
<span class=linenos data-linenos="429 "></span><span class=sd>            declared yet.</span>
<span class=linenos data-linenos="430 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="431 "></span>
<span class=linenos data-linenos="432 "></span>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_training_plan_path</span>
</code></pre></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h5 id=fedbiomed.researcher.experiment.Experiment.training_replies class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>training_replies</span><span class=p>()</span>
</code></pre></div> </h5> <div class="doc doc-contents "> <p>Retrieves training replies of each round of training.</p> <p>Training replies contains timing statistics and the files parth/URLs that has been received after each round.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><!----><!--typing.Union--><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a><!---->[<!--dict, None--><!--dict--><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a><!---->, <!---->None<!---->]</code> </td> <td><p>Dictionary of training replies keys stand for each round of training. None, if <a class="autorefs autorefs-internal" href="../job/#fedbiomed.researcher.job">Job</a> isn't declared or empty dict if there is no training round has been run.</p></td> </tr> </tbody> </table> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos="574 "></span><span class=nd>@exp_exceptions</span>
<span class=linenos data-linenos="575 "></span><span class=k>def</span> <span class=nf>training_replies</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>dict</span><span class=p>,</span> <span class=kc>None</span><span class=p>]:</span>
<span class=linenos data-linenos="576 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves training replies of each round of training.</span>
<span class=linenos data-linenos="577 "></span>
<span class=linenos data-linenos="578 "></span><span class=sd>    Training replies contains timing statistics and the files parth/URLs that has been received after each round.</span>
<span class=linenos data-linenos="579 "></span>
<span class=linenos data-linenos="580 "></span><span class=sd>    Returns:</span>
<span class=linenos data-linenos="581 "></span><span class=sd>        Dictionary of training replies keys stand for each round of training. None, if</span>
<span class=linenos data-linenos="582 "></span><span class=sd>            [Job][fedbiomed.researcher.job] isn&#39;t declared or empty dict if there is no training round has been run.</span>
<span class=linenos data-linenos="583 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos="584 "></span>
<span class=linenos data-linenos="585 "></span>    <span class=c1># at this point `job` is defined but may be None</span>
<span class=linenos data-linenos="586 "></span>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<span class=linenos data-linenos="587 "></span>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s1>&#39;No `job` defined for experiment, cannot get `training_replies`&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="588 "></span>        <span class=k>return</span> <span class=kc>None</span>
<span class=linenos data-linenos="589 "></span>    <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="590 "></span>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_job</span><span class=o>.</span><span class=n>training_replies</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> <h2 id=fedbiomed.researcher.experiment-functions class=api-section-header>Functions</h2> <div class="doc doc-object doc-function"> <h3 id=fedbiomed.researcher.experiment.exp_exceptions class="doc doc-heading function"> <div class=highlight><pre><span></span><code><span class=n>exp_exceptions</span><span class=p>(</span><span class=n>function</span><span class=p>)</span>
</code></pre></div> </h3> <div class="doc doc-contents "> <p>Decorator for handling all exceptions in the Experiment class() : pretty print a message for the user, quit Experiment.</p> <details class="quote source-code"> <summary>Source code in <code>fedbiomed/researcher/experiment.py</code></summary> <div class=highlight><pre><span></span><code><span class=linenos data-linenos=" 55 "></span><span class=k>def</span> <span class=nf>exp_exceptions</span><span class=p>(</span><span class=n>function</span><span class=p>):</span>
<span class=linenos data-linenos=" 56 "></span><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=linenos data-linenos=" 57 "></span><span class=sd>    Decorator for handling all exceptions in the Experiment class() :</span>
<span class=linenos data-linenos=" 58 "></span><span class=sd>    pretty print a message for the user, quit Experiment.</span>
<span class=linenos data-linenos=" 59 "></span><span class=sd>    &quot;&quot;&quot;</span>
<span class=linenos data-linenos=" 60 "></span>
<span class=linenos data-linenos=" 61 "></span>    <span class=c1># wrap the original function catching the exceptions</span>
<span class=linenos data-linenos=" 62 "></span>    <span class=nd>@functools</span><span class=o>.</span><span class=n>wraps</span><span class=p>(</span><span class=n>function</span><span class=p>)</span>
<span class=linenos data-linenos=" 63 "></span>    <span class=k>def</span> <span class=nf>payload</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
<span class=linenos data-linenos=" 64 "></span>        <span class=n>code</span> <span class=o>=</span> <span class=mi>0</span>
<span class=linenos data-linenos=" 65 "></span>        <span class=k>try</span><span class=p>:</span>
<span class=linenos data-linenos=" 66 "></span>            <span class=n>ret</span> <span class=o>=</span> <span class=n>function</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
<span class=linenos data-linenos=" 67 "></span>        <span class=k>except</span> <span class=n>FedbiomedSilentTerminationError</span><span class=p>:</span>
<span class=linenos data-linenos=" 68 "></span>            <span class=c1># handle the case of nested calls will exception decorator</span>
<span class=linenos data-linenos=" 69 "></span>            <span class=k>raise</span>
<span class=linenos data-linenos=" 70 "></span>        <span class=k>except</span> <span class=ne>SystemExit</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos=" 71 "></span>            <span class=c1># handle the sys.exit() from other clauses</span>
<span class=linenos data-linenos=" 72 "></span>            <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
<span class=linenos data-linenos=" 73 "></span>        <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
<span class=linenos data-linenos=" 74 "></span>            <span class=n>code</span> <span class=o>=</span> <span class=mi>1</span>
<span class=linenos data-linenos=" 75 "></span>            <span class=nb>print</span><span class=p>(</span>
<span class=linenos data-linenos=" 76 "></span>                <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>--------------------&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 77 "></span>                <span class=s1>&#39;Fed-BioMed researcher stopped due to keyboard interrupt&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 78 "></span>                <span class=s1>&#39;--------------------&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 79 "></span>                <span class=n>sep</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>linesep</span><span class=p>)</span>
<span class=linenos data-linenos=" 80 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=s1>&#39;Fed-BioMed researcher stopped due to keyboard interrupt&#39;</span><span class=p>)</span>
<span class=linenos data-linenos=" 81 "></span>        <span class=k>except</span> <span class=n>FedbiomedError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos=" 82 "></span>            <span class=n>code</span> <span class=o>=</span> <span class=mi>1</span>
<span class=linenos data-linenos=" 83 "></span>            <span class=nb>print</span><span class=p>(</span>
<span class=linenos data-linenos=" 84 "></span>                <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>--------------------&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 85 "></span>                <span class=sa>f</span><span class=s1>&#39;Fed-BioMed researcher stopped due to exception:</span><span class=se>\n</span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 86 "></span>                <span class=s1>&#39;--------------------&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 87 "></span>                <span class=n>sep</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>linesep</span><span class=p>)</span>
<span class=linenos data-linenos=" 88 "></span>            <span class=c1># redundant, should be already logged when raising exception</span>
<span class=linenos data-linenos=" 89 "></span>            <span class=c1># logger.critical(f&#39;Fed-BioMed researcher stopped due to exception:\n{str(e)}&#39;)</span>
<span class=linenos data-linenos=" 90 "></span>        <span class=k>except</span> <span class=ne>BaseException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<span class=linenos data-linenos=" 91 "></span>            <span class=n>code</span> <span class=o>=</span> <span class=mi>3</span>
<span class=linenos data-linenos=" 92 "></span>            <span class=nb>print</span><span class=p>(</span>
<span class=linenos data-linenos=" 93 "></span>                <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>--------------------&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 94 "></span>                <span class=sa>f</span><span class=s1>&#39;Fed-BioMed researcher stopped due to unknown error:</span><span class=se>\n</span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 95 "></span>                <span class=s1>&#39;More details in the backtrace extract below&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 96 "></span>                <span class=s1>&#39;--------------------&#39;</span><span class=p>,</span>
<span class=linenos data-linenos=" 97 "></span>                <span class=n>sep</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>linesep</span><span class=p>)</span>
<span class=linenos data-linenos=" 98 "></span>            <span class=c1># at most 5 backtrace entries to avoid too long output</span>
<span class=linenos data-linenos=" 99 "></span>            <span class=n>traceback</span><span class=o>.</span><span class=n>print_exc</span><span class=p>(</span><span class=n>limit</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>file</span><span class=o>=</span><span class=n>sys</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
<span class=linenos data-linenos="100 "></span>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;--------------------&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="101 "></span>            <span class=n>logger</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Fed-BioMed stopped due to unknown error:</span><span class=se>\n</span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=linenos data-linenos="102 "></span>
<span class=linenos data-linenos="103 "></span>        <span class=k>if</span> <span class=n>code</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
<span class=linenos data-linenos="104 "></span>            <span class=k>if</span> <span class=n>is_ipython</span><span class=p>():</span>
<span class=linenos data-linenos="105 "></span>                <span class=c1># raise a silent specific exception, don&#39;t exit the interactive kernel</span>
<span class=linenos data-linenos="106 "></span>                <span class=k>raise</span> <span class=n>FedbiomedSilentTerminationError</span>
<span class=linenos data-linenos="107 "></span>            <span class=k>else</span><span class=p>:</span>
<span class=linenos data-linenos="108 "></span>                <span class=c1># exit the process</span>
<span class=linenos data-linenos="109 "></span>                <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
<span class=linenos data-linenos="110 "></span>
<span class=linenos data-linenos="111 "></span>        <span class=k>return</span> <span class=n>ret</span>
<span class=linenos data-linenos="112 "></span>
<span class=linenos data-linenos="113 "></span>    <span class=k>return</span> <span class=n>payload</span>
</code></pre></div> </details> </div> </div> </div> </div> </div> </div> </div> <div class=right-col> <div id=right-sidebar class=sidebar-right> <nav class=toc> <!-- Render item list --> <label class=toc-title for=__toc> <span class=toc-icon></span> </label> <ul class=toc-list data-md-component=toc data-md-scrollfix> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.TExperiment class=md-nav__link> TExperiment </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.TrainingPlan class=md-nav__link> TrainingPlan </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Type_TrainingPlan class=md-nav__link> Type_TrainingPlan </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.training_plans class=md-nav__link> training_plans </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment-classes class=md-nav__link> Classes </a> <nav class=toc-nav aria-label=Classes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment class=md-nav__link> Experiment </a> <nav class=toc-nav aria-label=Experiment> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment-attributes class=md-nav__link> Attributes </a> <nav class=toc-nav aria-label=Attributes> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.aggregator_args class=md-nav__link> aggregator_args </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.secagg class=md-nav__link> secagg </a> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.aggregated_params class=md-nav__link> aggregated_params() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.aggregator class=md-nav__link> aggregator() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.breakpoint class=md-nav__link> breakpoint() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.check_training_plan_status class=md-nav__link> check_training_plan_status() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.experimentation_folder class=md-nav__link> experimentation_folder() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.experimentation_path class=md-nav__link> experimentation_path() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.info class=md-nav__link> info() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.job class=md-nav__link> job() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.load_breakpoint class=md-nav__link> load_breakpoint() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.model_args class=md-nav__link> model_args() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.monitor class=md-nav__link> monitor() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.nodes class=md-nav__link> nodes() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.round_current class=md-nav__link> round_current() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.round_limit class=md-nav__link> round_limit() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.run class=md-nav__link> run() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.run_once class=md-nav__link> run_once() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.save_breakpoints class=md-nav__link> save_breakpoints() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_aggregator class=md-nav__link> set_aggregator() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_experimentation_folder class=md-nav__link> set_experimentation_folder() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_job class=md-nav__link> set_job() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_model_args class=md-nav__link> set_model_args() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_nodes class=md-nav__link> set_nodes() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_round_limit class=md-nav__link> set_round_limit() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_save_breakpoints class=md-nav__link> set_save_breakpoints() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_secagg class=md-nav__link> set_secagg() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_strategy class=md-nav__link> set_strategy() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_tags class=md-nav__link> set_tags() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_tensorboard class=md-nav__link> set_tensorboard() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_test_metric class=md-nav__link> set_test_metric() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_test_on_global_updates class=md-nav__link> set_test_on_global_updates() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_test_on_local_updates class=md-nav__link> set_test_on_local_updates() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_test_ratio class=md-nav__link> set_test_ratio() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_training_args class=md-nav__link> set_training_args() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_training_data class=md-nav__link> set_training_data() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_training_plan_class class=md-nav__link> set_training_plan_class() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.set_training_plan_path class=md-nav__link> set_training_plan_path() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.strategy class=md-nav__link> strategy() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.tags class=md-nav__link> tags() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.test_metric class=md-nav__link> test_metric() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.test_metric_args class=md-nav__link> test_metric_args() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.test_on_global_updates class=md-nav__link> test_on_global_updates() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.test_on_local_updates class=md-nav__link> test_on_local_updates() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.test_ratio class=md-nav__link> test_ratio() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.training_args class=md-nav__link> training_args() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.training_data class=md-nav__link> training_data() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.training_plan class=md-nav__link> training_plan() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.training_plan_approve class=md-nav__link> training_plan_approve() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.training_plan_class class=md-nav__link> training_plan_class() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.training_plan_file class=md-nav__link> training_plan_file() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.training_plan_path class=md-nav__link> training_plan_path() </a> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.Experiment.training_replies class=md-nav__link> training_replies() </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment-functions class=md-nav__link> Functions </a> <nav class=toc-nav aria-label=Functions> <ul class=toc-list> <!-- Table of contents item --> <li class=toc-item> <a href=#fedbiomed.researcher.experiment.exp_exceptions class=md-nav__link> exp_exceptions() </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> </div> <!-- News Main Page--> </div> <footer> <div class=container-fluid> <div class=footer-first-inner> <div class=container> <div class=row> <div class=col-md-6> <div class=footer-contact> <strong>Address:</strong> <p>2004 Rte des Lucioles, 06902 Sophia Antipolis</p> <strong>E-mail:</strong> <p>fedbiomed _at_ inria _dot_ fr</p> </div> </div> <div class=col-md-6> <div class=footer-contact> <p>Fed-BioMed © 2022</p> </div> </div> </div> </div> </div> </div> </footer> <!-- JQuery --> <script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script> <!-- Latest compiled and minified JavaScript --> <script src=https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../../assets/javascript/lunr.js></script> <script src=../../../../assets/javascript/theme.js></script> </body> </html>